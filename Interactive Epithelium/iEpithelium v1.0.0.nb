(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1158769,      23539]
NotebookOptionsPosition[   1134587,      22985]
NotebookOutlinePosition[   1144944,      23217]
CellTagsIndexPosition[   1144870,      23212]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Interactive  Epithelium  1.0.0",
 FontFamily->"Alegreya SC",
 FontWeight->"Bold",
 FontColor->RGBColor[
  0.054901960784313725`, 0.615686274509804, 0.00784313725490196]]], "Chapter",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/U5SW6045o2j6uUTmiD6z25lKxB9YsEOWxAd07tO
c2vFG8c3/gpaIDp1m9KE7UD6vmM1mK4K03XbDaSN7H3BtEJZ/ItpDW8c1/1Y
DKbfPN/patr3xlHnxWsw/X1TcF/vhDeOixsjwPSuNRukOie/cbyzQEMaRHcV
a8WA6HcfLiaC6FmSfekguk3IowBEi8psLgXRE5amlYHoW72uVSD6warQZhAt
5LCpA0TX3UnrBdEfUuNzuoH0t09CBSB6nbfw9btAek5mGZieNN9nsdbUN441
+Z/B9K0QrY4ps984rthkDaY7Hi3mXLr4jWMCw1IwvSrtngnzxjeOy0wfgumw
2ZqBsWfeODYs1gHTKSyJm3+ff+Mo054Cpmf4vFy29eUbR60CoeUgGgACesVP

  "],
 FontSize->72,ExpressionUUID->"21d67043-0439-4dcb-9738-67dac4e280fa"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Chapter",
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
   3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
   3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
   3.832654871762952*^9, 3.832654885257023*^9}, {3.832672208050552*^9, 
   3.8326722080944057`*^9}, {3.8346684928733644`*^9, 3.834668495684127*^9}, {
   3.836302854643711*^9, 3.8363028825435247`*^9}, {3.8363172806936665`*^9, 
   3.836317282541274*^9}, 3.840808753066621*^9, 3.845640234527437*^9, 
   3.8671515113077555`*^9, {3.867154114073717*^9, 3.8671541149374094`*^9}},
 Background->RGBColor[
  0.792156862745098, 0.9333333333333333, 
   0.792156862745098],ExpressionUUID->"ef6ebd39-854b-4022-b856-4c37988f2f71"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["I Initialisation",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
   3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
   3.8326544786500597`*^9}, {3.835448207978485*^9, 3.83544820828826*^9}, {
   3.8354484562864656`*^9, 3.835448457090541*^9}, {3.8354485426331406`*^9, 
   3.835448547776848*^9}, 3.8354522639782515`*^9, {3.8806593805314465`*^9, 
   3.880659385508314*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"f5b1c457-01cb-4338-be9b-e8395d123dd5"],

Cell[CellGroupData[{

Cell["Geometrical functions", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.8059530980849442`*^9, 
   3.8059531001517*^9}, {3.8062583523522425`*^9, 3.806258352839839*^9}, {
   3.806437671573043*^9, 3.8064376782901735`*^9}, {3.821379141885955*^9, 
   3.8213791440719543`*^9}, 3.822622817448353*^9, {3.8231499800398006`*^9, 
   3.8231499807818203`*^9}, {3.8243852407119646`*^9, 3.824385242324649*^9}, {
   3.8291143133721895`*^9, 3.8291143135225353`*^9}, {3.8326543684903793`*^9, 
   3.832654369207111*^9}},
 Background->GrayLevel[0.85],
 CellTags->"codetag",ExpressionUUID->"fafd933b-3cf8-470e-b533-54cf079c83d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"un", "=", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"Sequence", "[", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inf", "=", "Infinity"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varstring0", "=", 
   RowBox[{"ToString", "/@", 
    RowBox[{"{", 
     RowBox[{
     "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", ",", 
      "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", "sorc", ",", 
      "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", ",",
       "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
      "stats", ",", "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
      "vormod", ",", "smod", ",", 
      StyleBox["ka", "Input"], 
      StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", "\[Eta]", 
      ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", "diamx", ",", "depQ",
       ",", 
      StyleBox["ka2", "Input"], 
      StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", "a0e2", 
      ",", "d\[Kappa]2", ",", "diamx2", ",", 
      StyleBox["ka3", "Input"], 
      StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", "a0e3", 
      ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", "treshT2", ",", 
      "n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy", ",", "Tvf", ",", 
      "Tsimf", ",", "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
      "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", "stretNQ", ",", 
      "stretN", ",", "Trele", ",", "Thold", ",", "sigallQ", ",", "stetbQ", 
      ",", "bthk", ",", "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", 
      ",", "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", 
      "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", 
      "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",", 
      "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", "\[Kappa]RS", ",", 
      "m", ",", "p", ",", "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", 
      "stefv", ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
      "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",", 
      "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", 
      "cellQ", ",", "longt", ",", "cutcQ", ",", "grQ", ",", "grt", ",", "grT",
       ",", "colo1", ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varstring00", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpression", "@", 
      RowBox[{"(", 
       RowBox[{"#", "<>", "\"\<0\>\""}], ")"}]}], "&"}], "/@", 
    "varstring0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varstring", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<msht\>\"", ",", "\"\<perQ\>\"", ",", "\"\<persQ\>\"", ",", 
     "\"\<lloydQ\>\"", ",", "\"\<mshn\>\"", ",", "\"\<lliter\>\"", ",", 
     "\"\<randQ\>\"", ",", "\"\<seed\>\"", ",", "\"\<fitQ\>\"", ",", 
     "\"\<sorc\>\"", ",", "\"\<plotperQ\>\"", ",", "\"\<plotcoeffvQ\>\"", 
     ",", "\"\<plotSOPnQ\>\"", ",", "\"\<plotSOPdQ\>\"", ",", 
     "\"\<plotsolQ\>\"", ",", "\"\<plotSOPQ\>\"", ",", "\"\<plottimeQ\>\"", 
     ",", "\"\<dlthresh\>\"", ",", "\"\<msimn\>\"", ",", "\"\<sigm\>\"", ",", 
     "\"\<sigr\>\"", ",", "\"\<vmod\>\"", ",", "\"\<vormod\>\"", ",", 
     "\"\<smod\>\"", ",", "\"\<ka\>\"", ",", "\"\<gamc\>\"", ",", 
     "\"\<\[CapitalLambda]\>\"", ",", "\"\<\[Eta]\>\"", ",", 
     "\"\<d\[Eta]\>\"", ",", "\"\<a0e\>\"", ",", "\"\<d\[Kappa]\>\"", ",", 
     "\"\<diamx\>\"", ",", "\"\<depQ\>\"", ",", "\"\<ka2\>\"", ",", 
     "\"\<gamc2\>\"", ",", "\"\<\[CapitalLambda]2\>\"", ",", "\"\<a0e2\>\"", 
     ",", "\"\<d\[Kappa]2\>\"", ",", "\"\<diamx2\>\"", ",", "\"\<ka3\>\"", 
     ",", "\"\<gamc3\>\"", ",", "\"\<\[CapitalLambda]3\>\"", ",", 
     "\"\<a0e3\>\"", ",", "\"\<d\[Kappa]3\>\"", ",", "\"\<diamx3\>\"", ",", 
     "\"\<treshT1\>\"", ",", "\"\<treshT2\>\"", ",", "\"\<n\>\"", ",", 
     "\"\<nx\>\"", ",", "\"\<ny\>\"", ",", "\"\<dmx\>\"", ",", "\"\<dmy\>\"", 
     ",", "\"\<Tvf\>\"", ",", "\"\<Tsimf\>\"", ",", "\"\<Tmax\>\"", ",", 
     "\"\<Tsim\>\"", ",", "\"\<Tsim2\>\"", ",", "\"\<sigs\>\"", ",", 
     "\"\<ss1\>\"", ",", "\"\<streQ\>\"", ",", "\"\<stet\>\"", ",", 
     "\"\<arfixQ0\>\"", ",", "\"\<stretNQ0\>\"", ",", "\"\<stretN0\>\"", ",", 
     "\"\<Trele0\>\"", ",", "\"\<Thold0\>\"", ",", "\"\<sigallQ0\>\"", ",", 
     "\"\<stetbQ\>\"", ",", "\"\<bthk\>\"", ",", "\"\<Tstei\>\"", ",", 
     "\"\<Tstef\>\"", ",", "\"\<fareaQ\>\"", ",", "\"\<fperQ\>\"", ",", 
     "\"\<fltensQ\>\"", ",", "\"\<fhookeQ\>\"", ",", "\"\<rho\>\"", ",", 
     "\"\<k\>\"", ",", "\"\<h\>\"", ",", "\"\<mu\>\"", ",", "\"\<aN0\>\"", 
     ",", "\"\<bN0\>\"", ",", "\"\<iniN\>\"", ",", "\"\<iniD\>\"", ",", 
     "\"\<iniR\>\"", ",", "\"\<\[Beta]N\>\"", ",", "\"\<\[Beta]D\>\"", ",", 
     "\"\<\[Beta]R\>\"", ",", "\"\<\[Tau]\>\"", ",", "\"\<\[Kappa]t\>\"", 
     ",", "\"\<\[Kappa]c\>\"", ",", "\"\<\[Kappa]RS\>\"", ",", "\"\<m\>\"", 
     ",", "\"\<p\>\"", ",", "\"\<l\>\"", ",", "\"\<cisQ\>\"", ",", 
     "\"\<Tste\>\"", ",", "\"\<stefh\>\"", ",", "\"\<stefv\>\"", ",", 
     "\"\<clmp\>\"", ",", "\"\<nv\>\"", ",", "\"\<shpQ\>\"", ",", 
     "\"\<protQ\>\"", ",", "\"\<inoiseQ\>\"", ",", "\"\<effvol\>\"", ",", 
     "\"\<dynpQ\>\"", ",", "\"\<uplQ\>\"", ",", "\"\<pfixQ\>\"", ",", 
     "\"\<pbt\>\"", ",", "\"\<pdt\>\"", ",", "\"\<pll\>\"", ",", 
     "\"\<pla\>\"", ",", "\"\<\[Epsilon]\>\"", ",", "\"\<cellQ\>\"", ",", 
     "\"\<longt\>\"", ",", "\"\<cutcQ\>\"", ",", "\"\<grQ\>\"", ",", 
     "\"\<grt\>\"", ",", "\"\<grT\>\"", ",", "\"\<colo1\>\"", ",", 
     "\"\<colom\>\"", ",", "\"\<colob\>\"", ",", "\"\<mbmt\>\"", ",", 
     "\"\<rmb\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vparams", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\[Epsilon]\>\"", ",", "\"\<n\>\"", ",", "\"\<stefh\>\"", ",", 
     "\"\<stefv\>\"", ",", "\"\<pbt\>\"", ",", "\"\<pdt\>\"", ",", 
     "\"\<ka2\>\"", ",", "\"\<gamc2\>\"", ",", "\"\<\[CapitalLambda]2\>\"", 
     ",", "\"\<a0e2\>\"", ",", "\"\<d\[Kappa]2\>\"", ",", "\"\<diamx2\>\"", 
     ",", "\"\<ka3\>\"", ",", "\"\<gamc3\>\"", ",", 
     "\"\<\[CapitalLambda]3\>\"", ",", "\"\<a0e3\>\"", ",", 
     "\"\<d\[Kappa]3\>\"", ",", "\"\<diamx3\>\"", ",", "\"\<effvol\>\""}], 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8058746030963326`*^9, 3.8058748315540104`*^9}, {
   3.8058749996383777`*^9, 3.805875012299678*^9}, {3.805875043059971*^9, 
   3.8058750450086327`*^9}, {3.805875080903138*^9, 3.8058751033959455`*^9}, {
   3.8058751409167194`*^9, 3.805875160014115*^9}, {3.8058752689941034`*^9, 
   3.8058753169853964`*^9}, {3.8058754094197216`*^9, 3.805875418374257*^9}, {
   3.8058779118119392`*^9, 3.8058779131965275`*^9}, 3.805885937982586*^9, {
   3.8059114464521923`*^9, 3.80591145886129*^9}, {3.8059117247041245`*^9, 
   3.8059117393411303`*^9}, {3.806571613112876*^9, 3.806571614883658*^9}, {
   3.8213794354897704`*^9, 3.821379461550808*^9}, {3.8213795212527723`*^9, 
   3.821379536969772*^9}, 3.8326550462732534`*^9, {3.8326559280999975`*^9, 
   3.832655932086961*^9}, {3.8388066791036043`*^9, 3.8388066830812263`*^9}, {
   3.8397466439228153`*^9, 3.8397466441153*^9}, {3.8397545949284363`*^9, 
   3.839754600567596*^9}, 3.839757764998119*^9, {3.840089020431483*^9, 
   3.840089055351454*^9}, 3.840089304585701*^9, {3.840089348060135*^9, 
   3.840089357996393*^9}, 3.8400894633918943`*^9, {3.840090084135373*^9, 
   3.8400901020400047`*^9}, 3.840092651693836*^9, 3.840111404961424*^9, 
   3.8401844995179505`*^9, {3.8401845778495045`*^9, 3.8401845862808123`*^9}, 
   3.840188725942928*^9, {3.8401887623891487`*^9, 3.840188766532355*^9}, {
   3.840525307312619*^9, 3.840525315360046*^9}, {3.8405267496324964`*^9, 
   3.8405267526773777`*^9}, {3.8406130022845907`*^9, 
   3.8406130028042097`*^9}, {3.840613227271022*^9, 3.8406132493294506`*^9}, {
   3.840619263857085*^9, 3.840619264011672*^9}, {3.840619304531559*^9, 
   3.840619309045436*^9}, {3.840624627261632*^9, 3.840624632982338*^9}, 
   3.841660477445138*^9, {3.841660514354126*^9, 3.8416605151150928`*^9}, {
   3.842601754658464*^9, 3.842601755389072*^9}, {3.8432919357877355`*^9, 
   3.8432919487434344`*^9}, 3.8434693575835667`*^9, {3.843469510864512*^9, 
   3.8434695120745497`*^9}, {3.843472887025317*^9, 3.8434728971760235`*^9}, {
   3.8434753088910213`*^9, 3.84347531148505*^9}, {3.844769560321531*^9, 
   3.844769585656499*^9}, {3.8447703470102005`*^9, 3.8447703512924294`*^9}, {
   3.8447706200383787`*^9, 3.844770642038453*^9}, 3.8447707206035323`*^9, {
   3.844771686660727*^9, 3.8447717029291177`*^9}, {3.84477575597285*^9, 
   3.844775759179556*^9}, {3.845465655172348*^9, 3.845465673665353*^9}, {
   3.845465768077937*^9, 3.8454657814195375`*^9}, 3.8454727840551434`*^9, {
   3.8456361948647594`*^9, 3.845636232125496*^9}, {3.8456386408176684`*^9, 
   3.845638675801261*^9}, {3.845658147541631*^9, 3.8456581517324667`*^9}, 
   3.845658281212926*^9, 3.8456584545285697`*^9, {3.8456585338891134`*^9, 
   3.8456585413204055`*^9}, {3.8456586635187836`*^9, 3.845658663812577*^9}, {
   3.8456587181705027`*^9, 3.8456587448584156`*^9}, 3.855904184789342*^9, {
   3.855904247347905*^9, 3.855904248518856*^9}, {3.855909395322609*^9, 
   3.8559094082942724`*^9}, {3.8559094400283685`*^9, 
   3.8559094445025964`*^9}, {3.855916018421028*^9, 3.8559160296655383`*^9}, {
   3.8560052771794996`*^9, 3.8560052794155397`*^9}, 3.8560053980503273`*^9, {
   3.8565212830625763`*^9, 3.856521284518682*^9}, {3.857032645812021*^9, 
   3.8570326625647717`*^9}, {3.8570333544256797`*^9, 3.8570333815733232`*^9}, 
   3.8570334387523313`*^9, {3.8570335171663747`*^9, 3.8570335250154853`*^9}, 
   3.8570339244446726`*^9, {3.8570473743357534`*^9, 3.8570474053518057`*^9}, 
   3.8570475516601954`*^9, {3.857050174679223*^9, 3.8570501769830627`*^9}, 
   3.857050227760116*^9, 3.8576424910171375`*^9, {3.85764258676784*^9, 
   3.8576426066260214`*^9}, {3.862133732309142*^9, 3.862133744105526*^9}, {
   3.862133840396885*^9, 3.8621338641179543`*^9}, {3.864721944573989*^9, 
   3.8647219697004004`*^9}, {3.8647223187375927`*^9, 
   3.8647223486476364`*^9}, {3.8647257514159365`*^9, 3.864725754163621*^9}, {
   3.865527044082412*^9, 3.8655270463043733`*^9}, 3.86552708976057*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellTags->"codetag",
 CellLabel->"In[1]:=",ExpressionUUID->"3dd97646-9dcf-481e-ae9a-f62f24f2150d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mesh restructuring operations", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.8059530980849442`*^9, 
   3.8059531001517*^9}, {3.8062583523522425`*^9, 3.806258352839839*^9}, 
   3.821382253127762*^9, {3.829114314978956*^9, 3.82911431523919*^9}},
 Background->GrayLevel[0.85],
 CellTags->"codetag",ExpressionUUID->"115e6658-3a3f-4e65-8338-0eb4c442a122"],

Cell[CellGroupData[{

Cell["Periodic mesh ", "Subsubsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
  3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
  3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
  3.8063863428902173`*^9, 3.806386343039177*^9}, {3.8064937311267085`*^9, 
  3.806493737792123*^9}, {3.821379062810771*^9, 3.821379065276965*^9}, {
  3.822622961483551*^9, 3.8226229652971597`*^9}, {3.8226230025305033`*^9, 
  3.822623004508814*^9}, {3.825514476410577*^9, 3.8255144776374083`*^9}, {
  3.838806546038517*^9, 3.838806552401683*^9}, {3.838806622924188*^9, 
  3.8388066326285963`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"43781ef2-a5e6-46e0-ad66-0f9b951abb2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"simulation", " ", "domain"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"xLim", "=", 
     RowBox[{"yLim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalD]", "=", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "@", "xLim"}], ",", 
         RowBox[{"First", "@", "yLim"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Last", "@", "xLim"}], ",", 
         RowBox[{"Last", "@", "yLim"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8226277964614773`*^9, 3.8226277971273212`*^9}, {
  3.8388141354230337`*^9, 3.838814140516189*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[7]:=",ExpressionUUID->"00e1dfb2-2619-4d50-8ef7-495e7ba9429f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "@", "outerCellsFn"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"outerCellsFn", "[", 
    RowBox[{"faceListCoords_", ",", "vertexToCell_", ",", "ptsToIndAssoc_"}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xlim1", "=", 
        RowBox[{"xLim", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"xlim2", "=", 
        RowBox[{"xLim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"ylim1", "=", 
        RowBox[{"yLim", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"ylim2", "=", 
        RowBox[{"yLim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"boundaryCells", ",", "bcells", ",", "temp", ",", "res"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", "faceListCoords"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryCells", "=", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"First", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"temp", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x_", "/;", 
                  RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", "_"}], 
                "}"}], "|", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x_", "/;", 
                  RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", "_"}], "}"}],
                "|", 
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"y_", "/;", 
                  RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], "|", 
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"y_", "/;", 
                  RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}]}]}], 
             "]"}]}], "/.", " ", 
           RowBox[{
            RowBox[{"Key", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bcells", "=", 
         RowBox[{"KeyTake", "[", 
          RowBox[{"faceListCoords", ",", "boundaryCells"}], "]"}]}], ";", 
        RowBox[{"res", "=", 
         RowBox[{"Union", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"Lookup", "[", 
              RowBox[{"vertexToCell", ",", 
               RowBox[{"Lookup", "[", 
                RowBox[{"ptsToIndAssoc", ",", 
                 RowBox[{
                  RowBox[{"DeleteDuplicates", "@", 
                   RowBox[{"Cases", "[", 
                    RowBox[{"bcells", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", "_"}], 
                    "}"}], " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", "_"}], 
                    "}"}], " ", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", 
                    RowBox[{"y_", "/;", 
                    RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], " ", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", 
                    RowBox[{"y_", "/;", 
                    RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}]}], ",", 
                    
                    RowBox[{"{", "3", "}"}]}], "]"}]}], "/.", 
                  "periodicRules"}]}], "]"}]}], "]"}]}], "~", "Join", "~", 
            "boundaryCells"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.823255731159246*^9, 3.8232558053584023`*^9}, {
   3.8232558449284863`*^9, 3.823255849326494*^9}, {3.8232559366526775`*^9, 
   3.823255967537771*^9}, {3.823256045590864*^9, 3.8232561042399654`*^9}, 
   3.82325624827921*^9, {3.823256322786336*^9, 3.823256324671338*^9}, {
   3.823256355507368*^9, 3.8232564176424303`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[9]:=",ExpressionUUID->"c76398dd-5245-4bff-a858-39191d16fca2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"periodicRules", ",", "transformRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"periodicRules", "::", "Information"}], "=", 
   "\"\<shift the points outside the simulation domain to inside the domain\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transformRules", "::", "Information"}], "=", 
   "\"\<vector that shifts the point outside the simulation domain back \
inside\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xlim1", "=", 
       RowBox[{"xLim", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"xlim2", "=", " ", 
       RowBox[{"xLim", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"ylim1", "=", " ", 
       RowBox[{"yLim", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"ylim2", "=", " ", 
       RowBox[{"yLim", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"dstep", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"periodicRules", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "-", "dstep"}], ",", 
              RowBox[{"y", "+", "dstep"}]}], "}"}], ",", "10"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"ylim1", "<", "y", "<", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "-", "dstep"}], ",", "y"}], "}"}], ",", "10"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"xlim1", "<", "x", "<", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"y", "+", "dstep"}]}], "}"}], ",", "10"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "dstep"}], ",", 
              RowBox[{"y", "+", "dstep"}]}], "}"}], ",", "10"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"ylim1", "<", "y", "<", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "dstep"}], ",", "y"}], "}"}], ",", "10"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "dstep"}], ",", 
              RowBox[{"y", "-", "dstep"}]}], "}"}], ",", "10"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"xlim1", "<", "x", "<", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"y", "-", "dstep"}]}], "}"}], ",", "10"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "-", "dstep"}], ",", 
              RowBox[{"y", "-", "dstep"}]}], "}"}], ",", "10"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"transformRules", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "dstep"}], ",", "dstep"}], "}"}], "~", 
           "SetPrecision", "~", "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"ylim1", "<", "y", "<", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "dstep"}], ",", "0"}], "}"}], "~", "SetPrecision", 
           "~", "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"xlim1", "<", "x", "<", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "dstep"}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[LessEqual]", "ylim1"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dstep", ",", "dstep"}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"ylim1", "<", "y", "<", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dstep", ",", "0"}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[LessEqual]", "xlim1"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dstep", ",", 
             RowBox[{"-", "dstep"}]}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"xlim1", "<", "x", "<", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "dstep"}]}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", "\[GreaterEqual]", "xlim2"}]}], ",", 
            RowBox[{"y_", "/;", 
             RowBox[{"y", "\[GreaterEqual]", "ylim2"}]}]}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "dstep"}], ",", 
             RowBox[{"-", "dstep"}]}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "___Real", "}"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "~", "SetPrecision", "~", 
           "10"}]}]}], "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.7610422740763903`*^9, 3.761042314243062*^9}, {
   3.7611091628173122`*^9, 3.7611091633120155`*^9}, {3.761109248993703*^9, 
   3.7611092714974656`*^9}, {3.7611095531646757`*^9, 3.761109576399495*^9}, {
   3.7611096383856173`*^9, 3.7611096804929223`*^9}, {3.761109749105323*^9, 
   3.761109754305421*^9}, {3.7611097944409904`*^9, 3.7611098003731375`*^9}, {
   3.7611098386187515`*^9, 3.761109850701415*^9}, 3.761109956721696*^9, {
   3.761110008958891*^9, 3.7611100270813913`*^9}, {3.76111009432743*^9, 
   3.7611101825852423`*^9}, {3.7611102427631903`*^9, 
   3.7611102451119375`*^9}, {3.761110315905448*^9, 3.761110475722807*^9}, {
   3.7611127132068853`*^9, 3.761112728959713*^9}, {3.7611142277157774`*^9, 
   3.7611142632806196`*^9}, {3.769178862001256*^9, 3.76917886993606*^9}, {
   3.7695780488238983`*^9, 3.769578066142578*^9}, {3.769578400946588*^9, 
   3.7695784171871524`*^9}, {3.769578447427273*^9, 3.7695785117920947`*^9}, {
   3.769579439184763*^9, 3.7695795127888966`*^9}, {3.7695796854830203`*^9, 
   3.769579748349881*^9}, {3.7695799703222337`*^9, 3.769579974410308*^9}, {
   3.7695817500937834`*^9, 3.769581753078803*^9}, {3.7695818725811872`*^9, 
   3.769581897427726*^9}, {3.7695822391547422`*^9, 3.7695822504665203`*^9}, {
   3.7695823525604706`*^9, 3.769582356182779*^9}, {3.769582758202533*^9, 
   3.7695827591879315`*^9}, {3.770875711462261*^9, 3.770875732686477*^9}, {
   3.7708762890423546`*^9, 3.7708763160361524`*^9}, {3.77087649538194*^9, 
   3.77087650020105*^9}, {3.771152139914132*^9, 3.771152157690584*^9}, {
   3.7711525531717634`*^9, 3.771152553563716*^9}, {3.771259359796241*^9, 
   3.771259361072853*^9}, {3.7713090930867357`*^9, 3.7713091061199074`*^9}, {
   3.7713743663696084`*^9, 3.771374381417395*^9}, 3.771405856544181*^9, {
   3.7867816799681387`*^9, 3.786781705225608*^9}, 3.7948051196491823`*^9, 
   3.7962489476825123`*^9, {3.799850252220211*^9, 3.79985033635509*^9}, {
   3.7998503927681255`*^9, 3.799850401702279*^9}, {3.8008707367615986`*^9, 
   3.8008707379534025`*^9}, {3.8073067135409927`*^9, 3.807306788887212*^9}, {
   3.8075332863234053`*^9, 3.807533287384429*^9}, {3.8218557400729723`*^9, 
   3.821855869594931*^9}, {3.8218559395822906`*^9, 3.82185610531479*^9}, {
   3.8218586250603848`*^9, 3.821858732183854*^9}, {3.821859674441352*^9, 
   3.8218598015798945`*^9}, {3.821860188339467*^9, 3.821860188370467*^9}, {
   3.821860790185972*^9, 3.821860817474341*^9}, {3.822627771764947*^9, 
   3.8226277730886917`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[11]:=",ExpressionUUID->"492cd829-20f7-413b-b485-49f0854e3c10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "@", "getLocalTopology"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLocalTopology", "[", 
     RowBox[{
     "ptsToIndAssoc_", ",", "indToPtsAssoc_", ",", "vertexToCell_", ",", 
      "cellVertexGrouping_", ",", "wrappedMat_", ",", "faceListCoords_"}], 
     "]"}], "[", "vertices_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"localtopology", "=", 
        RowBox[{"<|", "|>"}]}], ",", 
       RowBox[{"wrappedcellList", "=", 
        RowBox[{"{", "}"}]}], ",", "vertcellconns", ",", "localcellunion", 
       ",", "v", ",", "wrappedcellpos", ",", 
       RowBox[{"vertcs", "=", "vertices"}], ",", "rl1", ",", "rl2", ",", 
       "\[IndentingNewLine]", "transVector", ",", "wrappedcellCoords", ",", 
       "wrappedcells", ",", "vertOutofBounds", ",", "shiftedPt", ",", 
       RowBox[{"transvecList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"$faceListCoords", "=", "faceListCoords"}], ",", 
       "\[IndentingNewLine]", "vertexQ", ",", "boundsCheck", ",", "rules", 
       ",", "extractcellkeys", ",", "vertind", ",", "cellsconnected", ",", 
       "wrappedcellsrem"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vertexQ", "=", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"vertices", ",", 
         RowBox[{"{", 
          RowBox[{"__", "?", "NumberQ"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"vertexQ", ",", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vertcellconns", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AssociationThread", "[", 
              RowBox[{
               RowBox[{"{", "#", "}"}], " ", ",", 
               RowBox[{"{", 
                RowBox[{"vertexToCell", "[", 
                 RowBox[{"ptsToIndAssoc", "[", "#", "]"}], "]"}], "}"}]}], 
              "]"}], "&"}], "@", "vertices"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vertcs", "=", 
           RowBox[{"{", "vertices", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"localcellunion", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Values", "@", "vertcellconns"}], "]"}]}]}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vertcellconns", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AssociationThread", "[", 
              RowBox[{"#", " ", ",", 
               RowBox[{"Lookup", "[", 
                RowBox[{"vertexToCell", ",", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"ptsToIndAssoc", ",", "#"}], "]"}]}], "]"}]}], 
              "]"}], "&"}], "@", "vertices"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"localcellunion", "=", 
           RowBox[{"Union", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Values", "@", "vertcellconns"}], "]"}]}]}]}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"localcellunion", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"localtopology", ",", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"localcellunion", "\[Rule]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"cellVertexGrouping", "/@", "localcellunion"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "condition", " ", "to", " ", "be", " ", "an", " ", "internal", " ", 
        RowBox[{"edge", ":", " ", 
         RowBox[{
         "both", " ", "vertices", " ", "should", " ", "have", " ", "3", " ", 
          "neighbours"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "if", " ", "a", " ", "vertex", " ", "has", " ", "3", " ", "cells", 
         " ", "in", " ", "its", " ", "local", " ", "neighbourhood", " ", 
         "then", " ", "the", " ", "entire", " ", "network", " ", "topology", 
         " ", "about", " ", "the", " ", "vertex", " ", "is", " ", "known"}], 
        " ", "\[Rule]", " ", 
        RowBox[{"no", " ", "wrapping", " ", "required"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "else", " ", "we", " ", "need", " ", "to", " ", "wrap", " ", "around",
          " ", "the", " ", "vertex", " ", "because", " ", "other", " ", 
         "cells", " ", "are", " ", "connected", " ", "to", " ", "it"}], " ", 
        "\[Rule]", " ", 
        RowBox[{"periodic", " ", "boundary", " ", "conditions"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vert", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vertind", "=", 
            RowBox[{"ptsToIndAssoc", "[", "vert", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cellsconnected", "=", 
            RowBox[{"vertexToCell", "[", "vertind", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "cellsconnected", "]"}], "\[NotEqual]", 
              "3"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "\[ScriptCapitalD]", "~", "RegionMember", "~", "vert"}], 
                 ")"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"v", "=", "vert"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                   RowBox[{"boundsCheck", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "\[Equal]", 
                    RowBox[{"xLim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "||", 
                    RowBox[{"x", "\[Equal]", 
                    RowBox[{"xLim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "||", 
                    RowBox[{"y", "\[Equal]", 
                    RowBox[{"yLim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "||", 
                    RowBox[{"y", "\[Equal]", 
                    RowBox[{"yLim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], "]"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"extractcellkeys", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{"boundsCheck", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rl1", ",", "rl2"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", 
                    RowBox[{"v", "/.", "periodicRules"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"rules", "=", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "x$", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", "rl1"}], ",", 
                    RowBox[{"s", "=", "rl2"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"x$", ",", "r"}], "]"}], "]"}], "||", 
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"x$", ",", "s"}], "]"}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Position", "@@", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rule", "=", "rules"}], "}"}], ",", 
                    RowBox[{"Hold", "[", 
                    RowBox[{"wrappedMat", ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"ReleaseHold", "@", "rule"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Position", "[", 
                    RowBox[{"wrappedMat", ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"x", ",", "v"}], "]"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]",
                    "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "find", " ", "cell", " ", "indices", " ", "that", " ", 
                   "are", " ", "attached", " ", "to", " ", "the", " ", 
                   "vertex", " ", "in", " ", "wrappedMat"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"wrappedcellpos", "=", 
                  RowBox[{"DeleteDuplicatesBy", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"extractcellkeys", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", 
                    RowBox[{"p", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"localcellunion", ",", 
                    RowBox[{"Flatten", "@", "wrappedcellList"}]}], "]"}]}], 
                    "]"}]}], "]"}], ",", "y__"}], "}"}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "y"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "First"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"wrappedcellpos", " ", "=", " ", 
                    RowBox[{"wrappedcellpos", "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Flatten", "[", "wrappedcellList", "]"}]}], ",", 
                    "__"}], "}"}], " ", "\[RuleDelayed]", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}]}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "if", " ", "a", " ", "wrapped", " ", "cell", " ", "has", 
                   " ", "not", " ", "been", " ", "considered", " ", "earlier",
                    " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"i", ".", "e", ".", " ", "is"}], " ", "new"}], 
                    ")"}], " ", "then", " ", "we", " ", "translate", " ", 
                   "it", " ", "to", " ", "the", " ", "position", " ", "of", 
                   " ", "the", " ", "vertex"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"wrappedcellpos", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"vertexQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"transVector", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"$faceListCoords", ",", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p_", ",", "q__"}], "}"}], "\[RuleDelayed]", " ", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", "p", "]"}], ",", "q"}], "}"}]}]}], 
                    "]"}]}], "]"}]}], ")"}], "&"}], "/@", "wrappedcellpos"}], 
                    ",", "10"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "call", " ", "to", " ", "function", " ", "is", " ", 
                    "enquiring", " ", "an", " ", "edge", " ", "and", " ", 
                    "not", " ", "a", " ", "vertex"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"transVector", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"$faceListCoords", ",", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p_", ",", "q__"}], "}"}], "\[RuleDelayed]", " ", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", "p", "]"}], ",", "q"}], "}"}]}]}], 
                    "]"}]}], "]"}]}], ")"}], "&"}], "/@", "wrappedcellpos"}], 
                    ",", "10"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"wrappedcellCoords", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", " ", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"x", "+", "#2"}], ",", "10"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"$faceListCoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "@", "#1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "/@", "wrappedcellpos"}], ",", 
                    "transVector"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wrappedcells", "=", " ", 
                    RowBox[{"Keys", "@", "wrappedcellCoords"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wrappedcellList", ",", 
                    RowBox[{"Flatten", "@", "wrappedcells"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"transvecList", ",", "transVector"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"localtopology", ",", "wrappedcellCoords"}], 
                    "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"the", " ", "else", " ", 
                  RowBox[{"clause", ":", " ", 
                   RowBox[{
                   "vertex", " ", "is", " ", "out", " ", "of", " ", 
                    "bounds"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vertOutofBounds", "=", "vert"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "translate", " ", "the", " ", "vertex", " ", "back", " ", 
                   "into", " ", "mesh"}], " ", "*)"}], "\[IndentingNewLine]", 
                 
                 RowBox[{"transVector", "=", 
                  RowBox[{"vertOutofBounds", "/.", "transformRules"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"shiftedPt", "=", " ", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{
                    RowBox[{"vertOutofBounds", "+", "transVector"}], ",", 
                    "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "CORE"}]}]}]}]}]}]}], " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"B", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "find", " ", "which", " ", "cells", " ", "the", " ", 
                   "shifted", " ", "vertex", " ", "is", " ", "a", " ", "part",
                    " ", "of", " ", "in", " ", "the", " ", "wrapped", " ", 
                   "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"wrappedcells", "=", 
                  RowBox[{"Complement", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Union", "@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"wrappedMat", ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"x", ",", "shiftedPt"}], "]"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"x_Key", "\[RuleDelayed]", 
                    RowBox[{"Sequence", "@@", "x"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "/.", 
                    RowBox[{
                    RowBox[{"Alternatives", "@@", "localcellunion"}], 
                    "\[Rule]", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Flatten", "@", "wrappedcellList"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "forming", " ", "local", " ", "topology", " ", "now", " ", 
                   "that", " ", "we", " ", "know", " ", "the", " ", "wrapped",
                    " ", "cells"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"wrappedcells", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wrappedcellList", ",", 
                    RowBox[{"Flatten", "@", "wrappedcells"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wrappedcellCoords", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"wrappedcells", ",", "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "&"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cellVertexGrouping", "[", "#", "]"}], "&"}], "/@",
                     "wrappedcells"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"opt", "=", 
                    RowBox[{"(", 
                    RowBox[{"vertOutofBounds", "/.", "periodicRules"}], 
                    ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pos", ",", "vertref", ",", "transvec"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cellcoords", "=", 
                    RowBox[{"wrappedcellCoords", "[", "cell", "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pos", "=", 
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{
                    RowBox[{"cellcoords", "/.", "periodicRules"}], ",", 
                    "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"vertref", "=", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"cellcoords", ",", "pos"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"transvec", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"vertOutofBounds", "-", "vertref"}], ",", "10"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"transvecList", ",", "transvec"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"localtopology", ",", 
                    RowBox[{"cell", "\[Rule]", " ", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"#", "+", "transvec"}], ",", "10"}], "]"}], "&"}],
                     ",", "cellcoords"}], "]"}]}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"cell", ",", "wrappedcells"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "to", " ", "detect", " ", "wrapped", " ", "cells", " ", 
                   "not", " ", "detected", " ", "by", " ", "CORE", " ", "B"}],
                   "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "CORE"}]}]}]}]}]}]}], " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"C", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Block", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "pos", ",", "celllocs", ",", "ls", ",", "transvec", ",", 
                    "assoc", ",", 
                    RowBox[{"tvecLs", "=", 
                    RowBox[{"{", "}"}]}], ",", "ckey"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ls", "=", 
                    RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"cellsconnected", ",", "wrappedcells"}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ls", "]"}], "\[NotEqual]", " ", 
                    "3"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"$faceListCoords", ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"x", ",", "shiftedPt"}], "]"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"celllocs", "=", 
                    RowBox[{
                    RowBox[{"DeleteDuplicatesBy", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"pos", ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", 
                    RowBox[{"Alternatives", "@@", "ls"}], "]"}], ",", "__"}], 
                    "}"}], "]"}]}], "]"}], ",", "First"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", "x_", "]"}], ",", "z__"}], "}"}], 
                    "\[RuleDelayed]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Key", "[", "x", "]"}], ",", 
                    RowBox[{"{", "z", "}"}]}], "}"}]}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"celllocs", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"celllocs", "=", 
                    RowBox[{"Transpose", "@", "celllocs"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"assoc", "=", 
                    RowBox[{"<|", "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"transvec", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"vertOutofBounds", "-", 
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{"$faceListCoords", "[", 
                    RowBox[{"Sequence", "@@", "#1"}], "]"}], ",", "#2"}], 
                    "]"}]}], ",", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"ckey", "=", 
                    RowBox[{"Identity", "@@", "#1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tvecLs", ",", "transvec"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ckey", "\[Rule]", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "+", 
                    "transvec"}], ",", "10"}], "]"}], "&"}], ",", 
                    RowBox[{"cellVertexGrouping", "[", 
                    RowBox[{"Sequence", "@@", "#1"}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", ")"}], "&"}], ",", "celllocs"}], 
                    "]"}], "\[IndentingNewLine]", "|>"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"localtopology", ",", "assoc"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"wrappedcellList", ",", 
                    RowBox[{"Keys", "@", "assoc"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"transvecList", ",", "tvecLs"}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       "vertcs"}], ";", "\[IndentingNewLine]", 
      RowBox[{"transvecList", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"transvecList", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"__", "?", "NumberQ"}], "}"}], "}"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"First", "[", "transvecList", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"transvecList", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"__", "?", "NumberQ"}], "}"}], ".."}], "}"}]}], "]"}], 
         ",", "transvecList", ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"transvecList", "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x___", ",", 
             RowBox[{"{", 
              RowBox[{"p", ":", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"__", "?", "NumberQ"}], "}"}], ".."}]}], "}"}], ",", 
             "y___"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "p", ",", "y"}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"localtopology", ",", 
        RowBox[{"Flatten", "@", "wrappedcellList"}], ",", "transvecList"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.7619972843982573`*^9, 3.7619972911572185`*^9}, {
   3.761997379130829*^9, 3.761997407868949*^9}, {3.7619987603056684`*^9, 
   3.761998775261656*^9}, {3.761998830382189*^9, 3.761998835327984*^9}, {
   3.7621839883432817`*^9, 3.7621839952358427`*^9}, {3.762185964975376*^9, 
   3.762185965207781*^9}, {3.762325561768496*^9, 3.7623256037312202`*^9}, {
   3.762325705618636*^9, 3.7623257238638544`*^9}, {3.762337124960411*^9, 
   3.7623371364277315`*^9}, {3.762337274443508*^9, 3.762337355663228*^9}, {
   3.7623373942101016`*^9, 3.762337394723728*^9}, {3.762337426328142*^9, 
   3.762337441352977*^9}, {3.7623377078120704`*^9, 3.762337766640707*^9}, {
   3.7623378035379877`*^9, 3.762337804175293*^9}, {3.76253419344483*^9, 
   3.762534193678195*^9}, {3.762581285305636*^9, 3.762581305458725*^9}, {
   3.7625816239645686`*^9, 3.762581680574967*^9}, 3.7625818458255587`*^9, {
   3.762582252492511*^9, 3.762582287262596*^9}, {3.7625824783509183`*^9, 
   3.762582488626306*^9}, {3.7625827058418474`*^9, 3.7625827579682035`*^9}, {
   3.762582833436036*^9, 3.762582850880048*^9}, {3.76258335344681*^9, 
   3.7625833550158606`*^9}, {3.7625837343167906`*^9, 3.762583747935442*^9}, {
   3.762583933595067*^9, 3.762583959524957*^9}, {3.762584017282404*^9, 
   3.7625840415090103`*^9}, {3.7625845070682755`*^9, 
   3.7625845082506094`*^9}, {3.762584817612939*^9, 3.762584826089916*^9}, {
   3.762584866252762*^9, 3.762584922521736*^9}, {3.762584956883673*^9, 
   3.762585097301598*^9}, {3.7625852144149723`*^9, 3.762585233955674*^9}, {
   3.762585325947456*^9, 3.7625853406541367`*^9}, {3.762585381939678*^9, 
   3.76258538220401*^9}, {3.7625854544208636`*^9, 3.762585489619001*^9}, 
   3.7625855276971865`*^9, {3.7625855799698973`*^9, 3.7625856126920533`*^9}, {
   3.7625856492310314`*^9, 3.7625857471574917`*^9}, {3.7625860818489156`*^9, 
   3.7625860835007925`*^9}, {3.7625861752977843`*^9, 
   3.7625861788637743`*^9}, {3.7625895061999087`*^9, 3.762589519686819*^9}, {
   3.7625896836648045`*^9, 3.762589705585043*^9}, {3.76258979978016*^9, 
   3.7625898015257215`*^9}, {3.762589861056532*^9, 3.762589898100127*^9}, 
   3.762591055732869*^9, {3.7625912142016497`*^9, 3.762591217445634*^9}, {
   3.762591293856923*^9, 3.762591317049873*^9}, {3.762591368070636*^9, 
   3.7625913698820243`*^9}, {3.7625914324900746`*^9, 
   3.7625914441179485`*^9}, {3.7625914786060224`*^9, 3.762591481203523*^9}, {
   3.762591531255265*^9, 3.762591531489197*^9}, {3.7625927746209745`*^9, 
   3.7625927891885195`*^9}, 3.7625934122985935`*^9, {3.762593486271052*^9, 
   3.7625934898153315`*^9}, {3.762593522730626*^9, 3.7625935282505765`*^9}, {
   3.762593689373742*^9, 3.762593694300915*^9}, {3.7625947729670925`*^9, 
   3.76259477933537*^9}, {3.762596030874425*^9, 3.7625960728194275`*^9}, {
   3.7625961728494673`*^9, 3.7625961809413366`*^9}, 3.7625995414036217`*^9, 
   3.7625996642711444`*^9, {3.7625997342731037`*^9, 3.762599750871684*^9}, {
   3.762599809166724*^9, 3.7625998563205914`*^9}, {3.762600025923849*^9, 
   3.762600037274468*^9}, {3.7626020921902733`*^9, 3.762602092441601*^9}, {
   3.7626022245343285`*^9, 3.7626022275303144`*^9}, {3.762602321014373*^9, 
   3.7626023687526565`*^9}, {3.762602411986988*^9, 3.762602428507789*^9}, {
   3.762602468789022*^9, 3.762602475846151*^9}, {3.762602858756221*^9, 
   3.7626029258553057`*^9}, {3.762721043474702*^9, 3.7627210524426994`*^9}, {
   3.762721098821639*^9, 3.76272111423342*^9}, {3.7628839945472364`*^9, 
   3.7628839977825813`*^9}, {3.76288785966564*^9, 3.762887859968829*^9}, {
   3.7628883409031525`*^9, 3.7628884449936743`*^9}, {3.7628884986820383`*^9, 
   3.7628886495304947`*^9}, {3.7628886929313498`*^9, 3.762888725818392*^9}, {
   3.7628887618380055`*^9, 3.7628888467628293`*^9}, {3.762932032268837*^9, 
   3.7629320384283485`*^9}, {3.7629321491640954`*^9, 
   3.7629321550453677`*^9}, {3.76293264467642*^9, 3.7629326718856287`*^9}, {
   3.762932733013056*^9, 3.7629327515045843`*^9}, {3.7629331142162313`*^9, 
   3.762933128431199*^9}, {3.762933160551235*^9, 3.7629332003248625`*^9}, {
   3.7629334250775623`*^9, 3.7629334307314363`*^9}, {3.762933472932501*^9, 
   3.7629334785943537`*^9}, {3.7629430049729414`*^9, 3.762943032758599*^9}, {
   3.762943071002279*^9, 3.762943103832446*^9}, {3.762944091829195*^9, 
   3.762944094821191*^9}, 3.762944198748149*^9, {3.7629476376089783`*^9, 
   3.7629476425328045`*^9}, {3.762947765059969*^9, 3.762947794517186*^9}, {
   3.762947919960584*^9, 3.762947921784707*^9}, {3.762948676599269*^9, 
   3.7629487043370867`*^9}, {3.7629489009001837`*^9, 3.7629489026974*^9}, {
   3.762948958082201*^9, 3.762948961911955*^9}, {3.762949199077449*^9, 
   3.7629492012127633`*^9}, {3.7629492387144113`*^9, 3.762949251834306*^9}, 
   3.76294931311539*^9, {3.762949406370878*^9, 3.7629494907920403`*^9}, {
   3.762949525211937*^9, 3.762949527988525*^9}, {3.7629713105203314`*^9, 
   3.762971311573514*^9}, {3.7629713615597506`*^9, 3.762971398799122*^9}, {
   3.7629724133037705`*^9, 3.7629724176710553`*^9}, {3.762972494983039*^9, 
   3.7629725864024773`*^9}, {3.7630214230493717`*^9, 
   3.7630214371347203`*^9}, {3.763021480802859*^9, 3.7630215549584913`*^9}, {
   3.76302161231505*^9, 3.763021640276243*^9}, {3.763021683994248*^9, 
   3.7630216869713163`*^9}, {3.7630217433604217`*^9, 3.763021798161827*^9}, {
   3.763021838299426*^9, 3.763021841031149*^9}, {3.763021877444699*^9, 
   3.7630218822598486`*^9}, {3.7630219336663165`*^9, 
   3.7630219905879984`*^9}, {3.7630224528672676`*^9, 3.763022470829178*^9}, {
   3.7630225817289057`*^9, 3.7630225865490093`*^9}, {3.7630226637444844`*^9, 
   3.7630226676290603`*^9}, {3.7630227750836115`*^9, 3.763022775385808*^9}, {
   3.763022962208951*^9, 3.7630229683535113`*^9}, {3.763023024574133*^9, 
   3.7630230257998543`*^9}, {3.7630230945329676`*^9, 3.763023097766286*^9}, {
   3.7630232393831267`*^9, 3.76302324591565*^9}, 3.7691872222885847`*^9, {
   3.7692538419200163`*^9, 3.769253878444356*^9}, {3.76925394012638*^9, 
   3.7692539406609426`*^9}, {3.7692539964586973`*^9, 3.7692541582110357`*^9}, 
   3.769325201729751*^9, {3.769498658812662*^9, 3.76949865969128*^9}, {
   3.769498709932908*^9, 3.769498720055869*^9}, {3.7694995259125443`*^9, 
   3.7694995503990855`*^9}, {3.7695111311316643`*^9, 3.76951116335353*^9}, {
   3.769511332974861*^9, 3.769511333837554*^9}, 3.769511393474048*^9, {
   3.769511438079754*^9, 3.7695114985799427`*^9}, {3.7695115341198926`*^9, 
   3.769511536700989*^9}, {3.7695115795723333`*^9, 3.769511602963771*^9}, {
   3.7695117099660406`*^9, 3.7695117641950006`*^9}, {3.769511802039752*^9, 
   3.769511810619836*^9}, {3.7695119957586803`*^9, 3.7695119978999414`*^9}, {
   3.7695120798646994`*^9, 3.7695121044489803`*^9}, {3.7695121384061613`*^9, 
   3.769512157630744*^9}, {3.769512224239565*^9, 3.769512247119381*^9}, {
   3.769512659091578*^9, 3.76951265982561*^9}, {3.769512690511544*^9, 
   3.769512691167783*^9}, {3.7695128739848375`*^9, 3.7695128745662775`*^9}, {
   3.769512967426921*^9, 3.7695129740352526`*^9}, {3.7695130418927574`*^9, 
   3.769513076122177*^9}, {3.7695132682682753`*^9, 3.769513272802182*^9}, {
   3.7695141939295654`*^9, 3.769514194163973*^9}, {3.7695147229038076`*^9, 
   3.769514759760235*^9}, 3.769514896024789*^9, {3.7695150277464952`*^9, 
   3.769515037222185*^9}, {3.7695153630018497`*^9, 3.7695153893514123`*^9}, {
   3.769515549343467*^9, 3.769515577923063*^9}, {3.7695156903533688`*^9, 
   3.7695157037246094`*^9}, {3.769515839373822*^9, 3.7695158586831284`*^9}, {
   3.7695158924348593`*^9, 3.7695159189679313`*^9}, {3.769515981280279*^9, 
   3.76951598518582*^9}, {3.769516053114154*^9, 3.7695160630386057`*^9}, {
   3.769516339757518*^9, 3.769516374060767*^9}, 3.7695164280254374`*^9, 
   3.769516599076947*^9, {3.7695168821645164`*^9, 3.7695169095801773`*^9}, {
   3.7695170771196847`*^9, 3.769517086361002*^9}, {3.769517514239682*^9, 
   3.769517518805503*^9}, {3.769517632264021*^9, 3.7695176736693153`*^9}, {
   3.769518197501279*^9, 3.769518227310584*^9}, {3.7695182995752764`*^9, 
   3.7695183117447653`*^9}, {3.76951839082024*^9, 3.769518422665101*^9}, {
   3.7695186002042685`*^9, 3.7695186005902224`*^9}, {3.7695186638480206`*^9, 
   3.769518674794772*^9}, {3.7695200322641454`*^9, 3.7695200635095825`*^9}, {
   3.7695202005391035`*^9, 3.7695202101883135`*^9}, 3.769520579939372*^9, {
   3.7695207259797792`*^9, 3.769520768559925*^9}, {3.769520834657159*^9, 
   3.769520837387848*^9}, 3.7695215620476894`*^9, {3.769521601403431*^9, 
   3.769521652151738*^9}, {3.7695216911624002`*^9, 3.769521697504444*^9}, {
   3.76952191105427*^9, 3.769521915462504*^9}, {3.769522029953261*^9, 
   3.769522066355933*^9}, {3.769523023244671*^9, 3.7695230287659416`*^9}, {
   3.769571012993978*^9, 3.7695710228655763`*^9}, 3.769573992512667*^9, {
   3.7695754396003637`*^9, 3.7695754439616857`*^9}, {3.7695766284846425`*^9, 
   3.7695766337435894`*^9}, {3.769576823775329*^9, 3.7695768262876425`*^9}, {
   3.7695768591487284`*^9, 3.769576899128826*^9}, {3.7695770448740263`*^9, 
   3.7695770543397064`*^9}, {3.7695773243614955`*^9, 3.769577359687049*^9}, {
   3.7695774092046127`*^9, 3.769577473947424*^9}, {3.7695775226621666`*^9, 
   3.769577550584491*^9}, {3.7695775861124597`*^9, 3.769577727088391*^9}, {
   3.7695783394715724`*^9, 3.7695783397438555`*^9}, {3.769578597336342*^9, 
   3.769578612642408*^9}, {3.769580276277953*^9, 3.7695802810172777`*^9}, {
   3.7695809861154537`*^9, 3.7695810265183787`*^9}, {3.769581110179656*^9, 
   3.7695811132324905`*^9}, {3.769581234281743*^9, 3.769581239367142*^9}, {
   3.76958127305105*^9, 3.7695812918128414`*^9}, {3.76958135044206*^9, 
   3.7695813527199745`*^9}, {3.76958148190746*^9, 3.7695814870357475`*^9}, {
   3.7695815345356703`*^9, 3.7695815501299973`*^9}, {3.769581616502482*^9, 
   3.76958162067233*^9}, {3.769581793494686*^9, 3.7695817952240815`*^9}, {
   3.7695819597579985`*^9, 3.769581981525779*^9}, {3.7695820377873373`*^9, 
   3.769582068349599*^9}, {3.769582465190238*^9, 3.7695824702217464`*^9}, {
   3.769582540375125*^9, 3.7695825688758926`*^9}, {3.769582822980283*^9, 
   3.769582856908572*^9}, {3.7695830424213963`*^9, 3.7695830434057803`*^9}, {
   3.7695835086305556`*^9, 3.76958351830466*^9}, {3.7695836746156015`*^9, 
   3.769583724329672*^9}, {3.7695837552011075`*^9, 3.7695838026781263`*^9}, {
   3.7695838363011804`*^9, 3.7695838374600697`*^9}, {3.7695839079844484`*^9, 
   3.7695839495084248`*^9}, {3.769584493752803*^9, 3.769584522294489*^9}, {
   3.7695846248292246`*^9, 3.7695846383560786`*^9}, {3.769589304231016*^9, 
   3.7695893147698603`*^9}, 3.7695920461207604`*^9, {3.769592104445757*^9, 
   3.769592135283307*^9}, {3.769592403187756*^9, 3.76959241476083*^9}, {
   3.7695925076134977`*^9, 3.7695925389456987`*^9}, {3.769592581117875*^9, 
   3.7695925974013257`*^9}, {3.7695926485046654`*^9, 
   3.7695926496775107`*^9}, {3.7695927471358895`*^9, 
   3.7695927473792057`*^9}, {3.7695929838348293`*^9, 
   3.7695929885641804`*^9}, {3.7695930810946817`*^9, 3.769593081497595*^9}, {
   3.7695944025513926`*^9, 3.769594407908099*^9}, {3.7695945267123213`*^9, 
   3.7695945269876165`*^9}, {3.76959518860806*^9, 3.769595200787518*^9}, {
   3.769595243334725*^9, 3.769595248084022*^9}, {3.7695958386744537`*^9, 
   3.769595851355521*^9}, {3.769595888229931*^9, 3.769595910730747*^9}, {
   3.7695960183399487`*^9, 3.769596043463721*^9}, 3.769596481987876*^9, {
   3.7695965150394783`*^9, 3.7695965179267883`*^9}, {3.7695966770910664`*^9, 
   3.769596683306473*^9}, {3.769597071532119*^9, 3.769597086673622*^9}, {
   3.7695971414521494`*^9, 3.769597141804207*^9}, {3.7696001222937603`*^9, 
   3.7696001326989627`*^9}, {3.769602239482272*^9, 3.7696022489659386`*^9}, {
   3.7696025285112877`*^9, 3.7696025288892746`*^9}, {3.76961622699596*^9, 
   3.769616258976433*^9}, {3.769619496640492*^9, 3.7696194968020906`*^9}, {
   3.769619533801136*^9, 3.7696195553445168`*^9}, {3.7696196016815553`*^9, 
   3.7696196196834087`*^9}, {3.7696231686964607`*^9, 3.769623209489358*^9}, {
   3.769623402907055*^9, 3.769623405928973*^9}, 3.769624255546644*^9, {
   3.769653424903903*^9, 3.7696534391248703`*^9}, {3.7708826113460937`*^9, 
   3.7708826118377757`*^9}, {3.7708826502131295`*^9, 3.770882650652954*^9}, 
   3.770882870334367*^9, {3.77089413721914*^9, 3.7708941376480327`*^9}, {
   3.771316502979961*^9, 3.7713165794005365`*^9}, 3.7713166900804577`*^9, {
   3.77131672027768*^9, 3.7713167476574636`*^9}, {3.7714074637526045`*^9, 
   3.7714074670488195`*^9}, {3.771407506500288*^9, 3.7714075558094387`*^9}, {
   3.7714076125078363`*^9, 3.7714076178944635`*^9}, {3.7714076494789734`*^9, 
   3.771407654476641*^9}, {3.7714076903656445`*^9, 3.771407738560805*^9}, {
   3.7715535452400427`*^9, 3.771553545375679*^9}, {3.781674103234933*^9, 
   3.7816741184373207`*^9}, {3.7816742587239866`*^9, 3.781674273422671*^9}, 
   3.781674358078185*^9, {3.781674544964175*^9, 3.781674551037956*^9}, {
   3.7816746225107417`*^9, 3.7816747165930405`*^9}, {3.781674747859423*^9, 
   3.7816747617532325`*^9}, {3.7816750880442605`*^9, 3.781675120568281*^9}, {
   3.781675184314741*^9, 3.781675203060602*^9}, {3.7816752900518627`*^9, 
   3.7816753506541367`*^9}, {3.781675417916168*^9, 3.781675421868603*^9}, {
   3.781675468586622*^9, 3.781675472574956*^9}, {3.7816755475164557`*^9, 
   3.781675600542592*^9}, {3.7816756315546265`*^9, 3.781675680984398*^9}, {
   3.781676311147502*^9, 3.781676335336808*^9}, {3.781676694646524*^9, 
   3.781676704581955*^9}, {3.7816767472139053`*^9, 3.781676747392378*^9}, {
   3.7816776279675636`*^9, 3.7816776807503977`*^9}, {3.781677744407058*^9, 
   3.7816777574033327`*^9}, {3.781677869590147*^9, 3.781677869922291*^9}, {
   3.782321082964028*^9, 3.782321084430128*^9}, {3.782373931879709*^9, 
   3.7823739352856026`*^9}, {3.782419510096422*^9, 3.7824195174786882`*^9}, {
   3.782420024822645*^9, 3.782420027046699*^9}, {3.7824202804603095`*^9, 
   3.782420288212577*^9}, {3.7824204660911036`*^9, 3.7824204674893527`*^9}, {
   3.782420540238886*^9, 3.782420573075111*^9}, {3.7824206217250657`*^9, 
   3.782420625331427*^9}, 3.782420671977735*^9, {3.7824208658285527`*^9, 
   3.7824208759385405`*^9}, {3.78242107330096*^9, 3.782421080185555*^9}, {
   3.7824211811057854`*^9, 3.7824212292411175`*^9}, {3.78242127575478*^9, 
   3.7824212761018534`*^9}, {3.783848905633876*^9, 3.7838489132445073`*^9}, {
   3.783849306173318*^9, 3.7838493559022217`*^9}, {3.783849395553108*^9, 
   3.783849496575777*^9}, {3.783849671031081*^9, 3.7838497181948442`*^9}, {
   3.783850567342113*^9, 3.7838506490025682`*^9}, {3.783850730740814*^9, 
   3.783850731628439*^9}, {3.783850894640209*^9, 3.783850895962636*^9}, 
   3.7839344881541653`*^9, {3.784476965797349*^9, 3.7844770138447685`*^9}, {
   3.7844770712401114`*^9, 3.7844770755097275`*^9}, {3.785747373710929*^9, 
   3.7857473781590586`*^9}, {3.785747935717223*^9, 3.785747943763708*^9}, {
   3.786957756791807*^9, 3.7869577744435387`*^9}, {3.7948052483548017`*^9, 
   3.794805306595981*^9}, {3.7948053411615353`*^9, 3.794805343957061*^9}, {
   3.7948054091665936`*^9, 3.7948054411480255`*^9}, {3.794805540823345*^9, 
   3.7948055493904333`*^9}, {3.7948056386854916`*^9, 3.794805642306838*^9}, {
   3.7948056909197736`*^9, 3.794805692882524*^9}, {3.794805731808382*^9, 
   3.7948057573729815`*^9}, 3.794805989850004*^9, {3.7948072338731594`*^9, 
   3.7948072402700467`*^9}, {3.794807303160779*^9, 3.7948073063422737`*^9}, {
   3.795721183898082*^9, 3.795721251916125*^9}, {3.7957213044525833`*^9, 
   3.7957213077876616`*^9}, 3.795721351080879*^9, {3.7998495014280424`*^9, 
   3.799849519271311*^9}, 3.799849557255674*^9, {3.799850428889514*^9, 
   3.7998504466948805`*^9}, {3.7998504871266594`*^9, 
   3.7998504905824604`*^9}, {3.799850522700515*^9, 3.7998505315229053`*^9}, {
   3.799850570632269*^9, 3.799850617660458*^9}, {3.8073069603609056`*^9, 
   3.8073069704083962`*^9}, {3.8073070542833343`*^9, 3.807307054920644*^9}, {
   3.8075324168618965`*^9, 3.8075324455585175`*^9}, {3.821857377088685*^9, 
   3.821857379176687*^9}, {3.8218575841269393`*^9, 3.8218576120529737`*^9}, {
   3.8218577642980385`*^9, 3.8218577782710447`*^9}, {3.821857954887117*^9, 
   3.821857958943119*^9}, {3.8218579982361326`*^9, 3.8218579985971327`*^9}, {
   3.8218601883805013`*^9, 3.8218601884154673`*^9}, {3.821860615298319*^9, 
   3.8218606253555264`*^9}, {3.821860666902233*^9, 3.8218606816474853`*^9}, {
   3.821860843969629*^9, 3.821860882093094*^9}, {3.8218610276958876`*^9, 
   3.821861031027917*^9}, {3.8218610759522734`*^9, 3.8218610961544857`*^9}, {
   3.8218612333356576`*^9, 3.821861264725934*^9}, {3.821861727662811*^9, 
   3.821861745642877*^9}, {3.8218626529895134`*^9, 3.8218626829090347`*^9}, {
   3.8218628706847825`*^9, 3.8218628860999746`*^9}, {3.8218629483347855`*^9, 
   3.8218629704030623`*^9}, 3.8218630616602015`*^9, {3.8218648657336593`*^9, 
   3.821864893134699*^9}, {3.8218649645417995`*^9, 3.8218649840008593`*^9}, {
   3.821865017276873*^9, 3.821865017401873*^9}, {3.8218650632779374`*^9, 
   3.821865112267039*^9}, {3.8218652404581738`*^9, 3.8218652416751995`*^9}, {
   3.821865289332218*^9, 3.821865289398253*^9}, {3.821865681569595*^9, 
   3.8218656818385944`*^9}, {3.8218662266439867`*^9, 3.821866226693987*^9}, {
   3.821866505779149*^9, 3.821866511439184*^9}, 3.821866727082288*^9, {
   3.8218668527272587`*^9, 3.8218668959643793`*^9}, {3.8218669895274515`*^9, 
   3.8218669896644897`*^9}, {3.8218670301724014`*^9, 
   3.8218670338574877`*^9}, {3.8218674878184977`*^9, 
   3.8218674957336206`*^9}, {3.8218675721514673`*^9, 3.821867580242592*^9}, {
   3.821867813688122*^9, 3.8218678372932854`*^9}, {3.821867914124959*^9, 
   3.8218679474102*^9}, {3.8218679928625765`*^9, 3.8218680826803155`*^9}, {
   3.8218713347598763`*^9, 3.821871380711605*^9}, {3.8218714539517293`*^9, 
   3.821871495089411*^9}, {3.8218716624706016`*^9, 3.8218716869258785`*^9}, {
   3.8218717287483177`*^9, 3.821871759854669*^9}, {3.821871817328319*^9, 
   3.8218718692369175`*^9}, {3.8218732050257797`*^9, 3.8218732489978886`*^9}, 
   3.822453459714497*^9, {3.822566346272728*^9, 3.822566355937773*^9}, {
   3.822566393129941*^9, 3.822566396167954*^9}, {3.8225739999588537`*^9, 
   3.822574005146886*^9}, {3.8225742791848536`*^9, 3.8225742832298965`*^9}, {
   3.8225743361848536`*^9, 3.822574353942854*^9}, {3.8225744108498535`*^9, 
   3.822574449640891*^9}, 3.8225746513348866`*^9, {3.8225747017028856`*^9, 
   3.8225747256208854`*^9}, {3.8225747883828535`*^9, 
   3.8225748028198876`*^9}, {3.822575426645853*^9, 3.8225754430008535`*^9}, {
   3.8225755386058893`*^9, 3.8225755768008537`*^9}, {3.822576588135887*^9, 
   3.8225766322838535`*^9}, {3.822576725303854*^9, 3.822576727334891*^9}, {
   3.8225769308368883`*^9, 3.822576943971854*^9}, 3.8225775738428545`*^9, {
   3.8225785334848843`*^9, 3.8225785936218834`*^9}, {3.822578624560851*^9, 
   3.8225786617258835`*^9}, 3.8225787079868894`*^9, {3.822578894462852*^9, 
   3.822578915772851*^9}, {3.8225791103358507`*^9, 3.822579110679881*^9}, {
   3.8225792398768835`*^9, 3.8225792402908516`*^9}, {3.822579478365886*^9, 
   3.8225794805468836`*^9}, {3.822647627226272*^9, 3.8226476341528196`*^9}, {
   3.822648629651992*^9, 3.8226486298389764`*^9}, {3.8227182201080856`*^9, 
   3.8227182256831264`*^9}, {3.822718264558138*^9, 3.8227182647971387`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[15]:=",ExpressionUUID->"b6987550-1c44-4c8e-83f2-dbe8502c5b66"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["II Signalling Model",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
  3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
  3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
  3.8354482124686584`*^9, 3.835448216607688*^9}, {3.835448460311715*^9, 
  3.8354484608284793`*^9}, {3.8354485353898063`*^9, 3.83544854047954*^9}, {
  3.8397564074984627`*^9, 3.8397564075463333`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"9193ecb9-32f8-4da2-bc51-b6cc70cf7761"],

Cell[CellGroupData[{

Cell["Parameter and function definitions", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
  3.805912240465928*^9, 3.805912257297123*^9}, {3.805912392977785*^9, 
  3.805912394300799*^9}, {3.8059528395365086`*^9, 3.8059528434318323`*^9}, {
  3.806258171263176*^9, 3.806258172492014*^9}, {3.8062583400419245`*^9, 
  3.8062583409930496`*^9}, {3.822623093360408*^9, 3.8226231013755827`*^9}, {
  3.8226232158044233`*^9, 3.8226232229165697`*^9}, {3.8256784156426206`*^9, 
  3.8256784157521815`*^9}, {3.8326635768855524`*^9, 3.8326635834483805`*^9}, {
  3.833525696819208*^9, 3.8335257037500534`*^9}, {3.833874635141939*^9, 
  3.8338746384667463`*^9}},
 Background->GrayLevel[0.85],
 CellTags->"codetag",ExpressionUUID->"14d9d1af-a823-466d-936b-5397bbc717e7"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"sigm", "::", "usage"}], "=", 
    "\"\<Signalling model. Collier, Sprinzak or Shaya\>\""}], ";"}], 
  "Input"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"n", "::", "usage"}], "=", "\"\<Cell number\>\""}], ";"}], 
  "Input"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repp", "::", 
    StyleBox["usage", "Input"]}], 
   StyleBox["=", "Input"], 
   StyleBox["\"\<Repeats the list to fit Shaya's model dimensions\>\"", 
    "Input"]}], 
  StyleBox[";", "Input"]}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805879611735032*^9, 3.8058796119834433`*^9}, {
   3.8058796697282143`*^9, 3.80587967603558*^9}, {3.8058862914767017`*^9, 
   3.805886308360855*^9}, {3.8059025079702005`*^9, 3.8059025198294096`*^9}, 
   3.805902613324645*^9, {3.8059037788757753`*^9, 3.8059037803585567`*^9}, {
   3.805909079325393*^9, 3.8059090849431276`*^9}, {3.8059092962869806`*^9, 
   3.8059092978028603`*^9}, {3.805909366843373*^9, 3.805909367290275*^9}, {
   3.805909605017601*^9, 3.805909667752358*^9}, {3.8064459237504935`*^9, 
   3.8064459239192343`*^9}, {3.8064459657518597`*^9, 3.806445986423092*^9}, {
   3.806446174738922*^9, 3.8064461770085135`*^9}, {3.8064625901189537`*^9, 
   3.806462590965172*^9}, {3.821515146558688*^9, 3.821515150566696*^9}, {
   3.821516083273321*^9, 3.821516154214978*^9}, 3.821516392359342*^9, {
   3.8215164659448166`*^9, 3.821516491302168*^9}, {3.8215167561317415`*^9, 
   3.8215167625237703`*^9}, 3.8215167996009417`*^9, {3.8215168542211933`*^9, 
   3.821516874344285*^9}, 3.8215169359715796`*^9, {3.8226273484191723`*^9, 
   3.8226273561608615`*^9}, {3.8226715986350718`*^9, 
   3.8226715993020735`*^9}, {3.823761121484957*^9, 3.8237611325456743`*^9}, {
   3.8237612376819525`*^9, 3.8237612411349635`*^9}, {3.823764820148965*^9, 
   3.8237648202350445`*^9}, 3.8237649238022404`*^9, {3.8237649559319673`*^9, 
   3.8237649559802313`*^9}, {3.8237651578844023`*^9, 
   3.8237651588082323`*^9}, {3.8237652974839897`*^9, 3.823765302803136*^9}, {
   3.823765335124384*^9, 3.8237653623254232`*^9}, {3.8237658977882366`*^9, 
   3.8237659031357727`*^9}, {3.8237667324519787`*^9, 
   3.8237667438815613`*^9}, {3.823767135474635*^9, 3.8237671614141984`*^9}, {
   3.823770538192165*^9, 3.823770561570354*^9}, {3.823770602833664*^9, 
   3.8237706030369143`*^9}, {3.8237706728321037`*^9, 
   3.8237706878700495`*^9}, {3.8237707725019646`*^9, 
   3.8237707995761995`*^9}, {3.823771111178238*^9, 3.8237711118012247`*^9}, {
   3.8237712182054634`*^9, 3.8237712214393053`*^9}, {3.8237717706621094`*^9, 
   3.8237717878832045`*^9}, {3.8237718754295716`*^9, 3.823771875527137*^9}, {
   3.8237724306708994`*^9, 3.823772472557396*^9}, {3.8237732153192034`*^9, 
   3.8237732160197163`*^9}, {3.823778972301153*^9, 3.823778975110808*^9}, {
   3.8237942893632145`*^9, 3.8237943531382055`*^9}, {3.8237944092833304`*^9, 
   3.8237944677477865`*^9}, {3.8237947826043787`*^9, 3.823794783089592*^9}, {
   3.8238083053838463`*^9, 3.823808305575739*^9}, {3.823808392334058*^9, 
   3.823808396636021*^9}, {3.8238085252559805`*^9, 3.823808525319538*^9}, 
   3.823808597694934*^9, {3.8238086342182817`*^9, 3.823808634467719*^9}, {
   3.8238093839372644`*^9, 3.8238093843141327`*^9}, {3.8238106831768394`*^9, 
   3.8238106832908573`*^9}, {3.8238110354416933`*^9, 
   3.8238110355325828`*^9}, {3.8238122078733*^9, 3.8238122285231547`*^9}, {
   3.8238581560691795`*^9, 3.823858156442896*^9}, {3.824383516542162*^9, 
   3.8243835430685067`*^9}, {3.824383731520373*^9, 3.824383756388443*^9}, 
   3.8243837935354605`*^9, {3.824383849558404*^9, 3.824383870901231*^9}, {
   3.8243839227371635`*^9, 3.824383922999219*^9}, {3.8243839652175646`*^9, 
   3.824383994893087*^9}, {3.8243840307337856`*^9, 3.824384030826988*^9}, {
   3.824385605145857*^9, 3.824385621198181*^9}, {3.824385712620699*^9, 
   3.8243857448832645`*^9}, {3.824385878026354*^9, 3.824385878193098*^9}, {
   3.8243859751855597`*^9, 3.824385983727231*^9}, {3.8243871629957128`*^9, 
   3.8243871632014437`*^9}, {3.824387293344232*^9, 3.8243872938183937`*^9}, {
   3.824387430802317*^9, 3.824387456106408*^9}, {3.824387836458701*^9, 
   3.8243878407799273`*^9}, {3.8243879870831614`*^9, 3.8243879974012156`*^9}, 
   3.8243891619952607`*^9, {3.8243895657998576`*^9, 3.824389591657217*^9}, {
   3.8243917743357506`*^9, 3.8243917748606677`*^9}, {3.8244564643335714`*^9, 
   3.8244564668219547`*^9}, 3.8244565186498227`*^9, 3.824457071087975*^9, {
   3.824463354958598*^9, 3.824463369153125*^9}, 3.8244634169066563`*^9, {
   3.8244635068403454`*^9, 3.8244635090026517`*^9}, {3.8244637592114015`*^9, 
   3.824463767200752*^9}, {3.824464807855097*^9, 3.8244648560499287`*^9}, {
   3.824467407329995*^9, 3.8244674289545145`*^9}, {3.824539330438416*^9, 
   3.82453933096542*^9}, {3.8245395553980803`*^9, 3.8245395554667544`*^9}, {
   3.8245398384225326`*^9, 3.8245398407474546`*^9}, {3.824540312546051*^9, 
   3.824540338621957*^9}, 3.8245407296599207`*^9, {3.8245480998328886`*^9, 
   3.8245481115628133`*^9}, {3.8245485718061132`*^9, 3.824548595768612*^9}, {
   3.824549285580867*^9, 3.824549285950395*^9}, {3.8245496286464353`*^9, 
   3.824549642339865*^9}, {3.824550626155019*^9, 3.824550647298606*^9}, {
   3.8245512586541414`*^9, 3.8245512686556225`*^9}, {3.8245525995930324`*^9, 
   3.824552654728651*^9}, {3.8245529287751627`*^9, 3.824552937269043*^9}, {
   3.824553330110774*^9, 3.824553348742734*^9}, {3.824807396031418*^9, 
   3.8248073980237036`*^9}, {3.825514655419546*^9, 3.8255146612423315`*^9}, {
   3.8255147981686172`*^9, 3.8255147982279387`*^9}, {3.825517533845537*^9, 
   3.825517535805646*^9}, {3.8255187037966213`*^9, 3.8255187039292545`*^9}, {
   3.8255207268200808`*^9, 3.8255207275287313`*^9}, {3.8255207680703363`*^9, 
   3.825520768139099*^9}, {3.825520839420801*^9, 3.825520840292618*^9}, {
   3.825520983954655*^9, 3.8255209886950407`*^9}, {3.8255212442411704`*^9, 
   3.8255212466151876`*^9}, {3.825580575699616*^9, 3.8255805884547253`*^9}, {
   3.8255807399425073`*^9, 3.825580741704691*^9}, {3.8255808589133167`*^9, 
   3.825580859084896*^9}, {3.8255809071698895`*^9, 3.82558090724189*^9}, {
   3.82558096019638*^9, 3.825580960406559*^9}, {3.825581217104507*^9, 
   3.8255812174842525`*^9}, {3.825588678362708*^9, 3.8255886901379004`*^9}, {
   3.8255891260556374`*^9, 3.8255891346296344`*^9}, {3.825589318905561*^9, 
   3.82558933294762*^9}, {3.8255899929967575`*^9, 3.8255899932702174`*^9}, {
   3.825664174491381*^9, 3.8256641746266885`*^9}, 3.8256649297937555`*^9, {
   3.8256651093132052`*^9, 3.8256651197235565`*^9}, {3.82566517104311*^9, 
   3.8256651760284805`*^9}, {3.8256737692306156`*^9, 
   3.8256737719033203`*^9}, {3.825673832856662*^9, 3.825673833555518*^9}, {
   3.8256738992976832`*^9, 3.8256738996791835`*^9}, {3.8256739897235937`*^9, 
   3.825674006782044*^9}, {3.825678428551801*^9, 3.825678428790569*^9}, {
   3.825678483157711*^9, 3.8256784832220736`*^9}, {3.8256792361745205`*^9, 
   3.8256792392866716`*^9}, {3.825679334935173*^9, 3.8256793942961855`*^9}, {
   3.825680122675579*^9, 3.825680123054191*^9}, {3.8256807577078238`*^9, 
   3.825680770669303*^9}, {3.8256813087243285`*^9, 3.8256813090074115`*^9}, {
   3.825681878933922*^9, 3.8256818789881415`*^9}, {3.8256828120053625`*^9, 
   3.8256828646220636`*^9}, {3.8256837842311296`*^9, 
   3.8256837844010897`*^9}, {3.8256839549578753`*^9, 
   3.8256839552685547`*^9}, {3.825684224312383*^9, 3.825684227731038*^9}, {
   3.825685353068256*^9, 3.8256853534427967`*^9}, {3.825685842123771*^9, 
   3.825685842222681*^9}, {3.8256862147359324`*^9, 3.8256862156477265`*^9}, {
   3.825689379001584*^9, 3.825689381856078*^9}, {3.8256902433025866`*^9, 
   3.8256902684069614`*^9}, {3.825693425915304*^9, 3.825693426362857*^9}, {
   3.8256941326248517`*^9, 3.825694182493269*^9}, {3.8256942255156617`*^9, 
   3.8256942301917987`*^9}, {3.825694859482811*^9, 3.825694859573542*^9}, {
   3.82569577448968*^9, 3.8256957747520437`*^9}, {3.8256958899993477`*^9, 
   3.8256958911102448`*^9}, {3.825696506613579*^9, 3.825696506723522*^9}, {
   3.825696763810671*^9, 3.825696775061117*^9}, {3.825698261276558*^9, 
   3.825698262576825*^9}, {3.8257124862976317`*^9, 3.825712493211833*^9}, {
   3.8257462760932336`*^9, 3.8257462764490585`*^9}, {3.8257477969349356`*^9, 
   3.825747806128685*^9}, {3.8257480444028254`*^9, 3.8257480445733805`*^9}, {
   3.8257480815495434`*^9, 3.8257480834450026`*^9}, {3.825748278851542*^9, 
   3.825748279146574*^9}, {3.8260241961550837`*^9, 3.8260241966400166`*^9}, {
   3.826024528234595*^9, 3.8260245386926413`*^9}, {3.8260317109008307`*^9, 
   3.8260317243416157`*^9}, {3.826031964728044*^9, 3.826031965368174*^9}, {
   3.8260330114296827`*^9, 3.8260330216637955`*^9}, {3.826033073087246*^9, 
   3.8260330733328342`*^9}, {3.8260343128917723`*^9, 
   3.8260343178328924`*^9}, {3.826037221909957*^9, 3.826037245961738*^9}, {
   3.82603746480134*^9, 3.8260374674319415`*^9}, {3.8260377735575857`*^9, 
   3.826037784601339*^9}, {3.8260381580116677`*^9, 3.826038158247359*^9}, 
   3.8260383007293186`*^9, 3.826038375644622*^9, {3.8260394612570925`*^9, 
   3.8260394740785675`*^9}, {3.8260496667574186`*^9, 
   3.8260496976510572`*^9}, {3.826049937621585*^9, 3.826049964393605*^9}, {
   3.826050217537347*^9, 3.8260502195733037`*^9}, {3.8260503102344084`*^9, 
   3.8260503104418416`*^9}, {3.82605050274347*^9, 3.8260505030399327`*^9}, {
   3.826050686626536*^9, 3.8260506866855316`*^9}, {3.826050906153658*^9, 
   3.826050910123751*^9}, {3.8260511721605825`*^9, 3.8260511749670334`*^9}, {
   3.826051301503517*^9, 3.8260513071925364`*^9}, {3.8260807390734506`*^9, 
   3.826080739450879*^9}, {3.826080897058942*^9, 3.8260809054417777`*^9}, {
   3.826080963289836*^9, 3.826080963836748*^9}, {3.8260815962171707`*^9, 
   3.8260815962994556`*^9}, {3.826081765337963*^9, 3.8260817956238885`*^9}, {
   3.8260818594228454`*^9, 3.8260818992464657`*^9}, {3.8260821588908916`*^9, 
   3.8260821596373653`*^9}, {3.826082258780409*^9, 3.826082353296706*^9}, {
   3.8260826993716974`*^9, 3.8260826995946445`*^9}, {3.8260827524091177`*^9, 
   3.8260827717208424`*^9}, {3.82608322725115*^9, 3.8260832273341618`*^9}, {
   3.8260832759513884`*^9, 3.8260832759796352`*^9}, {3.8260834372752275`*^9, 
   3.8260834373747673`*^9}, {3.8260835253191557`*^9, 
   3.8260835257103243`*^9}, {3.826083589061351*^9, 3.8260836324716415`*^9}, {
   3.8260842528145905`*^9, 3.826084273181553*^9}, {3.8260847522941375`*^9, 
   3.826084752401659*^9}, {3.826085565880874*^9, 3.8260855659149656`*^9}, 
   3.8260857026655245`*^9, {3.826085764331626*^9, 3.8260857869861655`*^9}, {
   3.826085907499792*^9, 3.8260859531309185`*^9}, {3.826086121836466*^9, 
   3.826086125964778*^9}, {3.826086410083417*^9, 3.8260864254200373`*^9}, {
   3.8260867710933094`*^9, 3.8260867713679857`*^9}, {3.826087569365726*^9, 
   3.826087569675088*^9}, {3.826088009634377*^9, 3.8260880116888285`*^9}, {
   3.826088411768396*^9, 3.826088459962958*^9}, {3.826089426947858*^9, 
   3.826089452998969*^9}, {3.8260898293577857`*^9, 3.8260898295803957`*^9}, {
   3.826090212245872*^9, 3.826090212681624*^9}, {3.82609204724971*^9, 
   3.8260920563886433`*^9}, {3.8260921172723756`*^9, 
   3.8260921602205253`*^9}, {3.8260930893394885`*^9, 3.826093089726137*^9}, {
   3.826093478755097*^9, 3.826093479098279*^9}, {3.826094044296029*^9, 
   3.8260940494606886`*^9}, {3.826094628431615*^9, 3.826094628577734*^9}, {
   3.826095054411854*^9, 3.8260950579516716`*^9}, {3.826095886853355*^9, 
   3.826095887189859*^9}, {3.826096509620725*^9, 3.8260965240328712`*^9}, {
   3.826097246678782*^9, 3.826097249489582*^9}, {3.8260973446901712`*^9, 
   3.8260973556038675`*^9}, {3.826097867177883*^9, 3.8260978898888197`*^9}, {
   3.8260982123399734`*^9, 3.8260982124721155`*^9}, {3.8260992468262286`*^9, 
   3.8260992482155027`*^9}, {3.826099757673831*^9, 3.8260997586850634`*^9}, {
   3.8261000308452816`*^9, 3.826100031675827*^9}, {3.826100477380885*^9, 
   3.826100477896624*^9}, {3.826101886509852*^9, 3.8261018877353945`*^9}, {
   3.8261045172134333`*^9, 3.8261046173213077`*^9}, {3.8261047784830475`*^9, 
   3.826104778584463*^9}, {3.8261048638975163`*^9, 3.826104897995408*^9}, {
   3.8261060637556953`*^9, 3.8261060650491295`*^9}, {3.826107121479511*^9, 
   3.8261071265453143`*^9}, {3.8261072656973534`*^9, 
   3.8261072657723255`*^9}, {3.82610746362263*^9, 3.8261074636651735`*^9}, {
   3.826107609644972*^9, 3.8261076097617755`*^9}, {3.8261085684317656`*^9, 
   3.8261085685014877`*^9}, {3.826108826998629*^9, 3.826108834074193*^9}, {
   3.826113835838646*^9, 3.826113935360199*^9}, {3.8261139755117044`*^9, 
   3.826114035865157*^9}, {3.8261141436102505`*^9, 3.826114151878756*^9}, {
   3.8261144802933626`*^9, 3.8261144811534996`*^9}, {3.826114812564617*^9, 
   3.826114814828647*^9}, {3.826114889754921*^9, 3.8261148910569487`*^9}, {
   3.8261149374642167`*^9, 3.8261149385148015`*^9}, 3.826115083224955*^9, {
   3.8261151657924337`*^9, 3.8261151862471685`*^9}, {3.826115264832739*^9, 
   3.8261152711131268`*^9}, {3.826115461250308*^9, 3.826115523827112*^9}, 
   3.8261156080221167`*^9, {3.8261160072932796`*^9, 3.826116041683505*^9}, {
   3.826116262369053*^9, 3.8261162624599113`*^9}, {3.826116747237224*^9, 
   3.826116751420243*^9}, {3.826117400091778*^9, 3.826117400348405*^9}, {
   3.82611778874995*^9, 3.8261177935641413`*^9}, {3.8261181806464605`*^9, 
   3.826118215813963*^9}, {3.826118835060914*^9, 3.826118837090678*^9}, {
   3.8261203019773903`*^9, 3.8261203034944897`*^9}, {3.826186753677112*^9, 
   3.8261868056415625`*^9}, {3.8261868903351364`*^9, 3.826186898641782*^9}, {
   3.82618729641882*^9, 3.826187300018915*^9}, {3.8278271107883697`*^9, 
   3.8278271213800325`*^9}, {3.827827700538685*^9, 3.827827805519186*^9}, {
   3.8278278713500175`*^9, 3.827827879580393*^9}, {3.82783985951575*^9, 
   3.8278398600249605`*^9}, {3.827840834863559*^9, 3.8278408410400505`*^9}, {
   3.827844000202521*^9, 3.8278440044071302`*^9}, {3.827844544437809*^9, 
   3.8278445466642537`*^9}, {3.827844642077112*^9, 3.8278446427925816`*^9}, {
   3.827845207556794*^9, 3.8278452076413994`*^9}, {3.8278453529385605`*^9, 
   3.8278453739919453`*^9}, {3.8278454474993763`*^9, 3.827845461882996*^9}, {
   3.8278456966503525`*^9, 3.8278456967302732`*^9}, {3.827845804558919*^9, 
   3.827845805089779*^9}, {3.82784599493437*^9, 3.8278459965384083`*^9}, 
   3.827846133088688*^9, {3.82784681768799*^9, 3.827846821720585*^9}, {
   3.827846986834722*^9, 3.8278469873129487`*^9}, {3.827847350152418*^9, 
   3.8278473531578207`*^9}, {3.827847568854866*^9, 3.8278475689067106`*^9}, {
   3.8278480720953636`*^9, 3.827848076249971*^9}, {3.827848533667438*^9, 
   3.8278485342662907`*^9}, {3.827848980940919*^9, 3.827848983690712*^9}, 
   3.827849250431351*^9, {3.8278512538980584`*^9, 3.8278512541224637`*^9}, {
   3.8278515701198673`*^9, 3.827851570480401*^9}, {3.827852156881403*^9, 
   3.8278521574180293`*^9}, {3.8279066856538754`*^9, 
   3.8279067256359205`*^9}, {3.827906842155553*^9, 3.8279068582596693`*^9}, {
   3.8279072126213827`*^9, 3.8279072399243555`*^9}, {3.832655214241252*^9, 
   3.832655340437831*^9}, {3.8326554461719666`*^9, 3.8326554612553635`*^9}, {
   3.832655598027835*^9, 3.832655598371674*^9}, {3.8326556354484344`*^9, 
   3.8326556382882643`*^9}, {3.8326557373064423`*^9, 
   3.8326558515271807`*^9}, {3.832656030228155*^9, 3.8326560450533104`*^9}, {
   3.832656198929495*^9, 3.8326562159490795`*^9}, {3.8326570536893177`*^9, 
   3.832657063907899*^9}, {3.8326571738480663`*^9, 3.832657174169388*^9}, {
   3.832658731127903*^9, 3.8326587357443256`*^9}, {3.832659172117465*^9, 
   3.832659175219843*^9}, {3.8326593597969294`*^9, 3.8326593702590637`*^9}, {
   3.832659759359027*^9, 3.832659759500434*^9}, {3.832667633834819*^9, 
   3.832667634065404*^9}, {3.832668429406723*^9, 3.8326684305855746`*^9}, {
   3.8326690368707433`*^9, 3.832669037234048*^9}, {3.832669129973177*^9, 
   3.8326691300560975`*^9}, {3.832669238653461*^9, 3.8326692393357944`*^9}, {
   3.8326744379014425`*^9, 3.832674439142461*^9}, {3.8326759220755324`*^9, 
   3.8326759799745493`*^9}, 3.8327401082083607`*^9, {3.8327404573652587`*^9, 
   3.8327404610410876`*^9}, {3.8327781731094866`*^9, 3.832778173187763*^9}, {
   3.8327787116432533`*^9, 3.8327787117181997`*^9}, {3.832779072114788*^9, 
   3.83277907218855*^9}, 3.833445538429059*^9, {3.833445593959488*^9, 
   3.8334456114567595`*^9}, {3.8335262100354586`*^9, 3.833526267963702*^9}, {
   3.833526390658432*^9, 3.8335264107206907`*^9}, {3.8338746433932867`*^9, 
   3.833874667022375*^9}, {3.8339593243181653`*^9, 3.8339593250228186`*^9}, {
   3.834071155993312*^9, 3.8340711560101223`*^9}, 3.8342135899465647`*^9, {
   3.8342229037998266`*^9, 3.834222903936118*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[17]:=",ExpressionUUID->"b48a3a27-b8ac-4944-9365-c1d822bf61a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameter values", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
  3.805912240465928*^9, 3.805912257297123*^9}, {3.805912392977785*^9, 
  3.805912394300799*^9}, {3.8059528395365086`*^9, 3.8059528434318323`*^9}, {
  3.806258171263176*^9, 3.806258172492014*^9}, {3.8062583400419245`*^9, 
  3.8062583409930496`*^9}, {3.822623093360408*^9, 3.8226231013755827`*^9}, {
  3.8226232158044233`*^9, 3.8226232229165697`*^9}, {3.8256784156426206`*^9, 
  3.8256784157521815`*^9}, {3.8326635768855524`*^9, 3.8326635834483805`*^9}, {
  3.833525696819208*^9, 3.833525697728383*^9}},
 Background->GrayLevel[0.85],
 CellTags->"codetag",ExpressionUUID->"6965c3f3-0a09-495e-be8e-d91812854299"],

Cell[CellGroupData[{

Cell["Collier model", "Subsubsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761537402322*^9}, {
   3.8335451461475782`*^9, 3.8335451462734346`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"17439844-4c74-4e24-8f23-9de8f2189807"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", "1"}], ";", 
  RowBox[{"k", "=", "6"}], ";", 
  RowBox[{"h", "=", "6"}], ";", 
  RowBox[{"rn", "=", "1"}], ";", 
  RowBox[{"rd", "=", "1"}], ";", 
  RowBox[{"mu", "=", "0.02"}], ";", 
  RowBox[{"aN0", "=", 
   RowBox[{"-", "2"}]}], ";", 
  RowBox[{"bN0", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"10", "^", "aN0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"10", "^", "bN0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rn", "=", 
   RowBox[{"rn", " ", 
    RowBox[{
     RowBox[{"b", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "h"}], ")"}]}], "/", "mu"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rd", "=", 
   RowBox[{"rd", "/", 
    RowBox[{"(", 
     RowBox[{"mu", " ", 
      RowBox[{"a", "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "k"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"x", "^", "k"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"x", "^", "k"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"x", ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"x", "^", "h"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniN", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniD", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniR", "=", "0.1"}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8058863570780334`*^9, 3.805886433827979*^9}, {
   3.805902874455439*^9, 3.8059028763196163`*^9}, {3.8059042040790253`*^9, 
   3.805904210258957*^9}, {3.805907399314412*^9, 3.8059073994395447`*^9}, {
   3.805909254647366*^9, 3.8059092648273377`*^9}, {3.8059096823773875`*^9, 
   3.805909694519315*^9}, {3.805909867689107*^9, 3.805909873361408*^9}, {
   3.8059148180732574`*^9, 3.805914849517334*^9}, {3.806567050864914*^9, 
   3.8065670587545805`*^9}, {3.8213835784617558`*^9, 3.821383587551756*^9}, {
   3.821385934521756*^9, 3.821385946239756*^9}, 3.821386155037756*^9, {
   3.8213865612557554`*^9, 3.821386567601757*^9}, {3.821387666146756*^9, 
   3.821387668383756*^9}, {3.821721858868132*^9, 3.8217218934261312`*^9}, {
   3.821731349287841*^9, 3.8217313550708795`*^9}, {3.821731440315839*^9, 
   3.8217314406378393`*^9}, {3.8226268355627394`*^9, 
   3.8226268376942444`*^9}, {3.8226302423419275`*^9, 3.822630271025663*^9}, {
   3.8226303678644314`*^9, 3.822630372735221*^9}, {3.8226304359424286`*^9, 
   3.8226304387122664`*^9}, {3.822650263913976*^9, 3.822650267226859*^9}, {
   3.8226698860513964`*^9, 3.8226698987043667`*^9}, {3.822670255242035*^9, 
   3.8226702584580755`*^9}, {3.823761526305776*^9, 3.823761530729785*^9}, {
   3.824463371002329*^9, 3.8244633927249994`*^9}, {3.824464656030961*^9, 
   3.824464669379998*^9}, 3.8244647809424486`*^9, {3.824550065121257*^9, 
   3.8245500656815567`*^9}, {3.8245512556606274`*^9, 
   3.8245512557435007`*^9}, {3.824552584379249*^9, 3.824552588200617*^9}, {
   3.8245529241582055`*^9, 3.824552924343604*^9}, {3.8255896970995555`*^9, 
   3.8255897313964567`*^9}, {3.8255900055199003`*^9, 3.825590005595359*^9}, {
   3.8256641102285886`*^9, 3.825664113039303*^9}, {3.8256792341743326`*^9, 
   3.8256792343581233`*^9}, {3.8256801136284857`*^9, 3.825680113719998*^9}, {
   3.8256848403161883`*^9, 3.825684840448079*^9}, 3.8256865734045954`*^9, {
   3.8260324310460463`*^9, 3.8260324355252733`*^9}, {3.8260330079934845`*^9, 
   3.826033008185231*^9}, {3.8260330678761077`*^9, 3.8260330683609867`*^9}, {
   3.8260345151209836`*^9, 3.8260345286182194`*^9}, {3.8260376437707214`*^9, 
   3.8260376437877455`*^9}, {3.8260897969155655`*^9, 
   3.8260897978556404`*^9}, {3.826092069092636*^9, 3.8260920711757164`*^9}, {
   3.826094621771835*^9, 3.826094622047972*^9}, {3.8278275995443077`*^9, 
   3.8278276490799484`*^9}, 3.8278383420243654`*^9, {3.8278394491720867`*^9, 
   3.8278394507699933`*^9}, {3.8278395119311237`*^9, 
   3.8278395133986826`*^9}, {3.8278409516062365`*^9, 
   3.8278409523642654`*^9}, {3.8278521696667924`*^9, 
   3.8278521700811243`*^9}, {3.83265943476346*^9, 3.832659438050567*^9}, {
   3.8326597497937317`*^9, 3.8326597528454227`*^9}, {3.832668375990631*^9, 
   3.832668384637924*^9}, {3.8326739595923724`*^9, 3.832673962069702*^9}, 
   3.8426017570117335`*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[20]:=",ExpressionUUID->"b8ef69f4-b39c-4568-94c5-6ff81ce75cdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sprinzak model", "Subsubsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761537402322*^9}, {
   3.8326551308644977`*^9, 3.8326551316053624`*^9}, {3.833545147952588*^9, 
   3.8335451480698023`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"0fb7dce3-3d99-4ad8-aa9d-5248f675e8ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]N", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]D", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]R", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamN", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamD", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamS", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamR", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pR", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pS", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]c", "=", "0.55"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]RS", "=", "300000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniN", "=", "\[Beta]N"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniD", "=", "\[Beta]D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iniR", "=", "\[Beta]R"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CIS", "-", 
    RowBox[{"INHIBITION", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cisQ", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8058863570780334`*^9, 3.805886433827979*^9}, {
   3.805902874455439*^9, 3.8059028763196163`*^9}, {3.8059042040790253`*^9, 
   3.805904210258957*^9}, {3.805907399314412*^9, 3.8059073994395447`*^9}, {
   3.805909254647366*^9, 3.8059092648273377`*^9}, {3.8059096823773875`*^9, 
   3.805909694519315*^9}, {3.805909867689107*^9, 3.805909873361408*^9}, {
   3.8059148180732574`*^9, 3.805914849517334*^9}, {3.806567050864914*^9, 
   3.8065670587545805`*^9}, {3.8213835784617558`*^9, 3.821383587551756*^9}, {
   3.821385934521756*^9, 3.821385946239756*^9}, 3.821386155037756*^9, {
   3.8213865612557554`*^9, 3.821386567601757*^9}, {3.821387666146756*^9, 
   3.821387668383756*^9}, {3.821721858868132*^9, 3.8217218934261312`*^9}, {
   3.821731349287841*^9, 3.8217313550708795`*^9}, {3.821731440315839*^9, 
   3.8217314406378393`*^9}, {3.8226268355627394`*^9, 
   3.8226268376942444`*^9}, {3.8226302423419275`*^9, 3.822630271025663*^9}, {
   3.8226303678644314`*^9, 3.822630372735221*^9}, {3.8226304359424286`*^9, 
   3.8226304387122664`*^9}, {3.822650263913976*^9, 3.822650267226859*^9}, {
   3.8226698860513964`*^9, 3.8226698987043667`*^9}, {3.822670255242035*^9, 
   3.8226702584580755`*^9}, {3.823761526305776*^9, 3.823761530729785*^9}, {
   3.824463371002329*^9, 3.8244633927249994`*^9}, {3.824464656030961*^9, 
   3.824464669379998*^9}, 3.8244647809424486`*^9, {3.824550065121257*^9, 
   3.8245500656815567`*^9}, {3.8245512556606274`*^9, 
   3.8245512557435007`*^9}, {3.824552584379249*^9, 3.824552588200617*^9}, {
   3.8245529241582055`*^9, 3.824552924343604*^9}, {3.8255896970995555`*^9, 
   3.8255897313964567`*^9}, {3.8255900055199003`*^9, 3.825590005595359*^9}, {
   3.8256641102285886`*^9, 3.825664113039303*^9}, {3.8256792341743326`*^9, 
   3.8256792343581233`*^9}, {3.8256801136284857`*^9, 3.825680113719998*^9}, {
   3.8256848403161883`*^9, 3.825684840448079*^9}, 3.8256865734045954`*^9, {
   3.8260324310460463`*^9, 3.8260324355252733`*^9}, {3.8260330079934845`*^9, 
   3.826033008185231*^9}, {3.8260330678761077`*^9, 3.8260330683609867`*^9}, {
   3.8260345151209836`*^9, 3.8260345286182194`*^9}, {3.8260376437707214`*^9, 
   3.8260376437877455`*^9}, {3.8260897969155655`*^9, 
   3.8260897978556404`*^9}, {3.826092069092636*^9, 3.8260920711757164`*^9}, {
   3.826094621771835*^9, 3.826094622047972*^9}, {3.8278275995443077`*^9, 
   3.8278276490799484`*^9}, 3.8278383420243654`*^9, {3.8278394491720867`*^9, 
   3.8278394507699933`*^9}, {3.8278395119311237`*^9, 
   3.8278395133986826`*^9}, {3.8278409516062365`*^9, 
   3.8278409523642654`*^9}, {3.8278521696667924`*^9, 
   3.8278521700811243`*^9}, {3.8326593990383725`*^9, 3.832659625560326*^9}, {
   3.8326598004731045`*^9, 3.8326598010834208`*^9}, {3.832665998318148*^9, 
   3.8326660045084667`*^9}, {3.8326660665026712`*^9, 
   3.8326660676947064`*^9}, {3.8326662707486925`*^9, 
   3.8326662840957923`*^9}, {3.83266640117004*^9, 3.832666404281802*^9}, {
   3.8326665054667397`*^9, 3.8326665071988945`*^9}, {3.832666696203216*^9, 
   3.832666728921449*^9}, {3.832668389430694*^9, 3.83266840672773*^9}, {
   3.8326685674740868`*^9, 3.8326685746867986`*^9}, 3.8326686367734632`*^9, 
   3.833620805649764*^9, {3.8447757591985054`*^9, 3.8447757592044888`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[30]:=",ExpressionUUID->"89548b47-52e6-4daf-b2fd-9bd745022a34"]
}, Closed]],

Cell[CellGroupData[{

Cell["Shaya model", "Subsubsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761537402322*^9}, {
   3.8326551308644977`*^9, 3.8326551316053624`*^9}, {3.833545135591656*^9, 
   3.833545149295718*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"185fef26-9eea-4b78-815e-c88c518d4804"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]N", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]D", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]R", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniN", "=", "\[Beta]N"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iniD", "=", "\[Beta]D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iniR", "=", "\[Beta]R"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CIS", "-", 
    RowBox[{"INHIBITION", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cisQ", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8058863570780334`*^9, 3.805886433827979*^9}, {
   3.805902874455439*^9, 3.8059028763196163`*^9}, {3.8059042040790253`*^9, 
   3.805904210258957*^9}, {3.805907399314412*^9, 3.8059073994395447`*^9}, {
   3.805909254647366*^9, 3.8059092648273377`*^9}, {3.8059096823773875`*^9, 
   3.805909694519315*^9}, {3.805909867689107*^9, 3.805909873361408*^9}, {
   3.8059148180732574`*^9, 3.805914849517334*^9}, {3.806567050864914*^9, 
   3.8065670587545805`*^9}, {3.8213835784617558`*^9, 3.821383587551756*^9}, {
   3.821385934521756*^9, 3.821385946239756*^9}, 3.821386155037756*^9, {
   3.8213865612557554`*^9, 3.821386567601757*^9}, {3.821387666146756*^9, 
   3.821387668383756*^9}, {3.821721858868132*^9, 3.8217218934261312`*^9}, {
   3.821731349287841*^9, 3.8217313550708795`*^9}, {3.821731440315839*^9, 
   3.8217314406378393`*^9}, {3.8226268355627394`*^9, 
   3.8226268376942444`*^9}, {3.8226302423419275`*^9, 3.822630271025663*^9}, {
   3.8226303678644314`*^9, 3.822630372735221*^9}, {3.8226304359424286`*^9, 
   3.8226304387122664`*^9}, {3.822650263913976*^9, 3.822650267226859*^9}, {
   3.8226698860513964`*^9, 3.8226698987043667`*^9}, {3.822670255242035*^9, 
   3.8226702584580755`*^9}, {3.823761526305776*^9, 3.823761530729785*^9}, {
   3.824463371002329*^9, 3.8244633927249994`*^9}, {3.824464656030961*^9, 
   3.824464669379998*^9}, 3.8244647809424486`*^9, {3.824550065121257*^9, 
   3.8245500656815567`*^9}, {3.8245512556606274`*^9, 
   3.8245512557435007`*^9}, {3.824552584379249*^9, 3.824552588200617*^9}, {
   3.8245529241582055`*^9, 3.824552924343604*^9}, {3.8255896970995555`*^9, 
   3.8255897313964567`*^9}, {3.8255900055199003`*^9, 3.825590005595359*^9}, {
   3.8256641102285886`*^9, 3.825664113039303*^9}, {3.8256792341743326`*^9, 
   3.8256792343581233`*^9}, {3.8256801136284857`*^9, 3.825680113719998*^9}, {
   3.8256848403161883`*^9, 3.825684840448079*^9}, 3.8256865734045954`*^9, {
   3.8260324310460463`*^9, 3.8260324355252733`*^9}, {3.8260330079934845`*^9, 
   3.826033008185231*^9}, {3.8260330678761077`*^9, 3.8260330683609867`*^9}, {
   3.8260345151209836`*^9, 3.8260345286182194`*^9}, {3.8260376437707214`*^9, 
   3.8260376437877455`*^9}, {3.8260897969155655`*^9, 
   3.8260897978556404`*^9}, {3.826092069092636*^9, 3.8260920711757164`*^9}, {
   3.826094621771835*^9, 3.826094622047972*^9}, {3.8278275995443077`*^9, 
   3.8278276490799484`*^9}, 3.8278383420243654`*^9, {3.8278394491720867`*^9, 
   3.8278394507699933`*^9}, {3.8278395119311237`*^9, 
   3.8278395133986826`*^9}, {3.8278409516062365`*^9, 
   3.8278409523642654`*^9}, {3.8278521696667924`*^9, 
   3.8278521700811243`*^9}, {3.8326593990383725`*^9, 3.832659625560326*^9}, {
   3.8326598004731045`*^9, 3.8326598010834208`*^9}, {3.832665998318148*^9, 
   3.8326660045084667`*^9}, {3.8326660665026712`*^9, 
   3.8326660676947064`*^9}, {3.8326662707486925`*^9, 
   3.8326662840957923`*^9}, {3.83266640117004*^9, 3.832666404281802*^9}, {
   3.8326665054667397`*^9, 3.8326665071988945`*^9}, {3.832666696203216*^9, 
   3.832666728921449*^9}, {3.832668389430694*^9, 3.83266840672773*^9}, {
   3.8326685674740868`*^9, 3.8326685746867986`*^9}, 3.8326686367734632`*^9, {
   3.833545168243314*^9, 3.8335451869602633`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[48]:=",ExpressionUUID->"d1a8fd94-6836-4e4c-815b-264062c5a702"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other parameters", "Subsubsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.8806594503947144`*^9, 3.880659452456417*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"ad4b5aeb-0191-4e7d-9280-6c158f9427c3"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"SIGNALLING", " ", "MODEL"}], " ", "-", " ", 
      RowBox[{"COLLIER", ":", " ", "0"}]}], ";", " ", 
     RowBox[{"SPRINZAK", ":", " ", "1"}]}], " ", "*)"}], "Input"], 
  StyleBox["\[IndentingNewLine]", "Input"], 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"sigm", "=", "0"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", "TIMING", " ", "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"n", "=", "20"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"dmx", "=", "1"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"dmy", "=", ".75"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tmax", "=", "100"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"STRIPE", " ", "1"}], " ", "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tsim", "=", "10"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tsimi", "=", "Tsim"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"STRIPE", " ", "2"}], " ", "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tsim2", "=", "Tsim"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tsimf", "=", 
      RowBox[{"Tsim", "+", "20"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"STRETCH", " ", "AND", " ", "COMPACTION", " ", "MOMENTS"}], " ", 
     "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tste", "=", 
      RowBox[{"Tsim", "+", "inf"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"Tcmp", "=", 
      RowBox[{"Tsim", "+", "inf"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"CLAMPING", "?"}], " ", "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"clmp", "=", "False"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   RowBox[{
    RowBox[{"clmpw", "=", "0.1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"clamping", " ", "width"}], " ", "*)"}], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"[", 
       RowBox[{"OTHER", " ", "MODEL"}], "]"}], "?"}], " ", "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"vmod", "=", "False"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"[", 
       RowBox[{"OTHER", " ", "MODEL"}], "]"}], " ", "PARAMETERS"}], " ", 
     "*)"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"stefh", "=", "1.5"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"A0", "=", "1"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"ka", "=", "1000"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"gam", "=", 
      RowBox[{"0.04", "*", "ka", "*", "A0"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"P0", "=", "0"}], ";"}], "Input"], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"LINE", " ", "TENSION", " ", 
     RowBox[{"CHANGE", "?"}]}], " ", "*)"}], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"ltens", "=", "False"}], ";"}], "Input"], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"inlc", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"\[CapitalLambda]", "=", "0.025"}], ";"}], "Input"], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"\[CapitalLambda]2", "=", "0.025"}], ";"}], "Input"], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"OTHER", " ", "MODEL"}], "]"}], " ", "SPEED"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"sv", "=", "1"}], ";"}], "Input"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Tmax", ",", "Tsim", ",", "Tsimi", ",", "Tsim2", ",", "Tsimf", ",", 
        "Tste"}], "}"}], "=", 
      RowBox[{"sv", 
       RowBox[{"{", 
        RowBox[{
        "Tmax", ",", "Tsim", ",", "Tsimi", ",", "Tsim2", ",", "Tsimf", ",", 
         "Tste"}], "}"}]}]}], ";"}], "Input"], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"SOP", " ", "THRESHOLD", " ", 
     RowBox[{"(", "DELTA", ")"}], " ", "AND", " ", "SIGNAL", " ", "SPEED"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"dthr", "=", "70"}], ";"}], "Input"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"ss", "=", ".25"}], ";"}], "Input"], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"VM", " ", "NOISE"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nvm", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"avp", "=", 
     RowBox[{"2", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"A0", " ", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nst", "=", 
     RowBox[{
      RowBox[{"avp", "/", "175"}], "//", "N"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"SIGNALLING", " ", "REGION"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yr", "=", ".15"}], ";", 
    RowBox[{"xr", "=", ".2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "NOISE", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"noi", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nV", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"areQ", "=", "True"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805879611735032*^9, 3.8058796119834433`*^9}, {
   3.8058796697282143`*^9, 3.80587967603558*^9}, {3.8058862914767017`*^9, 
   3.805886308360855*^9}, {3.8059025079702005`*^9, 3.8059025198294096`*^9}, 
   3.805902613324645*^9, {3.8059037788757753`*^9, 3.8059037803585567`*^9}, {
   3.805909079325393*^9, 3.8059090849431276`*^9}, {3.8059092962869806`*^9, 
   3.8059092978028603`*^9}, {3.805909366843373*^9, 3.805909367290275*^9}, {
   3.805909605017601*^9, 3.805909667752358*^9}, {3.8064459237504935`*^9, 
   3.8064459239192343`*^9}, {3.8064459657518597`*^9, 3.806445986423092*^9}, {
   3.806446174738922*^9, 3.8064461770085135`*^9}, {3.8064625901189537`*^9, 
   3.806462590965172*^9}, {3.821515146558688*^9, 3.821515150566696*^9}, {
   3.821516083273321*^9, 3.821516154214978*^9}, 3.821516392359342*^9, {
   3.8215164659448166`*^9, 3.821516491302168*^9}, {3.8215167561317415`*^9, 
   3.8215167625237703`*^9}, 3.8215167996009417`*^9, {3.8215168542211933`*^9, 
   3.821516874344285*^9}, 3.8215169359715796`*^9, {3.8226273484191723`*^9, 
   3.8226273561608615`*^9}, {3.8226715986350718`*^9, 
   3.8226715993020735`*^9}, {3.823761121484957*^9, 3.8237611325456743`*^9}, {
   3.8237612376819525`*^9, 3.8237612411349635`*^9}, {3.823764820148965*^9, 
   3.8237648202350445`*^9}, 3.8237649238022404`*^9, {3.8237649559319673`*^9, 
   3.8237649559802313`*^9}, {3.8237651578844023`*^9, 
   3.8237651588082323`*^9}, {3.8237652974839897`*^9, 3.823765302803136*^9}, {
   3.823765335124384*^9, 3.8237653623254232`*^9}, {3.8237658977882366`*^9, 
   3.8237659031357727`*^9}, {3.8237667324519787`*^9, 
   3.8237667438815613`*^9}, {3.823767135474635*^9, 3.8237671614141984`*^9}, {
   3.823770538192165*^9, 3.823770561570354*^9}, {3.823770602833664*^9, 
   3.8237706030369143`*^9}, {3.8237706728321037`*^9, 
   3.8237706878700495`*^9}, {3.8237707725019646`*^9, 
   3.8237707995761995`*^9}, {3.823771111178238*^9, 3.8237711118012247`*^9}, {
   3.8237712182054634`*^9, 3.8237712214393053`*^9}, {3.8237717706621094`*^9, 
   3.8237717878832045`*^9}, {3.8237718754295716`*^9, 3.823771875527137*^9}, {
   3.8237724306708994`*^9, 3.823772472557396*^9}, {3.8237732153192034`*^9, 
   3.8237732160197163`*^9}, {3.823778972301153*^9, 3.823778975110808*^9}, {
   3.8237942893632145`*^9, 3.8237943531382055`*^9}, {3.8237944092833304`*^9, 
   3.8237944677477865`*^9}, {3.8237947826043787`*^9, 3.823794783089592*^9}, {
   3.8238083053838463`*^9, 3.823808305575739*^9}, {3.823808392334058*^9, 
   3.823808396636021*^9}, {3.8238085252559805`*^9, 3.823808525319538*^9}, 
   3.823808597694934*^9, {3.8238086342182817`*^9, 3.823808634467719*^9}, {
   3.8238093839372644`*^9, 3.8238093843141327`*^9}, {3.8238106831768394`*^9, 
   3.8238106832908573`*^9}, {3.8238110354416933`*^9, 
   3.8238110355325828`*^9}, {3.8238122078733*^9, 3.8238122285231547`*^9}, {
   3.8238581560691795`*^9, 3.823858156442896*^9}, {3.824383516542162*^9, 
   3.8243835430685067`*^9}, {3.824383731520373*^9, 3.824383756388443*^9}, 
   3.8243837935354605`*^9, {3.824383849558404*^9, 3.824383870901231*^9}, {
   3.8243839227371635`*^9, 3.824383922999219*^9}, {3.8243839652175646`*^9, 
   3.824383994893087*^9}, {3.8243840307337856`*^9, 3.824384030826988*^9}, {
   3.824385605145857*^9, 3.824385621198181*^9}, {3.824385712620699*^9, 
   3.8243857448832645`*^9}, {3.824385878026354*^9, 3.824385878193098*^9}, {
   3.8243859751855597`*^9, 3.824385983727231*^9}, {3.8243871629957128`*^9, 
   3.8243871632014437`*^9}, {3.824387293344232*^9, 3.8243872938183937`*^9}, {
   3.824387430802317*^9, 3.824387456106408*^9}, {3.824387836458701*^9, 
   3.8243878407799273`*^9}, {3.8243879870831614`*^9, 3.8243879974012156`*^9}, 
   3.8243891619952607`*^9, {3.8243895657998576`*^9, 3.824389591657217*^9}, {
   3.8243917743357506`*^9, 3.8243917748606677`*^9}, {3.8244564643335714`*^9, 
   3.8244564668219547`*^9}, 3.8244565186498227`*^9, 3.824457071087975*^9, {
   3.824463354958598*^9, 3.824463369153125*^9}, 3.8244634169066563`*^9, {
   3.8244635068403454`*^9, 3.8244635090026517`*^9}, {3.8244637592114015`*^9, 
   3.824463767200752*^9}, {3.824464807855097*^9, 3.8244648560499287`*^9}, {
   3.824467407329995*^9, 3.8244674289545145`*^9}, {3.824539330438416*^9, 
   3.82453933096542*^9}, {3.8245395553980803`*^9, 3.8245395554667544`*^9}, {
   3.8245398384225326`*^9, 3.8245398407474546`*^9}, {3.824540312546051*^9, 
   3.824540338621957*^9}, 3.8245407296599207`*^9, {3.8245480998328886`*^9, 
   3.8245481115628133`*^9}, {3.8245485718061132`*^9, 3.824548595768612*^9}, {
   3.824549285580867*^9, 3.824549285950395*^9}, {3.8245496286464353`*^9, 
   3.824549642339865*^9}, {3.824550626155019*^9, 3.824550647298606*^9}, {
   3.8245512586541414`*^9, 3.8245512686556225`*^9}, {3.8245525995930324`*^9, 
   3.824552654728651*^9}, {3.8245529287751627`*^9, 3.824552937269043*^9}, {
   3.824553330110774*^9, 3.824553348742734*^9}, {3.824807396031418*^9, 
   3.8248073980237036`*^9}, {3.825514655419546*^9, 3.8255146612423315`*^9}, {
   3.8255147981686172`*^9, 3.8255147982279387`*^9}, {3.825517533845537*^9, 
   3.825517535805646*^9}, {3.8255187037966213`*^9, 3.8255187039292545`*^9}, {
   3.8255207268200808`*^9, 3.8255207275287313`*^9}, {3.8255207680703363`*^9, 
   3.825520768139099*^9}, {3.825520839420801*^9, 3.825520840292618*^9}, {
   3.825520983954655*^9, 3.8255209886950407`*^9}, {3.8255212442411704`*^9, 
   3.8255212466151876`*^9}, {3.825580575699616*^9, 3.8255805884547253`*^9}, {
   3.8255807399425073`*^9, 3.825580741704691*^9}, {3.8255808589133167`*^9, 
   3.825580859084896*^9}, {3.8255809071698895`*^9, 3.82558090724189*^9}, {
   3.82558096019638*^9, 3.825580960406559*^9}, {3.825581217104507*^9, 
   3.8255812174842525`*^9}, {3.825588678362708*^9, 3.8255886901379004`*^9}, {
   3.8255891260556374`*^9, 3.8255891346296344`*^9}, {3.825589318905561*^9, 
   3.82558933294762*^9}, {3.8255899929967575`*^9, 3.8255899932702174`*^9}, {
   3.825664174491381*^9, 3.8256641746266885`*^9}, 3.8256649297937555`*^9, {
   3.8256651093132052`*^9, 3.8256651197235565`*^9}, {3.82566517104311*^9, 
   3.8256651760284805`*^9}, {3.8256737692306156`*^9, 
   3.8256737719033203`*^9}, {3.825673832856662*^9, 3.825673833555518*^9}, {
   3.8256738992976832`*^9, 3.8256738996791835`*^9}, {3.8256739897235937`*^9, 
   3.825674006782044*^9}, {3.825678428551801*^9, 3.825678428790569*^9}, {
   3.825678483157711*^9, 3.8256784832220736`*^9}, {3.8256792361745205`*^9, 
   3.8256792392866716`*^9}, {3.825679334935173*^9, 3.8256793942961855`*^9}, {
   3.825680122675579*^9, 3.825680123054191*^9}, {3.8256807577078238`*^9, 
   3.825680770669303*^9}, {3.8256813087243285`*^9, 3.8256813090074115`*^9}, {
   3.825681878933922*^9, 3.8256818789881415`*^9}, {3.8256828120053625`*^9, 
   3.8256828646220636`*^9}, {3.8256837842311296`*^9, 
   3.8256837844010897`*^9}, {3.8256839549578753`*^9, 
   3.8256839552685547`*^9}, {3.825684224312383*^9, 3.825684227731038*^9}, {
   3.825685353068256*^9, 3.8256853534427967`*^9}, {3.825685842123771*^9, 
   3.825685842222681*^9}, {3.8256862147359324`*^9, 3.8256862156477265`*^9}, {
   3.825689379001584*^9, 3.825689381856078*^9}, {3.8256902433025866`*^9, 
   3.8256902684069614`*^9}, {3.825693425915304*^9, 3.825693426362857*^9}, {
   3.8256941326248517`*^9, 3.825694182493269*^9}, {3.8256942255156617`*^9, 
   3.8256942301917987`*^9}, {3.825694859482811*^9, 3.825694859573542*^9}, {
   3.82569577448968*^9, 3.8256957747520437`*^9}, {3.8256958899993477`*^9, 
   3.8256958911102448`*^9}, {3.825696506613579*^9, 3.825696506723522*^9}, {
   3.825696763810671*^9, 3.825696775061117*^9}, {3.825698261276558*^9, 
   3.825698262576825*^9}, {3.8257124862976317`*^9, 3.825712493211833*^9}, {
   3.8257462760932336`*^9, 3.8257462764490585`*^9}, {3.8257477969349356`*^9, 
   3.825747806128685*^9}, {3.8257480444028254`*^9, 3.8257480445733805`*^9}, {
   3.8257480815495434`*^9, 3.8257480834450026`*^9}, {3.825748278851542*^9, 
   3.825748279146574*^9}, {3.8260241961550837`*^9, 3.8260241966400166`*^9}, {
   3.826024528234595*^9, 3.8260245386926413`*^9}, {3.8260317109008307`*^9, 
   3.8260317243416157`*^9}, {3.826031964728044*^9, 3.826031965368174*^9}, {
   3.8260330114296827`*^9, 3.8260330216637955`*^9}, {3.826033073087246*^9, 
   3.8260330733328342`*^9}, {3.8260343128917723`*^9, 
   3.8260343178328924`*^9}, {3.826037221909957*^9, 3.826037245961738*^9}, {
   3.82603746480134*^9, 3.8260374674319415`*^9}, {3.8260377735575857`*^9, 
   3.826037784601339*^9}, {3.8260381580116677`*^9, 3.826038158247359*^9}, 
   3.8260383007293186`*^9, 3.826038375644622*^9, {3.8260394612570925`*^9, 
   3.8260394740785675`*^9}, {3.8260496667574186`*^9, 
   3.8260496976510572`*^9}, {3.826049937621585*^9, 3.826049964393605*^9}, {
   3.826050217537347*^9, 3.8260502195733037`*^9}, {3.8260503102344084`*^9, 
   3.8260503104418416`*^9}, {3.82605050274347*^9, 3.8260505030399327`*^9}, {
   3.826050686626536*^9, 3.8260506866855316`*^9}, {3.826050906153658*^9, 
   3.826050910123751*^9}, {3.8260511721605825`*^9, 3.8260511749670334`*^9}, {
   3.826051301503517*^9, 3.8260513071925364`*^9}, {3.8260807390734506`*^9, 
   3.826080739450879*^9}, {3.826080897058942*^9, 3.8260809054417777`*^9}, {
   3.826080963289836*^9, 3.826080963836748*^9}, {3.8260815962171707`*^9, 
   3.8260815962994556`*^9}, {3.826081765337963*^9, 3.8260817956238885`*^9}, {
   3.8260818594228454`*^9, 3.8260818992464657`*^9}, {3.8260821588908916`*^9, 
   3.8260821596373653`*^9}, {3.826082258780409*^9, 3.826082353296706*^9}, {
   3.8260826993716974`*^9, 3.8260826995946445`*^9}, {3.8260827524091177`*^9, 
   3.8260827717208424`*^9}, {3.82608322725115*^9, 3.8260832273341618`*^9}, {
   3.8260832759513884`*^9, 3.8260832759796352`*^9}, {3.8260834372752275`*^9, 
   3.8260834373747673`*^9}, {3.8260835253191557`*^9, 
   3.8260835257103243`*^9}, {3.826083589061351*^9, 3.8260836324716415`*^9}, {
   3.8260842528145905`*^9, 3.826084273181553*^9}, {3.8260847522941375`*^9, 
   3.826084752401659*^9}, {3.826085565880874*^9, 3.8260855659149656`*^9}, 
   3.8260857026655245`*^9, {3.826085764331626*^9, 3.8260857869861655`*^9}, {
   3.826085907499792*^9, 3.8260859531309185`*^9}, {3.826086121836466*^9, 
   3.826086125964778*^9}, {3.826086410083417*^9, 3.8260864254200373`*^9}, {
   3.8260867710933094`*^9, 3.8260867713679857`*^9}, {3.826087569365726*^9, 
   3.826087569675088*^9}, {3.826088009634377*^9, 3.8260880116888285`*^9}, {
   3.826088411768396*^9, 3.826088459962958*^9}, {3.826089426947858*^9, 
   3.826089452998969*^9}, {3.8260898293577857`*^9, 3.8260898295803957`*^9}, {
   3.826090212245872*^9, 3.826090212681624*^9}, {3.82609204724971*^9, 
   3.8260920563886433`*^9}, {3.8260921172723756`*^9, 
   3.8260921602205253`*^9}, {3.8260930893394885`*^9, 3.826093089726137*^9}, {
   3.826093478755097*^9, 3.826093479098279*^9}, {3.826094044296029*^9, 
   3.8260940494606886`*^9}, {3.826094628431615*^9, 3.826094628577734*^9}, {
   3.826095054411854*^9, 3.8260950579516716`*^9}, {3.826095886853355*^9, 
   3.826095887189859*^9}, {3.826096509620725*^9, 3.8260965240328712`*^9}, {
   3.826097246678782*^9, 3.826097249489582*^9}, {3.8260973446901712`*^9, 
   3.8260973556038675`*^9}, {3.826097867177883*^9, 3.8260978898888197`*^9}, {
   3.8260982123399734`*^9, 3.8260982124721155`*^9}, {3.8260992468262286`*^9, 
   3.8260992482155027`*^9}, {3.826099757673831*^9, 3.8260997586850634`*^9}, {
   3.8261000308452816`*^9, 3.826100031675827*^9}, {3.826100477380885*^9, 
   3.826100477896624*^9}, {3.826101886509852*^9, 3.8261018877353945`*^9}, {
   3.8261045172134333`*^9, 3.8261046173213077`*^9}, {3.8261047784830475`*^9, 
   3.826104778584463*^9}, {3.8261048638975163`*^9, 3.826104897995408*^9}, {
   3.8261060637556953`*^9, 3.8261060650491295`*^9}, {3.826107121479511*^9, 
   3.8261071265453143`*^9}, {3.8261072656973534`*^9, 
   3.8261072657723255`*^9}, {3.82610746362263*^9, 3.8261074636651735`*^9}, {
   3.826107609644972*^9, 3.8261076097617755`*^9}, {3.8261085684317656`*^9, 
   3.8261085685014877`*^9}, {3.826108826998629*^9, 3.826108834074193*^9}, {
   3.826113835838646*^9, 3.826113935360199*^9}, {3.8261139755117044`*^9, 
   3.826114035865157*^9}, {3.8261141436102505`*^9, 3.826114151878756*^9}, {
   3.8261144802933626`*^9, 3.8261144811534996`*^9}, {3.826114812564617*^9, 
   3.826114814828647*^9}, {3.826114889754921*^9, 3.8261148910569487`*^9}, {
   3.8261149374642167`*^9, 3.8261149385148015`*^9}, 3.826115083224955*^9, {
   3.8261151657924337`*^9, 3.8261151862471685`*^9}, {3.826115264832739*^9, 
   3.8261152711131268`*^9}, {3.826115461250308*^9, 3.826115523827112*^9}, 
   3.8261156080221167`*^9, {3.8261160072932796`*^9, 3.826116041683505*^9}, {
   3.826116262369053*^9, 3.8261162624599113`*^9}, {3.826116747237224*^9, 
   3.826116751420243*^9}, {3.826117400091778*^9, 3.826117400348405*^9}, {
   3.82611778874995*^9, 3.8261177935641413`*^9}, {3.8261181806464605`*^9, 
   3.826118215813963*^9}, {3.826118835060914*^9, 3.826118837090678*^9}, {
   3.8261203019773903`*^9, 3.8261203034944897`*^9}, {3.826186753677112*^9, 
   3.8261868056415625`*^9}, {3.8261868903351364`*^9, 3.826186898641782*^9}, {
   3.82618729641882*^9, 3.826187300018915*^9}, {3.8278271107883697`*^9, 
   3.8278271213800325`*^9}, {3.827827700538685*^9, 3.827827805519186*^9}, {
   3.8278278713500175`*^9, 3.827827879580393*^9}, {3.82783985951575*^9, 
   3.8278398600249605`*^9}, {3.827840834863559*^9, 3.8278408410400505`*^9}, {
   3.827844000202521*^9, 3.8278440044071302`*^9}, {3.827844544437809*^9, 
   3.8278445466642537`*^9}, {3.827844642077112*^9, 3.8278446427925816`*^9}, {
   3.827845207556794*^9, 3.8278452076413994`*^9}, {3.8278453529385605`*^9, 
   3.8278453739919453`*^9}, {3.8278454474993763`*^9, 3.827845461882996*^9}, {
   3.8278456966503525`*^9, 3.8278456967302732`*^9}, {3.827845804558919*^9, 
   3.827845805089779*^9}, {3.82784599493437*^9, 3.8278459965384083`*^9}, 
   3.827846133088688*^9, {3.82784681768799*^9, 3.827846821720585*^9}, {
   3.827846986834722*^9, 3.8278469873129487`*^9}, {3.827847350152418*^9, 
   3.8278473531578207`*^9}, {3.827847568854866*^9, 3.8278475689067106`*^9}, {
   3.8278480720953636`*^9, 3.827848076249971*^9}, {3.827848533667438*^9, 
   3.8278485342662907`*^9}, {3.827848980940919*^9, 3.827848983690712*^9}, 
   3.827849250431351*^9, {3.8278512538980584`*^9, 3.8278512541224637`*^9}, {
   3.8278515701198673`*^9, 3.827851570480401*^9}, {3.827852156881403*^9, 
   3.8278521574180293`*^9}, {3.8279066856538754`*^9, 
   3.8279067256359205`*^9}, {3.827906842155553*^9, 3.8279068582596693`*^9}, {
   3.8279072126213827`*^9, 3.8279072399243555`*^9}, {3.832655214241252*^9, 
   3.832655340437831*^9}, {3.8326554461719666`*^9, 3.8326554612553635`*^9}, {
   3.832655598027835*^9, 3.832655598371674*^9}, {3.8326556354484344`*^9, 
   3.8326556382882643`*^9}, {3.8326557373064423`*^9, 
   3.8326558515271807`*^9}, {3.832656030228155*^9, 3.8326560450533104`*^9}, {
   3.832656198929495*^9, 3.8326562159490795`*^9}, {3.8326570536893177`*^9, 
   3.832657063907899*^9}, {3.8326571738480663`*^9, 3.832657174169388*^9}, {
   3.832658731127903*^9, 3.8326587357443256`*^9}, {3.832659172117465*^9, 
   3.832659175219843*^9}, {3.8326593597969294`*^9, 3.8326593702590637`*^9}, {
   3.832659759359027*^9, 3.832659759500434*^9}, {3.832667633834819*^9, 
   3.832667634065404*^9}, {3.832668429406723*^9, 3.8326684305855746`*^9}, {
   3.8326690368707433`*^9, 3.832669037234048*^9}, {3.832669129973177*^9, 
   3.8326691300560975`*^9}, {3.832669238653461*^9, 3.8326692393357944`*^9}, {
   3.8326744379014425`*^9, 3.832674439142461*^9}, {3.8326759220755324`*^9, 
   3.8326759799745493`*^9}, 3.8327401082083607`*^9, {3.8327404573652587`*^9, 
   3.8327404610410876`*^9}, {3.8327781731094866`*^9, 3.832778173187763*^9}, {
   3.8327787116432533`*^9, 3.8327787117181997`*^9}, {3.832779072114788*^9, 
   3.83277907218855*^9}, 3.833445538429059*^9, {3.833445593959488*^9, 
   3.8334456114567595`*^9}, {3.8335263345146236`*^9, 
   3.8335263687978215`*^9}, {3.833961179644128*^9, 3.8339611801496105`*^9}, {
   3.833961217965933*^9, 3.8339612181382785`*^9}, {3.8339695129367456`*^9, 
   3.8339695143664436`*^9}, {3.833985759959688*^9, 3.8339857599944005`*^9}, {
   3.8340381799348087`*^9, 3.8340381800061455`*^9}, {3.834057381634693*^9, 
   3.8340573831409173`*^9}, 3.8340660369643555`*^9, 3.834066080863394*^9, {
   3.8340689824471445`*^9, 3.8340690022276983`*^9}, {3.834069623516094*^9, 
   3.8340696242132*^9}, {3.8354452381618347`*^9, 3.835445238803239*^9}, 
   3.8363717035302687`*^9, {3.8364866622973175`*^9, 3.8364866626792946`*^9}, 
   3.8447703556434345`*^9, 3.844775759207481*^9, 3.8454725147330885`*^9, {
   3.845472992231592*^9, 3.8454729924918957`*^9}, {3.8570326854938717`*^9, 
   3.857032687178503*^9}, {3.865430634260207*^9, 3.8654306365918646`*^9}, {
   3.8806596686406755`*^9, 3.880659697846856*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[58]:=",ExpressionUUID->"611bdf8c-e18e-4751-a3c0-d204533b0f9f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"gam", "/", 
     RowBox[{"(", 
      RowBox[{"ka", "*", "A0"}], ")"}]}], ",", 
    RowBox[{"\[CapitalLambda]2", "/", 
     RowBox[{"(", 
      RowBox[{"ka", "*", 
       SuperscriptBox["A0", 
        RowBox[{"3", "/", "2"}]]}], " ", ")"}]}]}], "}"}], "//", 
  "N"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{3.8447757592114706`*^9, 3.8570326899233484`*^9},
 CellTags->"codetag",
 CellLabel->"In[92]:=",ExpressionUUID->"2759c0f7-ab79-45f4-b59a-195e6dbc3a9a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.04`", ",", "0.000025`"}], "}"}]], "Output",
 CellChangeTimes->{3.880661681632834*^9},
 CellTags->"codetag",
 CellLabel->"Out[92]=",ExpressionUUID->"1676e10e-ba5d-4dc2-bca0-fe079c2372a3"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"NEW", " ", "VM", " ", "PARAMETERS"}], " ", "*)"}], "Input"], 
  StyleBox["\[IndentingNewLine]", "Input"], 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"ka", "=", "3000"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"gam", "=", 
      RowBox[{"0.03", "*", "ka", "*", "A0"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"P00", "=", "0"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"P0", "=", "3.7224"}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"\[CapitalLambda]", "=", 
      RowBox[{"\[CapitalLambda]2", "=", "0.025"}]}], ";"}], "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gam", "/", 
       RowBox[{"(", 
        RowBox[{"ka", "*", "A0"}], ")"}]}], ",", 
      RowBox[{"\[CapitalLambda]2", "/", 
       RowBox[{"(", 
        RowBox[{"ka", "*", 
         SuperscriptBox["A0", 
          RowBox[{"3", "/", "2"}]]}], " ", ")"}]}]}], "}"}], "//", 
    "N"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.834057308892199*^9, 3.834057362016938*^9}, {
   3.834057393424988*^9, 3.834057450123827*^9}, {3.834057544337311*^9, 
   3.8340575749650435`*^9}, {3.8340578641101656`*^9, 
   3.8340578857593355`*^9}, {3.8342286153805137`*^9, 
   3.8342286389199543`*^9}, {3.834229153535579*^9, 3.8342291535814185`*^9}, {
   3.8342293926323147`*^9, 3.834229394487173*^9}, 3.844770356587909*^9, {
   3.84477575921546*^9, 3.844775759217455*^9}, 3.845472514559553*^9, {
   3.845472997315031*^9, 3.8454729974775953`*^9}, {3.857032691888095*^9, 
   3.8570326928036504`*^9}, {3.8575571930330935`*^9, 3.8575571986889806`*^9}},
 
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->"In[93]:=",ExpressionUUID->"143c3955-9162-4fed-9972-b8af524e265d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.03`", ",", "8.333333333333334`*^-6"}], "}"}]], "Output",
 CellChangeTimes->{3.8806616816767178`*^9},
 CellTags->"codetag",
 CellLabel->"Out[98]=",ExpressionUUID->"40d7d676-e4a6-4f99-8343-1103062578dd"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["III Program",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
  3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
  3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
  3.832672204632841*^9, 3.832672215583895*^9}, {3.835448462512396*^9, 
  3.8354484631862106`*^9}, {3.8354485286568203`*^9, 3.8354485339226103`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"661494ca-ef7e-4d69-8288-45d70b6edd5e"],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"346b2c59-f8f4-4332-bcd4-8278647a60f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"CLEAR", " ", "FUNCTION"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"clear", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{
        "lv", ",", "lvs", ",", "plots", ",", "plist", ",", "plistn", ",", 
         "pts0", ",", "vpts0", ",", "pts", ",", "mesh", ",", "hexagons", ",", 
         "nex", ",", "meshx", ",", "indToPts", ",", "cellToPts", ",", "sigR", 
         ",", "lsig1", ",", "lsig2", ",", "assl", ",", "asslJ", ",", "asslL", 
         ",", "asslT"}], "]"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8405568712264433`*^9, 3.8405568896055703`*^9}, {
  3.8405569520320144`*^9, 3.8405569831456594`*^9}, {3.840557074809108*^9, 
  3.84055707694497*^9}, {3.8405571510846806`*^9, 3.8405571657269564`*^9}, {
  3.856007901950119*^9, 3.8560079029654045`*^9}, {3.8648005531199217`*^9, 
  3.8648005543441563`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[99]:=",ExpressionUUID->"4af41dba-e75c-4e79-8299-07d35ab894f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"MULTIPLE", " ", "RUNS"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RunFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "saveli", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ik", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", ",", 
          "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", "sorc", ",", 
          "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
          ",", "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh",
           ",", "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", "vormod",
           ",", "smod", ",", 
          StyleBox["ka", "Input"], 
          StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
          "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
          "diamx", ",", "depQ", ",", 
          StyleBox["ka2", "Input"], 
          StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", 
          "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
          StyleBox["ka3", "Input"], 
          StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", 
          "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", 
          "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy", 
          ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",", "Tsim2", 
          ",", "sigs", ",", "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", 
          ",", "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",", 
          "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",", "Tstef", 
          ",", "fareaQ", ",", "fperQ", ",", "fltensQ", ",", "fhookeQ", ",", 
          "rho", ",", "k", ",", "h", ",", "mu", ",", "aN0", ",", "bN0", ",", 
          "iniN", ",", "iniD", " ", ",", "iniR", ",", "\[Beta]N", ",", 
          "\[Beta]D", ",", "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
          "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", 
          "cisQ", ",", "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", 
          "nv", ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", "effvol", ",",
           "dynpQ", ",", "uplQ", ",", "pfixQ", ",", "pbt", ",", "pdt", ",", 
          "pll", ",", "pla", ",", "\[Epsilon]", ",", "cellQ", ",", "longt", 
          ",", "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1", ",",
           "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], "}"}], "=", 
        RowBox[{"ToExpression", "@", "saveli"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SimFn", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"ToExpression", "@", "saveli"}], ")"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ik", "<", "msimn"}], ",", 
            RowBox[{
             RowBox[{"ik", "++"}], ";", 
             RowBox[{"check", "=", "0"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "msimn"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"GET", " ", "DATA"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coeffQ", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"coeffQ", ",", "\[IndentingNewLine]", 
         RowBox[{"coeffvarl", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"coeffvarl", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"coeffvar", "[", 
               RowBox[{
               "i", ",", "dinl", ",", "regcla", ",", "pts2x", ",", "pts2y"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Tmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"verdataQ", "=", "True"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verdataQ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tii", "=", "5"}], ";", "\[IndentingNewLine]", 
          RowBox[{"verdata", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"verdata", ",", 
             RowBox[{"{", 
              RowBox[{
               StyleBox["ka2", "Input"], 
               StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",",
                "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
               StyleBox["ka3", "Input"], 
               StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",",
                "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Area", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}], "/", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Area", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "Tii", "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}]}], "-", "1"}], ")"}], ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"4", "Pi", " ", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Area", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Perimeter", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}], ")"}], "^", "2"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "Pi", " ", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Area", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "Tii", "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"(", 
                    RowBox[{"Perimeter", "/@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "Tii", "]"}], "]"}], ",", "din"}], "]"}]}], 
                    ")"}], "]"}], ")"}], "^", "2"}]}]}], ")"}]}], "-", "1"}], 
                   ")"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
            "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dinll", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"dinll", ",", "dinl"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"solsl", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"solsl", ",", "sols"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{"plotSOPQ", ",", 
         RowBox[{"runplotSOP", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"runplotSOP", ",", "plotSOP"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"runvideos", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"runvideos", ",", "out"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"runfframe", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"runfframe", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "runvideos", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"runfframe", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"runfframe", ",", 
          RowBox[{
           RowBox[{"out", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8396737439979277`*^9, 3.839673765581289*^9}, {
   3.83967385565412*^9, 3.839673855795339*^9}, {3.8396740525988107`*^9, 
   3.839674075035843*^9}, {3.839675189914886*^9, 3.8396751991174226`*^9}, {
   3.839675259454485*^9, 3.839675262342283*^9}, {3.83967927434951*^9, 
   3.839679341759954*^9}, {3.8396800642223177`*^9, 3.8396800831480074`*^9}, {
   3.8396802898590293`*^9, 3.839680301677041*^9}, {3.8397039255342016`*^9, 
   3.839703930067374*^9}, {3.8397564295980873`*^9, 3.8397564315920477`*^9}, {
   3.8398318842016506`*^9, 3.839831886967496*^9}, {3.839846189556346*^9, 
   3.839846218686311*^9}, 3.8400890204374666`*^9, 3.8400890598076534`*^9, 
   3.840089327255782*^9, {3.840089464526859*^9, 3.8400894738434534`*^9}, 
   3.84009008708668*^9, 3.8400926543982067`*^9, 3.8401114066231976`*^9, {
   3.8401877601478653`*^9, 3.8401877617535725`*^9}, {3.840187949239952*^9, 
   3.8401879603496914`*^9}, 3.8405253218797226`*^9, 3.8405267661670823`*^9, 
   3.8406193183913827`*^9, 3.840624660475754*^9, 3.84166052429955*^9, 
   3.842601758095835*^9, {3.843291935793719*^9, 3.8432919482667084`*^9}, 
   3.843469358368549*^9, {3.8434720812884855`*^9, 3.843472085113515*^9}, {
   3.8434728870362887`*^9, 3.8434728971800127`*^9}, 3.844769592211296*^9, 
   3.844770358519744*^9, 3.8447706469529753`*^9, 3.8447717035376043`*^9, {
   3.8447757592214437`*^9, 3.8447757592234383`*^9}, 3.84546567711312*^9, 
   3.845465784533268*^9, 3.8454727849549313`*^9, {3.845636210756654*^9, 
   3.8456362331726947`*^9}, 3.845638656186977*^9, 3.84565880193698*^9, {
   3.850812987897114*^9, 3.8508129948674946`*^9}, {3.8508132044495907`*^9, 
   3.850813205813942*^9}, {3.850814765954916*^9, 3.850814768740466*^9}, {
   3.8508184650093393`*^9, 3.8508184727294006`*^9}, {3.8552342417863555`*^9, 
   3.855234258074545*^9}, 3.8552343629465895`*^9, 3.8559041863249335`*^9, 
   3.855909409468133*^9, {3.8559148684601774`*^9, 3.855914893092348*^9}, {
   3.855915368695205*^9, 3.8559154317338314`*^9}, {3.855915631346019*^9, 
   3.855915634668135*^9}, {3.855917035288591*^9, 3.8559170825668316`*^9}, 
   3.8560053997607527`*^9, {3.856520902886183*^9, 3.856520903279132*^9}, {
   3.8570326967405186`*^9, 3.8570327007531953`*^9}, 3.857033355989952*^9, {
   3.857033439680848*^9, 3.8570334403841076`*^9}, 3.8570475555936766`*^9, 
   3.857050229609172*^9, {3.857642492188123*^9, 3.857642496655675*^9}, 
   3.8621337405111365`*^9, 3.864721972643632*^9, 3.8647223198735695`*^9, 
   3.8655270920388584`*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[100]:=",ExpressionUUID->"3d6f59ac-cd47-44a9-a2e8-703fefb122bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"MATRIX", " ", "RESHAPE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"resm", "[", "mat_", "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", "mat"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Dimensions", "[", "mat", "]"}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mlt", "[", 
     RowBox[{"x_List", ",", "m_"}], "]"}], ":=", 
    RowBox[{"x", "*", "m"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"repf", "[", 
      RowBox[{"x_List", ",", "ns_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "ns"}], "]"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"err", "=", "1"}], ";", 
    RowBox[{"erf", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Check `1`\>\"", ",", 
          RowBox[{"err", "++"}]}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"posf", "[", 
      RowBox[{"grid_", ",", "s_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"j", "->", 
        RowBox[{"s", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"grid", ",", "s"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"posfc", "[", 
      RowBox[{"grid_", ",", "s_"}], "]"}], ":=", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "+", "1"}], "->", "col1l"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"grid", ",", "s"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       
       RowBox[{"1", "->", "col1l"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"addc", "[", "l_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"bts", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"l", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"l", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=!=", "spc"}]}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"hds", ",", 
                RowBox[{"l", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"l", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Invisible", "@", 
                RowBox[{"Item", "[", 
                 RowBox[{
                  RowBox[{"openers", "[", "opo", "]"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}]}]}], "]"}],
              ",", 
             RowBox[{"Insert", "[", 
              RowBox[{
               RowBox[{"l", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "SpanFromLeft", ",", 
               "2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Invisible", "@", 
            RowBox[{"openers", "[", "opo", "]"}]}]}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "l", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.833621759688491*^9, 3.833621778583685*^9}, {
   3.8336222470003433`*^9, 3.833622266094908*^9}, {3.8336223391360307`*^9, 
   3.8336223392088437`*^9}, {3.8336224096832404`*^9, 
   3.8336224115146313`*^9}, {3.8336224680303483`*^9, 
   3.8336225085242147`*^9}, {3.8336225585994945`*^9, 3.833622558756772*^9}, {
   3.833622602169307*^9, 3.8336226116915445`*^9}, 3.8336238347814445`*^9, {
   3.8338739454860473`*^9, 3.8338739528424377`*^9}, {3.8338825768890285`*^9, 
   3.8338825899975233`*^9}, {3.833882629811782*^9, 3.8338826659612455`*^9}, {
   3.8338828029652243`*^9, 3.833882837260852*^9}, {3.8338828723800898`*^9, 
   3.8338828897831535`*^9}, 3.833883047085823*^9, {3.8338830787664576`*^9, 
   3.8338831167184696`*^9}, {3.833883186155502*^9, 3.833883186724078*^9}, {
   3.8339684853088264`*^9, 3.8339684867822175`*^9}, {3.833981156311338*^9, 
   3.833981166622695*^9}, {3.833981499755837*^9, 3.833981502269541*^9}, {
   3.8339817242819977`*^9, 3.8339817332756195`*^9}, {3.8339856487531013`*^9, 
   3.833985649347531*^9}, {3.8340438577825484`*^9, 3.8340438759597836`*^9}, {
   3.8340611067334423`*^9, 3.8340612012128725`*^9}, {3.8347432509399395`*^9, 
   3.8347432871110897`*^9}, {3.8347463984974346`*^9, 3.834746429649541*^9}, {
   3.834751659893938*^9, 3.8347516600325665`*^9}, {3.8347517556811943`*^9, 
   3.834751758099674*^9}, 3.8347518122501783`*^9, {3.834753292389068*^9, 
   3.834753312099872*^9}, {3.8348276489215093`*^9, 3.8348276803609695`*^9}, {
   3.8348278293590307`*^9, 3.834827829597393*^9}, {3.8348278851304593`*^9, 
   3.834827912929948*^9}, {3.8348280250213127`*^9, 3.834828033897359*^9}, {
   3.8348315660299573`*^9, 3.8348315660668583`*^9}, {3.834831762486244*^9, 
   3.834831812086771*^9}, {3.834831924513857*^9, 3.834831933680569*^9}, {
   3.8350980966354465`*^9, 3.8350980994314985`*^9}, {3.8350989326004753`*^9, 
   3.8350989334741387`*^9}, {3.8351030450194674`*^9, 3.835103094688199*^9}, 
   3.8353711370536776`*^9, {3.835716479428857*^9, 3.835716481049553*^9}, {
   3.8357166630038195`*^9, 3.835716670635363*^9}, {3.837094588912708*^9, 
   3.8370945893044467`*^9}, {3.8370948025608706`*^9, 3.8370948053101177`*^9}, 
   3.837094906392456*^9, {3.837112441558008*^9, 3.83711247152273*^9}, {
   3.837113021340189*^9, 3.837113021657342*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[101]:=",ExpressionUUID->"7f214d9d-cfaa-493b-88d7-37e124271643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"TOOL", " ", "TIP"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dla", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tl", "[", "s_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringQ", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "==", "\"\<Alarm\>\""}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
         "s", ",", 
          "\"\<Sets an audio alarm for when the simulation is complete\>\"", 
          ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "==", "\"\<Quiet mode\>\""}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Hides error messages\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(N\)]\)\>\""}],
         ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Maximal Notch production rate\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(D\)]\)\>\""}],
         ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Maximal Delta production rate\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(R\)]\)\>\""}],
         ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Maximal repressor production rate\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(N\), \(0\)]\)\>\""}], ",", 
        
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Initial Notch activity\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(D\), \(0\)]\)\>\""}], ",", 
        
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Initial Delta activity\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", "\"\<\!\(\*SubscriptBox[\(R\), \(0\)]\)\>\""}], ",", 
        
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Initial repressor activity\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "s", "\[Equal]", 
         "\"\<\!\(\*SubscriptBox[\(\[Kappa]\), \(c\)]\)\>\""}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Cis-inhibition strength\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "\[Equal]", "\"\<Vertex update\>\""}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{"s", ",", "\"\<Allows the [OTHER MODEL] update\>\"", ",", 
          RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "True", ",", "s"}], "\[IndentingNewLine]", 
       "]"}], ",", "s"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tl2", "[", "s_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "s", "]"}], "==", "2"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", 
         RowBox[{"s", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<Alarm\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
           "s", ",", 
            "\"\<Sets an audio alarm for when the simulation is complete\>\"",
             ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(N\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Maximal Notch production rate\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(D\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Maximal Delta production rate\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(R\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Maximal repressor production rate\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(N\), \(0\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Initial Notch activity\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(D\), \(0\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Initial Delta activity\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(R\), \(0\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Initial repressor activity\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<\!\(\*SubscriptBox[\(\[Kappa]\), \(c\)]\)\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Cis-inhibition strength\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           "\"\<Vertex update\>\""}], ",", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"s", ",", "\"\<Allows the [OTHER MODEL] update\>\"", ",", 
            RowBox[{"TooltipDelay", "\[Rule]", "dla"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "True", ",", "s"}], "\[IndentingNewLine]", 
         "]"}], ",", "s"}], "]"}], ",", "s"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tlm", "[", "matt_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"tl", ",", "matt", ",", 
      RowBox[{"{", "4", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tlm2", "[", "matt_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{"tl2", ",", "matt", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strf", "[", "s_", "]"}], ":=", 
    RowBox[{"StringForm", "[", 
     RowBox[{"\"\<\\\"``\\\"\>\"", ",", "s"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"progf", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "M", ",", "M2"}], "}"}], ",", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Overlay", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ProgressIndicator", "[", 
                RowBox[{"m", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"M", "-", "1"}]}], "}"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"100", ",", "13"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"Item", "[", "\[IndentingNewLine]", 
                RowBox[{"StringForm", "[", 
                 RowBox[{"\"\<`1`/`2`\>\"", ",", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"m", "/", "M"}], "  ", "M2"}], "]"}], ",", "M2"}],
                  "]"}], "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], "}"}], 
          "}"}], ",", 
         RowBox[{"ItemSize", "->", "Automatic"}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Right", ",", "Left"}], "}"}], ",", "Center"}], 
           "}"}]}]}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.833621759688491*^9, 3.833621778583685*^9}, {
   3.8336222470003433`*^9, 3.833622266094908*^9}, {3.8336223391360307`*^9, 
   3.8336223392088437`*^9}, {3.8336224096832404`*^9, 
   3.8336224115146313`*^9}, {3.8336224680303483`*^9, 
   3.8336225085242147`*^9}, {3.8336225585994945`*^9, 3.833622558756772*^9}, {
   3.833622602169307*^9, 3.8336226116915445`*^9}, 3.8336238347814445`*^9, {
   3.8338739454860473`*^9, 3.8338739528424377`*^9}, {3.8338825768890285`*^9, 
   3.8338825899975233`*^9}, {3.833882629811782*^9, 3.8338826659612455`*^9}, {
   3.8338828029652243`*^9, 3.833882837260852*^9}, {3.8338828723800898`*^9, 
   3.8338828897831535`*^9}, 3.833883047085823*^9, {3.8338830787664576`*^9, 
   3.8338831167184696`*^9}, {3.833883186155502*^9, 3.833883186724078*^9}, {
   3.8339684161694674`*^9, 3.833968421389721*^9}, {3.8342256368966765`*^9, 
   3.8342256445736446`*^9}, {3.83465624957716*^9, 3.83465627701467*^9}, {
   3.8346574918700666`*^9, 3.8346575341784654`*^9}, {3.8346681168521323`*^9, 
   3.8346681288336024`*^9}, {3.8352831914172363`*^9, 
   3.8352831936602373`*^9}, {3.835283227144533*^9, 3.8352832646821737`*^9}, {
   3.83528331198199*^9, 3.8352833122173595`*^9}, 3.836378642284676*^9, {
   3.8363787085752444`*^9, 3.8363787179162188`*^9}, {3.8365710448066387`*^9, 
   3.836571044951229*^9}, {3.836652671524675*^9, 3.8366526717531776`*^9}, {
   3.836652914509674*^9, 3.836652921319021*^9}, {3.8366529576187434`*^9, 
   3.836652958903363*^9}, {3.8366532650801764`*^9, 3.8366532675463915`*^9}, 
   3.8366542018268003`*^9, {3.836655371510206*^9, 3.836655398499025*^9}, 
   3.8369896872277765`*^9, {3.8369992639861336`*^9, 3.8369992660077276`*^9}, {
   3.839587748428487*^9, 3.8395877778907647`*^9}, {3.840982728880723*^9, 
   3.840982731907158*^9}, {3.84098277306376*^9, 3.8409827857202864`*^9}, {
   3.841745789459885*^9, 3.8417457898667965`*^9}, {3.8417458201994643`*^9, 
   3.8417458374546275`*^9}, {3.8417459459273357`*^9, 
   3.8417459464688873`*^9}, {3.841746075979536*^9, 3.841746083495716*^9}, {
   3.8417463004806395`*^9, 3.841746300627217*^9}, {3.841746501644796*^9, 
   3.8417465273583903`*^9}, 3.8417466175146933`*^9, {3.8417469065868425`*^9, 
   3.8417469091034765`*^9}, {3.841746999921155*^9, 3.8417470041957226`*^9}, {
   3.84174710463842*^9, 3.8417471070365953`*^9}, {3.841747186493251*^9, 
   3.8417472508778067`*^9}, {3.8439137449848056`*^9, 
   3.8439137554749956`*^9}, {3.8806596713783107`*^9, 3.88065969966777*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[108]:=",ExpressionUUID->"1f204ace-288e-4d47-9339-8c139c9cfbb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"ROUNDING", " ", "CELLS"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"roundm", "[", 
      RowBox[{"p_", ",", "\[Lambda]_", ",", "\[Mu]_"}], "]"}], ":=", 
     RowBox[{"FilledCurve", "@", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"scales", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Lambda]"}], ")"}], " ", "0"}], "+", 
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", "0"}], "+", 
                  RowBox[{"\[Mu]", " ", 
                   RowBox[{"1", "/", "2"}]}]}], ")"}]}]}], ",", 
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", "1"}], "+", 
                  RowBox[{"\[Mu]", " ", 
                   RowBox[{"1", "/", "2"}]}]}], ")"}], " ", "\[Lambda]"}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Lambda]"}], ")"}], " ", "1"}]}]}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"Join", "@@", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{"p", ",", 
                RowBox[{"(", 
                 RowBox[{"1.", "-", "scales"}], ")"}]}], "]"}], "+", 
              RowBox[{"TensorProduct", "[", 
               RowBox[{
                RowBox[{"RotateLeft", "[", "p", "]"}], ",", "scales"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}]}], "]"}], 
        ",", 
        RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"POLYGON", " ", "DIAMETER"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"pold0", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"pol", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"EuclideanDistance", "@@@", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"pol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pold", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"pol", ",", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"pol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"pol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"protlf", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lplistn", ",", "longt"}], "}"}], ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"longt", "==", "0"}], ",", "Area", ",", 
           RowBox[{"longt", "==", "1"}], ",", "Perimeter", ",", 
           RowBox[{"longt", "==", "2"}], ",", "pold"}], "]"}], ",", 
         RowBox[{"Values", "@", "lplistn"}]}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8339684405821986`*^9, 3.8339684419530025`*^9}, {
   3.8340581835436597`*^9, 3.83405823097276*^9}, {3.8340582749000816`*^9, 
   3.8340582993569145`*^9}, {3.834058743564098*^9, 3.834058750304394*^9}, {
   3.8340588300138583`*^9, 3.8340588809670205`*^9}, {3.834058962839883*^9, 
   3.8340589636108303`*^9}, {3.8340598628312173`*^9, 3.834059862943492*^9}, {
   3.834059909721052*^9, 3.8340599100791173`*^9}, {3.83405999151303*^9, 
   3.834059991705262*^9}, {3.834060039898178*^9, 3.834060043837467*^9}, {
   3.8340612355275373`*^9, 3.8340612365961847`*^9}, {3.8340612966445913`*^9, 
   3.834061299308813*^9}, {3.834062662554765*^9, 3.834062684415369*^9}, {
   3.8340627668651485`*^9, 3.8340627671513166`*^9}, {3.8344975506173267`*^9, 
   3.8344975539607525`*^9}, {3.8347410326252604`*^9, 
   3.8347410740564394`*^9}, {3.8347412973931346`*^9, 
   3.8347412977310534`*^9}, {3.8352709582227697`*^9, 3.8352709603722425`*^9}, 
   3.835271170791541*^9, {3.8352712225884895`*^9, 3.8352712817519927`*^9}, {
   3.8352714793191185`*^9, 3.8352714798387012`*^9}, {3.8352718215886507`*^9, 
   3.835271883572593*^9}, {3.8352719352055593`*^9, 3.8352719394115524`*^9}, {
   3.8352726912553716`*^9, 3.835272703301796*^9}, {3.835273080732069*^9, 
   3.8352730829227552`*^9}, {3.835273288750947*^9, 3.8352733912921925`*^9}, {
   3.8352734365459423`*^9, 3.8352734423266673`*^9}, {3.8352734839055347`*^9, 
   3.835273492910542*^9}, 3.835273545648055*^9, {3.83535792571808*^9, 
   3.8353579976213675`*^9}, {3.8353580838287506`*^9, 3.835358123508673*^9}, {
   3.835358219526012*^9, 3.8353582206860723`*^9}, {3.835358267711892*^9, 
   3.8353582845543804`*^9}, {3.8353583510310736`*^9, 
   3.8353583557882595`*^9}, {3.835358908116091*^9, 3.83535895788171*^9}, 
   3.8353590318396482`*^9, {3.8353590836627274`*^9, 3.8353590850050297`*^9}, {
   3.835359510068493*^9, 3.8353595140985813`*^9}, {3.8353598113701167`*^9, 
   3.83535982049835*^9}, {3.835442684842012*^9, 3.835442701782485*^9}, {
   3.835443007224168*^9, 3.8354430088849573`*^9}, {3.835443268862655*^9, 
   3.835443269314932*^9}, {3.8354434205126657`*^9, 3.835443428780469*^9}, {
   3.8354435205553226`*^9, 3.8354435238548126`*^9}, {3.835443771370042*^9, 
   3.8354437740498343`*^9}, 3.835443831656166*^9, {3.8354442796684637`*^9, 
   3.8354442802021217`*^9}, 3.835444324770384*^9, {3.835444401875094*^9, 
   3.835444402187857*^9}, {3.8354446731945295`*^9, 3.835444673500531*^9}, {
   3.8354454782624464`*^9, 3.8354454795307884`*^9}, {3.8354456420579004`*^9, 
   3.835445642192572*^9}, {3.8356929967804327`*^9, 3.8356930083614855`*^9}, {
   3.8356930451307106`*^9, 3.8356931190641284`*^9}, {3.8356933485832767`*^9, 
   3.835693348776759*^9}, {3.8356934381097755`*^9, 3.8356934466836076`*^9}, {
   3.8356938415174446`*^9, 3.8356938427173123`*^9}, {3.835703851466108*^9, 
   3.835703871063589*^9}, {3.835705169721203*^9, 3.8357051705839233`*^9}, {
   3.8362996778512974`*^9, 3.8362996862846746`*^9}, {3.836300859761258*^9, 
   3.8363008619645433`*^9}, {3.83630089941271*^9, 3.8363009082623177`*^9}, {
   3.83630097419154*^9, 3.836300993078389*^9}, {3.8364860875877433`*^9, 
   3.8364860905099964`*^9}, {3.836486134602577*^9, 3.836486186008235*^9}, {
   3.836487521238064*^9, 3.836487540070232*^9}, {3.836487579153318*^9, 
   3.836487616412546*^9}, 3.836487697102262*^9, {3.836487974912029*^9, 
   3.836488021349637*^9}, {3.8364880823636985`*^9, 3.836488177708313*^9}, {
   3.8365655389198074`*^9, 3.836565539288958*^9}, {3.837076801484547*^9, 
   3.8370768106635942`*^9}, {3.83707694908633*^9, 3.8370769506231813`*^9}, {
   3.8377686958235984`*^9, 3.837768744449849*^9}, {3.8387034355553703`*^9, 
   3.8387034676186714`*^9}, 3.838808316925898*^9, {3.840774956041811*^9, 
   3.8407749669750853`*^9}, {3.85755512156579*^9, 3.8575551271887646`*^9}, 
   3.8575553823177547`*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[115]:=",ExpressionUUID->"3a5e2392-d240-4f7a-bc66-9d48bd3501cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"COEFFICIENT", " ", "OF", " ", "VARIATION"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"coeffvar", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"in", ",", "dinl", ",", "regcla", ",", "pts2x", ",", "pts2y"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dltc", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{"regcla", ",", 
          RowBox[{"dinl", "[", 
           RowBox[{"[", "in", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subsd", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dltc", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"dltc", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", "dltc"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "@", "dltc"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distd", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"PEuclideanDistance", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@", "#"}], ",", "pts2x", ",", "pts2y"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"subsd", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "@", "dltc"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distld", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TakeSmallest", "[", 
              RowBox[{"#", ",", 
               RowBox[{"UpTo", "[", "7", "]"}]}], "]"}], "&"}], "/@", 
            "distd"}], "]"}], ",", "0."}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "dltc"}], "<=", "1"}], ",", "Infinity", ",", 
         
         RowBox[{
          RowBox[{"StandardDeviation", "[", "distld", "]"}], "/", 
          RowBox[{"Mean", "[", "distld", "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8434687999014826`*^9, 3.8434688104395385`*^9}, {
   3.850813285669838*^9, 3.850813326783033*^9}, {3.855234280132869*^9, 
   3.855234318381279*^9}, 3.855234698233057*^9, {3.8552357673805714`*^9, 
   3.855235768599783*^9}, 3.8552618762957983`*^9, {3.855262971691016*^9, 
   3.8552629831239367`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[119]:=",ExpressionUUID->"ce0d0684-5028-4de7-a822-3f068ba70ded"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mesh editor", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}, {3.865242989441185*^9, 
   3.865242990379675*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"9dd62609-0be5-441e-a6d4-5a76052af921"],

Cell[BoxData[
 RowBox[{
  RowBox[{"abf", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"l", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"y1", "=", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x2", "=", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"y2", "=", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"as", " ", "x1"}], "+", 
             RowBox[{"bs", " ", "y1"}]}], "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"as", " ", "x2"}], "+", 
             RowBox[{"bs", " ", "y2"}]}], "\[Equal]", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"as", ",", "bs"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8652480850009527`*^9, 3.8652480859186773`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[120]:=",ExpressionUUID->"9938a427-64dc-4ea0-8bb3-89ae1c335bca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeEDGEs", "[", "r_", "]"}], "[", "ptss_", "]"}], ":=", 
   RowBox[{"UndirectedEdge", "@@@", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Nearest", "[", 
         RowBox[{
          RowBox[{"ptss", "\[Rule]", "\"\<Index\>\""}], ",", "ptss", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "r"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"delv", "[", "g_", "]"}], ":=", 
   RowBox[{"VertexDelete", "[", 
    RowBox[{"g", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"VertexDegree", "[", 
          RowBox[{"g", ",", "#"}], "]"}], "<", "2"}], "&"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d1Q", "[", "g_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexDegree", "[", "g", "]"}], ",", "1"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[121]:=",ExpressionUUID->"29fc1449-5689-4063-ad1b-e9c2bf726ad0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"graphToMesh", "[", 
    RowBox[{"graph_", "?", "PlanarGraphQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nextCandidate", ",", "m", ",", "orderings", ",", "pAdj", ",", "rightF",
        ",", "s", ",", "t", ",", "initial", ",", "face", ",", "emb", ",", 
       "faces"}], "}"}], ",", 
     RowBox[{
      RowBox[{"emb", "=", 
       RowBox[{"GraphEmbedding", "[", "graph", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextCandidate", "[", 
        RowBox[{"ss_", ",", "tt_", ",", "adj_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"length", ",", "pos"}], "}"}], ",", 
         RowBox[{
          RowBox[{"length", "=", 
           RowBox[{"Length", "[", "adj", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"pos", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"adj", ",", "ss"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
             "length", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"tt", ",", 
            RowBox[{"adj", "[", 
             RowBox[{"[", "pos", "]"}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"AdjacencyMatrix", "[", "graph", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pAdj", "[", "v", "]"}], "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"VertexList", "[", "graph", "]"}], ",", 
             RowBox[{"m", "[", 
              RowBox[{"[", "v", "]"}], "]"}], ",", "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ArcTan", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"emb", "[", 
                RowBox[{"[", "v", "]"}], "]"}], "-", 
               RowBox[{"emb", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"VertexList", "[", "graph", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rightF", "[", "_", "]"}], ":=", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"faces", "=", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"rightF", "[", "e", "]"}]}], ",", 
             RowBox[{
              RowBox[{"s", "=", 
               RowBox[{"e", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"t", "=", 
               RowBox[{"e", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"initial", "=", "s"}], ";", "\[IndentingNewLine]", 
              RowBox[{"face", "=", 
               RowBox[{"{", "s", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"t", "=!=", "initial"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rightF", "[", 
                   RowBox[{"UndirectedEdge", "[", 
                    RowBox[{"s", ",", "t"}], "]"}], "]"}], "=", "True"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", ",", "t"}], "}"}], "=", 
                  RowBox[{"nextCandidate", "[", 
                   RowBox[{"s", ",", "t", ",", 
                    RowBox[{"pAdj", "[", "t", "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"face", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"face", ",", 
                    RowBox[{"{", "s", "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", "face", "]"}], ";"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"e", ",", 
             RowBox[{"EdgeList", "[", "graph", "]"}]}], "}"}]}], "]"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"faces", "=", 
       RowBox[{"Most", "[", 
        RowBox[{"SortBy", "[", 
         RowBox[{"faces", ",", 
          RowBox[{
           RowBox[{"Area", "[", 
            RowBox[{"Polygon", "[", 
             RowBox[{"emb", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MeshRegion", "[", 
       RowBox[{"emb", ",", 
        RowBox[{"Polygon", "[", "faces", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[124]:=",ExpressionUUID->"fcdf6c78-5ab5-4fc3-9e07-cb742990a284"],

Cell[BoxData[
 RowBox[{
  RowBox[{"editor", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{
     "Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dynamic", "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sav", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"return0", "=", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"StringForm", "[", 
                   RowBox[{"\"\<Error: `1`\>\"", ",", 
                    RowBox[{"ScientificForm", "[", "error", "]"}]}], "]"}], 
                  ",", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Show", "[", 
                   RowBox[{"mesh", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ptt", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"VoronoiMesh", "[", "ptt", "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ptt", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
                  "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"HighlightMesh", "[", 
                    RowBox[{
                    RowBox[{"VoronoiMesh", "[", 
                    RowBox[{"ptt", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cr00", ",", "cr10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"cr01", ",", "cr11"}], "}"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"Style", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Opacity", "[", "0.4", "]"}]}], "]"}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"HighlightMesh", "[", 
                    RowBox[{"mesh", ",", 
                    RowBox[{"{", 
                    RowBox[{"Style", "[", 
                    RowBox[{"2", ",", "Yellow", ",", 
                    RowBox[{"Opacity", "[", "0.4", "]"}]}], "]"}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ptt", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"datae", "=!=", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}], "]"}]}], "}"}], "]"}]}],
                     ",", 
                    RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{"HighlightMesh", "[", 
                    RowBox[{"meshr", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"1", ",", "Thick", ",", "Yellow"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Opacity", "[", "0.4", "]"}]}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"Prolog", "->", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"datae", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"ImageDimensions", "@", "procImg"}]}], "]"}]}]}], 
                    "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}]}], "}"}]}], 
               "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"ItemSize", "\[Rule]", "Large"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"imp", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"DynamicModule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$MaxNodes", "=", "100"}], ",", 
                RowBox[{"r", "=", "ves"}], ",", 
                RowBox[{"range", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
                RowBox[{"snap", "=", "ves"}], ",", 
                RowBox[{"defNodes", "=", "5"}], ",", "nodes", ",", 
                RowBox[{"nodeList", "=", "None"}], ",", "edgeList", ",", 
                "nodeCoord", ",", "labels", ",", "selectedEdge", ",", 
                "selectedNode", ",", "nodePos", ",", "tail", ",", "tailCoord",
                 ",", "headCoord", ",", "arrowUp", ",", "edgeMenuUp", ",", 
                "nodeMenuUp", ",", "nodeMenuPos", ",", "edgeMenuPos", ",", 
                "key", ",", "reset", ",", "update", ",", "closestPoint", ",", 
                "circleLayout", ",", "selectEdge", ",", "deselectEdge", ",", 
                "moveEdge", ",", "snapEdge", ",", "deleteEdge", ",", 
                "reverseEdge", ",", "selectNode", ",", "moveNode", ",", 
                "deselectNode", ",", "addNode", ",", "deleteNode", ",", 
                "firstPosition"}], "}"}], ",", 
              RowBox[{"(*", 
               RowBox[{"Initialization", " ", "code"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"firstPosition", "[", 
                 RowBox[{"list_", ",", "case_"}], "]"}], ":=", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"list", ",", "case", ",", "1", ",", "1"}], "]"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"arrowUp", "=", 
                RowBox[{"edgeMenuUp", "=", 
                 RowBox[{"nodeMenuUp", "=", "False"}]}]}], ";", 
               RowBox[{"(*", 
                RowBox[{
                "switches", " ", "to", " ", "indicate", " ", "if", " ", 
                 "there", " ", "is", " ", "interaction", " ", "with", " ", 
                 RowBox[{"arrow", "/", "edge"}], " ", 
                 RowBox[{"menu", "/", "node"}], " ", "menu"}], "*)"}], 
               RowBox[{"selectedNode", "=", 
                RowBox[{"tail", "=", 
                 RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", "Output", "*)"}], 
               RowBox[{"Deploy", "@", 
                RowBox[{"EventHandler", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"Column", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Add node\>\"", ",", 
                    RowBox[{"addNode", "[", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Reset\>\"", ",", 
                    RowBox[{"reset", "[", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Make mesh\>\"", ",", 
                    RowBox[{
                    RowBox[{"gra", "=", 
                    RowBox[{"UndirectedGraph", "[", 
                    RowBox[{
                    RowBox[{"Graph", "[", 
                    RowBox[{"nodeList", ",", "edgeList"}], "]"}], ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", "nodeCoord"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KVertexConnectedGraphQ", "[", 
                    RowBox[{"gra", ",", "2"}], "]"}], "&&", 
                    RowBox[{"PlanarGraphQ", "[", "gra", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mesh", "=", 
                    RowBox[{"graphToMesh", "[", "gra", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pts", "=", 
                    RowBox[{"PropertyValue", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mesh", ",", "2"}], "}"}], ",", 
                    "MeshCellCentroid"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sa0", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sb", "=", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"sav", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sa0", "=", "2"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Back\>\"", ",", 
                    RowBox[{"sa0", "=", "0"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sa0", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Panel", "[", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"SetAlphaChannel", "[", 
                    RowBox[{"datae", ",", "imo"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AbsoluteThickness", "@", "1"}], ",", 
                    RowBox[{"Arrowheads", "@", ".04"}], ",", 
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"selectedEdge", "===", "#"}], ",", 
                    RowBox[{"Darker", "@", "Red"}], ",", "Black"}], "]"}], 
                    ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"List", "@@", "#"}], ")"}], "/.", "nodeCoord"}], 
                    ",", "r"}], "]"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", "nodeCoord", "}"}]}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"edgeMenuUp", ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"ActionMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"edgeMenuUp", "=", "False"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<reverse\>\"", "\[RuleDelayed]", 
                    RowBox[{"reverseEdge", "@", "selectedEdge"}]}], ",", 
                    RowBox[{"\"\<delete\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"edgeMenuUp", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deleteEdge", "@", "selectedEdge"}]}], ")"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}], ",", 
                    RowBox[{"AutoAction", "\[Rule]", "True"}]}], "]"}], ",", 
                    "edgeMenuPos"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<MouseDown\>\"", ",", "2"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selectedEdge", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"edgeMenuPos", "=", 
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", "Graphics"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeMenuUp", "=", "True"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<MouseUp\>\"", ",", "2"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selectedEdge", "=", 
                    RowBox[{"edgeMenuPos", "=", 
                    RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeMenuUp", "=", "False"}]}], ")"}]}]}], "}"}], 
                    ",", 
                    RowBox[{"PassEventsDown", "\[Rule]", "False"}], ",", 
                    RowBox[{"PassEventsUp", "\[Rule]", "False"}]}], "]"}]}], 
                    "}"}], "&"}], "/@", "edgeList"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{
                    "edgeList", ",", "edgeMenuPos", ",", "edgeMenuUp", ",", 
                    "selectedEdge"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "@", "1"}], ",", 
                    RowBox[{"GrayLevel", "@", ".5"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"arrowUp", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"tailCoord", ",", "headCoord"}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"arrowUp", ",", "headCoord", ",", "tailCoord"}], 
                    "}"}]}]}], "]"}], ",", 
                    RowBox[{"EdgeForm", "@", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Opacity", "@", ".7"}]}], "}"}]}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"selectedNode", "===", "#"}], ",", 
                    RowBox[{"Hue", "[", 
                    RowBox[{"1", ",", "1", ",", ".7"}], "]"}], ",", "Red"}], 
                    RowBox[{"(*", 
                    RowBox[{"Hue", "[", 
                    RowBox[{".6", ",", ".2", ",", ".8"}], "]"}], "*)"}], 
                    "]"}], ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"#", "/.", "nodeCoord"}], ",", "r"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"selectedNode", ",", "nodeCoord"}], "}"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"nodeMenuUp", ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"ActionMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nodeMenuUp", "=", "False"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<delete\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"nodeMenuUp", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"deleteNode", "@", "selectedNode"}]}], ")"}]}], 
                    "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}], ",", 
                    RowBox[{"AutoAction", "\[Rule]", "True"}]}], "]"}], ",", 
                    "nodeMenuPos"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"key", "=", 
                    RowBox[{"CurrentValue", "@", "\"\<ControlKey\>\""}]}], 
                    ")"}], ",", 
                    RowBox[{"selectNode", "@", "#"}], ",", 
                    RowBox[{"selectEdge", "@", "#"}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{"key", ",", 
                    RowBox[{"moveNode", "[", "]"}], ",", 
                    RowBox[{"moveEdge", "[", "]"}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"key", ",", 
                    RowBox[{"deselectNode", "[", "]"}], ",", 
                    RowBox[{"deselectEdge", "[", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"key", "=", "False"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<MouseDown\>\"", ",", "2"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selectedNode", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nodeMenuPos", "=", 
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", "Graphics"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeMenuUp", "=", "True"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<MouseUp\>\"", ",", "2"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selectedNode", "=", 
                    RowBox[{"nodeMenuPos", "=", 
                    RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeMenuUp", "=", "False"}]}], ")"}]}]}], "}"}], 
                    ",", 
                    RowBox[{"PassEventsDown", "\[Rule]", "False"}], ",", 
                    RowBox[{"PassEventsUp", "\[Rule]", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"#", "/.", "labels"}], ",", 
                    RowBox[{"#", "/.", "nodeCoord"}], ",", 
                    RowBox[{"Scaled", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}]}]}], "]"}], ",", "Red", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Ariel\>\""}], ",", 
                    "20"}], "]"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", "nodeCoord", "}"}]}]}], "]"}]}], "}"}], 
                    "&"}], "/@", "nodeList"}], ")"}], ",", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{
                    "nodeList", ",", "nodeMenuUp", ",", "nodeMenuPos"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    "do", " ", "NOT", " ", "put", " ", "selectedNode", " ", 
                    "here", " ", "as", " ", "it", " ", "disables", " ", 
                    "node", " ", 
                    RowBox[{"movement", "!"}]}], "*)"}], "}"}]}]}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"range", ",", "range"}], "}"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
                    RowBox[{"ImagePadding", "\[Rule]", "15"}], ",", 
                    RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
                    RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"400", ",", "Automatic"}], "}"}]}]}], "]"}], 
                    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sa0", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", 
                    RowBox[{"mesh", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"shc", "\[Equal]", "1"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"Point", "[", "pts", "]"}], "]"}], ",", "un"}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sa0", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "Panel", "[", 
                    "\"\<Please be sure the graph is connected and forms a \
lattice.\>\"", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
                     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<MouseDown\>\"", ",", "2"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                  RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "]"}]}]}], 
              ",", 
              RowBox[{"Initialization", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sa", "=", "0"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "accepts", " ", "coordinates", " ", "in", " ", "the", " ", 
                   RowBox[{"form", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"coord", ",", "1"}], "]"}]}], ",", 
                    RowBox[{"3", "\[Rule]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"coord", ",", "3"}], "]"}]}], ",", "..."}], 
                    "}"}]}]}], "*)"}], 
                 RowBox[{
                  RowBox[{"closestPoint", "[", 
                   RowBox[{"pt_List", ",", "all_List", ",", 
                    RowBox[{"d_", ":", " ", "Infinity"}]}], "]"}], ":=", 
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", "dist", "}"}], ",", 
                    RowBox[{
                    RowBox[{"dist", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"pt", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Last", "/@", "all"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Min", "@", "dist"}], ">", "d"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"all", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Ordering", "@", "dist"}]}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"circleLayout", "[", "n_Integer", "]"}], ":=", 
                  RowBox[{"N", "@", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "15"}], ")"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"\[Pi]", "/", "n"}], " ", "i"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"\[Pi]", "/", "n"}], " ", "i"}], "]"}]}], "}"}]}],
                     "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}]}], "}"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"selectEdge", "[", "node_", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"tail", "=", "node"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"tailCoord", "=", 
                    RowBox[{"headCoord", "=", 
                    RowBox[{"node", "/.", "nodeCoord"}]}]}], ";", 
                    RowBox[{"arrowUp", "=", "True"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"moveEdge", "[", "]"}], ":=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"tail", "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"headCoord", "=", 
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", "Graphics"}], "]"}]}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"snapEdge", "[", "]"}], ":=", 
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"head", ",", "new"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"head", "=", 
                    RowBox[{"closestPoint", "[", 
                    RowBox[{
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", "Graphics"}], "]"}], ",",
                     "nodeCoord", ",", "snap"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"new", "=", 
                    RowBox[{"tail", "\[DirectedEdge]", "head"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"head", "=!=", 
                    RowBox[{"{", "}"}]}], "\[And]", 
                    RowBox[{"UnsameQ", "@@", "new"}], "\[And]", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"edgeList", ",", "new"}], "]"}], "\[And]", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"edgeList", ",", 
                    RowBox[{"Reverse", "@", "new"}]}], "]"}]}], ",", 
                    RowBox[{"edgeList", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"edgeList", ",", "new"}], "]"}]}]}], "]"}]}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"deselectEdge", "[", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"snapEdge", "[", "]"}], ";", 
                    RowBox[{"arrowUp", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tail", "=", 
                    RowBox[{"tailCoord", "=", 
                    RowBox[{"headCoord", "=", 
                    RowBox[{"{", "}"}]}]}]}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"deleteEdge", "[", "edge_", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{"edgeList", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"edgeList", ",", 
                    RowBox[{"firstPosition", "[", 
                    RowBox[{"edgeList", ",", "edge"}], "]"}]}], "]"}]}], 
                   ")"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"reverseEdge", "[", "edge_", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{"edgeList", "=", 
                    RowBox[{"edgeList", "/.", 
                    RowBox[{"edge", "\[Rule]", 
                    RowBox[{"Reverse", "@", "edge"}]}]}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"selectNode", "[", "node_", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"selectedNode", "=", "node"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nodePos", "=", 
                    RowBox[{"firstPosition", "[", 
                    RowBox[{
                    RowBox[{"First", "/@", "nodeCoord"}], ",", "node"}], 
                    "]"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"moveNode", "[", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"selectedNode", "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"nodeCoord", "[", 
                    RowBox[{"[", 
                    RowBox[{"nodePos", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", "Graphics"}], "]"}]}]}], 
                    "]"}], ")"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"deselectNode", "[", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{"selectedNode", "=", 
                    RowBox[{"nodePos", "=", 
                    RowBox[{"{", "}"}]}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"deleteNode", "[", "n_", "]"}], ":=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nodes", ">", "0"}], ",", 
                    RowBox[{
                    RowBox[{"nodes", "=", 
                    RowBox[{"nodes", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeList", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"nodeList", ",", "n"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"edgeList", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"edgeList", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#", ",", "n"}], "]"}], "&"}], ")"}]}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeCoord", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"nodeCoord", ",", 
                    RowBox[{"_", "[", 
                    RowBox[{"n", ",", "_"}], "]"}]}], "]"}]}], ";"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"addNode", "[", "]"}], ":=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nodes", "<", "$MaxNodes"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "new", "}"}], ",", 
                    RowBox[{
                    RowBox[{"nodes", "=", 
                    RowBox[{"nodes", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"new", "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", "$MaxNodes"}], ",", "nodeList"}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"nodeList", ",", "new"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nodeCoord", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"nodeCoord", ",", 
                    RowBox[{"new", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "15"}], ")"}], 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"range", ",", "2"}], "]"}]}], "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}]}], "}"}]}]}]}],
                     "]"}]}], ";"}]}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"reset", "[", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"selectedEdge", "=", 
                    RowBox[{"selectedNode", "=", 
                    RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"labels", "=", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", "$MaxNodes"}], "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<\>\"", ",", "$MaxNodes"}], "]"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"Range", "[", "$MaxNodes", "]"}], "*)"}], 
                    RowBox[{"(*", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"CharacterRange", "[", 
                    RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], ",", 
                    "$MaxNodes"}], "]"}], "*)"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"update", "@", "defNodes"}], ";"}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"update", "[", "n_", "]"}], ":=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"nodes", "=", "n"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nodeList", "=", 
                    RowBox[{"Range", "@", "nodes"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nodeCoord", "=", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"nodeList", "\[Rule]", 
                    RowBox[{"circleLayout", "@", "nodes"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"edgeList", "=", 
                    RowBox[{"{", "}"}]}], ";"}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"reset", "[", "]"}], ";"}], ")"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sa", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"eshb", "\[Equal]", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}], "&"}], "@", 
                  RowBox[{"Blur", "[", 
                   RowBox[{"datae", ",", "eblur"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"eshb", "\[Equal]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ColorNegate", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}]}], "&"}], "@", 
                    RowBox[{"Blur", "[", 
                    RowBox[{"datae", ",", "eblur"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorNegate", "[", 
                    RowBox[{"eshd", " ", 
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "#"}], ")"}], "*", "#3"}], "]"}], 
                    "&"}], "@@", 
                    RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}]}], "&"}], "@", 
                    RowBox[{"Blur", "[", 
                    RowBox[{"datae", ",", "eblur"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sa", "\[Equal]", "0.5"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Show", "[", "gra", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"sa", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", 
                   RowBox[{"mesh", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"shc", "\[Equal]", "1"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"Point", "[", "pts", "]"}], "]"}], ",", "un"}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"sa", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Text", "[", 
                    "\"\<Please be sure the graph is connected and forms a \
lattice.\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Import image\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"SetDirectory", "[", 
              RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"file", "=", 
              RowBox[{"SystemDialogInput", "[", "\"\<FileOpen\>\"", "]"}]}], 
             ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"TrueQ", "[", 
                 RowBox[{"file", "\[Equal]", "$Canceled"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"reset", "[", "]"}], ";", 
                RowBox[{"datae", "=", 
                 RowBox[{"Import", "[", "file", "]"}]}]}]}], "]"}]}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Style", "[", "\"\<Clear\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{"sav", "=", "0"}], ";", 
             RowBox[{"datae", "=", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"White", ",", 
                 RowBox[{"Rectangle", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "100"}], "}"}], "]"}]}], "}"}], 
               "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"sb", "\[Equal]", "1"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"MeshPrimitives", "[", 
                  RowBox[{"mesh", ",", "2"}], "]"}], "]"}], ">", "1"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"Button", "[", 
                RowBox[{
                "\"\<Voronoi test\>\"", ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"n", "=", 
                   RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "//", "Length"}]}], 
                  ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"meshr", "=", "mesh"}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"imd1", "=", 
                   RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"imd2", "=", 
                   RowBox[{
                    RowBox[{"ImageDimensions", "[", "datae", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"mnar", "=", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Area", "[", 
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"mesh", "=", 
                   RowBox[{"RegionResize", "[", 
                    RowBox[{"mesh", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"imd1", "/", 
                    RowBox[{"Sqrt", "[", "mnar", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"imd2", "/", 
                    RowBox[{"Sqrt", "[", "mnar", "]"}]}]}], "}"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"shre0", "=", 
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "1"}], "]"}], ",", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{
                    RowBox[{"BoundaryMesh", "[", "mesh", "]"}], ",", "1"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"edgn", "=", 
                   RowBox[{"Length", "[", "shre0", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"cents1", "=", 
                   RowBox[{"Map", "[", 
                    RowBox[{"RegionCentroid", ",", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"shre", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"shre0", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "Norm"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "edgn"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"pol", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"polin0", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pol", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"pol", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"pol", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"polin", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"polin0", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                    "Norm"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"polin0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"lsp", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"shre", ",", 
                    RowBox[{"polin", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "polin", "]"}]}], "}"}]}], "]"}]}],
                   ";", "\[IndentingNewLine]", 
                  RowBox[{"lor", "=", 
                   RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "n"}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", 
                    RowBox[{"i", "+", "1"}]}], ",", 
                    RowBox[{"j", "\[LessEqual]", "n"}], ",", 
                    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"regg", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"lsp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"lsp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"regg", "=!=", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"lor", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"lor", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"abf", "[", 
                    RowBox[{"regg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"abf", "[", 
                    RowBox[{"regg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"regg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"abi", "=", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "lor", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ab", "=", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "lor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"matB", "=", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "-", "1"}], 
                    "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "-", "1"}], 
                    "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "n"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "-", "1"}], 
                    "\[Rule]", 
                    RowBox[{"-", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "-", "1"}], 
                    "\[Rule]", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"abi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "\[Rule]", 
                    RowBox[{"-", 
                    RowBox[{"ab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "edgn"}], "}"}]}], "]"}], ",",
                     "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cB", "=", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}], ",", "edgn"}], "]"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"crns", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "0"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "0"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cr00", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"crns", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"cr10", "=", 
                   RowBox[{"Max", "[", 
                    RowBox[{"crns", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"cr01", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"crns", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"cr11", "=", 
                   RowBox[{"Max", "[", 
                    RowBox[{"crns", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"minV", "=", 
                   RowBox[{"FindMinimum", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{"matB", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xs", "[", "i", "]"}], ",", 
                    RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}], 
                    "-", "cB"}], "]"}], "^", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cr00", "\[LessEqual]", 
                    RowBox[{"xs", "[", "i", "]"}], "\[LessEqual]", "cr10"}], "&&", 
                    RowBox[{"cr01", "\[LessEqual]", 
                    RowBox[{"ys", "[", "i", "]"}], "\[LessEqual]", "cr11"}], "&&",
                     "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"RegionMember", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xs", "[", "i", "]"}], ",", 
                    RowBox[{"ys", "[", "i", "]"}]}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xs", "[", "i", "]"}], ",", 
                    RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
                   ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"mnar", "=", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Area", "[", 
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"error", "=", 
                   RowBox[{"minV", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptt", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minV", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{
                    RowBox[{"2", "i"}], "-", "1"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"minV", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "i"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"sav", "=", "1"}]}]}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"Button", "[", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Voronoi test\>\"", ",", "Gray"}], "]"}], 
                "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Voronoi test\>\"", ",", "Gray"}], "]"}], "]"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"datae", "=!=", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "100"}], "}"}], "]"}]}], "}"}], "]"}]}], 
          ",", 
          RowBox[{"Column", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"imp", ",", "0", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<Image processing\>\"", ",", "st1"}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0", "\[Rule]", "\"\<Manual\>\""}], ",", 
                  RowBox[{"1", "\[Rule]", "\"\<Auto\>\""}]}], "}"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"imo", ",", "1", ",", "\"\<Image opacity\>\""}], 
                 "}"}], ",", "0", ",", "1", ",", "0.1", ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ves", ",", "5", ",", "\"\<Vertex size\>\""}], "}"}],
                 ",", "1", ",", "10", ",", "1", ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}],
               "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", "\"\<\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"imp", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sa0", "\[Equal]", "1"}], "&&", 
             RowBox[{"sav", "\[Equal]", "0"}]}], ",", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"shc", ",", "0", ",", "\"\<Show centroids\>\""}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
            RowBox[{"Invisible", "[", 
             RowBox[{"#", "&"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sa", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eblur", ",", "3", ",", "\"\<Blur\>\""}], "}"}], 
                  ",", "0", ",", "10", ",", ".5", ",", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eshrp", ",", "5", ",", "\"\<Sharpness\>\""}], 
                   "}"}], ",", "0", ",", "10", ",", ".5", ",", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "ewsh", ",", ".65", ",", "\"\<Watershed saliency\>\""}], 
                   "}"}], ",", "0.", ",", "1.", ",", ".01", ",", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eshb", ",", "0", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Negate colours\>\"", ",", "st1"}], "]"}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0", "\[Rule]", "\"\<No\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<Yes\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Custom\>\""}]}], "}"}]}], 
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"eshb", "\[Equal]", "2"}], ",", 
                  RowBox[{"Control", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"eshl", ",", "20", ",", "\"\<Shade level\>\""}], 
                    "}"}], ",", "0", ",", "50", ",", "1", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
                    "}"}], "]"}], ",", "\"\<\>\""}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Create graph\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"eshb", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"preprocImg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}], "&"}], "@", 
                    RowBox[{"Blur", "[", 
                    RowBox[{"datae", ",", "eblur"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"eshb", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"preprocImg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorNegate", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}]}], "&"}], "@", 
                    RowBox[{"Blur", "[", 
                    RowBox[{"datae", ",", "eblur"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"preprocImg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorNegate", "[", 
                    RowBox[{"eshd", " ", 
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "#"}], ")"}], "*", "#3"}], "]"}], 
                    "&"}], "@@", 
                    RowBox[{"First", "@", 
                    RowBox[{"ColorSeparate", "@", 
                    RowBox[{"Sharpen", "[", 
                    RowBox[{"#", ",", "eshrp"}], "]"}]}]}]}], "&"}], "@", 
                    RowBox[{"Blur", "[", 
                    RowBox[{"datae", ",", "eblur"}], "]"}]}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"wsComponents", "=", 
                   RowBox[{"WatershedComponents", "[", 
                    RowBox[{"preprocImg", ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MinimumSaliency\>\"", ",", "ewsh"}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cellMeshes", "=", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"ConvexHullMesh", "@*", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#2", ",", 
                    RowBox[{"-", "#"}]}], "}"}], "&"}], "//", "Apply"}], 
                    "]"}]}], "]"}], "@", 
                    RowBox[{"Values", "@", 
                    RowBox[{
                    RowBox[{"GroupBy", "[", 
                    RowBox[{"First", "\[Rule]", "Last"}], "]"}], "@", 
                    RowBox[{"Catenate", "@", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{"List", ",", "wsComponents", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}]}]}]}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"skipmergeQ", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"skipmergeQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"mergedCells", "=", "cellMeshes"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"mergedCells", "=", 
                    RowBox[{
                    RowBox[{"Graph", "[", 
                    RowBox[{"cellMeshes", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Area", "@", 
                    RowBox[{"RegionIntersection", "@", "##"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"Area", "@", "#"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"Area", "@", "#2"}]}]}], ")"}]}], ">", "0.35"}], 
                    ",", 
                    RowBox[{"UndirectedEdge", "@", "##"}], ",", "Nothing"}], 
                    "]"}], "&"}], "@@@", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{"cellMeshes", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Map", "[", "RegionUnion", "]"}], "@*", 
                    "ConnectedComponents"}]}]}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"procImg", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Region", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "@", 
                    RowBox[{"{", 
                    RowBox[{"White", ",", "Thick"}], "}"}]}], ",", 
                    RowBox[{"FaceForm", "@", "Black"}]}], "}"}]}]}], "]"}], 
                    "&"}], "/@", "mergedCells"}], "//", 
                    RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
                    RowBox[{"ImageMargins", "\[Rule]", "0"}]}], "]"}], 
                    "&"}]}], "//", 
                    RowBox[{
                    RowBox[{"Rasterize", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"ImageDimensions", "@", "datae"}]}]}], "]"}], 
                    "&"}]}], "//", "Binarize"}], "//", 
                    RowBox[{
                    RowBox[{"ImagePad", "[", 
                    RowBox[{
                    RowBox[{"ImageCrop", "@", "#"}], ",", 
                    RowBox[{"BorderDimensions", "@", "#"}]}], "]"}], 
                    "&"}]}]}], ";", 
                  RowBox[{"gra0", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MorphologicalGraph", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"EdgeStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thick", ",", "Yellow"}], "]"}]}], ",", 
                    RowBox[{"VertexStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"VertexSize", "\[Rule]", "2"}], ",", 
                    RowBox[{"Prolog", "->", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"datae", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"ImageDimensions", "@", "procImg"}]}], "]"}]}]}], 
                    "]"}], "&"}], "@", "procImg"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"posToVertex", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"GraphEmbedding", "[", "gra0", "]"}], ",", 
                    RowBox[{"VertexList", "[", "gra0", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"newEdges", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{"posToVertex", ",", 
                    RowBox[{
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{
                    RowBox[{"ConvexHullMesh", "[", 
                    RowBox[{"GraphEmbedding", "[", "gra0", "]"}], "]"}], ",", 
                    "1"}], "]"}], "/.", 
                    RowBox[{"Line", "\[Rule]", 
                    RowBox[{"Apply", "[", "UndirectedEdge", "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"gra", "=", 
                    RowBox[{"EdgeAdd", "[", 
                    RowBox[{"gra0", ",", "newEdges"}], "]"}]}], ";"}], "*)"}],
                   "\[IndentingNewLine]", 
                  RowBox[{"gra", "=", 
                   RowBox[{"NestWhile", "[", 
                    RowBox[{"delv", ",", "gra0", ",", "d1Q"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"sa", "=", "0.5"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Column", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<Back\>\"", ",", 
                    RowBox[{"sa", "=", "0"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"sa", "\[Equal]", "0.5"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Create mesh\>\"", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"vli", "=", 
                    RowBox[{"VertexList", "[", "gra", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eli", "=", 
                    RowBox[{"EdgeList", "[", "gra", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eli1", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"eli", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "eli", "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"eli2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"eli", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "eli", "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nvli0", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"DeleteDuplicates", "@", "#"}]}]}], "}"}], ",", 
                    RowBox[{"us", "\[Rule]", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "us"}]}]}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                    "vli"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"neli1", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"DeleteDuplicates", "@", "#"}]}]}], "}"}], ",", 
                    RowBox[{"us", "\[Rule]", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "us"}]}]}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"eli1", ",", "vli"}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Length", "[", "vli", "]"}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"neli2", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"DeleteDuplicates", "@", "#"}]}]}], "}"}], ",", 
                    RowBox[{"us", "\[Rule]", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "us"}]}]}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"eli2", ",", "vli"}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Length", "[", "vli", "]"}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"neli", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"neli1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "\[UndirectedEdge]", 
                    RowBox[{"neli2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "eli", "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nvli", "=", 
                    RowBox[{"Sort", "[", "nvli0", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"npli", "=", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"nvli0", ",", 
                    RowBox[{"GraphEmbedding", "[", "gra", "]"}]}], "}"}], 
                    "]"}], ",", "First"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"gra", "=", 
                    RowBox[{"Graph", "[", 
                    RowBox[{"nvli", ",", "neli", ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", "npli"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"mesh", "=", 
                    RowBox[{"graphToMesh", "[", "gra", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pts", "=", 
                    RowBox[{"PropertyValue", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mesh", ",", "2"}], "}"}], ",", 
                    "MeshCellCentroid"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sb", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sa", "=", "1"}]}]}], "]"}], ",", "un"}], "]"}]}],
                  "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sa", "\[Equal]", "1"}], "&&", 
                  RowBox[{"sav", "\[Equal]", "0"}]}], ",", 
                 RowBox[{"Control", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"shc", ",", "0", ",", "\"\<Show centroids\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Invisible", "[", 
                  RowBox[{"#", "&"}], "]"}]}], "]"}]}], "}"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Initialization", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sav", "=", "0"}], ";", 
          RowBox[{"sa", "=", "0"}], ";", 
          RowBox[{"sa0", "=", "0"}], ";", 
          RowBox[{"datae", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "100"}], "}"}], "]"}]}], "}"}], "]"}]}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"DynamicEvaluationTimeout", "\[Rule]", "500"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8652433165897903`*^9, 3.865243323742259*^9}, 
   3.8652434725556717`*^9, {3.865245132637907*^9, 3.865245179472371*^9}, 
   3.865246465585308*^9, {3.8652469363636827`*^9, 3.8652469365334044`*^9}, 
   3.865246978966157*^9, {3.865247605484968*^9, 3.8652476199340773`*^9}, {
   3.865247707263608*^9, 3.8652477077273693`*^9}, {3.8652482243550587`*^9, 
   3.86524823066491*^9}, {3.865248287571168*^9, 3.865248290529458*^9}, 
   3.865249470725608*^9, {3.8654145314704266`*^9, 3.8654145323001766`*^9}, {
   3.865416129550831*^9, 3.8654161621800222`*^9}, {3.8654290282487097`*^9, 
   3.8654290287095413`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[125]:=",ExpressionUUID->"34c6c809-d92d-49f5-91d5-21c238677cb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}, {3.840712174598595*^9, 
   3.8407121755803547`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"e7ff0c19-31d7-4e81-9c80-8dc41f7a2c19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToPack", " ", "=", " ", "Developer`ToPackedArray"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "getCellCellAdjacencyList", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getCellCellAdjacencyList", "[", 
    RowBox[{"R_MeshRegion", ",", " ", "d_"}], "]"}], " ", ":=", " ", "\n", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pts", ",", " ", "cells", ",", " ", "A", ",", " ", "lens", ",", " ", 
       "n", ",", " ", "m", ",", " ", "nn"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pts", " ", "=", " ", 
       RowBox[{"MeshCoordinates", "[", "R", "]"}]}], ";", "\n", "  ", 
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"ToPack", "[", 
        RowBox[{
         RowBox[{"MeshCells", "[", 
          RowBox[{"R", ",", " ", "d"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"lens", " ", "=", " ", 
       RowBox[{"Length", " ", "/@", " ", "cells"}]}], ";", "\n", "  ", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "pts", "]"}]}], ";", "\n", "  ", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"Length", "[", "cells", "]"}]}], ";", "\n", "  ", 
      RowBox[{"nn", " ", "=", " ", 
       RowBox[{"Total", "[", "lens", "]"}]}], ";", "\n", "  ", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"SparseArray", " ", "@@", " ", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", " ", "n"}], "}"}], ",", " ", "0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", 
            RowBox[{"{", "\n", "       ", 
             RowBox[{
              RowBox[{"ToPack", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "0", "}"}], ",", " ", 
                 RowBox[{"Accumulate", "[", "lens", "]"}]}], "]"}], "]"}], 
              ",", "\n", "       ", 
              RowBox[{"ArrayReshape", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Sort", " ", "/@", " ", "cells"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"nn", ",", " ", "1"}], "}"}]}], "]"}]}], "\n", 
             "       ", "}"}], ",", "\n", "      ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", " ", "nn"}], "]"}]}], "}"}]}], "}"}]}]}], ";", 
      "\n", "  ", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\n", "    ", 
        RowBox[{"UnitStep", "[", 
         RowBox[{
          RowBox[{"UpperTriangularize", "[", 
           RowBox[{
            RowBox[{"A", ".", 
             RowBox[{"Transpose", "[", "A", "]"}]}], ",", " ", "1"}], "]"}], 
          " ", "-", "  ", "d"}], "]"}], "\n", "  ", "]"}], "[", 
       "\"\<NonzeroPositions\>\"", "]"}]}]}], "\n", "  ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getCellCellAdjacencyList", "[", 
   RowBox[{"R_MeshRegion", ",", "0"}], "]"}], ":=", 
  RowBox[{"ToPack", "[", 
   RowBox[{
    RowBox[{"MeshCells", "[", 
     RowBox[{"R", ",", "1"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.84098832447867*^9, 3.840988332920494*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[126]:=",ExpressionUUID->"4d5c86ee-641d-4bd3-9332-7dd45c9b9c2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PEuclideanDistance", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "xp", ",", "yp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"p1", "==", "p2"}], ",", "0.", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"persQ", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"p2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"p1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"xp", "-", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"p2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "^", 
              "2"}], "+", 
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"p2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"p1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"yp", "-", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"p2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "^", 
              "2"}]}], "]"}]}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigr", "=!=", "1"}], ",", "1", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigr", "==", "1"}], "&&", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"p1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "==", 
                RowBox[{"Sign", "[", 
                 RowBox[{"p2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", "1", ",", 
              "Infinity"}], "]"}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"VectorAngle", "[", 
                  RowBox[{
                   RowBox[{"p2", "-", "p1"}], ",", "#"}], "]"}], "&"}], "/@", 
                
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ")"}]}],
              ">=", "pla"}], ",", "1", ",", "Infinity"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"p1", ",", "p2"}], "]"}]}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigr", "=!=", "1"}], ",", "1", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigr", "==", "1"}], "&&", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"p1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "==", 
                RowBox[{"Sign", "[", 
                 RowBox[{"p2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", "1", ",", 
              "Infinity"}], "]"}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"VectorAngle", "[", 
                  RowBox[{
                   RowBox[{"p2", "-", "p1"}], ",", "#"}], "]"}], "&"}], "/@", 
                
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ")"}]}],
              ">=", "pla"}], ",", "1", ",", "Infinity"}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.840888247865177*^9, 3.840888287036709*^9}, {
   3.840888405273363*^9, 3.840888458652655*^9}, 3.8408884913582916`*^9, {
   3.840891961349903*^9, 3.8408919766340475`*^9}, {3.840892006930381*^9, 
   3.8408920345086393`*^9}, {3.8408921387817307`*^9, 3.840892160431467*^9}, {
   3.8408921911542034`*^9, 3.8408921970911627`*^9}, {3.840892236596918*^9, 
   3.8408922560250797`*^9}, {3.84089295302046*^9, 3.8408929584021463`*^9}, {
   3.8408930367239804`*^9, 3.8408930579503736`*^9}, {3.840978265562331*^9, 
   3.8409783078357496`*^9}, {3.8409783482768316`*^9, 
   3.8409783543503203`*^9}, {3.840978391071743*^9, 3.840978397926816*^9}, {
   3.8410615106365476`*^9, 3.8410615128477907`*^9}, {3.841061720223774*^9, 
   3.841061731092613*^9}, {3.8410634059621058`*^9, 3.841063422914739*^9}, 
   3.841573057286547*^9, 3.8415731280807486`*^9, {3.84166163779692*^9, 
   3.84166167130301*^9}, {3.8416629003617744`*^9, 3.8416629031366096`*^9}, {
   3.841663166617612*^9, 3.841663170568471*^9}, {3.8416632196066685`*^9, 
   3.841663232368072*^9}, {3.841663355603183*^9, 3.8416633588008337`*^9}, {
   3.841663714206871*^9, 3.841663733950798*^9}, {3.8416638026304293`*^9, 
   3.84166380706946*^9}, {3.841664016047044*^9, 3.841664107344246*^9}, {
   3.8416649986228623`*^9, 3.8416649994516788`*^9}, {3.841665816540847*^9, 
   3.8416658175682545`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[130]:=",ExpressionUUID->"b0f5f187-0c18-4cde-85ec-d2a1ecf0d2e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matFn", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lv", ",", "lvs", ",", "lp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gl", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "lvs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gla", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvs", ",", 
         RowBox[{"Partition", "[", 
          RowBox[{"gl", ",", 
           RowBox[{"Length", "@", "lvs"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"regcla", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvs", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"RegionCentroid", "[", 
            RowBox[{"lp", "[", "#", "]"}], "]"}], "&"}], "/@", "lvs"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"regclagl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"aiii", "++"}], ";", 
            RowBox[{"regcla", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"regcla", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "gl"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distas", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"gl", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"PEuclideanDistance", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "pts2x", ",", "pts2y"}], 
             "]"}], "&"}], "/@", "regclagl"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vertsa", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvs", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Lookup", "[", 
             RowBox[{"lp", ",", "lvs"}], "]"}], ")"}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"polna0", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvs", ",", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pollen", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Values", "@", "vertsa"}], ",", "1"}], "]"}], ",", 
                 
                 RowBox[{
                  RowBox[{"vertsa", "[", "i", "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"vertsa", "[", "i", "]"}], "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"pollen", ",", "3"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"pollen", ",", "2"}], "]"}], "/", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"polnap", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvs", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Lookup", "[", 
             RowBox[{"lp", ",", "lvs"}], "]"}], ")"}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"persQ", ",", "\[IndentingNewLine]", 
        RowBox[{"polna", "=", "polnap"}], ",", "\[IndentingNewLine]", 
        RowBox[{"polna", "=", "polna0"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"lmesh", "=", 
       RowBox[{"DiscretizeGraphics", "@", 
        RowBox[{"Graphics", "@", 
         RowBox[{"Values", "@", 
          RowBox[{"(", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Last", "[", "plistn", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"msht", "==", "0"}], "||", 
                  RowBox[{"msht", "==", "4"}]}], ",", "0", ",", "3"}], 
                "]"}]}], "&"}]}], "]"}], ")"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"glt00", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"getCellCellAdjacencyList", "[", 
              RowBox[{"lmesh", ",", " ", "2"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"lvs", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"lvs", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}], 
           ",", 
           RowBox[{"Reverse", "/@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"getCellCellAdjacencyList", "[", 
               RowBox[{"lmesh", ",", " ", "2"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"lvs", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"lvs", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], 
             "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"regC", "=", 
         RowBox[{"RegionCentroid", "/@", 
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"lmesh", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"regM", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"RegionCentroid", "[", 
            RowBox[{
             RowBox[{"Last", "[", "plist", "]"}], "[", "#", "]"}], "]"}], 
           "&"}], "/@", "lvs"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"lva", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"lvs", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"regM", ",", "#"}], "]"}], "&"}], "/@", "regC"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"glt0", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lva", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"lva", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          "glt00"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"glt00", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"getCellCellAdjacencyList", "[", 
          RowBox[{"lmesh", ",", " ", "2"}], "]"}], ",", 
         RowBox[{"Reverse", "/@", 
          RowBox[{"getCellCellAdjacencyList", "[", 
           RowBox[{"lmesh", ",", " ", "2"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"regC", "=", 
       RowBox[{"RegionCentroid", "/@", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"lmesh", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"regM", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RegionCentroid", "[", 
          RowBox[{
           RowBox[{"Last", "[", "plist", "]"}], "[", "#", "]"}], "]"}], "&"}],
         "/@", "lvs"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lva", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Nearest", "[", 
                   RowBox[{"regM", ",", "#"}], "]"}], "&"}], "/@", "regC"}], 
                ",", "1"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", "regM"}], 
          "]"}], ",", "lvs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"glt0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lva", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"lva", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "glt00"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lvsf", "=", 
       RowBox[{"Keys", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"AssociationThread", "[", 
           RowBox[{"lvs", ",", 
            RowBox[{
             RowBox[{"Values", "@", "polnap"}], "-", 
             RowBox[{"Values", "@", "polna0"}]}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"shpQ", ",", 
        RowBox[{"shpa0", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"glt0", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ArcLength", "[", 
               RowBox[{"Line", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"lp", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"lp", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], "/", 
              RowBox[{"Perimeter", "[", 
               RowBox[{"lp", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
            "glt0"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cellsfa", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"lvsf", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TranslationTransform", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i", " ", "pts2x"}], ",", " ", 
                   RowBox[{"j", " ", "pts2y"}]}], "}"}], "]"}], "[", 
                RowBox[{"lp", "[", "#", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "2"}], 
            "]"}], "&"}], "/@", "lvsf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"glt1", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"perg1", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"persQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"edgesp", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", ".0001"}], "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{"lp", "[", "j", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", ".0001"}], "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cellsfa", "[", "i", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "edgesp"}], "==", "2"}], ",", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"glt1", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{"shpQ", ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"perg1", ",", 
                    RowBox[{
                    RowBox[{"ArcLength", "@", 
                    RowBox[{"Line", "@", "edgesp"}]}], "/", 
                    RowBox[{"Perimeter", "[", 
                    RowBox[{"lp", "[", "j", "]"}], "]"}]}]}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "8"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "lvsf"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "lvsf"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"shpQ", "&&", "persQ"}], ",", 
        RowBox[{"shpa1", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"glt1", ",", "perg1"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"glt", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"glt0", ",", "glt1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"shpQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"shpa", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"shpa0", ",", 
            RowBox[{"If", "[", 
             RowBox[{"persQ", ",", "shpa1", ",", "un"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"msht", "==", "1"}], "&&", 
            RowBox[{"mshn", "==", "0"}]}], ",", 
           RowBox[{"shpan", "=", 
            RowBox[{"shpa", "=", 
             RowBox[{"AssociationThread", "[", 
              RowBox[{
               RowBox[{"Keys", "@", "shpa"}], ",", 
               RowBox[{
                RowBox[{"N", "@", "1"}], "/", "6"}]}], "]"}]}]}]}], "]"}]}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gltp", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Keys", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"KeyTake", "[", 
               RowBox[{
                RowBox[{"KeyDrop", "[", 
                 RowBox[{"distas", ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "j"}], "}"}], "}"}], ",", "glt"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"gla", "[", "j", "]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"#", "<", 
                RowBox[{"protll", "[", "j", "]"}]}], "&"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ef", "[", "i_", "]"}], ":=", 
       RowBox[{"Length", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"gltp", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "i"}], "&"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"glv", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aiii", "++"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"glt", ",", "j"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"shpQ", ",", 
              RowBox[{"shpa", "[", "j", "]"}], ",", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "gl"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"glvL", "=", 
       RowBox[{"If", "[", 
        RowBox[{"protQ", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"aiii", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"gltp", ",", "j"}], "]"}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"If", "[", 
               RowBox[{"shpQ", ",", 
                RowBox[{
                 RowBox[{"N", "@", "1"}], "/", 
                 RowBox[{"ef", "[", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "1"}], "]"}],
               ",", "\[IndentingNewLine]", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "gl"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "@", "gl"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"asslJp", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"gl", "->", "glv"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"asslJp", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "asslJp", "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ContainsAny", "[", 
                RowBox[{"lvs2", ",", 
                 RowBox[{
                  RowBox[{"Keys", "[", "asslJp", "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "0", ",", 
               RowBox[{
                RowBox[{"Values", "[", "asslJp", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "@", "asslJp"}]}], "}"}]}], "]"}]}], "]"}]}],
         ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sigass", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"lvs2", ",", "#"}], "]"}], ",", "0", ",", "1"}], "]"}], 
         "&"}], "/@", "lvs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pfixQ", "&&", 
         RowBox[{"iii", ">=", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"asslLp", "=", "asslLp"}], ",", "\[IndentingNewLine]", 
        RowBox[{"asslLp", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"gl", "->", "glvL"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8408833041813507`*^9, 3.8408833343710213`*^9}, 
   3.8408860167338343`*^9, 3.840888834627617*^9, {3.840888903099468*^9, 
   3.840888904534847*^9}, {3.840888980229459*^9, 3.8408890383008366`*^9}, 
   3.8408891145515003`*^9, {3.8408927659341707`*^9, 3.8408928145690503`*^9}, {
   3.840892888749316*^9, 3.8408928891538277`*^9}, {3.840893073581055*^9, 
   3.8408930741262636`*^9}, {3.8408932241905694`*^9, 3.840893232235791*^9}, {
   3.840893427143524*^9, 3.84089345541059*^9}, {3.840893589693147*^9, 
   3.8408936107348223`*^9}, {3.840893730363964*^9, 3.8408937675489683`*^9}, {
   3.840893838743009*^9, 3.8408938695799327`*^9}, {3.8408943131145897`*^9, 
   3.840894338182314*^9}, {3.8408950793694906`*^9, 3.8408950876856847`*^9}, {
   3.840895833083169*^9, 3.8408958530501385`*^9}, 3.840895905620261*^9, {
   3.8408973027185726`*^9, 3.8408973030928097`*^9}, {3.840897660934024*^9, 
   3.8408976631782885`*^9}, 3.8408977749660053`*^9, {3.840898238278963*^9, 
   3.8408983154028077`*^9}, {3.840977580210302*^9, 3.8409775881285686`*^9}, {
   3.840981582093154*^9, 3.840981583871911*^9}, {3.840982107471372*^9, 
   3.84098212055188*^9}, {3.8409825079201574`*^9, 3.840982509299103*^9}, {
   3.840986252689536*^9, 3.840986300266669*^9}, {3.841004365442704*^9, 
   3.841004371644108*^9}, {3.8410062056567802`*^9, 3.841006257530199*^9}, {
   3.841008778063326*^9, 3.841008811737574*^9}, {3.841010072717101*^9, 
   3.841010092581786*^9}, {3.8410496516133947`*^9, 3.8410496772801714`*^9}, {
   3.8410574700724564`*^9, 3.8410574764889317`*^9}, {3.8410575384313765`*^9, 
   3.8410575412564373`*^9}, 3.8410612366286163`*^9, {3.841063199833622*^9, 
   3.841063200012173*^9}, 3.8415730581342816`*^9, {3.8426737789406295`*^9, 
   3.842673788231883*^9}, {3.842673851214275*^9, 3.8426738629705954`*^9}, {
   3.8426739226708546`*^9, 3.8426739276389213`*^9}, {3.843907443041111*^9, 
   3.8439074794037347`*^9}, {3.843908067878296*^9, 3.8439080713142653`*^9}, 
   3.8439081245561066`*^9, {3.843910020605323*^9, 3.8439100224166846`*^9}, 
   3.8439102015305176`*^9, {3.8439104985227594`*^9, 3.84391051803996*^9}, {
   3.8439108129940877`*^9, 3.8439108701108775`*^9}, 3.8439109329569893`*^9, 
   3.8439119337507343`*^9, {3.8439123466522465`*^9, 3.843912347576275*^9}, {
   3.845377549458807*^9, 3.8453775602143884`*^9}, {3.8453785533550687`*^9, 
   3.845378605373325*^9}, {3.8453789423895473`*^9, 3.8453789439841523`*^9}, {
   3.8453790672725477`*^9, 3.8453790848657455`*^9}, {3.8453793835452356`*^9, 
   3.845379384476042*^9}, {3.85600445704381*^9, 3.8560044730111136`*^9}, {
   3.8565186072218328`*^9, 3.856518612349287*^9}, 3.856518655745571*^9, {
   3.865244426382003*^9, 3.86524442851871*^9}, {3.865244858832222*^9, 
   3.865244859789771*^9}, {3.8654310605433173`*^9, 3.8654310623734255`*^9}, {
   3.86552760899034*^9, 3.8655276217805104`*^9}, {3.8655302003992577`*^9, 
   3.8655302089611735`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[131]:=",ExpressionUUID->"6ac9819b-115a-4dd5-8449-1342b25f7d15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Initial functions and variables", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.8388082948508825`*^9, 3.838808296311653*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"9b401317-068f-44f1-b72b-982338d04140"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PERIODIC", " ", "MESH"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mesh0p", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "nx", ",", "ny", ",", "msht", ",", "dmx", ",", "dmy", ",", 
        "randQ", ",", "seed", ",", "lloydQ", ",", "mshn", ",", "cutcQ", ",", 
        "lliter"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"msht", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"LLOYD", "'"}], "S", " ", "RELAXATION"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"lloydQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vpts0", "=", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"UniformDistribution", "[", 
                RowBox[{"tssL", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}], 
                "]"}], ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pl", "=", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"maxit", "=", "lliter"}], ",", 
                 RowBox[{"(*", 
                  RowBox[{"maximum", " ", "iterations"}], "*)"}], 
                 RowBox[{"tol", "=", 
                  RowBox[{"0.005", "*", "tssL"}]}]}], " ", 
                RowBox[{"(*", 
                 RowBox[{"distance", " ", "tolerance"}], "*)"}], "}"}], ",", 
               RowBox[{"FixedPointList", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{"pts", ",", 
                   RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "cells", "}"}], ",", 
                    RowBox[{
                    RowBox[{"cells", "=", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{
                    RowBox[{"VoronoiMesh", "[", 
                    RowBox[{"pts", ",", 
                    RowBox[{"tssL", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}]}], 
                    "]"}], ",", "\"\<Faces\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"RegionCentroid", "/@", 
                    RowBox[{"cells", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{
                    RowBox[{"Outer", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "@", "#1"}], "&"}], ",", "pts", ",", 
                    RowBox[{"RegionMember", "/@", "cells"}], ",", "1"}], 
                    "]"}], ",", "Automatic", ",", "False"}], "]"}], "[", 
                    "\"\<NonzeroPositions\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
                    "]"}]}]}]}], "]"}]}], "]"}], ",", "vpts0", ",", "maxit", 
                 ",", 
                 RowBox[{"SameTest", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"EuclideanDistance", ",", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "]"}], "<", 
                    "tol"}], "&"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pts", "=", 
             RowBox[{"Last", "[", "pl", "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"pts", "=", 
            RowBox[{"RandomVariate", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"tssL", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}], 
               "]"}], ",", "n"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sf", "=", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], "/", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"3", "/", "4"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vpts0", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"3", "/", "2"}], " ", "i"}], "+", 
                   RowBox[{"RandomReal", "[", "mshn", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sqrt", "[", "3", "]"}], " ", "j"}], "+", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], " ", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "+", 
                   RowBox[{"RandomReal", "[", "mshn", "]"}]}]}], "}"}], 
                "sf"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "nx"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "ny"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"pts", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"Mean", "@", "vpts0"}]}], "&"}], "/@", "vpts0"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pts", "==", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Error: no cells.\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pts2x", "=", 
           RowBox[{"nx", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Max", "@", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "-", 
               RowBox[{"Min", "@", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"nx", "-", "1"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pts2y", "=", 
           RowBox[{"2", "ny", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Max", "@", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "-", 
               RowBox[{"Min", "@", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "ny"}], "-", "1"}], ")"}]}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pts2x", "=", 
           RowBox[{"2", "tssL"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pts2y", "=", 
           RowBox[{"2", "tssL"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts2", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TranslationTransform", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", " ", "pts2x"}], ",", " ", 
                RowBox[{"j", " ", "pts2y"}]}], "}"}], "]"}], "[", "pts", 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vor", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"pts2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pts2x", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}]}], ",", 
            RowBox[{"pts2y", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"vcells", " ", "=", " ", 
         RowBox[{"Catenate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NearestMeshCells", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vor", ",", "2"}], "}"}], ",", "#"}], "]"}], "&"}], "/@",
            "pts"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"pvor", " ", "=", " ", 
         RowBox[{"MeshRegion", "[", 
          RowBox[{
           RowBox[{"MeshCoordinates", "[", "vor", "]"}], ",", 
           RowBox[{"MeshCells", "[", 
            RowBox[{"vor", ",", "vcells"}], "]"}]}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"mesh", "=", "pvor"}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       RowBox[{"vpts", "=", 
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"MeshCoordinates", "[", "vor", "]"}], ",", 
          RowBox[{
           RowBox[{"Union", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"MeshCells", "[", 
               RowBox[{"vor", ",", "vcells"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"Polygon", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}],
              "]"}]}], "~", "Partition", "~", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "pts", "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"C22", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", ".", 
            RowBox[{"Transpose", "[", "#", "]"}]}], "&"}], "@", 
          RowBox[{"vor", "[", 
           RowBox[{"\"\<ConnectivityMatrix\>\"", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"cells", "=", 
         RowBox[{
          RowBox[{"Region`Mesh`MeshMemberCellIndex", "[", 
           RowBox[{"vor", ",", "pts2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"C22perm", "=", 
         RowBox[{"C22", "[", 
          RowBox[{"[", 
           RowBox[{"cells", ",", "cells"}], "]"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"pC22", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"Unitize", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"Unitize", "[", "C22perm", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"len", ",", "len"}], "}"}]}], "]"}], ",", "2"}], 
            "]"}], "]"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"pC22", "-=", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"len", ",", "SparseArray"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"indToPtsAssoc", "=", 
        RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"MeshCells", "[", "pvor", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Point", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
            
            RowBox[{"{", "1", "}"}]}], "]"}], "\[Rule]", 
          "\[IndentingNewLine]", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"MeshPrimitives", "[", 
             RowBox[{"pvor", ",", "0"}], "]"}], ",", 
            RowBox[{"Point", "\[Rule]", "Sequence"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptsToIndAssoc", "=", 
        RowBox[{"<|", 
         RowBox[{"Reverse", "[", 
          RowBox[{
           RowBox[{"Normal", "@", "indToPtsAssoc"}], ",", "2"}], "]"}], 
         "|>"}]}], ";", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"cellVertexGrouping", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"AssociationThread", "[", 
            RowBox[{
             RowBox[{"Range", "@", 
              RowBox[{"Length", "[", "#", "]"}]}], "\[Rule]", " ", "#"}], 
            "]"}], "&"}], "@", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"MeshCells", "[", 
             RowBox[{"pvor", ",", "2"}], "]"}], ",", 
            RowBox[{"x_Polygon", "\[RuleDelayed]", 
             RowBox[{"Sequence", "@@", "x"}]}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       RowBox[{"vertexCellAssoc", "=", 
        RowBox[{"KeySort", "@", 
         RowBox[{"GroupBy", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Reverse", "[", 
              RowBox[{
               RowBox[{"Normal", "@", "cellVertexGrouping"}], ",", "2"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wrappedMat", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "cellVertexGrouping", "]"}], "\[Rule]", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "/.", 
              "periodicRules"}], "&"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Lookup", "[", 
             RowBox[{"cellVertexGrouping", ",", 
              RowBox[{"Keys", "[", "cellVertexGrouping", "]"}]}], "]"}], ",", 
            
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"faceListCoords", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "cellVertexGrouping", "]"}], " ", "\[Rule]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"Values", "@", 
             RowBox[{"Normal", "@", "cellVertexGrouping"}]}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptsToIndAssoc", "=", 
        RowBox[{"KeyMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "10"}], "]"}], "&"}], ",", "ptsToIndAssoc"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"indToPtsAssoc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"#", ",", "10"}], "]"}], "&"}], "/@", "indToPtsAssoc"}]}], 
       ";", "\n", "\t", 
       RowBox[{"wrappedMat", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"#", ",", "10"}], "]"}], "&"}], "/@", "wrappedMat"}]}], 
       ";", "\n", "\t", 
       RowBox[{"faceListCoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"#", ",", "10"}], "]"}], "&"}], "/@", "faceListCoords"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"$cellToPts", "=", 
        RowBox[{"cellToPts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{"indToPtsAssoc", ",", "#"}], "]"}], "&"}], "/@", 
          "cellVertexGrouping"}]}]}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8339684405821986`*^9, 3.8339684419530025`*^9}, {
   3.8340581835436597`*^9, 3.83405823097276*^9}, {3.8340582749000816`*^9, 
   3.8340582993569145`*^9}, {3.834058743564098*^9, 3.834058750304394*^9}, {
   3.8340588300138583`*^9, 3.8340588809670205`*^9}, {3.834058962839883*^9, 
   3.8340589636108303`*^9}, {3.8340598628312173`*^9, 3.834059862943492*^9}, {
   3.834059909721052*^9, 3.8340599100791173`*^9}, {3.83405999151303*^9, 
   3.834059991705262*^9}, {3.834060039898178*^9, 3.834060043837467*^9}, {
   3.8340612355275373`*^9, 3.8340612365961847`*^9}, {3.8340612966445913`*^9, 
   3.834061299308813*^9}, {3.834062662554765*^9, 3.834062684415369*^9}, {
   3.8340627668651485`*^9, 3.8340627671513166`*^9}, {3.8344975506173267`*^9, 
   3.8344975539607525`*^9}, {3.8347410326252604`*^9, 
   3.8347410740564394`*^9}, {3.8347412973931346`*^9, 
   3.8347412977310534`*^9}, {3.8352709582227697`*^9, 3.8352709603722425`*^9}, 
   3.835271170791541*^9, {3.8352712225884895`*^9, 3.8352712817519927`*^9}, {
   3.8352714793191185`*^9, 3.8352714798387012`*^9}, {3.8352718215886507`*^9, 
   3.835271883572593*^9}, {3.8352719352055593`*^9, 3.8352719394115524`*^9}, {
   3.8352726912553716`*^9, 3.835272703301796*^9}, {3.835273080732069*^9, 
   3.8352730829227552`*^9}, {3.835273288750947*^9, 3.8352733912921925`*^9}, {
   3.8352734365459423`*^9, 3.8352734423266673`*^9}, {3.8352734839055347`*^9, 
   3.835273492910542*^9}, 3.835273545648055*^9, {3.83535792571808*^9, 
   3.8353579976213675`*^9}, {3.8353580838287506`*^9, 3.835358123508673*^9}, {
   3.835358219526012*^9, 3.8353582206860723`*^9}, {3.835358267711892*^9, 
   3.8353582845543804`*^9}, {3.8353583510310736`*^9, 
   3.8353583557882595`*^9}, {3.835358908116091*^9, 3.83535895788171*^9}, 
   3.8353590318396482`*^9, {3.8353590836627274`*^9, 3.8353590850050297`*^9}, {
   3.835359510068493*^9, 3.8353595140985813`*^9}, {3.8353598113701167`*^9, 
   3.83535982049835*^9}, {3.835442684842012*^9, 3.835442701782485*^9}, {
   3.835443007224168*^9, 3.8354430088849573`*^9}, {3.835443268862655*^9, 
   3.835443269314932*^9}, {3.8354434205126657`*^9, 3.835443428780469*^9}, {
   3.8354435205553226`*^9, 3.8354435238548126`*^9}, {3.835443771370042*^9, 
   3.8354437740498343`*^9}, 3.835443831656166*^9, {3.8354442796684637`*^9, 
   3.8354442802021217`*^9}, 3.835444324770384*^9, {3.835444401875094*^9, 
   3.835444402187857*^9}, {3.8354446731945295`*^9, 3.835444673500531*^9}, {
   3.8354454782624464`*^9, 3.8354454795307884`*^9}, {3.8354456420579004`*^9, 
   3.835445642192572*^9}, {3.8356929967804327`*^9, 3.8356930083614855`*^9}, {
   3.8356930451307106`*^9, 3.8356931190641284`*^9}, {3.8356933485832767`*^9, 
   3.835693348776759*^9}, {3.8356934381097755`*^9, 3.8356934466836076`*^9}, {
   3.8356938415174446`*^9, 3.8356938427173123`*^9}, {3.835703851466108*^9, 
   3.835703871063589*^9}, {3.835705169721203*^9, 3.8357051705839233`*^9}, {
   3.8362996778512974`*^9, 3.8362996862846746`*^9}, {3.836300859761258*^9, 
   3.8363008619645433`*^9}, {3.83630089941271*^9, 3.8363009082623177`*^9}, {
   3.83630097419154*^9, 3.836300993078389*^9}, {3.8364860875877433`*^9, 
   3.8364860905099964`*^9}, {3.836486134602577*^9, 3.836486186008235*^9}, {
   3.836487521238064*^9, 3.836487540070232*^9}, {3.836487579153318*^9, 
   3.836487616412546*^9}, 3.836487697102262*^9, {3.836487974912029*^9, 
   3.836488021349637*^9}, {3.8364880823636985`*^9, 3.836488177708313*^9}, {
   3.8365655389198074`*^9, 3.836565539288958*^9}, {3.837076801484547*^9, 
   3.8370768106635942`*^9}, {3.83707694908633*^9, 3.8370769506231813`*^9}, {
   3.8377686958235984`*^9, 3.837768744449849*^9}, {3.8387034355553703`*^9, 
   3.8387034676186714`*^9}, {3.838808316925898*^9, 3.8388083492042804`*^9}, {
   3.8388114286078997`*^9, 3.8388114374790096`*^9}, {3.8388143143315907`*^9, 
   3.8388143686733823`*^9}, {3.8388170168618555`*^9, 
   3.8388170170224257`*^9}, {3.840617705053385*^9, 3.8406177055793304`*^9}, {
   3.8406177367412195`*^9, 3.8406177553047557`*^9}, {3.840618587345333*^9, 
   3.840618587503044*^9}, {3.8406186333357887`*^9, 3.840618724678981*^9}, {
   3.840619168506543*^9, 3.8406191686671143`*^9}, {3.8406201684866076`*^9, 
   3.8406201706863527`*^9}, {3.8406204959190817`*^9, 3.840620498551831*^9}, {
   3.840620563983907*^9, 3.840620565122863*^9}, {3.840620598377651*^9, 
   3.840620598665881*^9}, {3.840620647700698*^9, 3.840620675260127*^9}, 
   3.8406234251680317`*^9, {3.840623551170145*^9, 3.8406235517769084`*^9}, {
   3.8406240451562276`*^9, 3.840624071387331*^9}, {3.8406241357436576`*^9, 
   3.840624148348302*^9}, {3.8406241980909076`*^9, 3.8406242063351326`*^9}, {
   3.840624375402437*^9, 3.8406244060567875`*^9}, {3.8406244472493057`*^9, 
   3.8406244483474417`*^9}, {3.8407100696101894`*^9, 3.840710071737715*^9}, {
   3.840733406308793*^9, 3.8407334065970216`*^9}, {3.840734595515103*^9, 
   3.840734595980275*^9}, {3.8560079186384945`*^9, 3.856007921516798*^9}, {
   3.857050114921529*^9, 3.8570501184650793`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[132]:=",ExpressionUUID->"abe77338-1ee6-413c-9388-5fcc6e3f2ed0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"INITIAL", " ", "MESH"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mesh0", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "nx", ",", "ny", ",", "msht", ",", "dmx", ",", "dmy", ",", 
        "randQ", ",", "seed", ",", "lloydQ", ",", "mshn", ",", "cutcQ", ",", 
        "lliter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"msht", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"LLOYD", "'"}], "S", " ", "RELAXATION"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"lloydQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vpts0", "=", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"UniformDistribution", "[", 
                RowBox[{"tssL", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}], 
                "]"}], ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pl", "=", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"maxit", "=", "lliter"}], ",", 
                 RowBox[{"(*", 
                  RowBox[{"maximum", " ", "iterations"}], "*)"}], 
                 RowBox[{"tol", "=", 
                  RowBox[{"0.005", "*", "tssL"}]}]}], " ", 
                RowBox[{"(*", 
                 RowBox[{"distance", " ", "tolerance"}], "*)"}], "}"}], ",", 
               RowBox[{"FixedPointList", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{"vpts", ",", 
                   RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "cells", "}"}], ",", 
                    RowBox[{
                    RowBox[{"cells", "=", 
                    RowBox[{"MeshPrimitives", "[", 
                    RowBox[{
                    RowBox[{"VoronoiMesh", "[", 
                    RowBox[{"vpts", ",", 
                    RowBox[{"tssL", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}]}], 
                    "]"}], ",", "\"\<Faces\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"RegionCentroid", "/@", 
                    RowBox[{"cells", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{
                    RowBox[{"Outer", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "@", "#1"}], "&"}], ",", "vpts", ",", 
                    RowBox[{"RegionMember", "/@", "cells"}], ",", "1"}], 
                    "]"}], ",", "Automatic", ",", "False"}], "]"}], "[", 
                    "\"\<NonzeroPositions\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
                    "]"}]}]}]}], "]"}]}], "]"}], ",", "vpts0", ",", "maxit", 
                 ",", 
                 RowBox[{"SameTest", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"EuclideanDistance", ",", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "]"}], "<", 
                    "tol"}], "&"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vpts", "=", 
             RowBox[{"Last", "[", "pl", "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"vpts", "=", 
            RowBox[{"RandomVariate", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"tssL", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}], 
               "]"}], ",", "n"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sf", "=", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], "/", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"3", "/", "4"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vpts0", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"3", "/", "2"}], " ", "i"}], "+", 
                   RowBox[{"RandomReal", "[", "mshn", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sqrt", "[", "3", "]"}], " ", "j"}], "+", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], " ", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "+", 
                   RowBox[{"RandomReal", "[", "mshn", "]"}]}]}], "}"}], 
                "sf"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"nx", "+", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"ny", "+", "2"}]}], "}"}]}], "]"}], ",", "1"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vpts", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"Mean", "@", "vpts0"}]}], "&"}], "/@", "vpts0"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"getData", "[", "sorc", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"meshxa", "=", 
           RowBox[{"Mean", "@", "dtxAllArea"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"vpts", "=", 
           RowBox[{"dtxAllPts", "/", 
            RowBox[{"Sqrt", "@", "meshxa"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pts", "==", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Error: no cells.\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"msht", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"mesh", "=", 
          RowBox[{"VoronoiMesh", "[", 
           RowBox[{"vpts", ",", 
            RowBox[{"tssL", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "dmx"}], ",", "dmx"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "dmy"}], ",", "dmy"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", " ", "Medium"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mesh1", "=", 
           RowBox[{"VoronoiMesh", "[", 
            RowBox[{"vpts", ",", "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"hexagons", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"5", "<=", 
                RowBox[{"Length", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&&", 
               RowBox[{
                RowBox[{"Area", "[", "#", "]"}], "<", "2"}]}], "&"}], "]"}], 
            "@", 
            RowBox[{"MeshPrimitives", "[", 
             RowBox[{"mesh1", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "\"\<Interior\>\""}], "}"}]}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mesh", "=", 
           RowBox[{"DiscretizeGraphics", "@", 
            RowBox[{"Graphics", "@", "hexagons"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nex", "=", 
           RowBox[{
            RowBox[{"Length", "[", "hexagons", "]"}], "-", 
            RowBox[{"nx", " ", "ny"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nex", "=!=", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hexf", "=", 
              RowBox[{"MeshPrimitives", "[", 
               RowBox[{"mesh", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "\"\<Frontier\>\""}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"hexagons", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"hexagons", ",", 
                RowBox[{"RandomSample", "[", 
                 RowBox[{"hexf", ",", "nex"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"mesh", "=", 
           RowBox[{"DiscretizeGraphics", "@", 
            RowBox[{"Graphics", "@", "hexagons"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"meshx", "=", 
           RowBox[{"VoronoiMesh", "[", 
            RowBox[{"vpts", ",", "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mndtxp", "=", 
           RowBox[{"Mean", "@", "vpts"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"hexagons", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TransformedRegion", "[", 
               RowBox[{"#", ",", 
                RowBox[{"TranslationTransform", "[", 
                 RowBox[{"-", "mndtxp"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"3", "<=", 
                  RowBox[{"Length", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{"Area", "[", "#", "]"}], "<", "4"}]}], "&"}], "]"}],
               "@", 
              RowBox[{"MeshPrimitives", "[", 
               RowBox[{"meshx", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "\"\<Interior\>\""}], "}"}]}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"hexagons", "=", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"3", "<=", 
                  RowBox[{"Length", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{"Area", "[", "#", "]"}], "<", "4"}]}], "&"}], "]"}],
               "@", 
              RowBox[{"MeshPrimitives", "[", 
               RowBox[{"meshx", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "\"\<Interior\>\""}], "}"}]}], "]"}]}]}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"meshx2", "=", 
           RowBox[{"DiscretizeGraphics", "@", 
            RowBox[{"Graphics", "@", "hexagons"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"regcsx", "=", 
           RowBox[{"RegionCentroid", "/@", 
            RowBox[{"MeshPrimitives", "[", 
             RowBox[{"meshx2", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"hexagons2", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TransformedRegion", "[", 
               RowBox[{"#", ",", 
                RowBox[{"TranslationTransform", "[", 
                 RowBox[{"-", 
                  RowBox[{"Mean", "@", "regcsx"}]}], "]"}]}], "]"}], "&"}], 
             ",", 
             RowBox[{"MeshPrimitives", "[", 
              RowBox[{"meshx2", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "\"\<Interior\>\""}], "}"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mesh", "=", 
           RowBox[{"DiscretizeGraphics", "@", 
            RowBox[{"Graphics", "@", "hexagons2"}]}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msht", "==", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mesh", "=", 
           RowBox[{"graphToMesh", "[", "gra", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pts", "=", 
           RowBox[{"PropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mesh", ",", "2"}], "}"}], ",", "MeshCellCentroid"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mesh", "==", 
          RowBox[{"EmptyRegion", "[", "2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Error: no cells.\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"mesh", ",", "0"}], "]"}], "/.", 
         RowBox[{"Point", "\[Rule]", "Sequence"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cornerpts", "=", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "4"}], ";;"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cutcQ", "&&", 
          RowBox[{"msht", "==", "0"}]}], ",", 
         RowBox[{"pts", "=", 
          RowBox[{"pts", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "5"}]}], "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$indTopts", "=", 
        RowBox[{"indTopts", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "pts"}]}], "->", "pts"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$ptsToInd", "=", 
        RowBox[{"ptsToInd", "=", 
         RowBox[{
          RowBox[{"AssociationMap", "[", "Reverse", "]"}], "[", "indTopts", 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellmeshprim", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"mesh", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cutcQ", "&&", 
          RowBox[{"msht", "==", "0"}]}], ",", 
         RowBox[{"cells", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"MeshPrimitives", "[", 
                RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "cellmeshprim"}],
              ")"}], "/.", 
            RowBox[{"Point", "\[Rule]", "Sequence"}]}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"cornerpts", "\[Rule]", "Nothing"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"cells", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"MeshPrimitives", "[", 
               RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "cellmeshprim"}], 
            ")"}], "/.", 
           RowBox[{"Point", "\[Rule]", "Sequence"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$cellToVertexG", "=", 
        RowBox[{"cellToVertexG", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "cells"}], "]"}], "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{"ptsToInd", ",", "cells", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$vertexToCell", "=", 
        RowBox[{"vertexToCell", "=", 
         RowBox[{"GroupBy", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Reverse", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}], "@*", 
              "Thread"}], "/@", 
             RowBox[{"Normal", "@", "cellToVertexG"}]}], "]"}], ",", 
           RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$cellToPts", "=", 
        RowBox[{"cellToPts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
          "cellToVertexG"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$periPolygonAssoc", "=", 
        RowBox[{"periPolygonAssoc", "=", 
         RowBox[{"perimeterPolygon", "/@", "cellToPts"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$areaPolygonAssoc", "=", 
        RowBox[{"areaPolygonAssoc", "=", 
         RowBox[{"areaPolygon", "/@", "cellToPts"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$diamPolygonAssoc", "=", 
        RowBox[{"diamPolygonAssoc", "=", 
         RowBox[{"diamPolygon", "/@", "cellToPts"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8339684405821986`*^9, 3.8339684419530025`*^9}, {
   3.8340581835436597`*^9, 3.83405823097276*^9}, {3.8340582749000816`*^9, 
   3.8340582993569145`*^9}, {3.834058743564098*^9, 3.834058750304394*^9}, {
   3.8340588300138583`*^9, 3.8340588809670205`*^9}, {3.834058962839883*^9, 
   3.8340589636108303`*^9}, {3.8340598628312173`*^9, 3.834059862943492*^9}, {
   3.834059909721052*^9, 3.8340599100791173`*^9}, {3.83405999151303*^9, 
   3.834059991705262*^9}, {3.834060039898178*^9, 3.834060043837467*^9}, {
   3.8340612355275373`*^9, 3.8340612365961847`*^9}, {3.8340612966445913`*^9, 
   3.834061299308813*^9}, {3.834062662554765*^9, 3.834062684415369*^9}, {
   3.8340627668651485`*^9, 3.8340627671513166`*^9}, {3.8344975506173267`*^9, 
   3.8344975539607525`*^9}, {3.8347410326252604`*^9, 
   3.8347410740564394`*^9}, {3.8347412973931346`*^9, 
   3.8347412977310534`*^9}, {3.8352709582227697`*^9, 3.8352709603722425`*^9}, 
   3.835271170791541*^9, {3.8352712225884895`*^9, 3.8352712817519927`*^9}, {
   3.8352714793191185`*^9, 3.8352714798387012`*^9}, {3.8352718215886507`*^9, 
   3.835271883572593*^9}, {3.8352719352055593`*^9, 3.8352719394115524`*^9}, {
   3.8352726912553716`*^9, 3.835272703301796*^9}, {3.835273080732069*^9, 
   3.8352730829227552`*^9}, {3.835273288750947*^9, 3.8352733912921925`*^9}, {
   3.8352734365459423`*^9, 3.8352734423266673`*^9}, {3.8352734839055347`*^9, 
   3.835273492910542*^9}, 3.835273545648055*^9, {3.83535792571808*^9, 
   3.8353579976213675`*^9}, {3.8353580838287506`*^9, 3.835358123508673*^9}, {
   3.835358219526012*^9, 3.8353582206860723`*^9}, {3.835358267711892*^9, 
   3.8353582845543804`*^9}, {3.8353583510310736`*^9, 
   3.8353583557882595`*^9}, {3.835358908116091*^9, 3.83535895788171*^9}, 
   3.8353590318396482`*^9, {3.8353590836627274`*^9, 3.8353590850050297`*^9}, {
   3.835359510068493*^9, 3.8353595140985813`*^9}, {3.8353598113701167`*^9, 
   3.83535982049835*^9}, {3.835442684842012*^9, 3.835442701782485*^9}, {
   3.835443007224168*^9, 3.8354430088849573`*^9}, {3.835443268862655*^9, 
   3.835443269314932*^9}, {3.8354434205126657`*^9, 3.835443428780469*^9}, {
   3.8354435205553226`*^9, 3.8354435238548126`*^9}, {3.835443771370042*^9, 
   3.8354437740498343`*^9}, 3.835443831656166*^9, {3.8354442796684637`*^9, 
   3.8354442802021217`*^9}, 3.835444324770384*^9, {3.835444401875094*^9, 
   3.835444402187857*^9}, {3.8354446731945295`*^9, 3.835444673500531*^9}, {
   3.8354454782624464`*^9, 3.8354454795307884`*^9}, {3.8354456420579004`*^9, 
   3.835445642192572*^9}, {3.8356929967804327`*^9, 3.8356930083614855`*^9}, {
   3.8356930451307106`*^9, 3.8356931190641284`*^9}, {3.8356933485832767`*^9, 
   3.835693348776759*^9}, {3.8356934381097755`*^9, 3.8356934466836076`*^9}, {
   3.8356938415174446`*^9, 3.8356938427173123`*^9}, {3.835703851466108*^9, 
   3.835703871063589*^9}, {3.835705169721203*^9, 3.8357051705839233`*^9}, {
   3.8362996778512974`*^9, 3.8362996862846746`*^9}, {3.836300859761258*^9, 
   3.8363008619645433`*^9}, {3.83630089941271*^9, 3.8363009082623177`*^9}, {
   3.83630097419154*^9, 3.836300993078389*^9}, {3.8364860875877433`*^9, 
   3.8364860905099964`*^9}, {3.836486134602577*^9, 3.836486186008235*^9}, {
   3.836487521238064*^9, 3.836487540070232*^9}, {3.836487579153318*^9, 
   3.836487616412546*^9}, 3.836487697102262*^9, {3.836487974912029*^9, 
   3.836488021349637*^9}, {3.8364880823636985`*^9, 3.836488177708313*^9}, {
   3.8365655389198074`*^9, 3.836565539288958*^9}, {3.837076801484547*^9, 
   3.8370768106635942`*^9}, {3.83707694908633*^9, 3.8370769506231813`*^9}, {
   3.8377686958235984`*^9, 3.837768744449849*^9}, {3.8387034355553703`*^9, 
   3.8387034676186714`*^9}, 3.838808316925898*^9, {3.840734601175771*^9, 
   3.840734601498906*^9}, {3.8409836329936733`*^9, 3.840983676545661*^9}, {
   3.840984366790286*^9, 3.8409843763365955`*^9}, {3.856007603001297*^9, 
   3.8560076064121847`*^9}, 3.8560076392912765`*^9, {3.8560078644833117`*^9, 
   3.8560078772581453`*^9}, {3.8560084738360186`*^9, 
   3.8560084936600094`*^9}, {3.8560085338694887`*^9, 
   3.8560085763319454`*^9}, {3.8565187543502283`*^9, 
   3.8565187903275704`*^9}, {3.8570433676254187`*^9, 3.857043380393278*^9}, {
   3.8570500861853714`*^9, 3.8570500930569954`*^9}, {3.865243109055323*^9, 
   3.8652431159930344`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[133]:=",ExpressionUUID->"7c14710b-e35b-4f6d-80a5-6dbc0ffe2743"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "INITIALISATION", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inif", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sigm", ",", "sigr", ",", "sigs", ",", "perQ"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "perQ"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"indTopts", "=", "$indTopts"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"ptsToInd", "=", "$ptsToInd"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"vertexToCell", "=", "$vertexToCell"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cellToVertexG", "=", "$cellToVertexG"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vertexToCell", "=", 
           RowBox[{"GroupBy", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Reverse", "[", 
                   RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}], "@*", 
                "Thread"}], "/@", 
               RowBox[{"Normal", "@", "cellToVertexG"}]}], "]"}], ",", 
             RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"periPolygonAssoc", "=", "$periPolygonAssoc"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"areaPolygonAssoc", "=", "$areaPolygonAssoc"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"diamPolygonAssoc", "=", "$diamPolygonAssoc"}], ";"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"indTopts", "=", "indToPtsAssoc"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ptsToInd", "=", "ptsToIndAssoc"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cellToVertexG", "=", "cellVertexGrouping"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vertexToCell", "=", "vertexCellAssoc"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$wrappedMat", "=", "wrappedMat"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$wrappedMatTrim", "=", 
           RowBox[{"KeyTake", "[", 
            RowBox[{"wrappedMat", ",", 
             RowBox[{"outerCellsFn", "[", 
              RowBox[{
              "faceListCoords", ",", "vertexCellAssoc", ",", 
               "ptsToIndAssoc"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$faceListCoords", "=", "faceListCoords"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"areaPolygonAssoc", "=", 
           RowBox[{"areaOfPolygon", "@", "faceListCoords"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"periPolygonAssoc", "=", 
           RowBox[{"perimeterOfPolygon", "@", "faceListCoords"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellToPts", "=", "$cellToPts"}], ";", "\[IndentingNewLine]", 
       RowBox[{"edges0", "=", 
        RowBox[{"DeleteDuplicatesBy", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}], 
              ",", 
              RowBox[{"Values", "@", "cellToVertexG"}]}], "]"}], ",", "1"}], 
           "]"}], ",", "Sort"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edges0", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"edges0", ",", 
          RowBox[{"Reverse", "/@", "edges0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sigx", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Values", "[", 
             RowBox[{"indTopts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "@", 
            RowBox[{"Min", "[", 
             RowBox[{"Values", "[", 
              RowBox[{"indTopts", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigy", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Values", "[", 
             RowBox[{"indTopts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "@", 
            RowBox[{"Min", "[", 
             RowBox[{"Values", "[", 
              RowBox[{"indTopts", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rfw", "=", "0.2"}], ";", 
       RowBox[{"rf", "=", "2.3"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"smod", ",", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"sigr", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"fitQ", "&&", 
               RowBox[{"msht", "==", "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"lsig1", "=", 
                RowBox[{"DiscretizeRegion", "@", 
                 RowBox[{"ParametricRegion", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fit", "[", 
                    RowBox[{"regccs1", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "x", ",", 
                    RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"regccs1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"regccs1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"lsig2", "=", 
                RowBox[{"DiscretizeRegion", "@", 
                 RowBox[{"ParametricRegion", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fit", "[", 
                    RowBox[{"regccs2", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "x", ",", 
                    RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"regccs2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"regccs2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"lsig1", "=", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], "+", "rf"}], ",", 
                    RowBox[{
                    RowBox[{"-", "sigs"}], "-", "rfw"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sigx", "-", "rf"}], ",", 
                    RowBox[{"-", "sigs"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"lsig2", "=", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], "+", "rf"}], ",", "sigs"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sigx", "-", "rf"}], ",", 
                    RowBox[{"sigs", "+", "rfw"}]}], "}"}]}], "]"}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"sigR", "=", 
             RowBox[{"DiscretizeRegion", "@", 
              RowBox[{"(", 
               RowBox[{"RegionUnion", "[", 
                RowBox[{"lsig1", ",", "lsig2"}], "]"}], ")"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sigr", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"sigR", "=", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "sigx"}], "-", "rf"}], ",", 
                RowBox[{
                 RowBox[{"-", "sigy"}], "-", "rf"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sigx", "+", "rf"}], ",", 
                RowBox[{"sigy", "+", "rf"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sigr", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
           RowBox[{"sigR", "=", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "sigx"}], "+", "rf"}], ",", 
                RowBox[{
                 RowBox[{"-", "sigy"}], "+", "rf"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sigx", "-", "rf"}], ",", 
                RowBox[{"sigy", "-", "rf"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gr", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lv", "=", 
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "##", "}"}], "]"}], "&"}], "]"}], "@", 
           "cellToPts"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"{", 
         RowBox[{"Map", "[", 
          RowBox[{"Polygon", ",", "cellToPts"}], "]"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pcells", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pcells", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"pcells", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "[", "rmb", "]"}], "==", "0."}], ",", 
            RowBox[{"Last", "[", "plist", "]"}], ",", 
            RowBox[{"AssociationThread", "[", 
             RowBox[{
              RowBox[{"Last", "[", "lv", "]"}], "->", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"roundm", "[", 
                  RowBox[{"#", ",", "rmb", ",", 
                   RowBox[{"1", "/", "2"}]}], "]"}], "&"}], ",", 
                RowBox[{"Values", "@", 
                 RowBox[{
                  RowBox[{"Last", "[", "plist", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"miii", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"smod", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"SKIP", " ", "MESH", " ", "OPTION"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "skipmeshQ"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"sigr", "==", "2"}], ",", 
             RowBox[{"lvs", "=", 
              RowBox[{"Last", "@", "lv"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sigr", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"discra1", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Keys", "@", 
                    RowBox[{"Last", "@", "plist"}]}], "->", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{"DiscretizeRegion", "[", "#", "]"}], ",", 
                    "lsig1"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"Values", "@", 
                    RowBox[{"Last", "@", "plist"}]}], ")"}]}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"lvs1", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"miii", "++"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"discra1", "[", "j", "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"discra2", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Keys", "@", 
                    RowBox[{"Last", "@", "plist"}]}], "->", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{"DiscretizeRegion", "[", "#", "]"}], ",", 
                    "lsig2"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"Values", "@", 
                    RowBox[{"Last", "@", "plist"}]}], ")"}]}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"lvs2", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"miii", "++"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"discra2", "[", "j", "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"(*", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"lvs1", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}]}], 
                    ",", "lsig1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"lvs2", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"miii", "++"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}]}], 
                    ",", "lsig2"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], 
                  ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lvs1", ",", "lvs2"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"lvs1", "=", 
                 RowBox[{"lvs2", "=", 
                  RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"discra", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Keys", "@", 
                    RowBox[{"Last", "@", "plist"}]}], "->", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{"DiscretizeRegion", "[", "#", "]"}], ",", 
                    "sigR"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"Values", "@", 
                    RowBox[{"Last", "@", "plist"}]}], ")"}]}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"lvs", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"miii", "++"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"discra", "[", "j", "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"check", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lvs", "==", 
           RowBox[{"{", "}"}]}], "&&", "smod"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Signalling region is out of bounds\>\"", "]"}], 
          ";", " ", 
          RowBox[{"run", "=", "0"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"lvss0", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "i", "]"}]}], 
                    "]"}], "]"}], "\[Equal]", 
                   RowBox[{"-", "Infinity"}]}], ",", "un", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"lvs", ",", "i"}], "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
          ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sigm", "\[Equal]", "2"}], ",", 
         RowBox[{"lvss", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ns", "=", 
        RowBox[{"Length", "[", "lvs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plistn", "=", 
        RowBox[{"{", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"Last", "[", "plist", "]"}], ",", "lvs"}], "]"}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"cj", "=", "0"}], ";", 
       RowBox[{"tt", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"ti", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"solns", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"solnsl", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"sols", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"solutions", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ii", "=", "1"}], ";", 
       RowBox[{"iii", "=", "0"}], ";", 
       RowBox[{"iii0", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"flist", "=", 
        RowBox[{"{", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FaceForm", "[", "LightBlue", "]"}], ",", 
             RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
             RowBox[{"Values", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Polygon", "@", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"indTopts", ",", "#"}], "]"}]}], "&"}], "/@", 
               "cellToVertexG"}], "]"}]}], "}"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "550"}]}], "]"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"smod", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"repp", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"IdentityMatrix", "[", "ns", "]"}], "}"}], "[", 
               RowBox[{"[", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"1", ",", "ns"}], "]"}], "]"}], "]"}], "]"}], ",", 
             "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Lp", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Perimeter", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Polygon", ",", 
               RowBox[{"Lookup", "[", 
                RowBox[{"cellToPts", ",", "lvs"}], "]"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"repp", "=", 
           RowBox[{"{", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", "ns"}], "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"msum", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Lps", "=", 
           RowBox[{"repf", "[", 
            RowBox[{"Lp", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"lij", "="}], ";"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"INITIAL", " ", "CONDITIONS"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"initln0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "iniN"}], "}"}], ",", "ns"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initld0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "iniD"}], "}"}], ",", "ns"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initlr0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "iniR"}], "}"}], ",", "ns"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigm", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"initlne0", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "iniN"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"initlde0", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "iniD"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"CHANGES", " ", "101"}], " ", "-", " ", 
            RowBox[{"CUSTOM", " ", "INITIAL", " ", "CONDITIONS"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"False", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"refined", " ", "R2", " ", "14", "x14"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"l14", "=", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"14", "*", "i"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "13"}], "}"}]}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "4", ",", "6", ",", "2", ",", "4", ",", "0", ",", 
                 "2", ",", "5", ",", "0", ",", "3", ",", "5", ",", "1", ",", 
                 "3", ",", "6"}], "}"}], "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"l11", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"l14", ",", 
                RowBox[{"l14", "+", "7"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"initln0t", "=", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"RandomReal", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.65", ",", "1"}], "}"}], ",", 
                  RowBox[{"14", "*", "14"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"l11", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "->", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.35"}], "}"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "l11"}]}], "}"}]}], "]"}]}], 
               "]"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"initld0t", "=", 
              RowBox[{"1", "-", "initln0"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"3", " ", "types", " ", "6", "x6"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"nnn1", "=", 
              RowBox[{"nnn2", "=", "0.9923409816530349`"}]}], ";", 
             RowBox[{"nnn3", "=", "0.003265865229268777`"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ddd1", "=", 
              RowBox[{"ddd2", "=", "0.010207059424586606`"}]}], ";", 
             RowBox[{"ddd3", "=", "1."}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"nnass", "=", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "2"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"nnn1", ",", "nnn2", ",", "nnn3"}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"ddass", "=", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "2"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"ddd1", ",", "ddd2", ",", "ddd3"}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"initln0t", "=", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"nnass", "[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"EvenQ", "[", "i", "]"}], "]"}]}], ",", "3"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"initld0t", "=", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"ddass", "[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"EvenQ", "[", "i", "]"}], "]"}]}], ",", "3"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"new", " ", "test"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"initld0", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}], ",", "200", ",", 
                RowBox[{"-", "100"}], ",", 
                RowBox[{"-", "100"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initln0", "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0.000001", ",", "36"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"INITIAL", " ", "CLAMP"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ipts0", "=", 
        RowBox[{"Values", "[", "indTopts", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"minix", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"ipts0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxix", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"ipts0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pclmp", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"ipts0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "minix"}], "]"}], "<", 
              "clmpw"}], "||", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "maxix"}], "]"}], "<", 
              "clmpw"}]}], ")"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kclmp", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"AssociationMap", "[", 
           RowBox[{"Reverse", ",", "indTopts"}], "]"}], ",", "pclmp"}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.833968459650111*^9, 3.833968460967092*^9}, {
   3.8339685216161537`*^9, 3.833968530832884*^9}, {3.8339734896929555`*^9, 
   3.8339735386894474`*^9}, {3.8340447157073607`*^9, 
   3.8340447179476986`*^9}, {3.834052129443945*^9, 3.834052133046611*^9}, {
   3.834061359003188*^9, 3.834061454158576*^9}, {3.8340615148360972`*^9, 
   3.8340615849706526`*^9}, {3.8340617137699738`*^9, 3.8340617157803526`*^9}, 
   3.8340617700925293`*^9, {3.8340625007337823`*^9, 3.834062502978464*^9}, {
   3.834062603153084*^9, 3.834062605175721*^9}, {3.834062662560749*^9, 
   3.8340626783555665`*^9}, {3.834062774159068*^9, 3.834062779589102*^9}, 
   3.834062855599392*^9, {3.834065931262721*^9, 3.8340659629232464`*^9}, {
   3.8340660852197366`*^9, 3.8340660924706717`*^9}, 3.834066240255632*^9, {
   3.8340662962531767`*^9, 3.834066297424659*^9}, {3.8340666946316633`*^9, 
   3.834066713478149*^9}, {3.834213421912236*^9, 3.834213431500805*^9}, {
   3.834223724038807*^9, 3.8342237242599473`*^9}, {3.8345597162746625`*^9, 
   3.8345597173293037`*^9}, 3.834560120107358*^9, {3.834560404068348*^9, 
   3.834560409430503*^9}, {3.8346594493142614`*^9, 3.834659485805996*^9}, {
   3.8346596000624666`*^9, 3.8346596314252095`*^9}, 3.835276774967985*^9, {
   3.8352772818324823`*^9, 3.835277286896196*^9}, {3.835277744404354*^9, 
   3.8352777492048426`*^9}, {3.8353591302052526`*^9, 
   3.8353591322977943`*^9}, {3.835359252945589*^9, 3.835359253135298*^9}, {
   3.8354427375440226`*^9, 3.8354427539987984`*^9}, {3.835442845579321*^9, 
   3.8354428491917944`*^9}, {3.8356946836315875`*^9, 3.835694696684719*^9}, {
   3.8356948089203796`*^9, 3.835694832726923*^9}, {3.835695216240527*^9, 
   3.835695251015489*^9}, {3.835695502996499*^9, 3.8356955258315163`*^9}, {
   3.835695877423006*^9, 3.8356959588400917`*^9}, {3.8356960027432995`*^9, 
   3.8356960219404745`*^9}, {3.8356966052599154`*^9, 
   3.8356966773707213`*^9}, {3.8356973327295375`*^9, 3.835697444437103*^9}, {
   3.835697520320036*^9, 3.835697521541607*^9}, {3.835697564177696*^9, 
   3.8356975642355413`*^9}, {3.835697794070275*^9, 3.8356978090717745`*^9}, {
   3.83569794188564*^9, 3.835697944091742*^9}, 3.8356980106891317`*^9, {
   3.8356982752090216`*^9, 3.8356982759915714`*^9}, {3.835698518068293*^9, 
   3.835698535036852*^9}, {3.835698738994053*^9, 3.8356987702456636`*^9}, {
   3.8356988371518364`*^9, 3.8356988382528925`*^9}, {3.835699114097464*^9, 
   3.8356991155239162`*^9}, {3.8357053861397963`*^9, 
   3.8357053941388674`*^9}, {3.83577818322832*^9, 3.835778183304117*^9}, {
   3.8357857617479362`*^9, 3.8357857625328074`*^9}, {3.8357967279509563`*^9, 
   3.8357967287039156`*^9}, {3.83586368825541*^9, 3.83586368851678*^9}, 
   3.8358699611311674`*^9, {3.8362924810502357`*^9, 3.8362924944350424`*^9}, {
   3.836292539869278*^9, 3.836292602328745*^9}, {3.83629268618157*^9, 
   3.8362927032304296`*^9}, {3.836292920885847*^9, 3.8362929214732757`*^9}, {
   3.83629401559628*^9, 3.836294037322757*^9}, {3.836294132727606*^9, 
   3.836294132856313*^9}, {3.8362941694216332`*^9, 3.836294171293502*^9}, {
   3.836299706837072*^9, 3.8362997371911697`*^9}, 3.8362998181769247`*^9, 
   3.836300488383564*^9, {3.836499663669924*^9, 3.8364996931038547`*^9}, {
   3.836499805033971*^9, 3.8364998674749002`*^9}, {3.836500386101308*^9, 
   3.8365003896525555`*^9}, {3.8365015832482796`*^9, 3.836501583798807*^9}, {
   3.8365020192712135`*^9, 3.8365020212825017`*^9}, {3.836502250633371*^9, 
   3.83650225321233*^9}, {3.8365029794124107`*^9, 3.8365029818786616`*^9}, {
   3.836503476788127*^9, 3.8365034798147163`*^9}, {3.8365038259616346`*^9, 
   3.8365038551874723`*^9}, {3.8365043447550507`*^9, 
   3.8365043651144323`*^9}, {3.836505083886244*^9, 3.836505133913145*^9}, {
   3.836505563570278*^9, 3.836505569096054*^9}, {3.836649333422023*^9, 
   3.836649370421322*^9}, {3.8366494399122725`*^9, 3.836649441234553*^9}, {
   3.8366499123534775`*^9, 3.836649914966137*^9}, {3.836651094631275*^9, 
   3.8366510966545343`*^9}, 3.8366511538683996`*^9, 3.836651234333912*^9, {
   3.8371163138196545`*^9, 3.8371163174360633`*^9}, {3.8378595227879105`*^9, 
   3.8378595247756643`*^9}, 3.838703851287672*^9, {3.8387420677298107`*^9, 
   3.838742068455475*^9}, {3.8387421195190663`*^9, 3.838742130356081*^9}, {
   3.8387422195754576`*^9, 3.8387422593678665`*^9}, {3.8387422997388835`*^9, 
   3.8387423062464857`*^9}, {3.8388144166053057`*^9, 3.838814418456827*^9}, {
   3.8388170700944405`*^9, 3.838817119378406*^9}, 3.8388190082850943`*^9, 
   3.838819522607086*^9, {3.8388195777775173`*^9, 3.8388195868756895`*^9}, {
   3.8388198138644342`*^9, 3.838819821821908*^9}, {3.838820382022357*^9, 
   3.838820390440563*^9}, {3.8397550672338977`*^9, 3.839755083875208*^9}, {
   3.840110140185181*^9, 3.840110141098646*^9}, {3.8406114522255993`*^9, 
   3.840611484834044*^9}, {3.8406115321417046`*^9, 3.840611599441454*^9}, {
   3.840615762445969*^9, 3.8406158677977467`*^9}, 3.840615903579409*^9, {
   3.8406159427680874`*^9, 3.8406159580675235`*^9}, {3.8406162342824974`*^9, 
   3.840616263554077*^9}, {3.8406165799024067`*^9, 3.8406165882989674`*^9}, {
   3.840616973142369*^9, 3.840616974473722*^9}, {3.840617840642243*^9, 
   3.840617841938246*^9}, 3.8406183887372427`*^9, {3.840983595767494*^9, 
   3.8409836198313117`*^9}, {3.840984294384241*^9, 3.840984296278469*^9}, {
   3.8409843439186387`*^9, 3.8409843490326834`*^9}, {3.8409869026981564`*^9, 
   3.8409869036655674`*^9}, {3.845920139719548*^9, 3.845920140781061*^9}, {
   3.8508130339534993`*^9, 3.8508130369964123`*^9}, {3.855908711841797*^9, 
   3.8559087222228937`*^9}, {3.8560033411244373`*^9, 
   3.8560033513879795`*^9}, {3.8570434002990475`*^9, 
   3.8570434246190147`*^9}, {3.8613074775931025`*^9, 
   3.8613074777885795`*^9}, {3.8613081272562423`*^9, 
   3.8613081289028378`*^9}, {3.861308322810438*^9, 3.8613083271840477`*^9}, {
   3.8613112002246904`*^9, 3.861311216556595*^9}, {3.8613114922025576`*^9, 
   3.861311503558399*^9}, {3.8613495588445253`*^9, 3.8613495680041623`*^9}, {
   3.861771726422203*^9, 3.8617717316126337`*^9}, {3.861771940756794*^9, 
   3.8617720204448843`*^9}, {3.8617720572685504`*^9, 
   3.8617720585880194`*^9}, {3.8617721326043015`*^9, 3.861772132668131*^9}, 
   3.8617727105005026`*^9, {3.861772849487104*^9, 3.861772878811123*^9}, {
   3.861773076062848*^9, 3.861773110602499*^9}, 3.8617731609699306`*^9, {
   3.8617732061478586`*^9, 3.8617732061847596`*^9}, {3.861773919153811*^9, 
   3.8617739573319206`*^9}, {3.861774059736864*^9, 3.861774065345543*^9}, {
   3.861774532160903*^9, 3.8617745464975157`*^9}, {3.8617815438360786`*^9, 
   3.861781544273907*^9}, {3.862391488726127*^9, 3.862391492751165*^9}, {
   3.8623915790858073`*^9, 3.8623916310062866`*^9}, {3.8623916612614183`*^9, 
   3.862391828597879*^9}, {3.8623918992067237`*^9, 3.862391900039595*^9}, {
   3.8623919471744013`*^9, 3.8623919472701454`*^9}, {3.8623921230622816`*^9, 
   3.862392130934251*^9}, {3.8623923652390213`*^9, 3.862392370950776*^9}, {
   3.8623925971155024`*^9, 3.8623926023279448`*^9}, {3.8623926332326727`*^9, 
   3.862392657902294*^9}, {3.8623928646386037`*^9, 3.8623928870621223`*^9}, {
   3.8623932616552277`*^9, 3.8623932813104615`*^9}, {3.862395075234133*^9, 
   3.862395167699254*^9}, {3.862395548588056*^9, 3.8623955497964783`*^9}, {
   3.8623957525977783`*^9, 3.8623957560361347`*^9}, {3.8623958068603354`*^9, 
   3.862395807043871*^9}, 3.862395978766488*^9, {3.862396009925124*^9, 
   3.8623960117566*^9}, {3.8623962325889378`*^9, 3.862396243347272*^9}, {
   3.862396321212409*^9, 3.862396321771965*^9}, 3.862396392747221*^9, {
   3.862396436156452*^9, 3.8623964366363063`*^9}, {3.8623966473641777`*^9, 
   3.8623966479715753`*^9}, {3.8655331072405663`*^9, 3.865533113048978*^9}, {
   3.8655332633295693`*^9, 3.865533263604888*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[134]:=",ExpressionUUID->"a6a8b7ee-ea94-47bb-a4c5-ef5acbda0c3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "sigm", ",", "vmod", ",", "n", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",",
     "Tsim2", ",", "streQ", ",", "rho", ",", "k", ",", "h", ",", "mu", ",", 
    "aN0", ",", "bN0", ",", "iniN", ",", "iniD", ",", "\[Beta]N", ",", 
    "\[Beta]D", ",", "\[Beta]R", ",", "gamN", ",", "gamD", ",", "gamS", ",", 
    "gamR", ",", "pR", ",", "pS", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", 
    "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", "cisQ", ",", "Tste", ",",
     "clmp"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ivar", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"msht0", "=", "1"}], ",", 
       RowBox[{"perQ0", "=", "False"}], ",", 
       RowBox[{"persQ0", "=", "True"}], ",", 
       RowBox[{"lloydQ0", "=", "True"}], ",", 
       RowBox[{"mshn0", "=", "0"}], ",", 
       RowBox[{"lliter0", "=", "50"}], ",", 
       RowBox[{"randQ0", "=", "False"}], ",", 
       RowBox[{"seed0", "=", "1"}], ",", 
       RowBox[{"fitQ0", "=", "False"}], ",", 
       RowBox[{"sorc0", "=", "\"\<data_fixed_1\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"plotperQ0", "=", "False"}], ",", 
       RowBox[{"plotcoeffvQ0", "=", "False"}], ",", 
       RowBox[{"plotSOPnQ0", "=", "False"}], ",", 
       RowBox[{"plotSOPdQ0", "=", "False"}], ",", 
       RowBox[{"plotsolQ0", "=", "False"}], ",", 
       RowBox[{"plotSOPQ0", "=", "False"}], ",", 
       RowBox[{"plottimeQ0", "=", "False"}], ",", 
       RowBox[{"dlthresh0", "=", "0.3"}], ",", 
       RowBox[{"stats0", "=", "False"}], ",", 
       RowBox[{"allplotsQ0", "=", "False"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"allexpQ0", "=", "False"}], ",", 
       RowBox[{"msimn0", "=", "1"}], ",", 
       RowBox[{"sigm0", "=", "1"}], ",", 
       RowBox[{"sigr0", "=", "2"}], ",", 
       RowBox[{"vmod0", "=", "False"}], ",", 
       RowBox[{"vormod0", "=", "False"}], ",", 
       RowBox[{"smod0", "=", "True"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"ka0", "=", "10"}], "Input"], 
       StyleBox[",", "Input"], 
       RowBox[{"gamc0", "=", "0.01"}], ",", 
       RowBox[{"\[CapitalLambda]0", "=", "0.025"}], ",", 
       RowBox[{"\[Eta]0", "=", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"d\[Eta]0", "=", "0.1"}], ",", 
       RowBox[{"a0e0", "=", "1"}], ",", 
       RowBox[{"d\[Kappa]0", "=", "1"}], ",", 
       RowBox[{"diamx0", "=", "1.24081"}], ",", 
       RowBox[{"depQ0", "=", "False"}], ",", 
       StyleBox[
        RowBox[{"ka20", "=", "ka0"}], "Input"], 
       StyleBox[",", "Input"], 
       RowBox[{"gamc20", "=", "gamc0"}], ",", 
       RowBox[{"\[CapitalLambda]20", "=", "\[CapitalLambda]0"}], ",", 
       RowBox[{"a0e20", "=", "a0e0"}], ",", 
       RowBox[{"d\[Kappa]20", "=", "d\[Kappa]0"}], ",", 
       RowBox[{"diamx20", "=", "diamx0"}], ",", 
       StyleBox[
        RowBox[{"ka30", "=", "ka0"}], "Input"], 
       StyleBox[",", "Input"], 
       RowBox[{"gamc30", "=", "gamc0"}], ",", 
       RowBox[{"\[CapitalLambda]30", "=", "\[CapitalLambda]0"}], ",", 
       RowBox[{"a0e30", "=", "a0e0"}], ",", 
       RowBox[{"d\[Kappa]30", "=", "d\[Kappa]0"}], ",", 
       RowBox[{"diamx30", "=", "diamx0"}], ",", 
       RowBox[{"treshT10", "=", "0.15"}], ",", 
       RowBox[{"treshT20", "=", 
        RowBox[{
         RowBox[{"N", "@", "10"}], "^", 
         RowBox[{"-", "4"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"n0", "=", "20"}], ",", 
       RowBox[{"nx0", "=", "10"}], ",", 
       RowBox[{"ny0", "=", "10"}], ",", 
       RowBox[{"dmx0", "=", "1"}], ",", 
       RowBox[{"dmy0", "=", ".75"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Tvf0", "=", "100"}], ",", 
       RowBox[{"Tsimf0", "=", "30"}], ",", 
       RowBox[{"Tmax0", "=", "100"}], ",", 
       RowBox[{"Tsim0", "=", "0"}], ",", 
       RowBox[{"Tsim20", "=", "0"}], ",", 
       RowBox[{"sigs0", "=", "2.5"}], ",", 
       RowBox[{"ss10", "=", "1"}], ",", 
       RowBox[{"streQ0", "=", "False"}], ",", 
       RowBox[{"stet0", "=", "1"}], ",", 
       RowBox[{"arfixQ0", "=", "True"}], ",", 
       RowBox[{"stretNQ0", "=", "False"}], ",", 
       RowBox[{"stretN0", "=", "1"}], ",", 
       RowBox[{"Trele0", "=", "10"}], ",", 
       RowBox[{"Thold0", "=", "200"}], ",", 
       RowBox[{"sigallQ0", "=", "True"}], ",", 
       RowBox[{"stetbQ0", "=", "False"}], ",", 
       RowBox[{"bthk0", "=", "0.5"}], ",", 
       RowBox[{"Tstei0", "=", "25"}], ",", 
       RowBox[{"Tstef0", "=", "75"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fareaQ0", "=", "True"}], ",", 
       RowBox[{"fperQ0", "=", "True"}], ",", 
       RowBox[{"fltensQ0", "=", "True"}], ",", 
       RowBox[{"fhookeQ0", "=", "False"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rho0", "=", "1"}], ",", 
       RowBox[{"k0", "=", "4"}], ",", 
       RowBox[{"h0", "=", "4"}], ",", 
       RowBox[{"mu0", "=", "1"}], ",", 
       RowBox[{"aN00", "=", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"bN00", "=", "2"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"iniN0", "=", "0.1"}], ",", 
       RowBox[{"iniD0", "=", "0.1"}], ",", 
       RowBox[{"iniR0", "=", "0.1"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Beta]N0", "=", "3.9"}], ",", 
       RowBox[{"\[Beta]D0", "=", "3.9"}], ",", 
       RowBox[{"\[Beta]R0", "=", "194.1"}], ",", 
       RowBox[{"\[Tau]0", "=", "1"}], ",", 
       RowBox[{"\[Kappa]t0", "=", "0.2"}], ",", 
       RowBox[{"\[Kappa]c0", "=", "1"}], ",", 
       RowBox[{"\[Kappa]RS0", "=", "1"}], ",", 
       RowBox[{"m0", "=", "3"}], ",", 
       RowBox[{"p0", "=", "1"}], ",", 
       RowBox[{"l0", "=", "3"}], ",", 
       RowBox[{"cisQ0", "=", "False"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Tste0", "=", "50"}], ",", 
       RowBox[{"stefh0", "=", "1.5"}], ",", 
       RowBox[{"stefv0", "=", 
        RowBox[{"1", "/", "stefh0"}]}], ",", 
       RowBox[{"clmp0", "=", "False"}], ",", " ", 
       RowBox[{"nv0", "=", "2"}], ",", " ", 
       RowBox[{"shpQ0", "=", "False"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"protQ0", "=", "False"}], ",", " ", 
       RowBox[{"inoiseQ0", "=", "False"}], ",", 
       RowBox[{"effvol0", "=", "1000"}], ",", 
       RowBox[{"dynpQ0", "=", "False"}], ",", 
       RowBox[{"uplQ0", "=", "False"}], ",", 
       RowBox[{"pfixQ0", "=", "False"}], ",", 
       RowBox[{"pbt0", "=", "0.6"}], ",", 
       RowBox[{"pdt0", "=", "0.3"}], ",", 
       RowBox[{"pll0", "=", "2.1"}], ",", 
       RowBox[{"pla0", "=", "0"}], ",", 
       RowBox[{"\[Epsilon]0", "=", "0.1"}], ",", 
       RowBox[{"cellQ0", "=", "True"}], ",", 
       RowBox[{"longt0", "=", "2"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"opg0", "=", "True"}], ",", " ", 
       RowBox[{"opv0", "=", "True"}], ",", 
       RowBox[{"ops0", "=", "True"}], ",", 
       RowBox[{"opo0", "=", "False"}], ",", 
       RowBox[{"oposm0", "=", "True"}], ",", 
       RowBox[{"ovmod0", "=", "False"}], ",", 
       RowBox[{"ovormod0", "=", "False"}], ",", 
       RowBox[{"oforce0", "=", "False"}], ",", 
       RowBox[{"ostre0", "=", "False"}], ",", 
       RowBox[{"oparam0", "=", "False"}], ",", 
       RowBox[{"oar0", "=", "False"}], ",", 
       RowBox[{"otiss0", "=", "False"}], ",", 
       RowBox[{"osmod0", "=", "True"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cutcQ0", "=", "False"}], ",", 
       RowBox[{"grQ0", "=", "False"}], ",", 
       RowBox[{"grt0", "=", "1"}], ",", 
       RowBox[{"grT0", "=", "\"\<Minimal\>\""}], ",", 
       RowBox[{"colo10", "=", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{"245", ",", "32", ",", "3"}], "}"}]}], "/", "256"}], 
         "]"}]}], ",", 
       RowBox[{"colom0", "=", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{"27", ",", "143", ",", "8"}], "}"}]}], "/", "256"}], 
         "]"}]}], ",", 
       RowBox[{"colob0", "=", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "/", "256"}], "]"}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mbmt0", "=", ".25"}], ",", 
       RowBox[{"rmb0", "=", "0"}], ",", 
       RowBox[{"mexp0", "=", "False"}], ",", 
       RowBox[{"expsQ0", "=", "True"}], ",", 
       RowBox[{"imgse0", "=", "1"}], ",", 
       RowBox[{"mops0", "=", "False"}], ",", 
       RowBox[{"animQ0", "=", "True"}], ",", 
       RowBox[{"cusnQ0", "=", "False"}], ",", 
       RowBox[{"nmp0", "=", "\"\<\>\""}], ",", 
       RowBox[{"alaQ0", "=", "False"}], ",", 
       RowBox[{"quietQ0", "=", "False"}], ",", 
       RowBox[{"musicQ0", "=", "False"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"plotsQ0", "=", "False"}], ",", 
       RowBox[{"param1Q0", "=", "False"}], ",", 
       RowBox[{"param1nr0", "=", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"param1", ",", "param1min", ",", "param1max", ",", "param1inc"}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"param1", "[", "j", "]"}], "=", 
        RowBox[{"vparams", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"param1min", "[", "j", "]"}], "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"param1max", "[", "j", "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"param1inc", "[", "j", "]"}], "=", "0.1"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "@", "vparams"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ivard", "=", 
     RowBox[{"{", 
      RowBox[{
      "msht0", ",", "perQ0", ",", "persQ0", ",", "lloydQ0", ",", "mshn0", ",",
        "lliter0", ",", "randQ0", ",", "seed0", ",", "fitQ0", ",", "sorc0", 
       ",", "plotperQ0", ",", "plotcoeffvQ0", ",", "plotSOPnQ0", ",", 
       "plotSOPdQ0", ",", "plotsolQ0", ",", "plotSOPQ0", ",", "plottimeQ0", 
       ",", "dlthresh0", ",", "msimn0", ",", "sigm0", ",", "sigr0", ",", 
       "vmod0", ",", "vormod0", ",", "smod0", ",", "ka0", ",", "gamc0", ",", 
       "\[CapitalLambda]0", ",", "\[Eta]0", ",", "d\[Eta]0", ",", "a0e0", ",",
        "d\[Kappa]0", ",", "diamx0", ",", "depQ0", ",", "ka20", ",", "gamc20",
        ",", "\[CapitalLambda]20", ",", "a0e20", ",", "d\[Kappa]20", ",", 
       "diamx20", ",", "ka30", ",", "gamc30", ",", "\[CapitalLambda]30", ",", 
       "a0e30", ",", "d\[Kappa]30", ",", "diamx30", ",", "treshT10", ",", 
       "treshT20", ",", "n0", ",", "nx0", ",", "ny0", ",", "dmx0", ",", 
       "dmy0", ",", "Tvf0", ",", "Tsimf0", ",", "Tmax0", ",", "Tsim0", ",", 
       "Tsim20", ",", "sigs0", ",", "ss10", ",", "streQ0", ",", "stet0", ",", 
       "arfixQ0", ",", "stretNQ0", ",", "stretN0", ",", "Trele0", ",", 
       "Thold0", ",", "sigallQ0", ",", "stetbQ0", ",", "bthk0", ",", "Tstei0",
        ",", "Tstef0", ",", "fareaQ0", ",", "fperQ0", ",", "fltensQ0", ",", 
       "fhookeQ0", ",", "rho0", ",", "k0", ",", "h0", ",", "mu0", ",", "aN00",
        ",", "bN00", ",", "iniN0", ",", "iniD0", ",", "iniR0", ",", 
       "\[Beta]N0", ",", "\[Beta]D0", ",", "\[Beta]R0", ",", "\[Tau]0", ",", 
       "\[Kappa]t0", ",", "\[Kappa]c0", ",", "\[Kappa]RS0", ",", "m0", ",", 
       "p0", ",", "l0", ",", "cisQ0", ",", "Tste0", ",", "stefh0", ",", 
       "stefv0", ",", "clmp0", ",", "nv0", ",", "shpQ0", ",", "protQ0", ",", 
       "inoiseQ0", ",", "effvol0", ",", "dynpQ0", ",", "uplQ0", ",", "pfixQ0",
        ",", "pbt0", ",", "pdt0", ",", "pll0", ",", "pla0", ",", 
       "\[Epsilon]0", ",", "cellQ0", ",", "longt0", ",", "cutcQ0", ",", 
       "grQ0", ",", "grt0", ",", "grT0", ",", "colo10", ",", "colom0", ",", 
       "colob0", ",", "mbmt0", ",", "rmb0"}], "}"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.833613701945804*^9, 3.83361398897407*^9}, {
   3.833614235613803*^9, 3.833614237841191*^9}, {3.8336142718181047`*^9, 
   3.8336142725553045`*^9}, {3.8336148252523766`*^9, 
   3.8336148277269573`*^9}, {3.8336157708997545`*^9, 
   3.8336157912977223`*^9}, {3.833618350873502*^9, 3.833618350957679*^9}, {
   3.833620810518256*^9, 3.8336208192513065`*^9}, {3.8336209857847986`*^9, 
   3.833620985830799*^9}, {3.8336213595793295`*^9, 3.833621364040515*^9}, {
   3.833621408503622*^9, 3.8336214085426397`*^9}, {3.833873702320794*^9, 
   3.833873703034141*^9}, {3.8338757180175266`*^9, 3.833875718107629*^9}, {
   3.8339697408914137`*^9, 3.833969740932291*^9}, {3.833982623608012*^9, 
   3.833982629606011*^9}, {3.8339830800829744`*^9, 3.8339830803972473`*^9}, {
   3.8339833514175606`*^9, 3.833983394905012*^9}, {3.833983533034093*^9, 
   3.833983536556053*^9}, {3.8340471736197834`*^9, 3.8340471784482193`*^9}, {
   3.83404942429583*^9, 3.8340494267006702`*^9}, {3.8340498823133664`*^9, 
   3.834049887245916*^9}, {3.8340508009302397`*^9, 3.834050801234394*^9}, {
   3.8340515934159703`*^9, 3.834051599010942*^9}, {3.8340519636134615`*^9, 
   3.834051963694337*^9}, {3.8340523146431046`*^9, 3.834052319022833*^9}, {
   3.8340527936675477`*^9, 3.8340528081100235`*^9}, {3.8340528612788725`*^9, 
   3.8340528622744756`*^9}, {3.834052909725092*^9, 3.8340529325325823`*^9}, {
   3.8340538088020935`*^9, 3.8340538168289037`*^9}, {3.834054307743408*^9, 
   3.8340543089547863`*^9}, {3.8340546935964575`*^9, 
   3.8340546966898756`*^9}, {3.8340596564999833`*^9, 
   3.8340596683402557`*^9}, {3.8340666847245555`*^9, 3.83406668823781*^9}, {
   3.834067390125499*^9, 3.834067396269125*^9}, {3.8340681369903975`*^9, 
   3.8340681370435205`*^9}, {3.8340696356077023`*^9, 3.834069649340845*^9}, {
   3.8340699132963495`*^9, 3.834069932010493*^9}, {3.834146376383572*^9, 
   3.834146396604929*^9}, {3.834146453535523*^9, 3.8341464540989237`*^9}, {
   3.834213728401406*^9, 3.834213728518221*^9}, {3.8342146740036216`*^9, 
   3.8342146744416795`*^9}, {3.834226562775124*^9, 3.8342265672375803`*^9}, {
   3.8342281414363813`*^9, 3.834228141870566*^9}, {3.834228694555141*^9, 
   3.834228698696982*^9}, {3.8342288302860994`*^9, 3.8342288304585476`*^9}, {
   3.8342291663537188`*^9, 3.8342291664224586`*^9}, {3.8342294713472176`*^9, 
   3.834229473652663*^9}, {3.834230083663335*^9, 3.8342300874920425`*^9}, {
   3.834230268435435*^9, 3.8342302687395983`*^9}, {3.83423208196797*^9, 
   3.8342320888220944`*^9}, {3.83447808077557*^9, 3.834478081003316*^9}, {
   3.834494581833644*^9, 3.834494589784587*^9}, {3.8344946469930763`*^9, 
   3.834494647238792*^9}, {3.834497668933395*^9, 3.8344976903694563`*^9}, {
   3.834499074469654*^9, 3.8344990778931637`*^9}, {3.834516927958441*^9, 
   3.8345169281177254`*^9}, {3.8345524696046066`*^9, 
   3.8345524698999453`*^9}, {3.8345535688616714`*^9, 
   3.8345536234721346`*^9}, {3.8345576173692937`*^9, 3.834557634731095*^9}, {
   3.834557666214793*^9, 3.834557692512986*^9}, {3.83455899667303*^9, 
   3.8345589971730843`*^9}, {3.834559396279958*^9, 3.834559396355217*^9}, {
   3.834559442458927*^9, 3.8345594425411825`*^9}, {3.834655720323325*^9, 
   3.834655721184144*^9}, {3.8346629164951515`*^9, 3.834662916562827*^9}, {
   3.83466651851674*^9, 3.8346665275281224`*^9}, 3.834666747992565*^9, {
   3.834666915395537*^9, 3.83466693203887*^9}, {3.8346680081267357`*^9, 
   3.8346680086535892`*^9}, {3.8347371500346055`*^9, 3.834737153977415*^9}, {
   3.834739968561129*^9, 3.8347399702216873`*^9}, 3.834740225907268*^9, {
   3.8347409769619317`*^9, 3.8347409854553022`*^9}, {3.8347425805705166`*^9, 
   3.83474258458585*^9}, {3.8347426975043063`*^9, 3.8347426979511175`*^9}, {
   3.8347433354451747`*^9, 3.8347433358351994`*^9}, {3.83474383686895*^9, 
   3.834743848564592*^9}, {3.834746571817152*^9, 3.834746575670967*^9}, {
   3.8350951993835917`*^9, 3.835095273322731*^9}, 3.8351043113630114`*^9, 
   3.8351046536594014`*^9, {3.8352610992407427`*^9, 3.8352610996986923`*^9}, {
   3.835270906875908*^9, 3.8352709095297775`*^9}, {3.835271305536008*^9, 
   3.83527131619904*^9}, {3.835271420726604*^9, 3.8352714248724775`*^9}, {
   3.835283924751608*^9, 3.83528395146848*^9}, 3.8352839966185284`*^9, 
   3.8352840322098727`*^9, {3.8352843991958466`*^9, 3.835284408032775*^9}, {
   3.8353533118305216`*^9, 3.835353316053424*^9}, {3.8353537007438135`*^9, 
   3.8353537653785257`*^9}, 3.835353828238839*^9, {3.835358435547664*^9, 
   3.8353584359823785`*^9}, 3.835359605725916*^9, {3.8353597566399145`*^9, 
   3.8353597656808496`*^9}, 3.835430581980425*^9, {3.8354306685926437`*^9, 
   3.8354306699942064`*^9}, {3.8354309542942743`*^9, 
   3.8354309762617893`*^9}, {3.8354313025122447`*^9, 
   3.8354313057876196`*^9}, {3.8354314465980573`*^9, 
   3.8354314524738207`*^9}, {3.8354316401787724`*^9, 
   3.8354316411760187`*^9}, {3.835443978046156*^9, 3.8354439982178974`*^9}, {
   3.8354455011921167`*^9, 3.8354455016982083`*^9}, {3.835446297930678*^9, 
   3.8354462984195147`*^9}, {3.835446547551894*^9, 3.835446573414565*^9}, {
   3.8354466070717115`*^9, 3.8354466074455433`*^9}, {3.8354497747281623`*^9, 
   3.835449780152651*^9}, {3.8354498832279773`*^9, 3.835449902832533*^9}, {
   3.835451540043502*^9, 3.8354515404175014`*^9}, {3.835693369167514*^9, 
   3.8356933813361163`*^9}, {3.835693519893357*^9, 3.835693531967698*^9}, {
   3.8356967755830774`*^9, 3.835696830728726*^9}, {3.83569686815567*^9, 
   3.835696941307515*^9}, {3.835698030121196*^9, 3.835698030196993*^9}, {
   3.8356981669859743`*^9, 3.8356981729879265`*^9}, {3.8356982278304896`*^9, 
   3.8356982352286253`*^9}, {3.835698287230796*^9, 3.8356982902068396`*^9}, {
   3.835698554747334*^9, 3.835698556474742*^9}, {3.835698597932155*^9, 
   3.835698599131948*^9}, {3.8357005656847677`*^9, 3.835700582071654*^9}, {
   3.8357074719076138`*^9, 3.8357074735086393`*^9}, {3.8357739201926575`*^9, 
   3.8357739251691365`*^9}, {3.8357774071433644`*^9, 
   3.8357774080559196`*^9}, {3.83578147714968*^9, 3.8357814772394404`*^9}, {
   3.835791342917622*^9, 3.835791343859105*^9}, {3.8358578548316975`*^9, 
   3.835857857601368*^9}, {3.835857948367807*^9, 3.835857948711887*^9}, {
   3.835860307062233*^9, 3.835860307415289*^9}, {3.8358627277148714`*^9, 
   3.8358627281727133`*^9}, {3.835863179191161*^9, 3.8358631838869114`*^9}, {
   3.835864167759437*^9, 3.83586416783523*^9}, 3.8358642111100297`*^9, {
   3.8358670601064997`*^9, 3.835867085134075*^9}, 3.83586749178552*^9, {
   3.835891256184434*^9, 3.835891268890874*^9}, {3.835891902437852*^9, 
   3.835891918924689*^9}, {3.835892007715266*^9, 3.8358920077880716`*^9}, {
   3.8358920405348816`*^9, 3.835892040622647*^9}, {3.8362923480019464`*^9, 
   3.8362923588965707`*^9}, {3.8362947426212163`*^9, 3.836294743291597*^9}, {
   3.8362947793083324`*^9, 3.836294779682743*^9}, {3.836295274661329*^9, 
   3.836295309624961*^9}, {3.8362964180203056`*^9, 3.836296419556593*^9}, {
   3.836299920061384*^9, 3.836299936518812*^9}, {3.8363092130274005`*^9, 
   3.83630921757526*^9}, {3.8363112450599613`*^9, 3.836311255136986*^9}, {
   3.8363161971178284`*^9, 3.8363161999470825`*^9}, {3.836371705202237*^9, 
   3.8363717067047577`*^9}, {3.8363717754753447`*^9, 3.83637178840107*^9}, {
   3.8363800675728087`*^9, 3.836380072919626*^9}, {3.8365007729754763`*^9, 
   3.836500792198325*^9}, {3.8365654712821236`*^9, 3.8365654902362394`*^9}, {
   3.8365694824117947`*^9, 3.836569496506383*^9}, {3.8365720490246983`*^9, 
   3.836572050440385*^9}, {3.8369094038844423`*^9, 3.836909410458805*^9}, {
   3.836912054131237*^9, 3.836912055372033*^9}, {3.8369884299006557`*^9, 
   3.8369884682662563`*^9}, {3.8370763489953985`*^9, 
   3.8370763664708443`*^9}, {3.83707645024841*^9, 3.83707646351862*^9}, {
   3.837085445043501*^9, 3.8370854734112267`*^9}, {3.837092422815632*^9, 
   3.8370924232804613`*^9}, {3.837622721887528*^9, 3.8376227246521535`*^9}, {
   3.8378563800736537`*^9, 3.8378563806297474`*^9}, 3.8378574496800904`*^9, {
   3.8378614856691556`*^9, 3.837861486065097*^9}, {3.837861545147838*^9, 
   3.837861558653538*^9}, {3.837863465189231*^9, 3.8378635262852488`*^9}, {
   3.8378641683597827`*^9, 3.8378641688392854`*^9}, {3.8387050305000353`*^9, 
   3.8387050308550863`*^9}, {3.838706463855117*^9, 3.838706465877676*^9}, {
   3.838741527452344*^9, 3.838741538350554*^9}, {3.8387420365354414`*^9, 
   3.838742036592289*^9}, {3.838819723641822*^9, 3.838819723725419*^9}, {
   3.8389674189718275`*^9, 3.838967419069566*^9}, {3.8389675256567135`*^9, 
   3.838967526246137*^9}, {3.8389759830907536`*^9, 3.838975983349063*^9}, {
   3.8389786470650735`*^9, 3.8389786473772383`*^9}, {3.839486544384757*^9, 
   3.8394865486295652`*^9}, {3.839489482058262*^9, 3.8394895059381323`*^9}, {
   3.839489948044818*^9, 3.83948995031143*^9}, {3.8395851843965397`*^9, 
   3.839585201509128*^9}, {3.839585542699244*^9, 3.8395855427630377`*^9}, {
   3.839758069687951*^9, 3.839758118563862*^9}, {3.839759804573451*^9, 
   3.8397598093088217`*^9}, {3.8397602793296185`*^9, 
   3.8397602832335253`*^9}, {3.8397604531579447`*^9, 3.839760482764146*^9}, {
   3.8397613440738525`*^9, 3.839761365856327*^9}, {3.839762142375085*^9, 
   3.839762164885089*^9}, {3.840089020441456*^9, 3.8400890204444475`*^9}, {
   3.840089070158016*^9, 3.840089105276985*^9}, {3.8400893372966094`*^9, 
   3.8400893735904045`*^9}, {3.8400899620604577`*^9, 3.840089982711364*^9}, {
   3.8400927200272217`*^9, 3.84009273305063*^9}, {3.8400927808442497`*^9, 
   3.840092781426692*^9}, {3.8400950980486603`*^9, 3.840095103428732*^9}, {
   3.8401113368189774`*^9, 3.8401113505357447`*^9}, {3.840111816481741*^9, 
   3.8401118225395455`*^9}, {3.8401119943705845`*^9, 3.840111995037902*^9}, {
   3.8401840645765395`*^9, 3.84018408289375*^9}, 3.840188206521964*^9, {
   3.8401883140417485`*^9, 3.8401883385930643`*^9}, {3.840209617913247*^9, 
   3.840209622411786*^9}, {3.840210449074933*^9, 3.8402104491372786`*^9}, {
   3.84021563820129*^9, 3.8402156382780685`*^9}, {3.84052512013004*^9, 
   3.840525123963476*^9}, {3.84052522136523*^9, 3.840525230690258*^9}, {
   3.840525269282154*^9, 3.840525271051919*^9}, {3.840527986198336*^9, 
   3.8405280124769487`*^9}, {3.840530969847911*^9, 3.8405309727184105`*^9}, {
   3.840619271089164*^9, 3.8406192817668695`*^9}, {3.840619404071082*^9, 
   3.840619424124716*^9}, {3.84062091727948*^9, 3.8406209176761913`*^9}, {
   3.8406210153991385`*^9, 3.8406210167897835`*^9}, {3.8406246130250206`*^9, 
   3.8406246207440553`*^9}, {3.8406254702326307`*^9, 
   3.8406254706817107`*^9}, {3.8407104417386613`*^9, 3.840710441810469*^9}, {
   3.8408066901361036`*^9, 3.8408066956963167`*^9}, {3.840861567093482*^9, 
   3.8408615672071776`*^9}, {3.840871598529461*^9, 3.840871598603263*^9}, {
   3.8416604034852123`*^9, 3.8416604538409405`*^9}, {3.841743629119011*^9, 
   3.841743631680665*^9}, {3.8417440055704746`*^9, 3.8417440288558893`*^9}, {
   3.841745229260081*^9, 3.841745229917818*^9}, {3.8426017587919736`*^9, 
   3.8426017591639805`*^9}, {3.8432919357997026`*^9, 3.843291948276682*^9}, {
   3.8434695260996327`*^9, 3.8434695449214864`*^9}, {3.8434697026306467`*^9, 
   3.8434697027075386`*^9}, {3.843472887043269*^9, 3.8434728971859965`*^9}, {
   3.8434730697124605`*^9, 3.84347307414774*^9}, {3.843474725388688*^9, 
   3.843474727383452*^9}, {3.843474903436799*^9, 3.843474916237424*^9}, 
   3.843475279414424*^9, {3.8434753173705397`*^9, 3.8434753481357346`*^9}, {
   3.843551638583413*^9, 3.8435516386691837`*^9}, {3.8438961999375916`*^9, 
   3.8438962274160123`*^9}, 3.8438963064906025`*^9, {3.843896431119257*^9, 
   3.8438964772131524`*^9}, {3.843896520911392*^9, 3.8438965286039915`*^9}, {
   3.8438970460356197`*^9, 3.8438970464764404`*^9}, 3.8439096216347685`*^9, 
   3.843909654093378*^9, {3.8439134784367723`*^9, 3.843913482190895*^9}, {
   3.8447696386097527`*^9, 3.844769649959097*^9}, {3.8447696813085012`*^9, 
   3.8447696938259473`*^9}, {3.844769837417121*^9, 3.8447698376883955`*^9}, {
   3.8447703635443845`*^9, 3.8447703646793747`*^9}, {3.8447708264250345`*^9, 
   3.844770896609022*^9}, {3.8447716659670553`*^9, 3.844771677635856*^9}, {
   3.8447757592364035`*^9, 3.844775759253359*^9}, {3.844792870054718*^9, 
   3.8447928701105685`*^9}, {3.8453794787412243`*^9, 
   3.8453795135890765`*^9}, {3.8454612720196943`*^9, 
   3.8454612720877295`*^9}, {3.8454656346583395`*^9, 3.845465642743924*^9}, {
   3.845465745260394*^9, 3.8454657606995535`*^9}, {3.845472638435542*^9, 
   3.8454726773693066`*^9}, {3.8456361784348087`*^9, 3.845636189501588*^9}, {
   3.8456386161040354`*^9, 3.8456386311547813`*^9}, 3.8456436830093284`*^9, {
   3.8456578648752136`*^9, 3.845658058334526*^9}, 3.8456586128194323`*^9, 
   3.84565875136047*^9, {3.8459194186684933`*^9, 3.8459194187303314`*^9}, {
   3.8559041049238997`*^9, 3.855904131092378*^9}, {3.855909373080595*^9, 
   3.8559093875733323`*^9}, {3.8560052343276243`*^9, 
   3.8560052518223267`*^9}, {3.8560058054733405`*^9, 
   3.8560058126229362`*^9}, {3.8560076712942476`*^9, 3.856007671870705*^9}, {
   3.856008049882287*^9, 3.856008071991167*^9}, {3.856518676868263*^9, 
   3.8565186769292397`*^9}, {3.856520975053296*^9, 3.856520975164998*^9}, {
   3.857032713336281*^9, 3.8570327230649843`*^9}, {3.8570336881967187`*^9, 
   3.8570337798354754`*^9}, {3.8570433039045987`*^9, 3.857043303992364*^9}, {
   3.857047198575676*^9, 3.8570472045995655`*^9}, {3.8570473028869467`*^9, 
   3.8570473643434644`*^9}, {3.857050141319111*^9, 3.857050153694338*^9}, {
   3.857642527242549*^9, 3.8576425629358664`*^9}, {3.862133773757099*^9, 
   3.862133829580801*^9}, {3.8623047584466057`*^9, 3.862304763152019*^9}, {
   3.864721929516572*^9, 3.864721939259167*^9}, {3.86472232120877*^9, 
   3.864722340692531*^9}, {3.864723693025879*^9, 3.864723693141569*^9}, {
   3.8654295837277994`*^9, 3.8654295838255377`*^9}, {3.86552702801997*^9, 
   3.8655270384263945`*^9}, {3.865527742644017*^9, 3.8655277431049933`*^9}, {
   3.866981923030654*^9, 3.866981928828367*^9}, {3.880658771980117*^9, 
   3.880658778060775*^9}, {3.880658994876997*^9, 3.8806590013159*^9}, {
   3.8806592474960203`*^9, 3.8806592480186224`*^9}, {3.8806593344017177`*^9, 
   3.8806593347379313`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[135]:=",ExpressionUUID->"aa9894db-8484-4180-bc9b-4a044ba673f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Control grid", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.834232073581686*^9, 
   3.8342320746896152`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"8f686246-3ffb-4968-9947-c6f97814a846"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "5"}], ";", 
  RowBox[{"s2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "cont", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";", 
  RowBox[{
   RowBox[{"cont", "[", 
    RowBox[{
    "msht_", ",", "perQ_", ",", "persQ_", ",", "lloydQ_", ",", "mshn_", ",", 
     "lliter_", ",", "randQ_", ",", "seed_", ",", "fitQ_", ",", "sorc_", ",", 
     "plotperQ_", ",", "plotcoeffvQ_", ",", "plotSOPnQ_", ",", "plotSOPdQ_", 
     ",", "plotsolQ_", ",", "plotSOPQ_", ",", "plottimeQ_", ",", "dlthresh_", 
     ",", "stats_", ",", "allplotsQ_", ",", "allexpQ_", ",", "msimn_", ",", 
     "sigm_", ",", "sigr_", ",", "vmod_", ",", "vormod_", ",", "smod_", ",", 
     StyleBox["ka_", "Input"], 
     StyleBox[",", "Input"], "gamc_", ",", "\[CapitalLambda]_", ",", 
     "\[Eta]_", ",", "d\[Eta]_", ",", "a0e_", ",", "d\[Kappa]_", ",", 
     "diamx_", ",", "depQ_", ",", 
     StyleBox["ka2_", "Input"], 
     StyleBox[",", "Input"], "gamc2_", ",", "\[CapitalLambda]2_", ",", 
     "a0e2_", ",", "d\[Kappa]2_", ",", "diamx2_", ",", 
     StyleBox["ka3_", "Input"], 
     StyleBox[",", "Input"], "gamc3_", ",", "\[CapitalLambda]3_", ",", 
     "a0e3_", ",", "d\[Kappa]3_", ",", "diamx3_", ",", "treshT1_", ",", 
     "treshT2_", ",", 
     RowBox[{
      StyleBox["(*", "Input"], 
      RowBox[{
      "gam_", ",", "P0_", ",", "\[Eta]_", ",", "\[CapitalLambda]_", ","}], 
      "*)"}], "n_", ",", "nx_", ",", "ny_", ",", "dmx_", ",", "dmy_", ",", 
     "Tvf_", ",", "Tsimf_", ",", "Tmax_", ",", "Tsim_", ",", "Tsim2_", ",", 
     "sigs_", ",", "ss1_", ",", "streQ_", ",", "stet_", ",", "arfixQ_", ",", 
     "stretNQ_", ",", "stretN_", ",", "Trele_", ",", "Thold_", ",", 
     "sigallQ_", ",", "stetbQ_", ",", "bthk_", ",", "Tstei_", ",", "Tstef_", 
     ",", "fareaQ_", ",", "fperQ_", ",", "fltensQ_", ",", "fhookeQ_", ",", 
     "rho_", ",", "k_", ",", "h_", ",", "mu_", ",", "aN0_", ",", "bN0_", ",", 
     "iniN_", ",", "iniD_", ",", "iniR_", ",", "\[Beta]N_", ",", "\[Beta]D_", 
     ",", "\[Beta]R_", ",", "\[Tau]_", ",", "\[Kappa]t_", ",", "\[Kappa]c_", 
     ",", "\[Kappa]RS_", ",", "m_", ",", "p_", ",", "l_", ",", "cisQ_", ",", 
     "Tste_", ",", "stefh_", ",", "stefv_", ",", "clmp_", ",", "run_", ",", 
     "nv_", ",", "shpQ_", ",", "protQ_", ",", "inoiseQ_", ",", "effvol_", ",",
      "dynpQ_", ",", "uplQ_", ",", "pfixQ_", ",", "pbt_", ",", "pdt_", ",", 
     "pll_", ",", "pla_", ",", "\[Epsilon]_", ",", "cellQ_", ",", "longt_", 
     ",", 
     RowBox[{"(*", "openers", "*)"}], "opg_", ",", "opv_", ",", "ops_", ",", 
     "opo_", ",", "opsm_", ",", "ovmod_", ",", "ovormod_", ",", "oforce_", 
     ",", "ostre_", ",", "oparam_", ",", "oar_", ",", "otiss_", ",", "osmod_",
      ",", "cutcQ_", ",", "grQ_", ",", "grt_", ",", "grT_", ",", "colo1_", 
     ",", "colom_", ",", "colob_", ",", "mbmt_", ",", "rmb_", ",", "mexp_", 
     ",", "expsQ_", ",", "imgse_", ",", "mops_", ",", "animQ_", ",", "cusnQ_",
      ",", "nmp_", ",", "alaQ_", ",", "quietQ_", ",", "musicQ_", ",", 
     "plotsQ_", ",", "param1Q_", ",", "param1_", ",", "param1nr_", ",", 
     "param1min_", ",", "param1max_", ",", "param1inc_"}], "]"}], ":=", 
   RowBox[{"Dynamic", "@", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"tlm2", "@", 
        RowBox[{"fft4", "[", 
         RowBox[{"grid", "=", 
          RowBox[{"addc", "@", 
           RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "GENERAL", " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"hd1", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"opensect", "[", 
                 RowBox[{"\"\<General\>\"", ",", "opg"}], "]"}], ",", 
                "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"opg", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"spc2", ",", "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"msht", "==", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Number of cells\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "n"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"n", "=", 
                    RowBox[{"nx", " ", "ny"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Rows\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "ny"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "20", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Columns\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "nx"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "20", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}]}], ",", 
                    "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]",
                     "Nothing"}], "\[IndentingNewLine]", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Sim. time\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "Tmax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                   "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "}"}]}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]",
              "\[IndentingNewLine]", "spc", ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"hd3", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"opensect", "[", 
                 RowBox[{"\"\<Signalling Model\>\"", ",", "ops"}], "]"}], ",",
                 "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"ops", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"spc2", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Signalling update\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "smod"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"Item", "[", 
                    RowBox[{"openers", "[", "osmod", "]"}], "]"}]}], "*)"}], 
                    "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Right", ",", "Left"}], "}"}], ",", "Center"}], 
                    "}"}]}], ",", 
                    RowBox[{"Spacings", "\[Rule]", "0.1"}]}], "]"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"smod", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Periodic: \>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "persQ"}]}], ",", 
                    "\"\< Always signal: \>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "sigallQ"}]}]}], "}"}]}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"persQ", ",", 
                    RowBox[{"perQ", "=", "True"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Model:\>\"", ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "sigm"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "\[Rule]", "\"\<Collier\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<Sprinzak\>\""}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"2", "\[Rule]", 
                    RowBox[{"ft40", "@", "\"\<Shaya\>\""}]}]}], "*)"}], 
                    "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Signal region:\>\"", ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "sigr"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "\[Rule]", "\"\<Entire tissue\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Inner tissue\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<Double-stripe\>\""}]}], 
                    "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Show:\>\"", ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigm", "=!=", "2"}], ",", 
                    RowBox[{"nv", "=", "2"}]}], "]"}], ";"}], "*)"}], 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "nv"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Notch\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Delta\>\""}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigm", "=!=", "0"}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Repressor\>\""}], ",", 
                    "Nothing"}], "]"}]}], "}"}]}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "}"}]}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "\[Equal]", "1"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Stripe 1 start\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "Tsim"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Stripe 2 start\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "Tsim2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Stripe 1\>\"", ",", 
                    RowBox[{"IntervalSlider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "Ts1", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Stop\>\""}], ",", 
                    RowBox[{"Appearance", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<ThumbAppearance\>\"", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "Ts1", "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "col1"}]}], "]"}], "]"}],
                     ",", "None", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "Ts1", "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "col1"}]}], "]"}], 
                    "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Stripe 2\>\"", ",", 
                    RowBox[{"IntervalSlider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "Ts2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Stop\>\""}], ",", 
                    RowBox[{"Appearance", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<ThumbAppearance\>\"", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "Ts2", "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "col1"}]}], "]"}], "]"}],
                     ",", "None", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "Ts2", "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "col1"}]}], "]"}], 
                    "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Spacing\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "sigs"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10", ",", ".1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Signal start\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "Tsim"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"sigallQ", ",", 
                    RowBox[{
                    RowBox[{"Tsimf", "=", 
                    RowBox[{"Tmax", "+", "1"}]}], ";", "Nothing"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Signal end\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "Tsimf"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", "100", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Signal speed\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "ss1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2", ",", ".01"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigm", "=!=", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Contact area\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "shpQ"}]}]}], "}"}], ",", 
                    "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Cis-inhibition\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "cisQ"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"LONG", " ", "RANGE"}], " ", "*)"}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Long-range\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "protQ"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"protQ", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "ft40", "@", 
                    "\"\<\!\(\*SubscriptBox[\(p\), \(\[ScriptL]\)]\)\>\""}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "pll"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}], ",", 
                    RowBox[{
                    "ft40", "@", 
                    "\"\< \!\(\*SubscriptBox[\(p\), \(\[Alpha]\)]\)\>\""}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "pla"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}], ",", 
                    RowBox[{"ft40", "@", "\"\< \[Epsilon]\>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Epsilon]"}], ",", "Number", 
                    ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}],
                     "}"}], "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",",
                     "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"protQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Invisible", "@", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "protQ"}]}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Cell-based\>\""}], ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "cellQ"}]}], ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "longt"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "\[Rule]", "\"\<Area\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<Perimeter\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Diameter\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Dynamic\>\""}], ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "dynpQ"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"dynpQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "ft40", "@", 
                    "\"\<\!\(\*SubscriptBox[\(p\), \(b\)]\)\>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "pbt"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}], ",", 
                    RowBox[{
                    "ft40", "@", 
                    "\"\<\!\(\*SubscriptBox[\(p\), \(d\)]\)\>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "pdt"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", ",", "SpanFromAbove"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"streQ", "||", "vmod"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Update reach\>\""}], ",", 
                    RowBox[{"Checkbox", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "uplQ"}], ",", 
                    RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"pfixQ", "==", "False"}]}]}], "]"}], ",", 
                    "SpanFromAbove"}], "}"}], ",", "Nothing"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"streQ", "||", "vmod"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Fix initial\>\""}], ",", 
                    RowBox[{"Checkbox", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "pfixQ"}], ",", 
                    RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"uplQ", "==", "False"}]}]}], "]"}], ",", 
                    "SpanFromAbove"}], "}"}], ",", "Nothing"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Right", ",", "Left"}], "}"}], 
                    "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}]}]}], "}"}], ",", "Nothing"}],
                     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigm", "==", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Int. noise\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "inoiseQ"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"inoiseQ", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Effective volume: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "effvol"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"1.5", "s2"}]}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}],
                     "}"}], "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"inoiseQ", "=", "False"}], ";", "Nothing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"\"\<Parameters\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "oparam", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{"oparam", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "Which", "[", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"COLLIER", " ", "PARAMS"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"sigm", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"resm", "@", 
                    RowBox[{"tlm", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<k\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "k"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<h\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "h"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Rho]\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "rho"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Mu]\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "mu"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(a\), \(N0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "aN0"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(b\), \(N0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "bN0"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"INIT", " ", "COND"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniN"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(D\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniD"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                    "\[IndentingNewLine]", "}"}]}]}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"SPRINZAK", " ", "PARAMS"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"sigm", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"tlm", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(N\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]N"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(D\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]D"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(R\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]R"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Tau]\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Tau]"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<m\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "m"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<p\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "p"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"INIT", " ", "COND"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniN"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(D\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniD"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(R\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniR"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"INIT", " ", "COND"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Kappa]\), \(RS\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Kappa]RS"}], ",", "Number", 
                    ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"cisQ", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Kappa]\), \(c\)]\)\>\"", ",", 
                    
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Kappa]c"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], 
                    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                    "}"}]}]}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"SHAYA", " ", "PARAMS"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"tlm", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(N\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]N"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(D\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]D"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(R\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Beta]R"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Kappa]\), \(t\)]\)\>\"", ",", 
                    
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "\[Kappa]t"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<m\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "m"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<l\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "l"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"INIT", " ", "COND"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniN"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(D\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniD"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(R\), \(0\)]\)\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "iniR"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                    "\[IndentingNewLine]", "}"}]}]}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
                    "Nothing"}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "Nothing"}], "]"}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
                    ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
               "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "spc", ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"hd4", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"opensect", "[", 
                 RowBox[{"\"\<Statistics\>\"", ",", "stats"}], "]"}], ",", 
                "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"stats", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"spc2", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Plots\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "plotsQ", "]"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"plotsQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotSOPQ"}]}], ",", 
                    RowBox[{"ft40", "@", "\"\< SOPs\>\""}]}], "}"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotsolQ"}]}], ",", 
                    RowBox[{"ft40", "@", "\"\< Solutions\>\""}]}], "}"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotperQ"}]}], ",", 
                    RowBox[{"ft40", "@", "\"\< Perimeter\>\""}]}], "}"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotcoeffvQ"}]}], ",", 
                    RowBox[{
                    "ft40", "@", "\"\< Coefficient of variation\>\""}]}], 
                    "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotSOPnQ"}]}], ",", 
                    RowBox[{"ft40", "@", "\"\< SOP distance (#)\>\""}]}], 
                    "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plotSOPdQ"}]}], ",", 
                    RowBox[{
                    "ft40", "@", "\"\< SOP distance (Euclidean)\>\""}]}], 
                    "}"}]}]}], "}"}]}], "}"}]}], ",", "Nothing"}], "]"}], ",",
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Track time: \>\""}], ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "plottimeQ"}]}], ",", 
                    RowBox[{"ft40", "@", "\"\< Marker threshold: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "dlthresh"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Seed\>\"", ",", 
                    RowBox[{"Grid", "@", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Random\>\""}], ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "randQ"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "randQ"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Seed\>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "seed"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "Nothing"}], "]"}]}], "}"}], "}"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tissues\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "msimn"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10", ",", "1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Multiple tests\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "param1Q", "]"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"param1Q", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Nr of vars\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "param1nr"}], ",", "Number", ",", 
                    
                    RowBox[{"FieldSize", "->", 
                    RowBox[{"s2", "-", "1"}]}], ",", 
                    RowBox[{"BaseStyle", "->", "11"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vk", "=", "vk"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\< Variable ``: \>\"", ",", "vk"}], "]"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"param1", "[", "vk", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "->", 
                    RowBox[{"ft40", "@", "#"}]}], ")"}], "&"}], "/@", 
                    "vparams"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ft40", "@", "\"\< Min: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"param1min", "[", "vk", "]"}]}], ",", "Number", 
                    ",", 
                    RowBox[{"FieldSize", "->", 
                    RowBox[{"s2", "-", "1"}]}], ",", 
                    RowBox[{"BaseStyle", "->", "11"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ft40", "@", "\"\< Max: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"param1max", "[", "vk", "]"}]}], ",", "Number", 
                    ",", 
                    RowBox[{"FieldSize", "->", 
                    RowBox[{"s2", "-", "1"}]}], ",", 
                    RowBox[{"BaseStyle", "->", "11"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ft40", "@", "\"\< Inc: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"param1inc", "[", "vk", "]"}]}], ",", "Number", 
                    ",", 
                    RowBox[{"FieldSize", "->", "s2"}], ",", 
                    RowBox[{"BaseStyle", "->", "11"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vk", ",", "param1nr"}], "}"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
                    ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"param1Q", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Generate models\>\""}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"param1l", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"param1min", "[", "vk", "]"}], ",", 
                    RowBox[{"param1max", "[", "vk", "]"}], ",", 
                    RowBox[{"param1inc", "[", "vk", "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vk", ",", "param1nr"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"param1ll", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"param1nr", "==", "1"}], ",", 
                    RowBox[{"param1l", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Tuples", "[", "param1l", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"svm", "=", "1"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"param1a", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"varstring", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                    "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                    "fitQ", ",", 
                    RowBox[{"strf", "@", "sorc"}], ",", "plotperQ", ",", 
                    "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", ",", 
                    "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", 
                    "dlthresh", ",", "msimn", ",", "sigm", ",", "sigr", ",", 
                    "vmod", ",", "vormod", ",", "smod", ",", 
                    StyleBox["ka", "Input"], 
                    StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                    ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                    "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                    StyleBox["ka2", "Input"], 
                    StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2",
                     ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                    StyleBox["ka3", "Input"], 
                    StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3",
                     ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                    "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny",
                     ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                    "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
                    "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", 
                    "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",",
                     "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",",
                     "Tstef", ",", "fareaQ", ",", "fperQ", ",", "fltensQ", 
                    ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu",
                     ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
                    ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", 
                    "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                    "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", 
                    "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv",
                     ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
                    "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", 
                    "pfixQ", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", 
                    ",", "\[Epsilon]", ",", "cellQ", ",", "longt", ",", 
                    "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1",
                     ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"svc", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"savel", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"savel", ",", 
                    RowBox[{"ToString", "/@", 
                    RowBox[{"Values", "[", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"param1a", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"param1", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "param1nr"}], "}"}]}], "]"}], "->", 
                    RowBox[{"param1ll", "[", 
                    RowBox[{"[", "vki", "]"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"save", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"save", ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svc", "=", "svc"}], "}"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "2", "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<Model ``\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"svc", ",", "10", ",", "2"}], "]"}]}], "]"}], ",",
                     "ft4"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                    "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                    "fitQ", ",", "sorc", ",", "plotperQ", ",", "plotcoeffvQ", 
                    ",", "plotSOPnQ", ",", "plotSOPdQ", ",", "plotsolQ", ",", 
                    "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
                    "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
                    "vormod", ",", "smod", ",", 
                    StyleBox["ka", "Input"], 
                    StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                    ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                    "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                    StyleBox["ka2", "Input"], 
                    StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2",
                     ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                    StyleBox["ka3", "Input"], 
                    StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3",
                     ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                    "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny",
                     ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                    "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
                    "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", 
                    "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",",
                     "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",",
                     "Tstef", ",", "fareaQ", ",", "fperQ", ",", "fltensQ", 
                    ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu",
                     ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
                    ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", 
                    "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                    "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", 
                    "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv",
                     ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
                    "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", 
                    "pfixQ", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", 
                    ",", "\[Epsilon]", ",", "cellQ", ",", "longt", ",", 
                    "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1",
                     ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], 
                    "}"}], "=", 
                    RowBox[{"ToExpression", "/@", 
                    RowBox[{"savel", "[", 
                    RowBox[{"[", "svc", "]"}], "]"}]}]}], " ", ",", 
                    RowBox[{"Background", "->", "col0"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<\[DownArrow]\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SetDirectory", "[", 
                    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FileExistsQ", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Models\>\""}], "}"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"CreateDirectory", "[", "\"\<Models\>\"", "]"}]}],
                     "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"SetDirectory", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Models\>\""}], "}"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"exportd", "[", 
                    RowBox[{"svc", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"savel", "[", 
                    RowBox[{"[", "svc", "]"}], "]"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Background", "->", "White"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "2", "]"}]}], "}"}]}]}], "]"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"vki", ",", 
                    RowBox[{"Length", "@", "param1ll"}]}], "}"}]}], "]"}], 
                    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
                    
                    RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                    "run"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "]"}]}], "}"}], ",", "Nothing"}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", "Nothing"}], 
              "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "spc",
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"hd5", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Item", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Options\>\"", ",", "ft3"}], "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
                    RowBox[{"ItemSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "3"}], "}"}]}]}], "]"}], ",", 
                  RowBox[{"Item", "[", 
                   RowBox[{
                    RowBox[{"openers", "[", "opo", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Right", ",", "Center"}], "}"}]}]}], "]"}]}], 
                 "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"hd5", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"opensect", "[", 
                 RowBox[{"\"\<Options\>\"", ",", "opo"}], "]"}], ",", 
                "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"opo", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                 "spc2", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Animation\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "animQ"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Custom names\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "cusnQ"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"cusnQ", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Name: \>\""}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "nmp"}], ",", "String", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "16"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], ",", "Nothing"}], "]"}]}], "}"}]}]}], "}"}], ",",
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"msht", "==", "0"}], ",", " ", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Aspect ratio\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "oar", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"oar", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Length\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "dmx"}], ",", 
                    RowBox[{"{", 
                    RowBox[{".1", ",", "1", ",", ".05"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Width\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "dmy"}], ",", 
                    RowBox[{"{", 
                    RowBox[{".1", ",", "1", ",", ".05"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", "Nothing"}],
                     "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                    "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tissue styling\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "otiss", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"otiss", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Cut corners\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "cutcQ"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Show graph\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "grQ"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"grQ", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\< Type: \>\""}], ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "grt"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "->", "\"\<Juxtacrine\>\""}], ",", 
                    RowBox[{"2", "->", "\"\<Long-range\>\""}], ",", 
                    RowBox[{"3", "->", "\"\<All\>\""}]}], "}"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "grT"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Web\>\"", ",", "\"\<Minimal\>\"", ",", 
                    "\"\<Detailed\>\"", ",", "\"\<Business\>\"", ",", 
                    "\"\<Marketing\>\"", ",", "\"\<Scientific\>\"", ",", 
                    "\"\<Monochrome\>\"", ",", "\"\<Classic\>\"", ",", 
                    "\"\<Default\>\"", ",", "\"\<LargeGraph\>\"", ",", 
                    "\"\<ClassicDiagram\>\""}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], ",", "Nothing"}], "]"}]}],
                     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Thickness\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "mbmt"}], ",", 
                    RowBox[{"{", 
                    RowBox[{".01", ",", "1", ",", ".01"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Roundness\>\"", ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "rmb"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", ".1"}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Marker\>\"", ",", 
                    RowBox[{"ColorSlider", "[", 
                    RowBox[{"Dynamic", "@", "colo1"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Membrane\>\"", ",", 
                    RowBox[{"ColorSlider", "[", 
                    RowBox[{"Dynamic", "@", "colom"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Background\>\"", ",", 
                    RowBox[{"ColorSlider", "[", 
                    RowBox[{"Dynamic", "@", "colob"}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
                    ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Export options\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "mexp", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"mexp", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Single folder\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "expsQ"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Video scale\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "imgse"}], ",", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "s2"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", "11"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "}"}]}], ",", "Nothing"}], "]"}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Extras\>\"", ",", 
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"openers", "[", "mops", "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"mops", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Alarm\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "alaQ"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "alaQ"}], ",", 
                    RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Quiet mode\>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "quietQ"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Radio\>\"", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "musicQ"}], ",", 
                    "\"\<\[FilledRightTriangle]\>\"", ",", 
                    "\"\<\[FilledSquare]\>\""}], "]"}], ",", "17", ",", 
                    "col11"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"musicQ", "=", 
                    RowBox[{"!", "musicQ"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FileExistsQ", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Extras\>\"", ",", "\"\<Radio\>\""}], "}"}], "]"}], 
                    "]"}], "&&", 
                    RowBox[{"musiclist", "=!=", 
                    RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"musicQ", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"shf", "=", 
                    RowBox[{"RandomSample", "@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "musiclist"}]}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"musicshf", "=", 
                    RowBox[{"musiclist", "[", 
                    RowBox[{"[", "shf", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"stream", "=", 
                    RowBox[{"AudioStream", "[", 
                    RowBox[{"Audio", "/@", 
                    RowBox[{"mfiles", "[", 
                    RowBox[{"[", "shf", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"aa", "=", 
                    RowBox[{"AudioPlay", "[", "stream", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AudioPause", "[", "stream", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"musicQ", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", 
                    "\"\<Radio error: Extras folder or music files not found.\
\>\"", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "]"}]}], "}"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}]}], ",", "Nothing"}], "]"}]}],
                  "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
               "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"svm", "\[Equal]", "1"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                 "spc", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"hd6", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"opensect", "[", 
                    RowBox[{"\"\<Saved Models\>\"", ",", "opsm"}], "]"}], ",",
                     "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"opsm", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "spc2", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"lf", ",", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", "lf", "]"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"save", ",", 
                    RowBox[{"UpTo", "[", "4", "]"}]}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Item", "[", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<Run All\>\""}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"clear", "[", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"tt0", "=", 
                    RowBox[{"SessionTime", "[", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"modrunQ", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"savela", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"varstring", ",", "#"}], "]"}], "&"}], ",", 
                    "savel"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"coeffvarl", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"verdata", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"alaQ", ",", 
                    RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"data", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"bugQ", "=", "False"}], ";", 
                    RowBox[{"dinll", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"solsl", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"debug", "[", 
                    RowBox[{
                    "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                    "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                    "fitQ", ",", "sorc", ",", "plotperQ", ",", "plotcoeffvQ", 
                    ",", "plotSOPnQ", ",", "plotSOPdQ", ",", "plotsolQ", ",", 
                    "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
                    "stats", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
                    "vormod", ",", "smod", ",", 
                    StyleBox["ka", "Input"], 
                    StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                    ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                    "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                    StyleBox["ka2", "Input"], 
                    StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2",
                     ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                    StyleBox["ka3", "Input"], 
                    StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3",
                     ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                    "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny",
                     ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                    "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
                    "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", 
                    "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",",
                     "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",",
                     "Tstef", ",", "fareaQ", ",", "fperQ", ",", "fltensQ", 
                    ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu",
                     ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
                    ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", 
                    "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                    "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", 
                    "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv",
                     ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
                    "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", 
                    "pfixQ", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", 
                    ",", "\[Epsilon]", ",", "cellQ", ",", "longt", ",", 
                    "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1",
                     ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb", ",",
                     "expsQ", ",", "imgse", ",", "plotsQ", ",", "param1Q", 
                    ",", "param1"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"bugQ", ",", 
                    RowBox[{"run", "=", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"run", "=", "1.4"}]}], "]"}]}], ",", 
                    RowBox[{"Background", "->", "col1"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
                    RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"bl", ",", "Full"}], "}"}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
                    RowBox[{"Background", "->", "col1"}]}], "]"}], "]"}], ",",
                     "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Item", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Show all \>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "allplotsQ"}]}], ",", 
                    RowBox[{"Spacer", "[", "10", "]"}], ",", 
                    "\[IndentingNewLine]", "\"\<Export \>\"", ",", 
                    RowBox[{"Checkbox", "@", 
                    RowBox[{"Dynamic", "@", "allexpQ"}]}], ",", 
                    RowBox[{"Spacer", "[", "10", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete last\>\"", ",", 
                    RowBox[{
                    RowBox[{"savel", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"savel", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", 
                    RowBox[{"save", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"save", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", 
                    RowBox[{"svc", "--"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"save", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"savel", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"svm", "=", "0"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "10", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete all\>\"", ",", 
                    RowBox[{
                    RowBox[{"save", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"savel", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"svc", "=", "0"}], ";", 
                    RowBox[{"svm", "=", "0"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}]}], 
                    "}"}], "//", "Row"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", "Nothing"}], "]"}]}], "}"}]}], ",",
                "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "spc2", ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"hds", "=", 
               RowBox[{"{", 
                RowBox[{
                "hd1", ",", "hd2", ",", "hd3", ",", "hd4", ",", "hd5", ",", 
                 "hd6"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bts", "=", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"{", 
                 RowBox[{"bt1", ",", "bt2", ",", "bt3"}], "}"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", "BUTTONS", " ", "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"butts", "[", "run", "]"}]}]}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], "]"}]}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "Right", ",", "Left"}], "}"}], ",", 
          "Center"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"posf", "[", 
           RowBox[{"grid", ",", "spc"}], "]"}]}], "}"}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"Dividers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"False", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"grid", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Spacer", "[", ".02", "]"}]}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], 
               "\[Rule]", "Manipulate`Dump`$delimitercolor"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"grid", ",", "sps"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], 
               "\[Rule]", "Manipulate`Dump`$delimitercolor"}]}], "}"}]}], 
           "}"}]}]}], "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"Background", "->", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"posfc", "[", 
           RowBox[{"grid", ",", "spc"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ItemSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], 
           RowBox[{"(*", 
            RowBox[{"1", ",", "13", ",", "31", ",", "1"}], "*)"}], "}"}], ",",
           "Full"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8335271140580893`*^9, 3.8335271226802063`*^9}, {
   3.833527181890509*^9, 3.8335272818539248`*^9}, {3.833527361441786*^9, 
   3.833527366623571*^9}, {3.8335303518505344`*^9, 3.833530358563136*^9}, {
   3.833530411834403*^9, 3.833530492102806*^9}, {3.833530526462906*^9, 
   3.8335308021350417`*^9}, {3.833530840762616*^9, 3.83353088838606*^9}, {
   3.833531043166478*^9, 3.8335310435003533`*^9}, {3.833531107305204*^9, 
   3.833531116630317*^9}, {3.83353116400045*^9, 3.8335311899131117`*^9}, {
   3.833531238377338*^9, 3.833531240003832*^9}, {3.8335313197541885`*^9, 
   3.833531418402157*^9}, {3.833532369752632*^9, 3.833532540469773*^9}, {
   3.8335325753560004`*^9, 3.8335327174182587`*^9}, {3.8335327498499885`*^9, 
   3.8335327568268323`*^9}, {3.833532798360525*^9, 3.833532841478814*^9}, {
   3.8335328937530117`*^9, 3.833532907984059*^9}, {3.8335329760291424`*^9, 
   3.833532999581156*^9}, {3.8335330695344796`*^9, 3.8335330715330667`*^9}, {
   3.833545236579331*^9, 3.8335453554074783`*^9}, 3.8335456968871145`*^9, {
   3.833611976049525*^9, 3.833611980191318*^9}, {3.8336120742583003`*^9, 
   3.8336122372449784`*^9}, {3.833612434918811*^9, 3.833612512530839*^9}, {
   3.8336126009634027`*^9, 3.8336130537589626`*^9}, {3.833613111637143*^9, 
   3.8336131170268707`*^9}, {3.833613655923808*^9, 3.8336136576318026`*^9}, {
   3.833614753497157*^9, 3.833614789448439*^9}, {3.8336157379391665`*^9, 
   3.8336157475408993`*^9}, {3.8336165455134945`*^9, 3.833616548752446*^9}, {
   3.833618052029622*^9, 3.8336181658398275`*^9}, {3.8336182003938932`*^9, 
   3.8336183092508707`*^9}, {3.833618343208076*^9, 3.833618366498211*^9}, {
   3.8336184675527787`*^9, 3.8336184826848583`*^9}, {3.8336185611658826`*^9, 
   3.8336185710109243`*^9}, {3.833618725321444*^9, 3.8336187574319115`*^9}, {
   3.833618974973215*^9, 3.8336191935943556`*^9}, {3.833619808702673*^9, 
   3.8336198186047554`*^9}, {3.8336198573252883`*^9, 3.83361985738246*^9}, {
   3.8336200639455967`*^9, 3.833620219043603*^9}, {3.8336208229044795`*^9, 
   3.833620834884215*^9}, {3.83362130796467*^9, 3.833621351022501*^9}, 
   3.833621397836501*^9, {3.833621537588046*^9, 3.8336215513871145`*^9}, {
   3.8336217716736307`*^9, 3.8336217720237427`*^9}, {3.8336218214666367`*^9, 
   3.8336218363638034`*^9}, {3.8336225688902783`*^9, 
   3.8336225749950533`*^9}, {3.833623848586149*^9, 3.8336238925160737`*^9}, {
   3.83387391022422*^9, 3.833873925899102*^9}, 3.833883014394487*^9, {
   3.8338832845862665`*^9, 3.833883285051939*^9}, {3.8338836752174263`*^9, 
   3.833883677057377*^9}, {3.833962162220616*^9, 3.8339621826167727`*^9}, {
   3.8339622345391192`*^9, 3.8339622729682646`*^9}, {3.8339624117229333`*^9, 
   3.8339624171103387`*^9}, {3.833967361705092*^9, 3.833967361865423*^9}, {
   3.833967706875285*^9, 3.833967765837757*^9}, {3.833967803249928*^9, 
   3.833967804232219*^9}, {3.8339678844279823`*^9, 3.8339679198467546`*^9}, {
   3.833967986333151*^9, 3.833968001255127*^9}, {3.833968050055526*^9, 
   3.8339680603463583`*^9}, {3.833968268441498*^9, 3.8339682712405825`*^9}, {
   3.833969749250949*^9, 3.8339697493287263`*^9}, {3.8340470349232545`*^9, 
   3.8340470963803988`*^9}, {3.8340472011943836`*^9, 
   3.8340472053412657`*^9}, {3.8340477946840773`*^9, 
   3.8340478141417933`*^9}, {3.834047865298212*^9, 3.8340478658625016`*^9}, {
   3.8340493390638466`*^9, 3.8340494056891565`*^9}, {3.8340498442070475`*^9, 
   3.8340498679265523`*^9}, {3.8340507730317154`*^9, 3.834050783753722*^9}, {
   3.834051564039792*^9, 3.8340515852423105`*^9}, {3.834052476206117*^9, 
   3.8340525541059103`*^9}, {3.834052632514145*^9, 3.834052782236493*^9}, {
   3.8340536127227154`*^9, 3.8340537196954126`*^9}, {3.834053760805909*^9, 
   3.8340537975861397`*^9}, {3.834053869635573*^9, 3.8340539113310995`*^9}, {
   3.834054705182355*^9, 3.834054715201494*^9}, {3.8340666250154305`*^9, 
   3.8340666627202883`*^9}, {3.834067345292654*^9, 3.8340673844961267`*^9}, {
   3.834067484940167*^9, 3.8340675129282627`*^9}, {3.834145545010934*^9, 
   3.8341455454389057`*^9}, {3.834146185085181*^9, 3.834146367047571*^9}, {
   3.8341467969361067`*^9, 3.834146800493002*^9}, {3.8342133925737824`*^9, 
   3.834213393795684*^9}, {3.8342241645585036`*^9, 3.834224225040895*^9}, {
   3.8342243240856295`*^9, 3.8342244095184216`*^9}, {3.8342244499862003`*^9, 
   3.834224456285555*^9}, {3.8342245035134277`*^9, 3.8342245199235835`*^9}, {
   3.8342248882123127`*^9, 3.8342249606667337`*^9}, {3.834225026797306*^9, 
   3.834225034382725*^9}, {3.834225723050593*^9, 3.834225776495515*^9}, {
   3.834225845470825*^9, 3.8342258461066437`*^9}, {3.8342261560933976`*^9, 
   3.834226164476709*^9}, {3.834228711330716*^9, 3.834228737831239*^9}, {
   3.8342293614398065`*^9, 3.83422936232526*^9}, {3.8342294543311577`*^9, 
   3.8342294665955706`*^9}, {3.834229511551362*^9, 3.834229571123906*^9}, {
   3.834229612925786*^9, 3.834229662827857*^9}, {3.834230042983498*^9, 
   3.8342300769962883`*^9}, {3.8342301671277266`*^9, 
   3.8342301866542177`*^9}, {3.83423203851935*^9, 3.8342320694568253`*^9}, {
   3.834232341615196*^9, 3.8342323513545046`*^9}, {3.834235074536908*^9, 
   3.834235086598377*^9}, {3.834235133298546*^9, 3.8342352423626556`*^9}, {
   3.834235289730722*^9, 3.8342352927790985`*^9}, {3.8342353821752644`*^9, 
   3.8342354083067617`*^9}, {3.834235570225847*^9, 3.834235592827224*^9}, {
   3.834235647470765*^9, 3.8342356837070913`*^9}, {3.8342357445108547`*^9, 
   3.8342357673874173`*^9}, {3.8342358008888206`*^9, 
   3.8342358107759132`*^9}, {3.8342359027211275`*^9, 3.834235921088123*^9}, {
   3.8344945273753386`*^9, 3.8344945766702533`*^9}, {3.83449463286607*^9, 
   3.8344947034838886`*^9}, {3.8344948404231195`*^9, 3.834494874195342*^9}, {
   3.834495452408984*^9, 3.8344955023633394`*^9}, {3.834495538322651*^9, 
   3.83449562364124*^9}, {3.834495680528228*^9, 3.8344956807492514`*^9}, {
   3.8344976145081787`*^9, 3.834497660265297*^9}, {3.8344976996831656`*^9, 
   3.834497713435297*^9}, {3.8344978709148974`*^9, 3.83449787254655*^9}, {
   3.8345594547964735`*^9, 3.8345594569279704`*^9}, {3.8345595866693835`*^9, 
   3.8345595966227994`*^9}, {3.8346555051241083`*^9, 
   3.8346556034507933`*^9}, {3.8346556736143293`*^9, 
   3.8346556783287706`*^9}, {3.8346561697887115`*^9, 
   3.8346562229165993`*^9}, {3.834663836590108*^9, 3.8346638472792425`*^9}, {
   3.834663903485682*^9, 3.834663938425763*^9}, {3.834664014083807*^9, 
   3.8346640343649406`*^9}, {3.834664067411989*^9, 3.83466408027076*^9}, {
   3.834664115219327*^9, 3.83466412152564*^9}, {3.8346641852049646`*^9, 
   3.834664185319079*^9}, {3.8346642252364993`*^9, 3.8346643018813787`*^9}, {
   3.834664359994769*^9, 3.834664360605442*^9}, {3.8346644104415765`*^9, 
   3.834664472976346*^9}, {3.83466451488804*^9, 3.834664569253434*^9}, {
   3.8346646143535457`*^9, 3.8346646239209747`*^9}, {3.834664664432477*^9, 
   3.8346647427265687`*^9}, {3.834666386331118*^9, 3.8346664581854115`*^9}, {
   3.834666495849393*^9, 3.8346665056406264`*^9}, 3.834666579151163*^9, {
   3.8346666151136675`*^9, 3.834666671074419*^9}, {3.834666722673257*^9, 
   3.8346667260333447`*^9}, {3.834666823145026*^9, 3.8346669076096115`*^9}, {
   3.8346670146654286`*^9, 3.834667143998742*^9}, {3.834667197344127*^9, 
   3.8346672166777697`*^9}, {3.834667258032265*^9, 3.8346672581935215`*^9}, {
   3.8346675703025484`*^9, 3.834667633243699*^9}, {3.8346676863947916`*^9, 
   3.8346677217271457`*^9}, {3.834667810091196*^9, 3.834667829538198*^9}, {
   3.8346678603375487`*^9, 3.8346679158216686`*^9}, {3.8346679904259677`*^9, 
   3.8346679906714706`*^9}, {3.8347317479158516`*^9, 3.834731876068634*^9}, {
   3.8347319167076373`*^9, 3.8347319295225396`*^9}, {3.834732146459628*^9, 
   3.8347321762082143`*^9}, {3.834732241106152*^9, 3.834732242645265*^9}, {
   3.8347354310295796`*^9, 3.8347354790366907`*^9}, {3.8347355105287886`*^9, 
   3.834735532479967*^9}, {3.834735566796068*^9, 3.8347356008448467`*^9}, {
   3.8347356479880505`*^9, 3.8347356498720093`*^9}, {3.8347357574478083`*^9, 
   3.8347358065078316`*^9}, {3.8347358421985054`*^9, 
   3.8347358664681597`*^9}, {3.834735948672871*^9, 3.834735966752677*^9}, {
   3.834736025756446*^9, 3.8347361145578165`*^9}, {3.834736155991089*^9, 
   3.83473616426227*^9}, {3.8347362201714354`*^9, 3.834736224263524*^9}, {
   3.834736640688323*^9, 3.834736652786226*^9}, {3.83473675256688*^9, 
   3.834736760379321*^9}, {3.834736799908391*^9, 3.834736815678488*^9}, {
   3.834736847640066*^9, 3.834736864564762*^9}, {3.8347369862605867`*^9, 
   3.834737022415509*^9}, {3.8347370750648975`*^9, 3.834737086865331*^9}, {
   3.834739994486597*^9, 3.8347401301061206`*^9}, {3.834740194270645*^9, 
   3.8347402243733706`*^9}, {3.8347407314639926`*^9, 3.834740974483346*^9}, {
   3.8347431298217726`*^9, 3.8347432400730095`*^9}, {3.834743382719637*^9, 
   3.834743552429592*^9}, {3.834743586807094*^9, 3.8347435906934757`*^9}, {
   3.834743656158888*^9, 3.8347437578861165`*^9}, {3.8347438023788366`*^9, 
   3.8347438293193436`*^9}, {3.834745431364798*^9, 3.8347454358069077`*^9}, {
   3.8347465003714294`*^9, 3.834746509849351*^9}, {3.834746554106867*^9, 
   3.8347465642876616`*^9}, {3.8347510399899645`*^9, 3.834751101025259*^9}, {
   3.834751147331526*^9, 3.834751148271805*^9}, {3.834751180730094*^9, 
   3.834751181292452*^9}, {3.834751726687927*^9, 3.834751727280579*^9}, {
   3.834751844196871*^9, 3.834751887283273*^9}, {3.8347519379144306`*^9, 
   3.83475194689802*^9}, {3.8347538297574167`*^9, 3.8347538309264097`*^9}, {
   3.8347538738736916`*^9, 3.834753899402322*^9}, {3.8347543932529774`*^9, 
   3.834754398705392*^9}, {3.8348073610503654`*^9, 3.8348073643694873`*^9}, {
   3.8348275298664675`*^9, 3.834827637863883*^9}, {3.834829215937992*^9, 
   3.83482922296948*^9}, {3.8348293666578465`*^9, 3.8348293675574408`*^9}, {
   3.8348294385592794`*^9, 3.8348295202450647`*^9}, {3.834829586625431*^9, 
   3.8348295925493155`*^9}, {3.834829654303047*^9, 3.8348296668814445`*^9}, {
   3.8348297053717365`*^9, 3.834829749294644*^9}, {3.8348297989062138`*^9, 
   3.8348298001685457`*^9}, {3.8348299077050705`*^9, 
   3.8348299077679043`*^9}, {3.834830086129236*^9, 3.8348301037790017`*^9}, {
   3.8348310660367403`*^9, 3.8348310782703457`*^9}, {3.834831109259237*^9, 
   3.8348311627240553`*^9}, {3.8348312554536552`*^9, 3.83483130379424*^9}, {
   3.8348314584652896`*^9, 3.834831484163313*^9}, {3.8348318388193183`*^9, 
   3.834831885706808*^9}, {3.8348322926702075`*^9, 3.834832294055632*^9}, 
   3.8348323338646097`*^9, {3.8348323737819767`*^9, 3.834832393538759*^9}, {
   3.8348484529891834`*^9, 3.834848521333421*^9}, {3.8348512638685837`*^9, 
   3.8348512674653788`*^9}, {3.8348513180232534`*^9, 
   3.8348513192883883`*^9}, {3.834851374389897*^9, 3.8348513778243227`*^9}, {
   3.834851466447627*^9, 3.834851469153391*^9}, {3.834851536925003*^9, 
   3.834851576124859*^9}, {3.8348516139107265`*^9, 3.8348516669433856`*^9}, {
   3.834901788968815*^9, 3.8349018143488884`*^9}, {3.834901919091609*^9, 
   3.834901925333931*^9}, {3.8349019679829254`*^9, 3.834902071455392*^9}, {
   3.8349021297137156`*^9, 3.834902132774557*^9}, {3.834902165201068*^9, 
   3.834902213855999*^9}, {3.834902289761056*^9, 3.834902290294629*^9}, {
   3.8349023614481816`*^9, 3.8349023689135714`*^9}, {3.8349025110572405`*^9, 
   3.8349025480327473`*^9}, 3.8349028871555557`*^9, {3.834902996681275*^9, 
   3.8349029974711933`*^9}, {3.8349033061101556`*^9, 3.834903311481407*^9}, {
   3.8349033420307903`*^9, 3.834903342755851*^9}, {3.835094850398717*^9, 
   3.8350948504755116`*^9}, {3.835094965997216*^9, 3.835095027307109*^9}, {
   3.8350952464436064`*^9, 3.8350952636190577`*^9}, {3.8350955764674883`*^9, 
   3.8350955783155456`*^9}, {3.8350957496966753`*^9, 3.835095751082596*^9}, {
   3.835095895560359*^9, 3.835095908495327*^9}, {3.8350967191604404`*^9, 
   3.835096719239257*^9}, {3.835096889081091*^9, 3.835096889697442*^9}, {
   3.8350969917580547`*^9, 3.835097084282564*^9}, {3.83509717958279*^9, 
   3.8350971844394455`*^9}, {3.83509744712843*^9, 3.8350974528618536`*^9}, {
   3.8350976488820763`*^9, 3.8350976637191267`*^9}, {3.8350980572117004`*^9, 
   3.835098070166828*^9}, 3.8350984011260557`*^9, {3.8350986632347145`*^9, 
   3.8350986648197427`*^9}, {3.8350987016645775`*^9, 
   3.8350987064608297`*^9}, {3.835098764129219*^9, 3.8350987655394473`*^9}, {
   3.835099470604978*^9, 3.8350995142138224`*^9}, {3.8350995683516645`*^9, 
   3.8350996088996115`*^9}, {3.83509964862407*^9, 3.835099655069785*^9}, {
   3.835100106714398*^9, 3.8351001334626865`*^9}, {3.8351002075908375`*^9, 
   3.8351002108042445`*^9}, {3.8351002718208017`*^9, 3.835100324562437*^9}, {
   3.8351003912110057`*^9, 3.8351004172705917`*^9}, {3.8351004776236706`*^9, 
   3.835100576390731*^9}, {3.8351006966753187`*^9, 3.8351007237597895`*^9}, {
   3.8351008030049706`*^9, 3.835100978236822*^9}, {3.8351010192834096`*^9, 
   3.8351010292089696`*^9}, {3.8351011558211193`*^9, 3.835101202772048*^9}, {
   3.835101914689355*^9, 3.8351019193243976`*^9}, {3.835102852877042*^9, 
   3.835102853560851*^9}, {3.835103151168844*^9, 3.835103151773569*^9}, {
   3.835104084613*^9, 3.8351040849673634`*^9}, {3.8351042398769493`*^9, 
   3.835104240554139*^9}, {3.8351043502062545`*^9, 3.835104351108094*^9}, 
   3.83526923720757*^9, 3.8352693004839096`*^9, {3.8352706786114264`*^9, 
   3.8352706873445764`*^9}, {3.835270735521922*^9, 3.835270896459175*^9}, {
   3.8352713261650796`*^9, 3.8352714154021683`*^9}, {3.8352715622638297`*^9, 
   3.835271630139944*^9}, {3.835278191292386*^9, 3.835278197188049*^9}, {
   3.8352782320819783`*^9, 3.835278252272193*^9}, {3.8352783192867107`*^9, 
   3.8352783292176285`*^9}, {3.8352787700326376`*^9, 3.835278785987729*^9}, 
   3.835278817084085*^9, {3.8352788960456743`*^9, 3.8352789770001373`*^9}, {
   3.83527901344022*^9, 3.8352790141912107`*^9}, {3.8352791969925857`*^9, 
   3.8352792434025345`*^9}, {3.835281818558155*^9, 3.835281819210451*^9}, {
   3.8352836352202263`*^9, 3.835283638792057*^9}, {3.8352837653372836`*^9, 
   3.8352838496731358`*^9}, {3.835283907305702*^9, 3.8352839191071115`*^9}, {
   3.8352843760454454`*^9, 3.835284392701317*^9}, {3.8352848062139473`*^9, 
   3.835284806931347*^9}, {3.8353568830994344`*^9, 3.835356883828618*^9}, {
   3.8353595745645905`*^9, 3.835359648437008*^9}, {3.8353596894531527`*^9, 
   3.835359693436118*^9}, {3.8353656401477175`*^9, 3.8353656479096437`*^9}, {
   3.835371403156599*^9, 3.8353714042116275`*^9}, {3.8353714651166754`*^9, 
   3.835371465787342*^9}, {3.835371548345269*^9, 3.8353715489727373`*^9}, {
   3.8353736687576065`*^9, 3.835373668903309*^9}, {3.8353865352047434`*^9, 
   3.8353865504726486`*^9}, {3.8353867138181257`*^9, 
   3.8353867423558474`*^9}, {3.8353871764984426`*^9, 
   3.8353872092575984`*^9}, {3.835387293034786*^9, 3.835387384269529*^9}, {
   3.8354307760201697`*^9, 3.8354308915285015`*^9}, {3.83543093693882*^9, 
   3.835430938544074*^9}, {3.8354312840330286`*^9, 3.8354312908486004`*^9}, {
   3.8354314609344873`*^9, 3.8354314700335274`*^9}, {3.8354386204025507`*^9, 
   3.835438634774619*^9}, {3.8354407106661577`*^9, 3.8354407112791395`*^9}, {
   3.835441166649664*^9, 3.835441169715785*^9}, {3.83544937600981*^9, 
   3.835449479040164*^9}, {3.8354495180179234`*^9, 3.835449639951706*^9}, {
   3.8354496701429415`*^9, 3.8354497006842656`*^9}, 3.835449826243925*^9, {
   3.8354499732442017`*^9, 3.8354500037655244`*^9}, 3.8354500923319225`*^9, 
   3.835450133470729*^9, {3.8354501634731617`*^9, 3.835450177678563*^9}, {
   3.8354502256748314`*^9, 3.835450306485691*^9}, {3.8354503702243805`*^9, 
   3.835450415609973*^9}, {3.835450482835788*^9, 3.8354505357404766`*^9}, {
   3.835450569548915*^9, 3.835450572126993*^9}, 3.8354506442222385`*^9, {
   3.835450683784405*^9, 3.8354507350762153`*^9}, 3.8354507839819865`*^9, {
   3.835450821262338*^9, 3.8354509444408736`*^9}, 3.835450975249425*^9, {
   3.835451008579708*^9, 3.8354510118130608`*^9}, {3.835451087276816*^9, 
   3.8354510875939674`*^9}, {3.83545140630877*^9, 3.8354514088221364`*^9}, {
   3.835451933544882*^9, 3.8354519339039555`*^9}, {3.835456969364006*^9, 
   3.835456970612342*^9}, {3.835457698156035*^9, 3.835457702703593*^9}, {
   3.8354581923299913`*^9, 3.8354581984748535`*^9}, 3.835460621555681*^9, {
   3.8354606537046785`*^9, 3.83546066086652*^9}, {3.8354614011163254`*^9, 
   3.8354614016335783`*^9}, {3.8354636436690836`*^9, 3.835463643947338*^9}, {
   3.8354637366710205`*^9, 3.835463736989169*^9}, {3.8356932303104906`*^9, 
   3.8356933025810966`*^9}, 3.835693339987416*^9, {3.835693388790535*^9, 
   3.8356933933291183`*^9}, {3.8356936589508123`*^9, 3.835693662054514*^9}, {
   3.8356937111902437`*^9, 3.8356937220865636`*^9}, {3.835694043487599*^9, 
   3.8356940875210505`*^9}, 3.8356945838301597`*^9, {3.8356948801528215`*^9, 
   3.8356948980427203`*^9}, {3.835698113620409*^9, 3.83569815498483*^9}, {
   3.8356982923107557`*^9, 3.835698293469021*^9}, {3.835698558269916*^9, 
   3.8356985613176184`*^9}, {3.8357170595906286`*^9, 3.835717059667425*^9}, {
   3.8357171812383757`*^9, 3.835717194997593*^9}, {3.8357172276170554`*^9, 
   3.8357172670918303`*^9}, {3.8357173151582565`*^9, 3.83571732600457*^9}, {
   3.8357173897981863`*^9, 3.8357174785667477`*^9}, {3.83577345025*^9, 
   3.835773559642682*^9}, {3.8357737870294104`*^9, 3.835773792998911*^9}, {
   3.835773827900915*^9, 3.835773844923853*^9}, {3.8357746565265255`*^9, 
   3.8357747006635647`*^9}, {3.835774788865861*^9, 3.8357748132477674`*^9}, {
   3.8357749625407705`*^9, 3.835774993362937*^9}, {3.835775026841719*^9, 
   3.835775033563908*^9}, {3.835775146301244*^9, 3.835775171037691*^9}, {
   3.8357792633508797`*^9, 3.8357792651718864`*^9}, {3.8357915218059955`*^9, 
   3.8357915371236963`*^9}, {3.8357921951613703`*^9, 3.835792241607605*^9}, {
   3.835792285887375*^9, 3.8357922964191885`*^9}, 3.8357923267207155`*^9, 
   3.8358568133594723`*^9, {3.83586317049543*^9, 3.835863172013339*^9}, 
   3.8358640553649936`*^9, {3.835891156525031*^9, 3.8358912026006613`*^9}, {
   3.8358912751056557`*^9, 3.8358913140591297`*^9}, {3.836292205261606*^9, 
   3.8362922935646944`*^9}, {3.836292397634878*^9, 3.8362924032333136`*^9}, {
   3.8362942277020197`*^9, 3.836294229928226*^9}, {3.836294651461503*^9, 
   3.8362946643095407`*^9}, {3.836294713471483*^9, 3.836294735477128*^9}, {
   3.836294797176896*^9, 3.836294887284775*^9}, {3.8362949247689548`*^9, 
   3.83629513079148*^9}, {3.836295195448908*^9, 3.8362952238761435`*^9}, {
   3.836296391398359*^9, 3.8362964106332073`*^9}, {3.8362998692112436`*^9, 
   3.8362998963565483`*^9}, {3.8363000679753847`*^9, 3.836300076043764*^9}, {
   3.8363057428052797`*^9, 3.8363057449467077`*^9}, {3.8363091158839955`*^9, 
   3.836309116179206*^9}, {3.8363093865418215`*^9, 3.836309421652603*^9}, {
   3.836309456418514*^9, 3.836309459218096*^9}, {3.8363107739219403`*^9, 
   3.836310791931076*^9}, {3.8363108442515287`*^9, 3.836310888953718*^9}, {
   3.8363109225426254`*^9, 3.8363109231839542`*^9}, {3.836310954034525*^9, 
   3.8363109777125053`*^9}, {3.836311032910746*^9, 3.836311038439094*^9}, {
   3.8363111441055217`*^9, 3.83631117624144*^9}, {3.8363112082322454`*^9, 
   3.836311215475865*^9}, {3.8363112922207556`*^9, 3.8363113090612144`*^9}, {
   3.8363115220285864`*^9, 3.8363115837079983`*^9}, {3.836311849491073*^9, 
   3.8363118512020645`*^9}, {3.8363119263022785`*^9, 3.836312093447173*^9}, {
   3.836312769281062*^9, 3.8363127693279085`*^9}, {3.8363161477104063`*^9, 
   3.8363161734806046`*^9}, {3.836316351795721*^9, 3.8363163523696985`*^9}, {
   3.836319853528082*^9, 3.836319867841943*^9}, {3.8363716641878715`*^9, 
   3.8363717094534187`*^9}, {3.836371816062887*^9, 3.8363718177518396`*^9}, {
   3.836379953648121*^9, 3.836380059742626*^9}, {3.8363801696520243`*^9, 
   3.8363801969620724`*^9}, {3.8363805269018507`*^9, 
   3.8363806258609405`*^9}, {3.8364860504077635`*^9, 
   3.8364860588147564`*^9}, {3.8364862862383633`*^9, 
   3.8364863245257573`*^9}, {3.8365006324017043`*^9, 3.836500720618269*^9}, {
   3.836500819154728*^9, 3.8365008409503875`*^9}, {3.8365654092441735`*^9, 
   3.8365654623346057`*^9}, {3.836565547617586*^9, 3.836565554168228*^9}, {
   3.8365656029037313`*^9, 3.836565647298256*^9}, {3.8365656829241757`*^9, 
   3.836565733962522*^9}, {3.8365694429309034`*^9, 3.836569475145282*^9}, {
   3.836909314095752*^9, 3.836909358668886*^9}, {3.836909963571307*^9, 
   3.836909965170085*^9}, 3.8369107868009105`*^9, {3.8369839553712916`*^9, 
   3.8369839703879957`*^9}, {3.83698411693405*^9, 3.8369841196635685`*^9}, {
   3.8369841657407956`*^9, 3.8369841986322746`*^9}, {3.8369882306590295`*^9, 
   3.8369883829644537`*^9}, {3.836988529332226*^9, 3.836988533589913*^9}, {
   3.8369904579196324`*^9, 3.836990475603298*^9}, {3.836990749153719*^9, 
   3.8369907523359528`*^9}, {3.836990875528288*^9, 3.836990904884599*^9}, {
   3.8369909949406376`*^9, 3.8369910059465156`*^9}, 3.83699121906476*^9, {
   3.836991315684963*^9, 3.8369913161965947`*^9}, {3.8369914160140305`*^9, 
   3.8369914396720595`*^9}, {3.8369918926859083`*^9, 
   3.8369918933171835`*^9}, {3.836997077089562*^9, 3.8369971052584906`*^9}, {
   3.836998076202141*^9, 3.836998098354161*^9}, {3.83700460063507*^9, 
   3.837004612882392*^9}, {3.8370755316719637`*^9, 3.837075580228845*^9}, {
   3.837075636662761*^9, 3.837075692929554*^9}, 3.837075739200449*^9, {
   3.837075776702217*^9, 3.837075800031436*^9}, {3.837075834882929*^9, 
   3.837075836299509*^9}, {3.837075866465474*^9, 3.8370759362741613`*^9}, {
   3.8370759862688246`*^9, 3.837076001112985*^9}, {3.8370760414497623`*^9, 
   3.837076077858944*^9}, {3.8370761351405025`*^9, 3.8370762824479914`*^9}, {
   3.8370763206730576`*^9, 3.837076340783126*^9}, {3.837076391139532*^9, 
   3.83707641020028*^9}, {3.83707790054868*^9, 3.8370779055465317`*^9}, {
   3.837084769300249*^9, 3.837084861067546*^9}, {3.8370849134732647`*^9, 
   3.8370849323530245`*^9}, {3.83708496324492*^9, 3.8370850703231564`*^9}, {
   3.8370851478182716`*^9, 3.83708515460721*^9}, {3.837085204324829*^9, 
   3.8370853399964824`*^9}, {3.8370853764479218`*^9, 
   3.8370853878724003`*^9}, {3.837086253017536*^9, 3.8370862548329024`*^9}, {
   3.8371171571507373`*^9, 3.837117159007208*^9}, {3.8376227291102877`*^9, 
   3.837622732374606*^9}, {3.837628579022767*^9, 3.837628584388443*^9}, {
   3.837856360787746*^9, 3.8378563679036727`*^9}, {3.8378564548800077`*^9, 
   3.8378564809861*^9}, {3.83785661218359*^9, 3.837856626714864*^9}, {
   3.8378566671460085`*^9, 3.83785672343382*^9}, {3.837858906701936*^9, 
   3.837858941160404*^9}, {3.837859773052266*^9, 3.8378597842362027`*^9}, {
   3.8387435940096197`*^9, 3.8387436053425817`*^9}, {3.8394893536029882`*^9, 
   3.8394893699308844`*^9}, {3.8394894373004866`*^9, 
   3.8394894734233828`*^9}, {3.839489641216883*^9, 3.8394896602120905`*^9}, {
   3.8394898268650713`*^9, 3.8394898960203805`*^9}, {3.839489933566902*^9, 
   3.8394899352464104`*^9}, {3.839585084405391*^9, 3.8395850962587795`*^9}, {
   3.8395852680894995`*^9, 3.8395852709379387`*^9}, {3.8395875446544075`*^9, 
   3.839587545012458*^9}, {3.839587673676485*^9, 3.839587713313867*^9}, {
   3.8395879028266783`*^9, 3.839587939964389*^9}, {3.8395879721296973`*^9, 
   3.83958797600733*^9}, {3.839588042459508*^9, 3.8395880987136183`*^9}, {
   3.8395881333721848`*^9, 3.839588145942929*^9}, {3.839588176430953*^9, 
   3.8395881831800222`*^9}, {3.839588239150219*^9, 3.8395882485554056`*^9}, {
   3.8395883317211494`*^9, 3.839588332913968*^9}, 3.839588433905425*^9, {
   3.839668893159918*^9, 3.8396689025343375`*^9}, {3.839672191848637*^9, 
   3.8396721922251973`*^9}, {3.839678336650002*^9, 3.8396783813402467`*^9}, {
   3.839678609633292*^9, 3.839678611208536*^9}, {3.8397475388978963`*^9, 
   3.839747539993965*^9}, {3.839757281065442*^9, 3.839757286518863*^9}, {
   3.8397573185685525`*^9, 3.839757396611309*^9}, {3.8397578009985924`*^9, 
   3.8397578030741663`*^9}, 3.8397578427387857`*^9, {3.839757941172126*^9, 
   3.8397580239396305`*^9}, {3.8397582434060307`*^9, 
   3.8397583079859486`*^9}, {3.839758502209092*^9, 3.8397586668119464`*^9}, {
   3.8397586984326787`*^9, 3.839758733617756*^9}, {3.839758900588656*^9, 
   3.83975896275268*^9}, {3.8397597626066914`*^9, 3.839759786282042*^9}, {
   3.8397599789282365`*^9, 3.8397599795186577`*^9}, 3.8397600179188433`*^9, {
   3.8397600823158665`*^9, 3.839760085649334*^9}, 3.839760510361949*^9, {
   3.839760609392893*^9, 3.8397606095455055`*^9}, {3.8397611598878036`*^9, 
   3.839761219790221*^9}, {3.8397612663942738`*^9, 3.8397613297035527`*^9}, {
   3.839762051983131*^9, 3.8397620560053453`*^9}, {3.839762105875749*^9, 
   3.8397621276498528`*^9}, {3.8397622961509156`*^9, 
   3.8397623220273294`*^9}, {3.839762406647874*^9, 3.8397624148734226`*^9}, {
   3.8397624847764564`*^9, 3.839762492879135*^9}, {3.839763055457118*^9, 
   3.8397630583274436`*^9}, {3.8397675187324166`*^9, 3.839767519945513*^9}, {
   3.8397677362264338`*^9, 3.8397677395168943`*^9}, {3.8397681243270826`*^9, 
   3.839768175030052*^9}, {3.839827571736762*^9, 3.839827571844474*^9}, {
   3.8399137328268623`*^9, 3.8399137517610254`*^9}, {3.8399138978841004`*^9, 
   3.8399138992031016`*^9}, {3.840079346497238*^9, 3.8400793526802874`*^9}, {
   3.8400793894303627`*^9, 3.8400794429564743`*^9}, {3.840079495525519*^9, 
   3.840079539972373*^9}, {3.840088817657552*^9, 3.840088819288192*^9}, {
   3.84008885605282*^9, 3.8400888564188476`*^9}, {3.8400889080255637`*^9, 
   3.8400889208167224`*^9}, {3.8400889658429775`*^9, 
   3.8400889718632574`*^9}, {3.840089020467418*^9, 3.840089020548203*^9}, {
   3.8400891258824377`*^9, 3.8400891364678645`*^9}, 3.840089276681696*^9, {
   3.840089309061973*^9, 3.8400893091038923`*^9}, {3.8400893787363496`*^9, 
   3.8400893948398867`*^9}, {3.840089745446193*^9, 3.8400898297815065`*^9}, 
   3.840089861608858*^9, {3.8400899284875717`*^9, 3.840089933335462*^9}, {
   3.8400900013981695`*^9, 3.840090031857475*^9}, 3.8400900884473467`*^9, {
   3.840090136732771*^9, 3.8400901421386995`*^9}, 3.840090523645985*^9, {
   3.840092590675087*^9, 3.840092666053088*^9}, {3.840092793617963*^9, 
   3.8400927976237216`*^9}, {3.840095090182533*^9, 3.8400950913708043`*^9}, 
   3.84010254945543*^9, {3.8401112392797437`*^9, 3.840111328978945*^9}, {
   3.8401113792245255`*^9, 3.840111382119807*^9}, {3.840111684715989*^9, 
   3.8401117714614325`*^9}, {3.840111853664341*^9, 3.8401118727841806`*^9}, {
   3.840111940981064*^9, 3.840111958431426*^9}, {3.840183988214566*^9, 
   3.8401840307250943`*^9}, {3.840184093084935*^9, 3.8401841198791895`*^9}, {
   3.8401841923647113`*^9, 3.840184194239411*^9}, {3.840185151466297*^9, 
   3.840185153328429*^9}, 3.8401874007315435`*^9, {3.8401875159678397`*^9, 
   3.840187517523641*^9}, {3.8401875678781033`*^9, 3.8401875688396215`*^9}, {
   3.8401876117656946`*^9, 3.840187619217736*^9}, {3.840188055946281*^9, 
   3.84018806602413*^9}, {3.8401885291671686`*^9, 3.840188541383249*^9}, {
   3.8401886687014523`*^9, 3.8401886932032995`*^9}, {3.840188895647601*^9, 
   3.840188895811191*^9}, {3.8405229773283486`*^9, 3.84052297762156*^9}, {
   3.8405249806449256`*^9, 3.840524989872512*^9}, {3.840525028009952*^9, 
   3.840525060715764*^9}, {3.840525100730178*^9, 3.8405251071981645`*^9}, {
   3.84052525617321*^9, 3.84052528722893*^9}, {3.8405253268201494`*^9, 
   3.8405253310399213`*^9}, {3.8405267692968554`*^9, 3.840526778911964*^9}, {
   3.8405268887018056`*^9, 3.8405268887711267`*^9}, {3.8405279480920362`*^9, 
   3.8405279802389917`*^9}, {3.8405308774197593`*^9, 
   3.8405309469720545`*^9}, {3.840557177382945*^9, 3.840557179305874*^9}, {
   3.8406192315104356`*^9, 3.840619257883649*^9}, {3.840619345108076*^9, 
   3.8406193524964447`*^9}, {3.8406245761007333`*^9, 3.840624606997203*^9}, {
   3.840624664817936*^9, 3.8406246747947226`*^9}, {3.840624735975341*^9, 
   3.840624738087978*^9}, {3.8410089244621572`*^9, 3.84100898955201*^9}, {
   3.841570932703331*^9, 3.8415709414599*^9}, 3.841571046498742*^9, {
   3.841573715826954*^9, 3.8415737178994155`*^9}, {3.841655909695567*^9, 
   3.8416559958300295`*^9}, {3.841659788932923*^9, 3.8416597898125463`*^9}, {
   3.84165988300008*^9, 3.841659883699233*^9}, {3.841659932115108*^9, 
   3.841659946590443*^9}, {3.84165998117468*^9, 3.841660038742385*^9}, {
   3.8416601366943655`*^9, 3.841660138290377*^9}, 3.841660216354147*^9, {
   3.8416602508403435`*^9, 3.841660282515642*^9}, {3.8416603493956604`*^9, 
   3.841660392365801*^9}, {3.841660426044669*^9, 3.841660427116914*^9}, {
   3.8416605339210505`*^9, 3.841660536189903*^9}, {3.841660609396141*^9, 
   3.8416606430410433`*^9}, {3.841661239936568*^9, 3.8416612416747513`*^9}, {
   3.8416642759255924`*^9, 3.8416642760402813`*^9}, {3.8417435786123705`*^9, 
   3.841743599494528*^9}, {3.8417438348112493`*^9, 3.841743984882522*^9}, 
   3.8417440771430035`*^9, {3.841745597045842*^9, 3.8417455980554695`*^9}, {
   3.841745630870783*^9, 3.8417456435981894`*^9}, {3.841746155604951*^9, 
   3.841746156146465*^9}, {3.8417463103553896`*^9, 3.841746311459153*^9}, {
   3.841746369060828*^9, 3.841746370161007*^9}, {3.8417464822420845`*^9, 
   3.841746483659832*^9}, {3.8417465550557547`*^9, 3.8417465769324427`*^9}, {
   3.841746670371194*^9, 3.841746671365751*^9}, {3.8417469249333043`*^9, 
   3.8417469267927804`*^9}, {3.8426017593565016`*^9, 3.842601760429621*^9}, {
   3.84329193583066*^9, 3.843291948405366*^9}, {3.8434693056673393`*^9, 
   3.8434693192812986`*^9}, {3.8434693651904736`*^9, 3.843469369217214*^9}, {
   3.8434695821872387`*^9, 3.843469583383642*^9}, {3.843470411003566*^9, 
   3.843470416521675*^9}, {3.843471919587145*^9, 3.843471921517623*^9}, {
   3.843471952063469*^9, 3.8434719586483746`*^9}, {3.843472795475214*^9, 
   3.8434727958871107`*^9}, {3.8434728870721917`*^9, 3.843472955580122*^9}, {
   3.8434729999182286`*^9, 3.843473016728792*^9}, 3.843473062412133*^9, {
   3.8434746280137577`*^9, 3.8434746405972214`*^9}, {3.843474754907011*^9, 
   3.8434747582852845`*^9}, {3.84347484761749*^9, 3.8434748481859703`*^9}, {
   3.8434749477643557`*^9, 3.843474996342908*^9}, 3.843475057229201*^9, {
   3.843475104523821*^9, 3.843475121244484*^9}, 3.8434754712315474`*^9, {
   3.843475607172014*^9, 3.8434756351205673`*^9}, {3.84347570787573*^9, 
   3.8434757449118624`*^9}, {3.8434760384614143`*^9, 
   3.8434760455150924`*^9}, {3.843476419718083*^9, 3.843476420842461*^9}, {
   3.843476476067371*^9, 3.8434765254206514`*^9}, {3.8434766226343966`*^9, 
   3.843476624958967*^9}, {3.84347746159288*^9, 3.843477476790541*^9}, {
   3.84389545974946*^9, 3.8438954834718556`*^9}, {3.8438956369161396`*^9, 
   3.8438956581026382`*^9}, {3.843896132535117*^9, 3.8438961898822093`*^9}, {
   3.843897066002225*^9, 3.843897068180682*^9}, {3.8439134517235503`*^9, 
   3.8439134716551185`*^9}, {3.844769381290517*^9, 3.8447694194014482`*^9}, {
   3.8447694566822*^9, 3.8447694647140627`*^9}, {3.8447695223148746`*^9, 
   3.8447695389678545`*^9}, {3.8447695980410824`*^9, 3.8447696029020805`*^9}, 
   3.8447698469281216`*^9, {3.8447700242044573`*^9, 3.8447701803044195`*^9}, {
   3.844770236533422*^9, 3.844770312345481*^9}, {3.844770367285462*^9, 
   3.844770410539522*^9}, {3.8447705005326324`*^9, 3.8447705779453526`*^9}, {
   3.8447706502735567`*^9, 3.844770656244026*^9}, {3.844771658172366*^9, 
   3.8447716590774755`*^9}, {3.8447717078887444`*^9, 3.844771712329028*^9}, {
   3.844775759297267*^9, 3.8447758200314713`*^9}, {3.8453778478397727`*^9, 
   3.845377883054348*^9}, {3.8453779146259527`*^9, 3.845377921730295*^9}, {
   3.8453780051153193`*^9, 3.845378014040118*^9}, {3.8453781671176777`*^9, 
   3.845378224004304*^9}, {3.8453782701329703`*^9, 3.845378272939339*^9}, {
   3.8454598613620453`*^9, 3.8454599028490357`*^9}, {3.84546099533733*^9, 
   3.8454610248825464`*^9}, {3.8454611246348867`*^9, 
   3.8454612046896863`*^9}, {3.8454634821678343`*^9, 3.845463504787079*^9}, {
   3.845465686386065*^9, 3.8454656881573234`*^9}, {3.8454657281674566`*^9, 
   3.845465733538168*^9}, {3.845465789146216*^9, 3.845465790849167*^9}, {
   3.845468364597576*^9, 3.845468364673381*^9}, 3.845472514587509*^9, {
   3.8454725724292383`*^9, 3.8454726295025897`*^9}, {3.8454727903501463`*^9, 
   3.845472795783389*^9}, {3.845472845889121*^9, 3.8454729118353653`*^9}, {
   3.845474779204056*^9, 3.845474787608528*^9}, {3.8454748208142004`*^9, 
   3.8454748551094637`*^9}, {3.8454749679093466`*^9, 
   3.8454749983147483`*^9}, {3.845636166800599*^9, 3.8456361703315887`*^9}, {
   3.8456362152277207`*^9, 3.845636241827571*^9}, {3.8456362858280287`*^9, 
   3.8456362863685884`*^9}, {3.845637722938092*^9, 3.8456377230109468`*^9}, {
   3.84563836866453*^9, 3.8456383697159033`*^9}, {3.8456384058838778`*^9, 
   3.8456384750038757`*^9}, {3.845638609780938*^9, 3.845638610596171*^9}, {
   3.8456386600922956`*^9, 3.84563866356176*^9}, {3.8456387173437195`*^9, 
   3.8456387186945333`*^9}, {3.8456436990422525`*^9, 
   3.8456437765158043`*^9}, {3.8456438321231995`*^9, 
   3.8456438436091347`*^9}, {3.8456438750493035`*^9, 3.84564387743723*^9}, {
   3.8456467708037777`*^9, 3.8456467708686247`*^9}, {3.845648143810877*^9, 
   3.8456481440382366`*^9}, {3.845653480918944*^9, 3.845653488712803*^9}, {
   3.845658814374024*^9, 3.8456588246790466`*^9}, {3.8456655155070143`*^9, 
   3.8456655155768275`*^9}, {3.8459194305591493`*^9, 
   3.8459194343062696`*^9}, {3.845919469821615*^9, 3.845919569515545*^9}, {
   3.845919612832523*^9, 3.84591961386792*^9}, {3.8459196537233863`*^9, 
   3.845919681545277*^9}, {3.850469231542519*^9, 3.85046923740353*^9}, 
   3.850813084243986*^9, {3.8508184834068775`*^9, 3.8508184865275316`*^9}, {
   3.855233192110571*^9, 3.855233213942996*^9}, 3.855233329616348*^9, {
   3.855233370347418*^9, 3.855233386883235*^9}, {3.8552344894940166`*^9, 
   3.8552344938497286`*^9}, 3.8552377831243963`*^9, 3.855237854854705*^9, {
   3.8552379601063833`*^9, 3.8552380018265033`*^9}, {3.855266612026794*^9, 
   3.8552666122591724`*^9}, {3.8559041563728933`*^9, 
   3.8559041591524553`*^9}, {3.8559042605651703`*^9, 3.855904263850912*^9}, {
   3.8559092324379845`*^9, 3.855909233287711*^9}, {3.855909302202888*^9, 
   3.8559093291144257`*^9}, {3.8559093648322124`*^9, 
   3.8559093669909124`*^9}, {3.8559094143707576`*^9, 3.855909415897651*^9}, {
   3.85591067696208*^9, 3.855910683429324*^9}, {3.8559153585629897`*^9, 
   3.855915362228464*^9}, {3.856004785535783*^9, 3.8560048498044796`*^9}, {
   3.8560050040191517`*^9, 3.856005125463601*^9}, {3.8560051606066294`*^9, 
   3.856005161159151*^9}, {3.856005224591643*^9, 3.8560052267249393`*^9}, {
   3.856005347174944*^9, 3.8560053498069057`*^9}, {3.8560057377626467`*^9, 
   3.8560057815939593`*^9}, {3.856005845394355*^9, 3.8560058472583704`*^9}, {
   3.8565209163077655`*^9, 3.8565209213496914`*^9}, {3.857032507718193*^9, 
   3.857032551255767*^9}, {3.8570327266902447`*^9, 3.8570327621957216`*^9}, {
   3.8570329291626678`*^9, 3.85703307881818*^9}, {3.857033177183635*^9, 
   3.857033192798642*^9}, {3.8570333568738747`*^9, 3.8570333573207116`*^9}, {
   3.8570334406474314`*^9, 3.8570334414842434`*^9}, {3.8570334785523415`*^9, 
   3.8570334992548666`*^9}, {3.857033547377263*^9, 3.857033547496942*^9}, {
   3.857035107729603*^9, 3.85703514665495*^9}, 3.857035181039028*^9, {
   3.8570417974368057`*^9, 3.8570418394364796`*^9}, {3.8570461433491917`*^9, 
   3.8570461476496916`*^9}, {3.8570461915373325`*^9, 
   3.8570462329876013`*^9}, {3.8570470235708075`*^9, 3.857047155124474*^9}, {
   3.857047224612259*^9, 3.8570472262129784`*^9}, {3.8570474139009447`*^9, 
   3.857047427556429*^9}, {3.8570474579780793`*^9, 3.85704746016922*^9}, {
   3.85704765002544*^9, 3.857047754013381*^9}, {3.857049813882755*^9, 
   3.857049894853236*^9}, {3.857050184507941*^9, 3.857050200632656*^9}, {
   3.857640564609147*^9, 3.8576406040588074`*^9}, {3.8576406526183043`*^9, 
   3.857640669658959*^9}, {3.8576408358783817`*^9, 3.8576409001239185`*^9}, {
   3.857640950764741*^9, 3.8576409565153203`*^9}, {3.8576410142500753`*^9, 
   3.857641039010373*^9}, {3.857641071179265*^9, 3.857641099483686*^9}, {
   3.8576411425665035`*^9, 3.8576411495964527`*^9}, {3.857642406071066*^9, 
   3.85764241943933*^9}, {3.8576424574897413`*^9, 3.8576424637530036`*^9}, {
   3.8621233544206686`*^9, 3.8621233822137117`*^9}, {3.862123465398221*^9, 
   3.862123479414049*^9}, 3.862123557996598*^9, {3.8621235905977974`*^9, 
   3.8621235920523367`*^9}, {3.8621236346240053`*^9, 
   3.8621236594413505`*^9}, {3.8621236969326506`*^9, 3.862123724092559*^9}, {
   3.862123923062495*^9, 3.8621239236040792`*^9}, {3.862123960250002*^9, 
   3.862124231884859*^9}, {3.8621243670762367`*^9, 3.8621244588875337`*^9}, {
   3.862124491053169*^9, 3.8621245052306523`*^9}, {3.8621245442641745`*^9, 
   3.862124578469802*^9}, {3.862124611431036*^9, 3.862124646046311*^9}, {
   3.8621251965402155`*^9, 3.8621251980463004`*^9}, {3.8621254208266773`*^9, 
   3.862125421358286*^9}, {3.8621308442213907`*^9, 3.862130948560855*^9}, {
   3.862133741221266*^9, 3.862133741891446*^9}, {3.862133972318351*^9, 
   3.862133992141349*^9}, {3.8621340631704454`*^9, 3.862134063786824*^9}, {
   3.8623929987477055`*^9, 3.862393005368707*^9}, {3.8647218972148657`*^9, 
   3.864721907001882*^9}, {3.8647219813021865`*^9, 3.8647220168939967`*^9}, {
   3.864722137761819*^9, 3.8647221566938376`*^9}, {3.8647221949754543`*^9, 
   3.8647223003524466`*^9}, {3.864722356952349*^9, 3.864722358519326*^9}, {
   3.864722420819545*^9, 3.8647224227983737`*^9}, {3.8647228176466036`*^9, 
   3.864722840405826*^9}, {3.865242098887231*^9, 3.8652421124369965`*^9}, {
   3.865242148512848*^9, 3.8652422385850477`*^9}, {3.8652422837700424`*^9, 
   3.86524229119874*^9}, {3.8652423243633256`*^9, 3.865242364553945*^9}, {
   3.865242407469389*^9, 3.8652424096376095`*^9}, {3.865242455173159*^9, 
   3.865242473639701*^9}, {3.8652425098434224`*^9, 3.8652425152289324`*^9}, {
   3.8652426486611595`*^9, 3.86524264895637*^9}, {3.86524268513032*^9, 
   3.8652426869540715`*^9}, {3.865242746028761*^9, 3.8652428423577394`*^9}, {
   3.865243341345766*^9, 3.865243343657707*^9}, {3.8655268281834497`*^9, 
   3.865526918648753*^9}, {3.8655269850484037`*^9, 3.865527008615131*^9}, {
   3.8655270521664*^9, 3.865527072447765*^9}, {3.8655272004920816`*^9, 
   3.8655272988849735`*^9}, {3.865527338902738*^9, 3.865527339112178*^9}, {
   3.8671824599507346`*^9, 3.8671824755509973`*^9}, {3.867182513785961*^9, 
   3.86718251633168*^9}, {3.867182722477756*^9, 3.8671827250973797`*^9}, {
   3.8806587426895847`*^9, 3.8806587443391576`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[139]:=",ExpressionUUID->"73acf02e-9eae-4023-b010-5d7828bb67dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Buttons", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8339622862359695`*^9, 
   3.8339622868840885`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"6b588259-a233-43c3-aa3f-764ad1952bfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "butts", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bl", "=", "347"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bl4", "=", 
   RowBox[{"bl", "/", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"butts", "[", "run_", "]"}], ":=", 
   RowBox[{"Dynamic", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "GENERAL", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bt1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1.4", ",", "1.5", ",", "0.9", ",", "1.55"}], "}"}], 
             ",", "run"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"fts0", "@", "\"\<Start\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"clear", "[", "]"}], ";", 
             RowBox[{"clearData", "[", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"tt0", "=", 
              RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"modrunQ", "=", "False"}], ";", 
             RowBox[{"skipmeshQ", "=", "False"}], ";", 
             RowBox[{"skipmatricesQ", "=", "False"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"alaQ", ",", 
               RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"bugQ", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"debug", "[", 
              RowBox[{
              "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", 
               ",", "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", 
               "sorc", ",", "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", 
               ",", "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
               "plottimeQ", ",", "dlthresh", ",", "stats", ",", "sigm", ",", 
               "sigr", ",", "vmod", ",", "vormod", ",", "smod", ",", 
               StyleBox["ka", "Input"], 
               StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
               "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
               "diamx", ",", "depQ", ",", 
               StyleBox["ka2", "Input"], 
               StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",",
                "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
               StyleBox["ka3", "Input"], 
               StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",",
                "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",",
                "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", 
               "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",",
                "Tsim2", ",", "sigs", ",", "ss1", ",", "streQ", ",", "stet", 
               ",", "arfixQ", ",", "stretNQ", ",", "stretN", ",", "Trele", 
               ",", "Thold", ",", "sigallQ", ",", "stetbQ", ",", "bthk", ",", 
               "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", ",", 
               "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",",
                "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
               ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R",
                ",", "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", 
               "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", "cisQ", ",", 
               "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", "nv", 
               ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", "effvol", ",", 
               "dynpQ", ",", "uplQ", ",", "pfixQ", ",", "pbt", ",", "pdt", 
               ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", "cellQ", ",", 
               "longt", ",", "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",",
                "colo1", ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb", 
               ",", "expsQ", ",", "imgse", ",", "plotsQ", ",", "param1Q", ",",
                "param1"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"bugQ", ",", 
               RowBox[{"run", "=", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"run", "=", "1.4"}]}], "]"}]}], ",", 
            RowBox[{"Background", "->", "col1"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"bl", ",", "Full"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"fts0", "@", "\"\<Stop\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"run", "=", "0"}], ";", 
             RowBox[{"frame", "=", "logo"}], ";", 
             RowBox[{
             "FrontEndTokenExecute", "[", "\"\<EvaluatorAbort\>\"", "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Background", "\[Rule]", "col2"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"bl", ",", "Full"}], "}"}]}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Preemptive\>\""}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "SpanFromLeft"}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"bt2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{
          RowBox[{"fts0", "@", "\"\<Clear\>\""}], ",", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"alaQ", ",", 
             RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"run", "=", "0"}]}], ",", 
          RowBox[{"Background", "->", "col0"}], ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", "run"}], 
              "]"}]}], ")"}]}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"bl", ",", "Full"}], "}"}]}]}], "]"}], ",", 
        "SpanFromLeft"}], "}"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"bt3", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "@", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
             RowBox[{"fts0", "@", "\"\<Save\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"svm", "=", "1"}], ";", 
              RowBox[{"svc", "++"}], ";", 
              RowBox[{"savel", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"savel", ",", 
                 RowBox[{"ToString", "/@", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                   "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                    "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                    "fitQ", ",", "sorc", ",", "plotperQ", ",", "plotcoeffvQ", 
                    ",", "plotSOPnQ", ",", "plotSOPdQ", ",", "plotsolQ", ",", 
                    "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
                    "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
                    "vormod", ",", "smod", ",", 
                    StyleBox["ka", "Input"], 
                    StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                    ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                    "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                    StyleBox["ka2", "Input"], 
                    StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2",
                     ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                    StyleBox["ka3", "Input"], 
                    StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3",
                     ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                    "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny",
                     ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                    "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
                    "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", 
                    "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",",
                     "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",",
                     "Tstef", ",", "fareaQ", ",", "fperQ", ",", "fltensQ", 
                    ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu",
                     ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
                    ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", 
                    "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                    "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", 
                    "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv",
                     ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
                    "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", 
                    "pfixQ", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", 
                    ",", "\[Epsilon]", ",", "cellQ", ",", "longt", ",", 
                    "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1",
                     ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], 
                   "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"save", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"save", ",", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"svc", "=", "svc"}], "}"}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "2", "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<Model ``\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"svc", ",", "10", ",", "2"}], "]"}]}], "]"}], ",",
                     "ft4"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                    "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                    "fitQ", ",", "sorc", ",", "plotperQ", ",", "plotcoeffvQ", 
                    ",", "plotSOPnQ", ",", "plotSOPdQ", ",", "plotsolQ", ",", 
                    "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
                    "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
                    "vormod", ",", "smod", ",", 
                    StyleBox["ka", "Input"], 
                    StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                    ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                    "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                    StyleBox["ka2", "Input"], 
                    StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2",
                     ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                    StyleBox["ka3", "Input"], 
                    StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3",
                     ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                    "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny",
                     ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                    "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
                    "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", 
                    "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",",
                     "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",",
                     "Tstef", ",", "fareaQ", ",", "fperQ", ",", "fltensQ", 
                    ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu",
                     ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", 
                    ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", 
                    "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                    "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", 
                    "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv",
                     ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
                    "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", 
                    "pfixQ", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", 
                    ",", "\[Epsilon]", ",", "cellQ", ",", "longt", ",", 
                    "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1",
                     ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], 
                    "}"}], "=", 
                    RowBox[{"ToExpression", "/@", 
                    RowBox[{"savel", "[", 
                    RowBox[{"[", "svc", "]"}], "]"}]}]}], " ", ",", 
                    RowBox[{"Background", "->", "col0"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"ft40", "@", "\"\<\[DownArrow]\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SetDirectory", "[", 
                    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FileExistsQ", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Models\>\""}], "}"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"CreateDirectory", "[", "\"\<Models\>\"", "]"}]}],
                     "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"SetDirectory", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Models\>\""}], "}"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"exportd", "[", 
                    RowBox[{"svc", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"savel", "[", 
                    RowBox[{"[", "svc", "]"}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Background", "->", "White"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "2", "]"}]}], "}"}]}]}], "]"}]}], 
                "]"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"Background", "->", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "]"}], ",", "0.8"}],
                "]"}]}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                  "run"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"{", 
               RowBox[{"bl4", ",", "Full"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{
             RowBox[{"fts0", "@", "\"\<Load\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"alaQ", ",", 
                RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"loadf", "[", "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"Background", "->", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "]"}], ",", "0.8"}],
                "]"}]}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                  "run"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"{", 
               RowBox[{"bl4", ",", "Full"}], "}"}]}], ",", 
             RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{
             RowBox[{"fts0", "@", "\"\<Default\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", 
                ",", "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", 
                "sorc", ",", "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ",
                 ",", "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
                "plottimeQ", ",", "dlthresh", ",", "msimn", ",", "sigm", ",", 
                "sigr", ",", "vmod", ",", "vormod", ",", "smod", ",", "ka", 
                ",", "gamc", ",", "\[CapitalLambda]", ",", "\[Eta]", ",", 
                "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", "diamx", ",", 
                "depQ", ",", 
                StyleBox["ka2", "Input"], 
                StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", 
                ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                StyleBox["ka3", "Input"], 
                StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", 
                ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1",
                 ",", "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", 
                ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", 
                "Tsim", ",", "Tsim2", ",", "sigs", ",", "ss1", ",", "streQ", 
                ",", "stet", ",", "arfixQ", ",", "stretNQ", ",", "stretN", 
                ",", "Trele", ",", "Thold", ",", "sigallQ", ",", "stetbQ", 
                ",", "bthk", ",", "Tstei", ",", "Tstef", ",", "fareaQ", ",", 
                "fperQ", ",", "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k",
                 ",", "h", ",", "mu", ",", "aN0", ",", "bN0", ",", "iniN", 
                ",", "iniD", ",", "iniR", ",", "\[Beta]N", ",", "\[Beta]D", 
                ",", "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
                "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", "l", 
                ",", "cisQ", ",", "Tste", ",", "stefh", ",", "stefv", ",", 
                "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", "inoiseQ", 
                ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",", 
                "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", "\[Epsilon]", 
                ",", "cellQ", ",", "longt", ",", "cutcQ", ",", "grQ", ",", 
                "grt", ",", "grT", ",", "colo1", ",", "colom", ",", "colob", 
                ",", "mbmt", ",", "rmb"}], "}"}], "=", "ivard"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"Background", "->", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "]"}], ",", "0.8"}],
                "]"}]}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                  "run"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"{", 
               RowBox[{"bl4", ",", "Full"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{
             RowBox[{"fts0", "@", "\"\<Export\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"run", "=", "3"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"alaQ", ",", 
                RowBox[{"AudioPause", "[", "alarm", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"SetDirectory", "[", 
               RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FileExistsQ", "[", 
                  RowBox[{"FileNameJoin", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\""}], "}"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"CreateDirectory", "[", "\"\<Exports\>\"", "]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"SetDirectory", "[", 
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                  "\"\<Exports\>\""}], "}"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"export", "[", "frameout", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"run", "=", "1"}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Background", "->", "col0"}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "1.4", ",", "1.5", ",", "0.9", ",", "0", ",", "2"}], "}"}],
                   ",", "run"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"{", 
               RowBox[{"bl4", ",", "Full"}], "}"}]}], ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "2.1"}], "}"}], ",", "run"}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"fts0", "@", "\"\<About\>\""}], ",", 
               RowBox[{"run", "=", "2"}], ",", 
               RowBox[{"Background", "->", "col0"}], ",", 
               RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                    "run"}], "]"}]}], ")"}]}], ",", 
               RowBox[{"ImageSize", "->", 
                RowBox[{"{", 
                 RowBox[{"bl4", ",", "Full"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"fts0", "@", "\"\<Back\>\""}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"run", "==", "2.1"}], ",", 
                 RowBox[{"run", "=", "2"}], ",", 
                 RowBox[{"run", "=", "0"}]}], "]"}], ",", 
               RowBox[{"Background", "->", "col0"}], ",", 
               RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1.4", ",", "1.5", ",", "0.9"}], "}"}], ",", 
                    "run"}], "]"}]}], ")"}]}], ",", 
               RowBox[{"ImageSize", "->", 
                RowBox[{"{", 
                 RowBox[{"bl4", ",", "Full"}], "}"}]}]}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
        "SpanFromLeft"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "openers", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"openers", "[", "op_", "]"}], ":=", 
   RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"op", ",", "uarrow", ",", "darrow"}], "]"}], ",", 
      RowBox[{"op", "=", 
       RowBox[{"!", "op"}]}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
      RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "opensect", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opensect", "[", 
    RowBox[{"s_", ",", "op_"}], "]"}], ":=", 
   RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rs1", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", "s", "]"}], ",", "fts"}], "]"}], ",", "rs2", 
          ",", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "op"}], ",", 
             RowBox[{"darrown", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"uarrown", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Full", ",", "30"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"op", "=", 
       RowBox[{"!", "op"}]}], ",", 
      RowBox[{"Background", "\[Rule]", 
       RowBox[{"ColorNegate", "@", "col1l"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "bl"}], ",", 
      RowBox[{"Appearance", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Frameless\>\"", ",", "\"\<Pressed\>\""}], "}"}]}]}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8335271140580893`*^9, 3.8335271226802063`*^9}, {
   3.833527181890509*^9, 3.8335272818539248`*^9}, {3.833527361441786*^9, 
   3.833527366623571*^9}, {3.8335303518505344`*^9, 3.833530358563136*^9}, {
   3.833530411834403*^9, 3.833530492102806*^9}, {3.833530526462906*^9, 
   3.8335308021350417`*^9}, {3.833530840762616*^9, 3.83353088838606*^9}, {
   3.833531043166478*^9, 3.8335310435003533`*^9}, {3.833531107305204*^9, 
   3.833531116630317*^9}, {3.83353116400045*^9, 3.8335311899131117`*^9}, {
   3.833531238377338*^9, 3.833531240003832*^9}, {3.8335313197541885`*^9, 
   3.833531418402157*^9}, {3.833532369752632*^9, 3.833532540469773*^9}, {
   3.8335325753560004`*^9, 3.8335327174182587`*^9}, {3.8335327498499885`*^9, 
   3.8335327568268323`*^9}, {3.833532798360525*^9, 3.833532841478814*^9}, {
   3.8335328937530117`*^9, 3.833532907984059*^9}, {3.8335329760291424`*^9, 
   3.833532999581156*^9}, {3.8335330695344796`*^9, 3.8335330715330667`*^9}, {
   3.833545236579331*^9, 3.8335453554074783`*^9}, 3.8335456968871145`*^9, {
   3.833611976049525*^9, 3.833611980191318*^9}, {3.8336120742583003`*^9, 
   3.8336122372449784`*^9}, {3.833612434918811*^9, 3.833612512530839*^9}, {
   3.8336126009634027`*^9, 3.8336130537589626`*^9}, {3.833613111637143*^9, 
   3.8336131170268707`*^9}, {3.833613655923808*^9, 3.8336136576318026`*^9}, {
   3.833614753497157*^9, 3.833614789448439*^9}, {3.8336157379391665`*^9, 
   3.8336157475408993`*^9}, {3.8336165455134945`*^9, 3.833616548752446*^9}, {
   3.833618052029622*^9, 3.8336181658398275`*^9}, {3.8336182003938932`*^9, 
   3.8336183092508707`*^9}, {3.833618343208076*^9, 3.833618366498211*^9}, {
   3.8336184675527787`*^9, 3.8336184826848583`*^9}, {3.8336185611658826`*^9, 
   3.8336185710109243`*^9}, {3.833618725321444*^9, 3.8336187574319115`*^9}, {
   3.833618974973215*^9, 3.8336191935943556`*^9}, {3.833619808702673*^9, 
   3.8336198186047554`*^9}, {3.8336198573252883`*^9, 3.83361985738246*^9}, {
   3.8336200639455967`*^9, 3.833620219043603*^9}, {3.8336208229044795`*^9, 
   3.833620834884215*^9}, {3.83362130796467*^9, 3.833621351022501*^9}, 
   3.833621397836501*^9, {3.833621537588046*^9, 3.8336215513871145`*^9}, {
   3.8336217716736307`*^9, 3.8336217720237427`*^9}, {3.8336218214666367`*^9, 
   3.8336218363638034`*^9}, {3.8336225688902783`*^9, 
   3.8336225749950533`*^9}, {3.833623848586149*^9, 3.8336238925160737`*^9}, {
   3.83387391022422*^9, 3.833873925899102*^9}, 3.833883014394487*^9, {
   3.8338832845862665`*^9, 3.833883285051939*^9}, {3.8338836752174263`*^9, 
   3.833883677057377*^9}, {3.833962162220616*^9, 3.8339621826167727`*^9}, {
   3.8339622345391192`*^9, 3.833962368310057*^9}, {3.833967191115449*^9, 
   3.8339671913609405`*^9}, {3.833967268918623*^9, 3.8339672691501055`*^9}, {
   3.8339673000174403`*^9, 3.833967300097452*^9}, {3.8339673582334013`*^9, 
   3.8339673851997194`*^9}, {3.833967419995755*^9, 3.8339674212434545`*^9}, {
   3.83396756351262*^9, 3.8339675661658773`*^9}, {3.8339676030416927`*^9, 
   3.833967630465831*^9}, {3.8339678302613745`*^9, 3.83396783489203*^9}, {
   3.833967866476012*^9, 3.8339678689450364`*^9}, {3.833967972307337*^9, 
   3.8339679982974844`*^9}, {3.8339680696199913`*^9, 
   3.8339681089683027`*^9}, {3.8340494383522043`*^9, 
   3.8340494384401383`*^9}, {3.834225072959453*^9, 3.834225125523203*^9}, {
   3.834235007596832*^9, 3.834235045058887*^9}, {3.8342360809735827`*^9, 
   3.8342362684216256`*^9}, {3.834236351048468*^9, 3.834236353708604*^9}, {
   3.834236393568062*^9, 3.8342363941859665`*^9}, {3.8342364420540943`*^9, 
   3.8342364441727095`*^9}, {3.834237039209513*^9, 3.8342370431185937`*^9}, 
   3.83423707435176*^9, {3.834237154243252*^9, 3.8342371662616377`*^9}, {
   3.8342372177328606`*^9, 3.8342372215784216`*^9}, {3.8342374337035933`*^9, 
   3.8342374777280307`*^9}, 3.8346561284103823`*^9, {3.8346896863222303`*^9, 
   3.834689773549176*^9}, {3.834690979970826*^9, 3.834690980160318*^9}, {
   3.8347311842046285`*^9, 3.834731538388385*^9}, {3.834731677324486*^9, 
   3.8347317212633514`*^9}, {3.8347319994327173`*^9, 
   3.8347320097352104`*^9}, {3.8347320643956842`*^9, 3.834732078712638*^9}, {
   3.834736374093274*^9, 3.834736478591133*^9}, {3.834736550686406*^9, 
   3.834736551188063*^9}, {3.8347368956289263`*^9, 3.8347369614605637`*^9}, {
   3.8347380301199617`*^9, 3.8347380351714425`*^9}, {3.8348299850051413`*^9, 
   3.834830009886249*^9}, {3.8348300415843587`*^9, 3.834830075361311*^9}, {
   3.8348301324311886`*^9, 3.83483013953811*^9}, 3.8350953198639555`*^9, {
   3.8350972084236183`*^9, 3.8350972264004393`*^9}, {3.8350985142189083`*^9, 
   3.8350985322468433`*^9}, {3.835100746852188*^9, 3.8351007958366547`*^9}, {
   3.8351018763867626`*^9, 3.835101886452034*^9}, {3.8352664292717595`*^9, 
   3.8352664566295767`*^9}, {3.8352665072125096`*^9, 
   3.8352665085656075`*^9}, {3.835266669526972*^9, 3.8352666713267365`*^9}, {
   3.83526670902256*^9, 3.8352667453631897`*^9}, {3.8352667945295906`*^9, 
   3.8352667946059*^9}, {3.835266844477721*^9, 3.835266846193886*^9}, 
   3.835266895639115*^9, 3.8352669376265974`*^9, {3.835267074825143*^9, 
   3.835267076942964*^9}, {3.835267110028122*^9, 3.8352671616270905`*^9}, 
   3.835267216219225*^9, 3.835269074294684*^9, {3.8352817379360185`*^9, 
   3.8352818080174284`*^9}, {3.8352829070545588`*^9, 3.835282931081653*^9}, {
   3.8352829860728955`*^9, 3.8352830971006217`*^9}, {3.835283138483012*^9, 
   3.8352831493630867`*^9}, 3.8352844342209125`*^9, {3.8352847274992075`*^9, 
   3.835284793523139*^9}, 3.8352848780936184`*^9, {3.835284913794419*^9, 
   3.835284914348362*^9}, {3.8352851580871887`*^9, 3.8352851778203545`*^9}, 
   3.835285210969071*^9, {3.835285241429486*^9, 3.8352852435627375`*^9}, {
   3.835285793295843*^9, 3.835285833647827*^9}, {3.8352859480086193`*^9, 
   3.8352859480745597`*^9}, {3.8352868150003924`*^9, 
   3.8352868207277956`*^9}, {3.835286897349225*^9, 3.8352869014539375`*^9}, {
   3.835286953876656*^9, 3.835286966082652*^9}, {3.835287106755674*^9, 
   3.835287115198582*^9}, {3.835287233945661*^9, 3.8352872446544695`*^9}, {
   3.8352874603713098`*^9, 3.835287464572838*^9}, 3.8352875494154673`*^9, {
   3.835353783806576*^9, 3.8353537859394636`*^9}, 3.835359717118845*^9, {
   3.8353713660505285`*^9, 3.835371374120714*^9}, 3.8353714360201797`*^9, {
   3.8353714709246798`*^9, 3.8353715122942486`*^9}, {3.8353715729180965`*^9, 
   3.835371623825508*^9}, {3.835371654832676*^9, 3.835371741211962*^9}, {
   3.835371804683507*^9, 3.8353719232740297`*^9}, {3.835373465350484*^9, 
   3.835373522794967*^9}, {3.8353735634343996`*^9, 3.835373563565752*^9}, {
   3.835373616634755*^9, 3.83537366215022*^9}, {3.835373705576515*^9, 
   3.8353737182775517`*^9}, {3.835387072795928*^9, 3.8353870728995295`*^9}, 
   3.8353872410609827`*^9, {3.835430297355345*^9, 3.8354303004068766`*^9}, {
   3.8354305697690773`*^9, 3.8354305699340696`*^9}, 3.8354309929175663`*^9, {
   3.8354499135259266`*^9, 3.835449927117567*^9}, {3.835451476288149*^9, 
   3.835451496629843*^9}, {3.8354515308813443`*^9, 3.8354515345396595`*^9}, {
   3.8356934735336456`*^9, 3.8356934790694437`*^9}, 3.8356982030250206`*^9, 
   3.8356982952522535`*^9, 3.835698563316557*^9, 3.8357001180944033`*^9, {
   3.835705959187787*^9, 3.8357059655778227`*^9}, {3.835707380003039*^9, 
   3.8357073831236954`*^9}, {3.835716687112569*^9, 3.8357166884519854`*^9}, {
   3.8357753956877003`*^9, 3.835775399861964*^9}, {3.8357896267155128`*^9, 
   3.835789663839795*^9}, {3.835789715646485*^9, 3.835789724081321*^9}, {
   3.835792313994171*^9, 3.8357923141208005`*^9}, 3.835859404714053*^9, {
   3.8358596731897125`*^9, 3.835859677744771*^9}, 3.835862588893614*^9, {
   3.8358627787752533`*^9, 3.8358627818408947`*^9}, {3.835862815404128*^9, 
   3.83586281794732*^9}, {3.8358628804964657`*^9, 3.835862916585544*^9}, 
   3.835891225751838*^9, 3.836292329989584*^9, 3.8362952450405207`*^9, {
   3.836309261759799*^9, 3.8363093424835362`*^9}, {3.836310397168093*^9, 
   3.836310424688731*^9}, {3.8363104587167063`*^9, 3.8363105059500017`*^9}, {
   3.83631058330429*^9, 3.83631058645767*^9}, {3.8363106175061703`*^9, 
   3.8363106216052303`*^9}, 3.836311371819213*^9, {3.8363114643127604`*^9, 
   3.8363114681245365`*^9}, {3.83631161074227*^9, 3.836311713906537*^9}, {
   3.8363117516467104`*^9, 3.83631178768589*^9}, {3.8363123054464903`*^9, 
   3.836312340830948*^9}, {3.8363123835828514`*^9, 3.8363123868156786`*^9}, {
   3.8363124173305016`*^9, 3.8363125156121044`*^9}, {3.836312561862465*^9, 
   3.8363125645551014`*^9}, {3.8363126916441264`*^9, 
   3.8363127426989346`*^9}, {3.8363135085178113`*^9, 3.836313559290886*^9}, {
   3.8363136482960634`*^9, 3.8363136503016014`*^9}, {3.8363138831305847`*^9, 
   3.8363139017335997`*^9}, {3.836315002223994*^9, 3.836315002638907*^9}, {
   3.836315125922*^9, 3.8363151463611574`*^9}, {3.8363154845794597`*^9, 
   3.836315523204191*^9}, 3.836316067694211*^9, {3.83631829106389*^9, 
   3.836318292896984*^9}, {3.8363194004066563`*^9, 3.8363194040091763`*^9}, {
   3.836320214692438*^9, 3.8363202162076316`*^9}, {3.836371711637008*^9, 
   3.8363717144845543`*^9}, {3.836371828452544*^9, 3.8363718356359034`*^9}, {
   3.8363770654898877`*^9, 3.8363770655876265`*^9}, {3.836377152213605*^9, 
   3.8363771855740747`*^9}, {3.8363818081618834`*^9, 3.836381810622207*^9}, 
   3.8363819019316583`*^9, {3.8365657677202787`*^9, 3.83656586614048*^9}, {
   3.836568040378225*^9, 3.8365680721428685`*^9}, {3.836568777341234*^9, 
   3.83656877838245*^9}, {3.836568916138175*^9, 3.8365689298118925`*^9}, {
   3.8365690220589213`*^9, 3.836569029326908*^9}, 3.8365691939978914`*^9, {
   3.836569245832177*^9, 3.8365692518600817`*^9}, {3.8365693670063715`*^9, 
   3.836569372759692*^9}, {3.836570396985239*^9, 3.8365703989273624`*^9}, 
   3.8365714782077703`*^9, {3.836654975974367*^9, 3.8366549807707343`*^9}, {
   3.836655067619006*^9, 3.8366550688477273`*^9}, {3.836655186023006*^9, 
   3.836655186181582*^9}, {3.8366587685047607`*^9, 3.8366588096331787`*^9}, {
   3.836658862704809*^9, 3.836658868622175*^9}, {3.8366589879644814`*^9, 
   3.8366590314014597`*^9}, {3.836659115814168*^9, 3.8366591193447266`*^9}, {
   3.8366591891004496`*^9, 3.8366592301005163`*^9}, {3.8366592660128303`*^9, 
   3.836659267313487*^9}, {3.836659325040057*^9, 3.836659325684304*^9}, 
   3.836659421976946*^9, {3.836659769965887*^9, 3.836659795898794*^9}, {
   3.8366603275343227`*^9, 3.8366603310832024`*^9}, {3.836660367392948*^9, 
   3.8366603714656177`*^9}, {3.8369093745703554`*^9, 
   3.8369093783950143`*^9}, {3.8369884888926296`*^9, 
   3.8369884970675287`*^9}, {3.8369918685387774`*^9, 3.836991883320216*^9}, {
   3.8369956205011406`*^9, 3.836995621244158*^9}, {3.8370019895480676`*^9, 
   3.837001990480612*^9}, {3.837002530762186*^9, 3.837002535756425*^9}, 
   3.8370027996927595`*^9, {3.837002836507204*^9, 3.8370028407160015`*^9}, {
   3.837002885283136*^9, 3.8370028858187037`*^9}, {3.8370029605705566`*^9, 
   3.8370029856062193`*^9}, {3.837003144582307*^9, 3.837003180619651*^9}, {
   3.837003239324083*^9, 3.837003240533848*^9}, 3.8370032821529317`*^9, {
   3.8370033670455923`*^9, 3.837003380392253*^9}, {3.8370043743047776`*^9, 
   3.8370043782572556`*^9}, {3.8370044711938133`*^9, 3.837004478063162*^9}, {
   3.83700453138428*^9, 3.8370045317333965`*^9}, {3.837004584038473*^9, 
   3.8370045928375487`*^9}, 3.8370047285731287`*^9, {3.837005061649108*^9, 
   3.837005071453559*^9}, {3.837005166938338*^9, 3.8370051724689617`*^9}, {
   3.8370052471356425`*^9, 3.837005250230899*^9}, {3.8370052860235343`*^9, 
   3.837005288038124*^9}, {3.8370053571893835`*^9, 3.837005383048487*^9}, {
   3.8370054855747366`*^9, 3.8370054960022798`*^9}, {3.8370056153752904`*^9, 
   3.837005622034311*^9}, {3.8370056591534643`*^9, 3.8370056641838617`*^9}, {
   3.837005739974957*^9, 3.837005752873768*^9}, {3.837005799125167*^9, 
   3.837005804779255*^9}, {3.837005863172676*^9, 3.8370058639805155`*^9}, {
   3.8370764272260976`*^9, 3.8370764293937902`*^9}, {3.837077909362463*^9, 
   3.837077971117426*^9}, {3.837085419030095*^9, 3.8370854212710667`*^9}, {
   3.837093006849332*^9, 3.8370930494122562`*^9}, 3.8371135147493615`*^9, {
   3.8371143037862234`*^9, 3.8371143207901134`*^9}, {3.8371570199368753`*^9, 
   3.837157040444518*^9}, {3.837157096155944*^9, 3.8371570978474293`*^9}, {
   3.837622733664155*^9, 3.837622737064064*^9}, {3.8376232896024523`*^9, 
   3.83762333990138*^9}, {3.8376235484127207`*^9, 3.8376235815509534`*^9}, {
   3.8376236409947224`*^9, 3.837623644163332*^9}, {3.8376242552109146`*^9, 
   3.837624273519412*^9}, {3.8376244095564575`*^9, 3.837624411304326*^9}, {
   3.8376245271520557`*^9, 3.8376245324441624`*^9}, {3.8376246966408887`*^9, 
   3.8376246976112933`*^9}, {3.837624749239458*^9, 3.8376247738614597`*^9}, 
   3.837624906352302*^9, {3.8376285876200914`*^9, 3.837628626306157*^9}, {
   3.8377692258732624`*^9, 3.8377692439403553`*^9}, {3.8378717597455664`*^9, 
   3.8378717760191793`*^9}, {3.837873995240386*^9, 3.8378739960841293`*^9}, 
   3.8387417678636603`*^9, {3.8387418122320523`*^9, 3.8387418579483376`*^9}, {
   3.8389729899650183`*^9, 3.838972991881075*^9}, {3.8390621699849186`*^9, 
   3.839062172483238*^9}, {3.8394895280788317`*^9, 3.839489531470357*^9}, {
   3.8395852315729218`*^9, 3.8395852348692827`*^9}, {3.839588337866787*^9, 
   3.839588407863155*^9}, {3.839668879697318*^9, 3.83966888195827*^9}, {
   3.8396755788056793`*^9, 3.8396755795237584`*^9}, 3.839749209598377*^9, {
   3.839749463556749*^9, 3.8397494656359844`*^9}, {3.8397581616423535`*^9, 
   3.839758165022586*^9}, {3.8397597938338814`*^9, 3.8397597939854755`*^9}, {
   3.8397605948797464`*^9, 3.8397606037003703`*^9}, 3.8397606693793397`*^9, {
   3.8400890205561867`*^9, 3.8400890205731196`*^9}, {3.840089141666494*^9, 
   3.8400891502906833`*^9}, {3.8400893091108418`*^9, 3.840089309128825*^9}, {
   3.8400893960027766`*^9, 3.8400893990898237`*^9}, {3.8400900397959423`*^9, 
   3.8400900592724967`*^9}, 3.840090090321829*^9, {3.8400926672089615`*^9, 
   3.8400926705213065`*^9}, {3.840092804273389*^9, 3.8400928109426813`*^9}, {
   3.84009509021146*^9, 3.840095090230384*^9}, {3.840111383074894*^9, 
   3.840111386098387*^9}, {3.8401118742032623`*^9, 3.8401118795544863`*^9}, {
   3.840184126995998*^9, 3.84018413057137*^9}, {3.840188085374566*^9, 
   3.8401881237479134`*^9}, 3.8401881760159802`*^9, {3.840525333731312*^9, 
   3.840525336890418*^9}, {3.8405255149956055`*^9, 3.840525521615678*^9}, 
   3.840525609149866*^9, {3.8405267850903563`*^9, 3.840526795625825*^9}, {
   3.8405568493899436`*^9, 3.8405568611927843`*^9}, {3.8406193548516912`*^9, 
   3.8406193614582596`*^9}, {3.840624677109535*^9, 3.840624684556605*^9}, {
   3.841576288023748*^9, 3.841576290559283*^9}, {3.84157973809054*^9, 
   3.841579739715165*^9}, {3.84166053738371*^9, 3.8416605403040886`*^9}, {
   3.841742845867052*^9, 3.8417428466369934`*^9}, 3.8417440801924515`*^9, {
   3.8426017609512005`*^9, 3.842601761526662*^9}, {3.8432919360121355`*^9, 
   3.843291948436283*^9}, {3.8434693700857916`*^9, 3.8434693729135604`*^9}, {
   3.8434728871829314`*^9, 3.8434728973435745`*^9}, {3.8447696060358443`*^9, 
   3.8447696100750446`*^9}, {3.844770371255912*^9, 3.8447703717994895`*^9}, {
   3.8447706571476097`*^9, 3.8447706600716553`*^9}, {3.84477171313129*^9, 
   3.8447717149640164`*^9}, {3.8447757595914803`*^9, 
   3.8447757596293793`*^9}, {3.8454656933484173`*^9, 
   3.8454656958247952`*^9}, {3.8454657916128902`*^9, 3.845465793660438*^9}, {
   3.8454727966603785`*^9, 3.8454727987448044`*^9}, {3.8456362199869647`*^9, 
   3.845636245034369*^9}, {3.8456386644019275`*^9, 3.8456386665726337`*^9}, {
   3.8456577388597355`*^9, 3.845657739535776*^9}, {3.845657778211796*^9, 
   3.84565780121167*^9}, 3.8456585841647077`*^9, {3.84565884330424*^9, 
   3.8456588501657515`*^9}, {3.855904160439987*^9, 3.8559041639566145`*^9}, {
   3.855909416745515*^9, 3.855909419079275*^9}, {3.856005350895994*^9, 
   3.8560053544784145`*^9}, 3.856518983138687*^9, {3.8565209321390567`*^9, 
   3.8565209411139994`*^9}, {3.857032768988885*^9, 3.8570327966069994`*^9}, {
   3.857032884428009*^9, 3.857032889339886*^9}, {3.857033358314024*^9, 
   3.8570333625598745`*^9}, {3.857033441732684*^9, 3.8570334425718975`*^9}, {
   3.8570474613500624`*^9, 3.8570474645983768`*^9}, {3.8570502019102407`*^9, 
   3.857050205374975*^9}, {3.8576424675119247`*^9, 3.8576424724487286`*^9}, {
   3.8621337420759525`*^9, 3.8621337426524115`*^9}, {3.864721989186022*^9, 
   3.864721992689687*^9}, {3.864722302114386*^9, 3.8647223046272173`*^9}, {
   3.865527073304619*^9, 3.8655270766003056`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[141]:=",ExpressionUUID->"fa67cb41-f069-45c2-ac35-7fec9b162b28"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export & Import", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8338826936159997`*^9, 
   3.833882694258896*^9}, {3.8338833391990476`*^9, 3.833883340659916*^9}, {
   3.834555668295546*^9, 3.8345556687848897`*^9}, {3.8363155330383687`*^9, 
   3.836315537730116*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"2e54da77-49b4-48c1-8e00-2299f8b9c563"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"export", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"frameout", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<Exports\>\""}], "}"}], "]"}], "]"}]}], ",", 
         RowBox[{"CreateDirectory", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", "\"\<Exports\>\"", "}"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Exports\>\""}], 
          "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"expsQ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 "\"\<Exports\>\"", ",", "\"\<Simulations\>\""}], "}"}], 
               "]"}], "]"}]}], ",", 
            RowBox[{"CreateDirectory", "[", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", "\"\<Simulations\>\"", "}"}], "]"}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetDirectory", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Exports\>\"",
               ",", "\"\<Simulations\>\""}], "}"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"foldername", "=", 
           RowBox[{"If", "[", 
            RowBox[{"cusnQ", ",", "nmp", ",", 
             RowBox[{"\"\<Simulation\>\"", "  ", "<>", " ", "\"\< - \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Floor", "@", 
                RowBox[{
                 RowBox[{"Date", "[", "]"}], "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"CreateDirectory", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", "foldername", "}"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SetDirectory", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Exports\>\"",
               ",", "\"\<Simulations\>\"", ",", "foldername"}], "}"}], "]"}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", "x", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"imgse", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"exp1", "=", 
        RowBox[{"frameout", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"exp20", "=", 
        RowBox[{"frameout", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tT0", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"j", ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                 RowBox[{"\"\<t = `1`\>\"", "<>", 
                  RowBox[{"If", "[", 
                   RowBox[{"plotSOPQ", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    "\"\<\\nSOPs: `2` (top), `3` (bottom)\>\"", ",", 
                    "\"\<\\nSOPs: `2`\>\""}], "]"}], ",", "un"}], "]"}]}], 
                 ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"plotSOPQ", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dlf2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"dlf1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"dlf", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "un"}], 
                  "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"imgse", " ", "30"}], ",", 
               RowBox[{"Darker", "[", 
                RowBox[{
                 RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], "]"}], 
               ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigyM", ",", "plyM"}], "}"}], "]"}]}], "}"}]}], 
            "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tT", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"cusnQ", ",", "nmp", ",", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<SOP patterning (Berkemeier ``)\>\"", ",", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"imgse", " ", "30"}], ",", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], "]"}], 
             ",", "Bold"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"sigym", ",", "plym"}], "}"}], "]"}]}], "}"}]}], "]"}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"SIMULATION", " ", "EXPORT"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"animQ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exampleFrames", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"colob", ",", "plate"}], "}"}], "]"}], ",", 
               RowBox[{"allcels", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"stetbQ", "&&", "streQ", "&&", 
                  RowBox[{"stet", "==", "2"}]}], ",", 
                 RowBox[{"recs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"grQ", ",", 
                 RowBox[{"gr", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"tT0", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
               "tT", ",", "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"imgse", 
                 RowBox[{"{", 
                  RowBox[{"1920", ",", " ", "1080"}], "}"}]}]}], ",", 
               RowBox[{"Background", "\[Rule]", "colob"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "sols", "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rasterizedFrames", "=", 
           RowBox[{"Image", "/@", "exampleFrames"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "expsQ"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FileExistsQ", "[", 
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Videos\>\""}], "}"}], "]"}], 
                 "]"}]}], ",", 
               RowBox[{"CreateDirectory", "[", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", "\"\<Videos\>\"", "}"}], "]"}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"SetDirectory", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 "\"\<Exports\>\"", ",", "\"\<Videos\>\""}], "}"}], "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"cusnQ", ",", "nmp", ",", 
               RowBox[{
               "\"\<Simulation Movie\>\"", "  ", "<>", " ", "\"\< - \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Floor", "@", 
                  RowBox[{
                   RowBox[{"Date", "[", "]"}], "[", 
                   RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], "]"}], "<>", 
             "\"\<.mp4\>\""}], ",", "rasterizedFrames", ",", 
            RowBox[{"ImageResolution", "\[Rule]", "3000"}], ",", 
            RowBox[{"Antialiasing", "\[Rule]", "True"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exampleFrame", "=", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"colob", ",", "plate"}], "}"}], "]"}], ",", 
             RowBox[{"allcels", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"grQ", ",", 
               RowBox[{"gr", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"tT0", "[", 
              RowBox[{"Length", "[", "sols", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", "tT", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"imgse", 
               RowBox[{"{", 
                RowBox[{"1920", ",", " ", "1080"}], "}"}]}]}], ",", 
             RowBox[{"Background", "\[Rule]", "colob"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "expsQ"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FileExistsQ", "[", 
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Snapshots\>\""}], "}"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"CreateDirectory", "[", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", "\"\<Snapshots\>\"", "}"}], "]"}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"SetDirectory", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 "\"\<Exports\>\"", ",", "\"\<Snapshots\>\""}], "}"}], "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"cusnQ", ",", "nmp", ",", 
               RowBox[{"\"\<Simulation\>\"", "  ", "<>", " ", "\"\< - \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{"Date", "[", "]"}], "[", 
                  RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Floor", "@", 
                  RowBox[{
                   RowBox[{"Date", "[", "]"}], "[", 
                   RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], "]"}], "<>", 
             "\"\<.pdf\>\""}], ",", "exampleFrame"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"PLOTS", " ", "EXPORT"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringQ", "@", "exp20"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plotnames", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"plotSOPQ", ",", "\"\<SOPs\>\"", ",", "un"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"plotsolQ", ",", "\"\<Solutions\>\"", ",", "un"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"plotperQ", ",", "\"\<Perimeter\>\"", ",", "un"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
              "plotcoeffvQ", ",", "\"\<Coefficient of variation\>\"", ",", 
               "un"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
              "plotSOPnQ", ",", "\"\<SOP distance (#)\>\"", ",", "un"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
              "plotSOPdQ", ",", "\"\<SOP distance (Euclidean)\>\"", ",", 
               "un"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "plottimeQ"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"exp2", "=", "plots"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", "expsQ"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"FileExistsQ", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Plots\>\""}], "}"}], "]"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"CreateDirectory", "[", 
                   RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", "\"\<Plots\>\"", "}"}], "]"}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"SetDirectory", "[", 
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Plots\>\""}], "}"}], "]"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"plotnames", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], " ", "<>", " ", 
                  "\"\< - \>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Floor", "@", 
                    RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "<>", 
                  "\"\<.pdf\>\""}], ",", 
                 RowBox[{"exp2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "@", "exp2"}]}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"exampleFramesl", "=", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "plotsl"}], ")"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"rasterizedFramesl", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Image", "/@", 
                 RowBox[{"exampleFramesl", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "plotnames"}]}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", "expsQ"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"FileExistsQ", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Plots\>\"", ",", 
                    "\"\<Plot movies\>\""}], "}"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SetDirectory", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Plots\>\""}], "}"}], "]"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"CreateDirectory", "[", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", "\"\<Plot movies\>\"", "}"}], "]"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"SetDirectory", "[", 
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Exports\>\"", ",", "\"\<Plots\>\"", ",", 
                    "\"\<Plot movies\>\""}], "}"}], "]"}], "]"}]}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"plotnames", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], " ", "<>", " ", 
                  "\"\< - \>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", 
                  "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Floor", "@", 
                    RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "<>", 
                  "\"\<.mp4\>\""}], ",", 
                 RowBox[{"rasterizedFramesl", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"ImageResolution", "\[Rule]", "3000"}], ",", 
                 RowBox[{"Antialiasing", "\[Rule]", "True"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "@", "plotnames"}]}], "}"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportd", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"svc", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"cusnQ", ",", "nmp", ",", 
           RowBox[{"\"\<Model data\>\"", "<>", " ", "\"\< - \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Date", "[", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Date", "[", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Date", "[", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Date", "[", "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Date", "[", "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "]"}], "<>", "\"\<'\>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{"Floor", "@", 
              RowBox[{
               RowBox[{"Date", "[", "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], "]"}], "<>", " ", 
         "\"\< (\>\"", "<>", 
         RowBox[{"ToString", "[", "fversion", "]"}], "<>", "\"\<)\>\"", "<>", 
         "\"\<.dat\>\""}], ",", "dt"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loadf", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataName", "=", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<FileOpen\>\"", ",", 
         RowBox[{"SetDirectory", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<Models\>\""}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], ",", 
               "\"\<Models\>\""}], "}"}], "]"}], ",", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", ",", 
         "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", "sorc", ",", 
         "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
         ",", "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", 
         ",", "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", "vormod", 
         ",", "smod", ",", 
         StyleBox["ka", "Input"], 
         StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
         "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", "diamx",
          ",", "depQ", ",", 
         StyleBox["ka2", "Input"], 
         StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", 
         "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
         StyleBox["ka3", "Input"], 
         StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", 
         "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", 
         "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy", 
         ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",", "Tsim2", 
         ",", "sigs", ",", "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", 
         ",", "stretNQ", ",", "stretN", ",", "Trele", ",", "Thold", ",", 
         "sigallQ", ",", "stetbQ", ",", "bthk", ",", "Tstei", ",", "Tstef", 
         ",", "fareaQ", ",", "fperQ", ",", "fltensQ", ",", "fhookeQ", ",", 
         "rho", ",", "k", ",", "h", ",", "mu", ",", "aN0", ",", "bN0", ",", 
         "iniN", ",", "iniD", " ", ",", "iniR", ",", "\[Beta]N", ",", 
         "\[Beta]D", ",", "\[Beta]R", ",", "\[Tau]", ",", "\[Kappa]t", ",", 
         "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", 
         "cisQ", ",", "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", 
         "nv", ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", "effvol", ",", 
         "dynpQ", ",", "uplQ", ",", "pfixQ", ",", "pbt", ",", "pdt", ",", 
         "pll", ",", "pla", ",", "\[Epsilon]", ",", "cellQ", ",", "longt", 
         ",", "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", "colo1", ",", 
         "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], "}"}], "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"dataName", ",", "\"\<List\>\""}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8260308543663063`*^9, 3.8260308797396097`*^9}, {
   3.8260484657149534`*^9, 3.8260484672155533`*^9}, {3.8260485818344727`*^9, 
   3.826048583013398*^9}, {3.8260486636542797`*^9, 3.826048667145936*^9}, {
   3.8260487257589273`*^9, 3.8260487269021697`*^9}, {3.8260494313310575`*^9, 
   3.8260494592854147`*^9}, {3.826083139892048*^9, 3.8260831447095194`*^9}, {
   3.82608669330847*^9, 3.8260866934300957`*^9}, {3.8260874153198414`*^9, 
   3.826087418303621*^9}, {3.8260891419033346`*^9, 3.826089142385808*^9}, {
   3.8260912484187555`*^9, 3.826091248710965*^9}, {3.826091614797104*^9, 
   3.8260916179293427`*^9}, {3.826091674127561*^9, 3.8260916853173885`*^9}, {
   3.826094370333968*^9, 3.8260943769841304`*^9}, {3.8260956614837303`*^9, 
   3.826095661979802*^9}, {3.8260968370237427`*^9, 3.8260968392824435`*^9}, {
   3.826097722106609*^9, 3.82609772510378*^9}, {3.8260991526362967`*^9, 
   3.8260991550126143`*^9}, {3.826100284901946*^9, 3.82610028536794*^9}, {
   3.8261007323730035`*^9, 3.826100733045615*^9}, {3.8261017381152315`*^9, 
   3.826101741796569*^9}, {3.8261070793124447`*^9, 3.8261070864378214`*^9}, {
   3.82610973837737*^9, 3.8261097546074553`*^9}, {3.8261194216280036`*^9, 
   3.8261194437968383`*^9}, {3.827847817144483*^9, 3.8278478175201845`*^9}, {
   3.827847881291585*^9, 3.8278478885900717`*^9}, {3.832779427026119*^9, 
   3.832779431474106*^9}, {3.8340726208037643`*^9, 3.834072622227874*^9}, {
   3.8342331091266284`*^9, 3.8342331117794333`*^9}, {3.834234473377798*^9, 
   3.8342344749469757`*^9}, {3.8345556119529605`*^9, 
   3.8345556190397954`*^9}, {3.834558449637323*^9, 3.834558451817921*^9}, {
   3.8352845912405357`*^9, 3.835284591718258*^9}, {3.8352846696451197`*^9, 
   3.835284675336892*^9}, {3.835285190559432*^9, 3.8352852356710052`*^9}, {
   3.8352861062242126`*^9, 3.8352861107519364`*^9}, {3.835286169692213*^9, 
   3.8352862243102865`*^9}, {3.8352863779943814`*^9, 3.835286390029408*^9}, 
   3.835286518686816*^9, {3.8354478657781696`*^9, 3.8354478683799515`*^9}, 
   3.83570841290834*^9, {3.835708573729254*^9, 3.8357085909254856`*^9}, {
   3.8357086277373323`*^9, 3.8357086977545795`*^9}, {3.8357093565866013`*^9, 
   3.835709371651837*^9}, {3.8357094993578186`*^9, 3.8357095028599553`*^9}, {
   3.8357151346549435`*^9, 3.8357151738718367`*^9}, {3.8357757151731033`*^9, 
   3.835775715998192*^9}, {3.835859097850289*^9, 3.835859111747734*^9}, {
   3.8358593824207067`*^9, 3.83585939724445*^9}, {3.835860019278259*^9, 
   3.835860023414959*^9}, {3.8358602673642845`*^9, 3.8358602725655193`*^9}, {
   3.83586872076635*^9, 3.8358687298226247`*^9}, {3.835869336253296*^9, 
   3.835869336257285*^9}, {3.8363138530828485`*^9, 3.836313950149593*^9}, {
   3.8363149727576785`*^9, 3.836314984953396*^9}, 3.836315234371842*^9, {
   3.83631554509984*^9, 3.8363155764772825`*^9}, {3.8363156607286854`*^9, 
   3.836315665422686*^9}, {3.8363157670095825`*^9, 3.8363157684387584`*^9}, {
   3.8363157986567717`*^9, 3.8363158000782804`*^9}, {3.836316279722989*^9, 
   3.836316324315732*^9}, {3.8363164119518766`*^9, 3.8363164123838377`*^9}, {
   3.836316475958087*^9, 3.836316478235608*^9}, 3.8363170929990473`*^9, {
   3.836317632584695*^9, 3.8363176378682127`*^9}, {3.8363192746312265`*^9, 
   3.83631934039979*^9}, 3.8363196923919516`*^9, {3.8363227535634594`*^9, 
   3.8363227849768553`*^9}, 3.8363717164653254`*^9, 3.8363718368416767`*^9, {
   3.836379694894379*^9, 3.8363797050713243`*^9}, 3.836379785074732*^9, {
   3.8363804871910877`*^9, 3.836380512917285*^9}, 3.836506475606048*^9, {
   3.83650651025705*^9, 3.836506522200344*^9}, 3.8365680160318055`*^9, {
   3.8365680803696604`*^9, 3.836568080592065*^9}, {3.836568198984114*^9, 
   3.8365682282890635`*^9}, 3.8365697041476407`*^9, {3.8365701304630013`*^9, 
   3.8365701336433764`*^9}, {3.836570572978754*^9, 3.836570573607074*^9}, {
   3.8365706886016555`*^9, 3.8365706904295645`*^9}, 3.8365709441193438`*^9, {
   3.836571624304314*^9, 3.8365716449653893`*^9}, {3.836814258209691*^9, 
   3.836814282854487*^9}, 3.836814321129051*^9, {3.8368144773971715`*^9, 
   3.8368144781225457`*^9}, {3.8368145567832975`*^9, 3.836814557789637*^9}, 
   3.836909380879587*^9, 3.836988500441507*^9, 3.8370764307898088`*^9, 
   3.837085422501805*^9, 3.837622738421434*^9, {3.8377693717562866`*^9, 
   3.837769443960345*^9}, {3.8377695708097687`*^9, 3.837769587122484*^9}, {
   3.8377706467425404`*^9, 3.837770665319321*^9}, {3.8377706959095745`*^9, 
   3.8377707058718023`*^9}, {3.8377707381282096`*^9, 
   3.8377707491246014`*^9}, {3.8377709039263153`*^9, 
   3.8377709307173448`*^9}, {3.837771033786606*^9, 3.8377710359908624`*^9}, {
   3.8377719882464056`*^9, 3.8377719885048103`*^9}, 3.839061933659457*^9, 
   3.83948953397204*^9, {3.8394963427797003`*^9, 3.8394963470384855`*^9}, {
   3.839576362249181*^9, 3.839576366077178*^9}, {3.839585119161278*^9, 
   3.8395851228504057`*^9}, 3.839585240526507*^9, {3.840089020579119*^9, 
   3.8400890205821114`*^9}, 3.8400891663111267`*^9, 3.840089309131818*^9, {
   3.8400894283379965`*^9, 3.840089446911891*^9}, {3.840089622920854*^9, 
   3.840089652807313*^9}, 3.840090063548238*^9, 3.8400926780299616`*^9, 
   3.8400950902343674`*^9, 3.8401113871755056`*^9, 3.8401118804795437`*^9, 
   3.840190636774864*^9, 3.840525338039925*^9, 3.840526800239406*^9, 
   3.840619363255451*^9, 3.840624687034692*^9, 3.8416605413078394`*^9, {
   3.841730690712858*^9, 3.841730707836611*^9}, {3.841730781675987*^9, 
   3.8417308635840535`*^9}, {3.8417310217208576`*^9, 3.8417311018663363`*^9}, 
   3.8417345855686965`*^9, {3.841734622677223*^9, 3.8417346240143733`*^9}, {
   3.8417349054553757`*^9, 3.841734924120109*^9}, {3.841738259240091*^9, 
   3.841738268170873*^9}, {3.8417383073783903`*^9, 3.841738350109816*^9}, {
   3.8417384115250053`*^9, 3.8417384540735493`*^9}, {3.8417384898298426`*^9, 
   3.841738510933003*^9}, {3.841738557655589*^9, 3.8417385687482195`*^9}, {
   3.8417386717734547`*^9, 3.841738712417001*^9}, {3.8417387650208454`*^9, 
   3.841738786972329*^9}, {3.84173881759624*^9, 3.841738817696971*^9}, {
   3.8417388633386517`*^9, 3.841739033412715*^9}, {3.8417393773188734`*^9, 
   3.841739394878475*^9}, 3.8417397344448605`*^9, {3.8417399837482433`*^9, 
   3.8417399841142883`*^9}, {3.8417406792590785`*^9, 3.841740686278487*^9}, {
   3.8417407529124045`*^9, 3.84174077796958*^9}, {3.84174128699993*^9, 
   3.8417414507139597`*^9}, {3.8417415883611155`*^9, 
   3.8417415946573954`*^9}, {3.8417416665171895`*^9, 3.841741678236088*^9}, {
   3.8417417517989283`*^9, 3.841741791225278*^9}, {3.841741843012124*^9, 
   3.8417418541889668`*^9}, {3.8417421213712454`*^9, 
   3.8417421602403708`*^9}, {3.841742201895429*^9, 3.8417422020340576`*^9}, {
   3.8417423489509115`*^9, 3.8417423507067184`*^9}, {3.8417429990567665`*^9, 
   3.841743000203574*^9}, {3.84174419312105*^9, 3.8417442527467175`*^9}, {
   3.841744302917292*^9, 3.8417444913194056`*^9}, {3.8417448008776445`*^9, 
   3.8417448163706045`*^9}, 3.8426017617171545`*^9, {3.8432919360430794`*^9, 
   3.8432919484402437`*^9}, {3.843469383984651*^9, 3.843469401299739*^9}, {
   3.843472887207862*^9, 3.843472897346572*^9}, 3.8447696111202497`*^9, 
   3.8447703719770155`*^9, 3.8447706615300884`*^9, 3.84477171573695*^9, {
   3.844775759639327*^9, 3.8447757596423445`*^9}, 3.8454656969936686`*^9, 
   3.8454657946777177`*^9, 3.8454727996942654`*^9, {3.845481899025714*^9, 
   3.8454819004466624`*^9}, 3.8456362492201724`*^9, 3.8456386676499805`*^9, {
   3.854626597266833*^9, 3.8546266536922064`*^9}, {3.854626684135783*^9, 
   3.8546266867217655`*^9}, 3.8546267209872413`*^9, 3.855904165098566*^9, 
   3.855909420401739*^9, 3.856005355297225*^9, 3.856518993208124*^9, {
   3.856519603735859*^9, 3.8565196039512815`*^9}, {3.8565208683427505`*^9, 
   3.8565208684863677`*^9}, 3.8565229766302347`*^9, 3.8570319820269527`*^9, 
   3.857032797727131*^9, 3.8570328888152885`*^9, 3.8570333650868154`*^9, 
   3.8570334429498863`*^9, 3.8570474659846697`*^9, 3.8570502062925215`*^9, 
   3.857642473474018*^9, 3.862133742853873*^9, 3.864721994246667*^9, 
   3.8647223053682623`*^9, 3.865527077485979*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[149]:=",ExpressionUUID->"47b2ac4d-a87e-4ae0-87ad-69172bcbc70c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Statistics", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8338826936159997`*^9, 
   3.833882694258896*^9}, {3.8338833391990476`*^9, 3.833883340659916*^9}, {
   3.8345556760520754`*^9, 3.8345556777910366`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"3570e9ac-d272-4b96-9001-b50f56f5541d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"clearData", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data1SOPnl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data2SOPnl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dlf1l", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"dlf2l", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"dlfl", "=", 
       RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.840175658660492*^9, 3.8401756709491935`*^9}, {
  3.8415763498678164`*^9, 3.8415763696701593`*^9}, {3.8415797038595853`*^9, 
  3.8415797151557026`*^9}, {3.8655363708330755`*^9, 3.8655363709746976`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[152]:=",ExpressionUUID->"3bd8804e-687c-48e6-a9fb-f3c6654a2ff1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data0", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data1per", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data2per", "=", 
       RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.840175658660492*^9, 3.8401756709491935`*^9}, {
  3.8415763498678164`*^9, 3.8415763696701593`*^9}, {3.8415797038595853`*^9, 
  3.8415797196357574`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[153]:=",ExpressionUUID->"cd5d9982-322f-4989-bf76-647836dc80ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataFn", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", ",",
        "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
       "sigm", ",", "sols", ",", "solnsl", ",", "plistn", ",", "lvs", ",", 
       "lvs1", ",", "lvs2", ",", "iii"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotlistQn", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
           ",", "plotsolQ", ",", "plotSOPQ"}], "}"}], ",", "True"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"plotlistQn", ">", "0"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"DELTA", " ", "DATA"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dlf", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"#", ">", "dlthresh"}], "&"}]}], "]"}]}], "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"#", ",", "lvs"}], "]"}], "&"}], ",", "solnsl"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"dlfl", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"dlfl", ",", "dlf"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dlf2", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigr", "==", "1"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"#", ">", "dlthresh"}], "&"}]}], "]"}]}], "&"}], 
              ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"#", ",", "lvs2"}], "]"}], "&"}], ",", "solnsl"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dlf1", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigr", "==", "1"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"#", ">", "dlthresh"}], "&"}]}], "]"}]}], "&"}], 
              ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"#", ",", "lvs1"}], "]"}], "&"}], ",", "solnsl"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dlf1l", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"dlf1l", ",", "dlf1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dlf2l", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"dlf2l", ",", "dlf2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nin", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"lvs", ",", "din"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PERIMETER", " ", "DATA"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"pern", "=", 
          RowBox[{"Perimeter", "/@", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"Last", "[", "plistn", "]"}], ",", "nin"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"perd", "=", 
          RowBox[{"Perimeter", "/@", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"Last", "[", "plistn", "]"}], ",", "din"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"data1per", "=", 
          RowBox[{"Flatten", "@", "pern"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data2per", "=", 
          RowBox[{"Flatten", "@", "perd"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"SOLUTIONS", " ", "DATA"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dval", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dinval", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dinapp", "=", 
          RowBox[{"10.", "^", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<=", 
            RowBox[{"Length", "@", 
             RowBox[{"Last", "[", "lv", "]"}]}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"dval", ",", 
                RowBox[{"N", "@", 
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sols", "[", 
                    RowBox[{"[", 
                    RowBox[{"iii", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "dinapp"}], 
                  "]"}]}]}], "]"}], ",", "Nothing", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"dinval", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"dinval", ",", 
                 RowBox[{
                  RowBox[{"Last", "[", "lv", "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dval", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"dval", ",", 
               RowBox[{"N", "@", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"sols", "[", 
                    RowBox[{"[", 
                    RowBox[{"iii", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "dinapp"}], "]"}]}]}],
               "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"SOP", " ", "DISTANCE"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cnt", "=", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"all", ",", "dlts"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cntl", "=", 
                 RowBox[{"{", "}"}]}], ";", 
                RowBox[{"ci", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "\[LessEqual]", 
                   RowBox[{"Length", "@", "all"}]}], ",", 
                  RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"dlts", ",", 
                    RowBox[{"all", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"cntl", ",", "ci"}], "]"}], ";", 
                    RowBox[{"ci", "=", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"ci", "++"}], ";"}]}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Drop", "[", 
                 RowBox[{"cntl", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cntd", "=", 
             RowBox[{"Function", "[", 
              RowBox[{"dlts", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"dlts", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"dlts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{
                    RowBox[{"Length", "@", "dlts"}], "-", "1"}]}], "}"}]}], 
                "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"din1", "=", 
             RowBox[{"Intersection", "[", 
              RowBox[{"lvs1", ",", "din"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"din2", "=", 
             RowBox[{"Intersection", "[", 
              RowBox[{"lvs2", ",", "din"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"olvs1", "=", 
             RowBox[{
              RowBox[{"SortBy", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"RegionCentroid", ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "lvs1"}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "lvs1"}], 
                  "}"}], "]"}], ",", "First"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"olvs2", "=", 
             RowBox[{
              RowBox[{"SortBy", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"RegionCentroid", ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "lvs2"}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "lvs2"}], 
                  "}"}], "]"}], ",", "First"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"odin1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"olvs1", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"din1", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"odin2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"olvs2", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"din2", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"asslT", "=", "asslJp"}], ";", "\[IndentingNewLine]", 
            RowBox[{"grv", "=", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asslT", "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "]"}], "=!=", "0"}], ",", 
                    
                    RowBox[{"i", "\[UndirectedEdge]", "j"}], ",", "Nothing"}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}], "]"}], ",", 
               "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"grd", "=", 
             RowBox[{"SimpleGraph", "[", "grv", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nn1", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"grd", ",", 
                   RowBox[{"odin1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                   RowBox[{"odin1", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}]}], "-", 
                "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "odin1"}], "-", "1"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"nn2", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"grd", ",", 
                   RowBox[{"odin2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                   RowBox[{"odin2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}]}], "-", 
                "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "odin2"}], "-", "1"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"odin1c", "=", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"RegionCentroid", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "plistn", "]"}], ",", "odin1"}], 
                 "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"odin2c", "=", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"RegionCentroid", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "plistn", "]"}], ",", "odin2"}], 
                 "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"SOP", " ", "DISTANCE", " ", 
              RowBox[{"(", "#", ")"}], " ", "DATA"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"data1SOPn", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nn1", "==", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"{", "0", "}"}], ",", "nn1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"data2SOPn", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nn2", "==", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"{", "0", "}"}], ",", "nn2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"data1SOPnl", ",", "data1SOPn"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"data2SOPnl", ",", "data2SOPn"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"din1l", ",", "din1"}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"din2l", ",", "din2"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"row1cSOPn", "=", 
             RowBox[{"Mean", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "#", "]"}], "+", "1"}], "&"}], ",", 
                "data1SOPn"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"row2cSOPn", "=", 
             RowBox[{"Mean", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "#", "]"}], "+", "1"}], "&"}], ",", 
                "data2SOPn"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"SOP", " ", "DISTANCE", " ", 
              RowBox[{"(", "EUCLIDEAN", ")"}], " ", "DATA"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"data1SOPd", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nn1", "==", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"cntd", "[", "odin1c", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"data2SOPd", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nn1", "==", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"cntd", "[", "odin1c", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"row1cSOPd", "=", 
             RowBox[{"Mean", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "#", "]"}], "+", "1"}], "&"}], ",", 
                "data1SOPd"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"row2cSOPd", "=", 
             RowBox[{"Mean", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "#", "]"}], "+", "1"}], "&"}], ",", 
                "data2SOPd"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8400821932176857`*^9, 3.8400822101837564`*^9}, {
   3.840082290488959*^9, 3.840082345577315*^9}, {3.8400824292137346`*^9, 
   3.840082451885083*^9}, {3.840084181557807*^9, 3.840084181895218*^9}, {
   3.8400842143462286`*^9, 3.8400843018529205`*^9}, {3.84008761576598*^9, 
   3.8400876211919394`*^9}, {3.8400876951745853`*^9, 
   3.8400877002101955`*^9}, {3.8400885930123444`*^9, 
   3.8400886039248514`*^9}, {3.8400890205880637`*^9, 3.840089020591056*^9}, {
   3.84009080075395*^9, 3.8400908213407803`*^9}, {3.8400914388517833`*^9, 
   3.8400914805429387`*^9}, 3.840092679303929*^9, 3.8400950902413497`*^9, {
   3.8400961638824224`*^9, 3.840096175281678*^9}, {3.840096224620162*^9, 
   3.8400962322915444`*^9}, {3.8400967041771946`*^9, 3.840096704801798*^9}, {
   3.840099206089572*^9, 3.8400992181203957`*^9}, {3.8401030166457434`*^9, 
   3.8401030237628613`*^9}, {3.840111805945986*^9, 3.8401118061765947`*^9}, 
   3.8401118884642296`*^9, {3.840111981123144*^9, 3.8401119897979436`*^9}, {
   3.8401745420503025`*^9, 3.840174544151539*^9}, {3.84017471322307*^9, 
   3.840174730965534*^9}, {3.8401750946529784`*^9, 3.8401751923081694`*^9}, 
   3.840175579768339*^9, {3.841574074620969*^9, 3.841574079142644*^9}, {
   3.841576435105508*^9, 3.841576457669299*^9}, {3.841656289820698*^9, 
   3.8416563030563297`*^9}, {3.841656378978485*^9, 3.8416563987776055`*^9}, {
   3.841739163297239*^9, 3.84173916366057*^9}, {3.843389131908535*^9, 
   3.8433891454505453`*^9}, {3.8433960500303555`*^9, 
   3.8433960504834185`*^9}, {3.843469403297631*^9, 3.843469404610437*^9}, {
   3.843564943070371*^9, 3.843564943276934*^9}, {3.8435828826971197`*^9, 
   3.8435829368834343`*^9}, {3.8655330568106728`*^9, 3.865533084239563*^9}, {
   3.8655338439520607`*^9, 3.865533849358708*^9}, {3.8655352915476694`*^9, 
   3.865535291606512*^9}, {3.8655357489215927`*^9, 3.865535751636018*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[154]:=",ExpressionUUID->"c2d12b86-006d-4f13-9057-f329c54fc73d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"statsFn", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", ",",
        "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
       "sigm", ",", "sols", ",", "solnsl", ",", "plistn", ",", "lvs", ",", 
       "lvs1", ",", "lvs2", ",", "iii"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataFn", "[", 
       RowBox[{
       "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
        ",", "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", 
        ",", "sigm", ",", "sols", ",", "solnsl", ",", "plistn", ",", "lvs", 
        ",", "lvs1", ",", "lvs2", ",", "iii"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SIGNALLING", " ", "STATS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"smod", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"PLOT", " ", "PERIMETER", " ", "OF", " ", "SOPs"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plotper", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotperQ", ",", 
            RowBox[{"plotperFn", "[", 
             RowBox[{
             "data1per", ",", "data2per", ",", "plistn", ",", "nin", ",", 
              "din", ",", "imgs", ",", "imgs2", ",", "iii"}], "]"}], ",", 
            "un"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PLOT", " ", "COEFFICIENT", " ", "OF", " ", "VARIATION"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"plotcoeffv", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotcoeffvQ", ",", 
            RowBox[{"plotcoeffvFn", "[", 
             RowBox[{
             "data1per", ",", "data2per", ",", "plistn", ",", "nin", ",", 
              "din", ",", "imgs", ",", "imgs2", ",", "iii"}], "]"}], ",", 
            "un"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PLOT", " ", "SOP", " ", "DISTANCE", " ", 
           RowBox[{"(", "#", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"plotSOPn", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotSOPnQ", ",", 
            RowBox[{"plotSOPnFn", "[", 
             RowBox[{
             "data1SOPn", ",", "data2SOPn", ",", "plistn", ",", "nin", ",", 
              "din", ",", "din1", ",", "din2", ",", "imgs", ",", "imgs2", ",",
               "row1cSOPn", ",", "row2cSOPn", ",", "iii"}], "]"}], ",", 
            "un"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PLOT", " ", "SOP", " ", "DISTANCE", " ", 
           RowBox[{"(", "EUCLIDEAN", ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"plotSOPd", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotSOPdQ", ",", 
            RowBox[{"plotSOPdFn", "[", 
             RowBox[{
             "data1SOPd", ",", "data2SOPd", ",", "plistn", ",", "nin", ",", 
              "din", ",", "imgs", ",", "imgs2", ",", "row1cSOPd", ",", 
              "row2cSOPd", ",", "iii"}], "]"}], ",", "un"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PLOT", " ", "SOLUTIONS"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"plotsol", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotsolQ", ",", 
            RowBox[{"plotsolFn", "[", 
             RowBox[{"sols", ",", "iii"}], "]"}], ",", "un"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"PLOT", "  ", "NUMBER", " ", "OF", " ", "SOPs"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"plotSOP", "=", 
          RowBox[{"If", "[", 
           RowBox[{"plotSOPQ", ",", 
            RowBox[{"plotSOPFn", "[", 
             RowBox[{
             "dlf", ",", "dlf1", ",", "dlf2", ",", "imgs", ",", "imgs2", ",", 
              "iii"}], "]"}], ",", "un"}], "]"}]}]}]}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", 
        RowBox[{
        "plotSOP", ",", "plotsol", ",", "plotper", ",", "plotSOPn", ",", 
         "plotSOPd"}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799589766164`*^9}, {
   3.840080020735898*^9, 3.8400800535093412`*^9}, {3.8400800888739033`*^9, 
   3.840080153739462*^9}, {3.8400801865482187`*^9, 3.8400802209326143`*^9}, {
   3.8400802619385166`*^9, 3.84008033289914*^9}, {3.8400803670103188`*^9, 
   3.840080367159919*^9}, 3.8400804808628817`*^9, {3.840080545805586*^9, 
   3.840080545921276*^9}, {3.8400806870863695`*^9, 3.840080687263895*^9}, {
   3.840080757138139*^9, 3.8400807572907305`*^9}, {3.8400807977803955`*^9, 
   3.840080799297861*^9}, {3.8400809157232437`*^9, 3.8400809189590106`*^9}, {
   3.840080979663296*^9, 3.840080987788003*^9}, 3.8400810336356783`*^9, 
   3.840081605061549*^9, 3.8400816650214005`*^9, {3.840081781231902*^9, 
   3.840081781364683*^9}, {3.8400823289474535`*^9, 3.840082353251849*^9}, {
   3.8400834341698256`*^9, 3.8400834364497275`*^9}, {3.840085412086249*^9, 
   3.8400854187224984`*^9}, {3.840087510984623*^9, 3.840087556938945*^9}, 
   3.840088408337469*^9, {3.8400884807342806`*^9, 3.84008850776838*^9}, {
   3.8400885514132595`*^9, 3.84008855381188*^9}, {3.840089020595045*^9, 
   3.8400890205990343`*^9}, {3.8400916111020536`*^9, 3.840091615053486*^9}, {
   3.840092680317884*^9, 3.840092681108835*^9}, {3.8400950902463365`*^9, 
   3.840095090247334*^9}, {3.84009530394267*^9, 3.8400953484027653`*^9}, {
   3.840096676564866*^9, 3.840096684996336*^9}, {3.8400989044149256`*^9, 
   3.8400989079591045`*^9}, {3.840111889879445*^9, 3.840111890359162*^9}, {
   3.841745052198177*^9, 3.8417450654744635`*^9}, {3.8434694057705283`*^9, 
   3.843469453239532*^9}, {3.843562127199221*^9, 3.8435621290475683`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[155]:=",ExpressionUUID->"b450ede4-e687-49e3-aa5e-af4ddc2fdc35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "PERIMETER"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotperFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data1per", ",", "data2per", ",", "plistn", ",", "nin", ",", "din", 
        ",", "imgs", ",", "imgs2", ",", "iii"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BoxWhiskerChart", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Labeled", "[", 
           RowBox[{"data1per", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<non-SOP (`` cells)\>\"", ",", 
              RowBox[{"n", "-", 
               RowBox[{"Length", "@", "din"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Labeled", "[", 
           RowBox[{"data2per", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<SOP (`` cells)\>\"", ",", 
              RowBox[{"Length", "@", "din"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "}"}], ",", "\"\<Mean\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
           RowBox[{"\"\<`3`\\n\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"msimn", ">", "1"}], ",", "\"\<`2` tissues with \>\"", 
              ",", "\"\<\>\""}], "]"}], "<>", 
            "\"\<`1` cells | T-Test: `4`\>\""}], ",", "n", ",", "msimn", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Perimeter distribution\\nt = ``\>\"", ",", "iii"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1per"}], "==", "0"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2per"}], "==", "0"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1per"}], "==", "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2per"}], "==", "1"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data1per"}]}], "==", 
                 "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data2per"}]}], "==", 
                 "1"}]}], ")"}]}], ",", "\"\<N/A\>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"data1per", "==", "data2per"}], ",", "0", ",", 
               RowBox[{"Quiet", "[", 
                RowBox[{
                 RowBox[{"TTest", "[", 
                  RowBox[{"{", 
                   RowBox[{"data1per", ",", "data2per"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"TTest", "::", "nortst"}], "}"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
             RowBox[{"Point", "/@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}]}], ",", 
                   "data1"}], "}"}]}], ",", 
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.08"}], ",", "0.08"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}]}], ",", 
                   "data2"}], "}"}]}]}], "}"}]}]}], "}"}]}]}], "*)"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1920", " ", "imgs", " ", "imgs2"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799860062943`*^9}, {
   3.840080437462606*^9, 3.8400805248274374`*^9}, {3.8400805843842545`*^9, 
   3.840080588483468*^9}, {3.840080838608873*^9, 3.8400809037179346`*^9}, {
   3.840080999211012*^9, 3.8400810144721975`*^9}, {3.840081570868003*^9, 
   3.840081576512906*^9}, {3.840082302308913*^9, 3.8400823026370363`*^9}, {
   3.8400824619597845`*^9, 3.840082477799567*^9}, {3.8400988988411674`*^9, 
   3.8400988993923097`*^9}, {3.840099480052116*^9, 3.840099493438696*^9}, {
   3.840111013126898*^9, 3.840111019666154*^9}, {3.8401743924734063`*^9, 
   3.840174395127804*^9}, 3.840174439640093*^9, {3.840174758530101*^9, 
   3.8401747611064444`*^9}, {3.8401748043863688`*^9, 3.840174804645676*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[156]:=",ExpressionUUID->"614a636c-614b-4029-a6ea-8e3649f6dcc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "SOP", " ", "DISTANCE", " ", 
    RowBox[{"(", "#", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotSOPnFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data1SOPn", ",", "data2SOPn", ",", "plistn", ",", "nin", ",", "din", 
        ",", "din1", ",", "din2", ",", "imgs", ",", "imgs2", ",", "row1cSOPn",
         ",", "row2cSOPn", ",", "iii"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"BoxWhiskerChart", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Labeled", "[", 
           RowBox[{"data2SOPn", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"\"\<Top row\\n(\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"msimn", ">", "1"}], ",", "\"\<mean: \>\"", ",", 
                 "\"\<\>\""}], "]"}], "<>", "\"\<`` cells)\>\""}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"Length", "@", "din2"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"msimn", "==", "1"}], ",", "1", ",", ".01"}], 
                 "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Labeled", "[", 
           RowBox[{"data1SOPn", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"\"\<Bottom row\\n(\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"msimn", ">", "1"}], ",", "\"\<mean: \>\"", ",", 
                 "\"\<\>\""}], "]"}], "<>", "\"\<`` cells)\>\""}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"Length", "@", "din1"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"msimn", "==", "1"}], ",", "1", ",", ".01"}], 
                 "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Whiskers\>\"", ",", "Thick"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Outliers\>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\[EmptyCircle]", ",", "13", ",", "Black"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<MedianMarker\>\"", ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Thick", ",", "Yellow"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Fences\>\"", ",", "Thick"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
           RowBox[{"\"\<`3`\\n\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"msimn", ">", "1"}], ",", "\"\<`2` tissues with \>\"", 
              ",", "\"\<\>\""}], "]"}], "<>", 
            "\"\<`1` cells | T-Test: `4`\\nt = `5`\>\""}], ",", "n", ",", 
           "msimn", ",", "\[IndentingNewLine]", 
           "\"\<Distance between SOP cells (# cells)\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1SOPn"}], "==", "0"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2SOPn"}], "==", "0"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1SOPn"}], "==", "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2SOPn"}], "==", "1"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data1SOPn"}]}], "==", 
                 "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data2SOPn"}]}], "==", 
                 "1"}]}], ")"}]}], ",", "\"\<N/A\>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"data1SOPn", "==", "data2SOPn"}], ",", "0", ",", 
               RowBox[{"Quiet", "[", 
                RowBox[{
                 RowBox[{"TTest", "[", 
                  RowBox[{"{", 
                   RowBox[{"data1SOPn", ",", "data2SOPn"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"TTest", "::", "nortst"}], "}"}]}], "]"}]}], 
              "]"}]}], "]"}], ",", "iii"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
             RowBox[{"Point", "/@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}]}], ",", 
                   "data1"}], "}"}]}], ",", 
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.08"}], ",", "0.08"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}]}], ",", 
                   "data2"}], "}"}]}]}], "}"}]}]}], "}"}]}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChartStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"178", ",", "34", ",", "34"}], "}"}], "/", "255"}], 
              "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"100", ",", "149", ",", "237"}], "}"}], "/", "255"}], 
              "]"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"GridLines", "->", 
         RowBox[{"{", 
          RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1920", " ", "imgs", " ", "imgs2"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799860062943`*^9}, {
   3.840080437462606*^9, 3.8400805248274374`*^9}, {3.8400805843842545`*^9, 
   3.840080588483468*^9}, {3.840080838608873*^9, 3.8400809037179346`*^9}, {
   3.840080999211012*^9, 3.8400810144721975`*^9}, {3.840081432976807*^9, 
   3.8400815484581814`*^9}, {3.840081585672373*^9, 3.8400815997281113`*^9}, {
   3.840085359510459*^9, 3.8400853732954254`*^9}, {3.840091516620451*^9, 
   3.8400915203378725`*^9}, {3.840098884038068*^9, 3.840098884741188*^9}, {
   3.8401109906197166`*^9, 3.8401109946586857`*^9}, {3.8401128701909213`*^9, 
   3.8401128971130075`*^9}, 3.840174441033369*^9, {3.84017482191682*^9, 
   3.8401748458023796`*^9}, {3.8415752121724234`*^9, 3.841575225052476*^9}, {
   3.841575258577135*^9, 3.841575258655924*^9}, 3.841575467178284*^9, {
   3.8415797498644934`*^9, 3.8415797667187414`*^9}, {3.8435502866049347`*^9, 
   3.8435502919336767`*^9}, {3.8435516011766186`*^9, 
   3.8435516059315624`*^9}, {3.843555842413478*^9, 3.84355586542707*^9}, {
   3.843562114051097*^9, 3.8435621161805725`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[157]:=",ExpressionUUID->"2a58de34-5724-4ba2-b6b6-ffb423515f08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "SOP", " ", "DISTANCE", " ", 
    RowBox[{"(", "EUCLIDEAN", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotSOPdFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data1SOPd", ",", "data2SOPd", ",", "plistn", ",", "nin", ",", "din", 
        ",", "imgs", ",", "imgs2", ",", "row1cSOPd", ",", "row2cSOPd", ",", 
        "iii"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BoxWhiskerChart", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Labeled", "[", 
           RowBox[{"data2SOPd", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"\"\<Top row (\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"msimn", ">", "1"}], ",", "\"\<mean: \>\"", ",", 
                 "\"\<\>\""}], "]"}], "<>", "\"\<`` cells)\>\""}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{"row2cSOPd", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"msimn", "==", "1"}], ",", "1", ",", ".01"}], 
                 "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Labeled", "[", 
           RowBox[{"data1SOPd", ",", "\[IndentingNewLine]", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"\"\<Bottom row (\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"msimn", ">", "1"}], ",", "\"\<mean: \>\"", ",", 
                 "\"\<\>\""}], "]"}], "<>", "\"\<`` cells)\>\""}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{"row1cSOPd", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"msimn", "==", "1"}], ",", "1", ",", ".01"}], 
                 "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "}"}], ",", "\"\<Mean\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
           RowBox[{"\"\<`3`\\n\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"msimn", ">", "1"}], ",", "\"\<`2` tissues with \>\"", 
              ",", "\"\<\>\""}], "]"}], "<>", 
            "\"\<`1` cells | T-Test: `4`\\nt = `5`\>\""}], ",", "n", ",", 
           "msimn", ",", "\[IndentingNewLine]", 
           "\"\<Distance between SOP cells (Euclidean)\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1SOPd"}], "==", "0"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2SOPd"}], "==", "0"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "data1SOPd"}], "==", "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", "data2SOPd"}], "==", "1"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data1SOPd"}]}], "==", 
                 "1"}], "||", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"DeleteDuplicates", "@", "data2SOPd"}]}], "==", 
                 "1"}]}], ")"}]}], ",", "\"\<N/A\>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"data1SOPd", "==", "data2SOPd"}], ",", "0", ",", 
               RowBox[{"Quiet", "[", 
                RowBox[{
                 RowBox[{"TTest", "[", 
                  RowBox[{"{", 
                   RowBox[{"data1SOPd", ",", "data2SOPd"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"TTest", "::", "nortst"}], "}"}]}], "]"}]}], 
              "]"}]}], "]"}], ",", "iii"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
             RowBox[{"Point", "/@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data1"}]}], "]"}]}], ",", 
                   "data1"}], "}"}]}], ",", 
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}], "+", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.08"}], ",", "0.08"}], "}"}], ",", 
                    RowBox[{"Length", "@", "data2"}]}], "]"}]}], ",", 
                   "data2"}], "}"}]}]}], "}"}]}]}], "}"}]}]}], "*)"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1920", " ", "imgs", " ", "imgs2"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799860062943`*^9}, {
   3.840080437462606*^9, 3.8400805248274374`*^9}, {3.8400805843842545`*^9, 
   3.840080588483468*^9}, {3.840080838608873*^9, 3.8400809037179346`*^9}, {
   3.840080999211012*^9, 3.8400810144721975`*^9}, {3.840081432976807*^9, 
   3.840081494102601*^9}, {3.8400816129434013`*^9, 3.840081659301689*^9}, {
   3.840085378700004*^9, 3.8400854045550346`*^9}, {3.8400915226048355`*^9, 
   3.8400915292988243`*^9}, {3.8400988690187955`*^9, 
   3.8400988696540966`*^9}, {3.840111004794961*^9, 3.8401110088974147`*^9}, 
   3.840174441887308*^9, {3.8401748733118114`*^9, 3.8401748805277796`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[158]:=",ExpressionUUID->"45e28963-cc31-4392-8d46-e7f4a6cac121"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "SOLUTIONS"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotsolFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sols", ",", "iii"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sols", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "[", "j", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "1", ",", "iii"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "dinval"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Tmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<Delta dynamics (`1` fates)\\nt = `2`\>\"", ",", 
           RowBox[{"Length", "@", "dinval"}], ",", "iii"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1920", " ", "imgs", " ", "imgs2"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",\

 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799860062943`*^9}, {
   3.840080437462606*^9, 3.8400805248274374`*^9}, 3.8400806580872173`*^9, 
   3.840080901981579*^9, {3.840080954505142*^9, 3.840080972622126*^9}, {
   3.8400987348153276`*^9, 3.840098738260113*^9}, {3.840098793514182*^9, 
   3.8400988477569466`*^9}, {3.8400989272635746`*^9, 3.840098948809678*^9}, {
   3.8401000355926123`*^9, 3.8401000625216208`*^9}, {3.8401000934333267`*^9, 
   3.840100096289215*^9}, {3.840100453723503*^9, 3.8401004629155674`*^9}, {
   3.8401006662272224`*^9, 3.840100668141113*^9}, {3.8401008601192255`*^9, 
   3.8401008601710863`*^9}, {3.8401009141693864`*^9, 
   3.8401009143329487`*^9}, {3.840101528247141*^9, 3.840101533909355*^9}, {
   3.840101675930568*^9, 3.8401016760442643`*^9}, 3.840102196496938*^9, {
   3.840102428298247*^9, 3.840102455811804*^9}, {3.840102487452015*^9, 
   3.840102487498891*^9}, {3.8401092361527147`*^9, 3.8401092472771215`*^9}, 
   3.840109494971784*^9, {3.8401750337803736`*^9, 3.840175066009961*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[159]:=",ExpressionUUID->"c46f8669-714b-4815-a474-eea452bb09ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", "  ", "NUMBER", " ", "OF", " ", "SOPs"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotSOPFn", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dlf", ",", "dlf1", ",", "dlf2", ",", "imgs", ",", "imgs2", ",", 
        "iii"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "iii"}], "]"}], ",", "dlf2"}], "}"}], "]"}],
             ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "iii"}], "]"}], ",", "dlf1"}], "}"}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "iii"}], "]"}], ",", "dlf"}], "}"}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sigr", "==", "1"}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Top row\>\"", ",", "\"\<Bottom row\>\""}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{".8", ",", "0.2"}], "}"}]}], "]"}]}], ",", "un"}], 
         "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Tmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"1920", "imgs", " ", "imgs2"}]}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<time\>\"", ",", "\"\<number of SOP cells\>\""}], 
          "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",\

 InitializationGroup->True,
 CellChangeTimes->{{3.8400796954010935`*^9, 3.8400797317383776`*^9}, {
   3.8400797766427965`*^9, 3.8400797782778416`*^9}, {3.8400798146706*^9, 
   3.840079900747921*^9}, {3.840079954843669*^9, 3.8400799860062943`*^9}, {
   3.840080437462606*^9, 3.8400804977119102`*^9}, {3.840096594066981*^9, 
   3.840096653657555*^9}, {3.8400980186510367`*^9, 3.8400980367461023`*^9}, {
   3.840098071259201*^9, 3.8400980734334574`*^9}, {3.8401001008221364`*^9, 
   3.8401001037102084`*^9}, 3.8592959267490797`*^9, {3.8592959581273766`*^9, 
   3.859295958738001*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[160]:=",ExpressionUUID->"7ec15ea6-c934-4165-a964-ce4afaaec45e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Output", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8338826936159997`*^9, 
   3.833882694258896*^9}, {3.8338833391990476`*^9, 3.833883340659916*^9}, {
   3.834555668295546*^9, 3.8345556687848897`*^9}, {3.8345584393396516`*^9, 
   3.834558442490505*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"811240bc-cc80-463f-9cea-e2d952e8e01f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputf", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "smod", ",", "sigm", ",", "nv", ",", "colo1", ",", "colom", ",", 
       "colob", ",", "mbmt"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mbmtt", "=", 
       RowBox[{
        RowBox[{"mbmt", "/", "100"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edr", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imgs", "=", ".35"}], ";", "\[IndentingNewLine]", 
      RowBox[{"allpts", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Values", "[", 
               RowBox[{"plist", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", "1"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "plist"}]}], "}"}]}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigx", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Abs", "@", 
         RowBox[{"allpts", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigy", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Abs", "@", 
         RowBox[{"allpts", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigxM", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"allpts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigyM", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"allpts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigxm", "=", 
       RowBox[{"Min", "@", 
        RowBox[{"allpts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigym", "=", 
       RowBox[{"Min", "@", 
        RowBox[{"allpts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"streQ", ",", 
        RowBox[{
         RowBox[{"stefho", "=", "stefh"}], ";", 
         RowBox[{"stefvo", "=", "stefv"}]}], ",", 
        RowBox[{"stefho", "=", 
         RowBox[{"stefvo", "=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"plx", "=", " ", 
       RowBox[{"sigx", "+", "edr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ply", "=", " ", 
       RowBox[{"sigy", "+", "edr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plxM", "=", " ", 
       RowBox[{"sigxM", "+", "edr"}]}], ";", 
      RowBox[{"plxm", "=", " ", 
       RowBox[{"sigxm", "-", "edr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plyM", "=", " ", 
       RowBox[{"sigyM", "+", "edr"}]}], ";", 
      RowBox[{"plym", "=", " ", 
       RowBox[{"sigym", "-", "edr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ares", "=", 
       RowBox[{"1080", "/", "1920"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pplx", ",", "pply"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"plx", ",", "ply"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plate", "=", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"plxm", ",", "plym"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"plxM", ",", "plyM"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"smod", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sigm", "\[Equal]", "2"}], "&&", 
            RowBox[{"nv", "=!=", "3"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"maxs", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Total", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "sols", "]"}], ",", "lvs"}], "]"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "nv"}], "]"}], "]"}], "*", "mat"}], 
               ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"maxs", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Last", "[", "sols", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "nv"}], "]"}], "]"}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"allcels", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Thickness", "[", "mbmtt", "]"}], ",", "colom"}], 
                   "}"}], "]"}], ",", 
                 RowBox[{"Blend", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"colob", ",", "colo1"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sigm", "\[Equal]", "2"}], "&&", 
                    RowBox[{"nv", "=!=", "3"}]}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sols", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", "pi", "]"}], "[", 
                    RowBox[{"[", "nv", "]"}], "]"}], "*", 
                    RowBox[{"mata", "[", "pi", "]"}]}], "]"}], "/", "maxs"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sols", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", "pi", "]"}], "[", 
                    RowBox[{"[", "nv", "]"}], "]"}], "/", "maxs"}]}], "]"}]}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"pcells", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", "pi", "]"}]}],
                 "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"pi", ",", 
                RowBox[{"lv", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "sols", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tT0", "=", 
          RowBox[{"Function", "[", 
           RowBox[{"j", ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                   RowBox[{"\"\<t = `1`\>\"", "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{"plotSOPQ", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    "\"\<\\nSOPs: `2` (top), `3` (bottom)\>\"", ",", 
                    "\"\<\\nSOPs: `2`\>\""}], "]"}], ",", "un"}], "]"}]}], 
                   ",", 
                   RowBox[{"j", "-", "1"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"plotSOPQ", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dlf2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"dlf1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"dlf", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "un"}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"imgs", " ", "30"}], ",", 
                 RowBox[{"Darker", "[", 
                  RowBox[{
                   RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], 
                  "]"}], ",", "Bold"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Mean", "[", 
                  RowBox[{"{", 
                   RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
                 RowBox[{"Mean", "[", 
                  RowBox[{"{", 
                   RowBox[{"sigyM", ",", "plyM"}], "}"}], "]"}]}], "}"}]}], 
              "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tT", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"cusnQ", ",", "nmp", ",", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<SOP patterning (v``)\>\"", ",", "fversion"}], 
                  "]"}]}], "]"}], ",", 
               RowBox[{"imgs", " ", "30"}], ",", 
               RowBox[{"Darker", "[", 
                RowBox[{
                 RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], "]"}], 
               ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigym", ",", "plym"}], "}"}], "]"}]}], "}"}]}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"listanim", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"colob", ",", "plate"}], "}"}], "]"}], ",", 
              RowBox[{"allcels", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"stetbQ", "&&", "streQ", "&&", 
                 RowBox[{"stet", "==", "2"}]}], ",", 
                RowBox[{"recs", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"grQ", ",", 
                RowBox[{"gr", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"tT0", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
              "tT", ",", "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"imgs", 
                RowBox[{"{", 
                 RowBox[{"1920", ",", " ", "1080"}], "}"}]}]}], ",", 
              RowBox[{"Background", "\[Rule]", "colob"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "sols", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"anim", "=", 
          RowBox[{"ListAnimate", "[", 
           RowBox[{"listanim", ",", 
            RowBox[{"ControlPlacement", "\[Rule]", "Top"}], ",", 
            RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
            RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tT", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"cusnQ", ",", "nmp", ",", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<SOP patterning (v``)\>\"", ",", "fversion"}], 
                  "]"}]}], "]"}], ",", 
               RowBox[{"imgs", " ", "30"}], ",", 
               RowBox[{"Darker", "[", 
                RowBox[{
                 RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], "]"}], 
               ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
               RowBox[{"Mean", "[", 
                RowBox[{"{", 
                 RowBox[{"sigym", ",", "plym"}], "}"}], "]"}]}], "}"}]}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"anim", "=", 
          RowBox[{"ListAnimate", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", 
                  RowBox[{"colob", ",", "plate"}], "}"}], "]"}], ",", 
                RowBox[{"flist", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<t = ``\>\"", ",", 
                    RowBox[{"j", "-", "2"}]}], "]"}], ",", 
                    RowBox[{"imgs", " ", "30"}], ",", 
                    RowBox[{"Darker", "[", 
                    RowBox[{
                    RowBox[{"ColorNegate", "@", "colob"}], ",", "dcol"}], 
                    "]"}], ",", "Bold"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", 
                    RowBox[{"sigxm", ",", "sigxM"}], "}"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", 
                    RowBox[{"sigyM", ",", "plyM"}], "}"}], "]"}]}], "}"}]}], 
                  "]"}], "]"}], ",", "tT", ",", "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"imgs", 
                  RowBox[{"{", 
                   RowBox[{"1920", ",", " ", "1080"}], "}"}]}]}], ",", 
                RowBox[{"Background", "\[Rule]", "colob"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", 
                RowBox[{"Length", "[", "flist", "]"}]}], "}"}]}], "]"}], ",", 
            
            RowBox[{"ControlPlacement", "\[Rule]", "Top"}], ",", 
            RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
            RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8260308543663063`*^9, 3.8260308797396097`*^9}, {
   3.8260484657149534`*^9, 3.8260484672155533`*^9}, {3.8260485818344727`*^9, 
   3.826048583013398*^9}, {3.8260486636542797`*^9, 3.826048667145936*^9}, {
   3.8260487257589273`*^9, 3.8260487269021697`*^9}, {3.8260494313310575`*^9, 
   3.8260494592854147`*^9}, {3.826083139892048*^9, 3.8260831447095194`*^9}, {
   3.82608669330847*^9, 3.8260866934300957`*^9}, {3.8260874153198414`*^9, 
   3.826087418303621*^9}, {3.8260891419033346`*^9, 3.826089142385808*^9}, {
   3.8260912484187555`*^9, 3.826091248710965*^9}, {3.826091614797104*^9, 
   3.8260916179293427`*^9}, {3.826091674127561*^9, 3.8260916853173885`*^9}, {
   3.826094370333968*^9, 3.8260943769841304`*^9}, {3.8260956614837303`*^9, 
   3.826095661979802*^9}, {3.8260968370237427`*^9, 3.8260968392824435`*^9}, {
   3.826097722106609*^9, 3.82609772510378*^9}, {3.8260991526362967`*^9, 
   3.8260991550126143`*^9}, {3.826100284901946*^9, 3.82610028536794*^9}, {
   3.8261007323730035`*^9, 3.826100733045615*^9}, {3.8261017381152315`*^9, 
   3.826101741796569*^9}, {3.8261070793124447`*^9, 3.8261070864378214`*^9}, {
   3.82610973837737*^9, 3.8261097546074553`*^9}, {3.8261194216280036`*^9, 
   3.8261194437968383`*^9}, {3.827847817144483*^9, 3.8278478175201845`*^9}, {
   3.827847881291585*^9, 3.8278478885900717`*^9}, {3.832779427026119*^9, 
   3.832779431474106*^9}, {3.8340726208037643`*^9, 3.834072622227874*^9}, {
   3.8342331091266284`*^9, 3.8342331117794333`*^9}, {3.834234473377798*^9, 
   3.8342344749469757`*^9}, {3.8345556119529605`*^9, 3.8345556190397954`*^9}, 
   3.834558444925746*^9, {3.834563341457923*^9, 3.834563438446309*^9}, 
   3.834563546063717*^9, 3.8345636720938787`*^9, {3.834750238662663*^9, 
   3.834750241443613*^9}, {3.835284016571088*^9, 3.835284017030302*^9}, {
   3.8352841123643417`*^9, 3.8352841319124784`*^9}, {3.8352843257637177`*^9, 
   3.835284336296049*^9}, {3.8352846507925806`*^9, 3.8352846551795187`*^9}, {
   3.8353597171268234`*^9, 3.8353597171308146`*^9}, 3.8353597830663924`*^9, {
   3.8353598717730713`*^9, 3.8353598718899655`*^9}, 3.8354310292495747`*^9, {
   3.8354312204333754`*^9, 3.8354312260998254`*^9}, {3.835431480722257*^9, 
   3.835431494196879*^9}, {3.8354427841937294`*^9, 3.8354427877313447`*^9}, {
   3.8354468225109987`*^9, 3.8354468445314655`*^9}, 3.835446908472578*^9, {
   3.8354469391575127`*^9, 3.83544695170186*^9}, {3.8354470164732246`*^9, 
   3.8354470230373573`*^9}, {3.8356991733266244`*^9, 
   3.8356992405808706`*^9}, {3.835699298830224*^9, 3.8356992992911053`*^9}, {
   3.8356993474541388`*^9, 3.8356993899528728`*^9}, {3.835699436871935*^9, 
   3.835699475228038*^9}, {3.835699511803501*^9, 3.8356996086828423`*^9}, {
   3.8356998428202972`*^9, 3.8356998583004627`*^9}, 3.8357001900983305`*^9, 
   3.8357002681698337`*^9, {3.8358591227902327`*^9, 3.8358591644310336`*^9}, {
   3.8358591992730074`*^9, 3.8358592066782446`*^9}, {3.8358592430222254`*^9, 
   3.8358592431190166`*^9}, {3.8358592801752663`*^9, 3.835859286726904*^9}, {
   3.8358593270485144`*^9, 3.8358593329709377`*^9}, 3.835868639372053*^9, {
   3.83586867305238*^9, 3.8358687029771805`*^9}, {3.83586926096462*^9, 
   3.8358693204056454`*^9}, 3.8358696925382776`*^9, {3.8358698047946925`*^9, 
   3.8358698048774447`*^9}, 3.8358701466065407`*^9, {3.835891383592194*^9, 
   3.835891385862158*^9}, {3.835891614972653*^9, 3.835891637372858*^9}, {
   3.8362939487626762`*^9, 3.8362939599776964`*^9}, {3.8362962395145307`*^9, 
   3.8362962395923223`*^9}, {3.8363005956533012`*^9, 3.8363005960677*^9}, {
   3.836371717578417*^9, 3.8363717248742895`*^9}, {3.8363718470884933`*^9, 
   3.8363718787518497`*^9}, {3.8363722234530573`*^9, 
   3.8363722470675383`*^9}, {3.8363726343483696`*^9, 3.836372658475211*^9}, {
   3.836373625037841*^9, 3.836373628027705*^9}, {3.8363737229700584`*^9, 
   3.8363737244441137`*^9}, {3.836374041872079*^9, 3.836374071884071*^9}, {
   3.836374144520892*^9, 3.836374144761248*^9}, {3.8363742014791737`*^9, 
   3.8363742129520297`*^9}, {3.8363742637083845`*^9, 
   3.8363742751733074`*^9}, {3.836376060861977*^9, 3.8363760630022497`*^9}, {
   3.8363796381005263`*^9, 3.8363796800068836`*^9}, {3.836379720198062*^9, 
   3.836379740316186*^9}, {3.836379858454807*^9, 3.836379858814844*^9}, {
   3.8363804775614004`*^9, 3.8363804786175437`*^9}, 3.8364869028970013`*^9, {
   3.836488883579929*^9, 3.8364889107276692`*^9}, 3.836489271237358*^9, {
   3.8364904589675627`*^9, 3.83649046216298*^9}, {3.836491898956167*^9, 
   3.8364919005602655`*^9}, 3.836493482374995*^9, {3.836494030779086*^9, 
   3.8364941230740814`*^9}, {3.836494163646302*^9, 3.8364941680985003`*^9}, {
   3.8364942266229258`*^9, 3.8364942273901*^9}, {3.8364943053915095`*^9, 
   3.8364943439702353`*^9}, {3.8364944034614015`*^9, 3.836494403637898*^9}, {
   3.8364946955031753`*^9, 3.836494715116102*^9}, {3.836494752738083*^9, 
   3.836494760232193*^9}, {3.836814329046093*^9, 3.8368143442861247`*^9}, {
   3.836814479458973*^9, 3.836814482114873*^9}, {3.8368145584907637`*^9, 
   3.836814562692283*^9}, 3.8369990134757524`*^9, {3.836999052338746*^9, 
   3.836999052487372*^9}, {3.8377759214463825`*^9, 3.837775932429393*^9}, 
   3.837864207648529*^9, 3.837864292838628*^9, {3.838742462190618*^9, 
   3.838742462258436*^9}, {3.83874249878706*^9, 3.838742503860071*^9}, {
   3.8387433301897073`*^9, 3.838743335827626*^9}, {3.83949212310999*^9, 
   3.8394921422528014`*^9}, {3.839492480993972*^9, 3.839492566381081*^9}, {
   3.839495118702137*^9, 3.839495118808852*^9}, {3.8395851338928814`*^9, 
   3.8395851440610046`*^9}, {3.839585299779416*^9, 3.8395853002272186`*^9}, {
   3.839585340603986*^9, 3.839585375724689*^9}, {3.839585516005971*^9, 
   3.839585520660678*^9}, {3.839585654040316*^9, 3.839585656160614*^9}, {
   3.8396719688593884`*^9, 3.8396719729620266`*^9}, {3.840089452288432*^9, 
   3.8400894531406736`*^9}, {3.8417318378704596`*^9, 3.841731840493043*^9}, {
   3.841732500206592*^9, 3.8417325099004335`*^9}, {3.841732597776737*^9, 
   3.8417326737817106`*^9}, {3.8417327091585445`*^9, 3.84173270919744*^9}, {
   3.841733072246862*^9, 3.8417330734750967`*^9}, {3.8417338638760853`*^9, 
   3.84173386798237*^9}, {3.8417339192460756`*^9, 3.841733919278988*^9}, 
   3.8417339953971663`*^9, {3.8417341942463818`*^9, 3.8417342164056377`*^9}, {
   3.841734492742406*^9, 3.8417345167873774`*^9}, {3.84173472054871*^9, 
   3.8417347344387493`*^9}, {3.841734779995408*^9, 3.8417348619639006`*^9}, {
   3.8417385984020634`*^9, 3.8417386007134295`*^9}, {3.8454751749994774`*^9, 
   3.8454751927075224`*^9}, {3.845475290095907*^9, 3.8454753243056335`*^9}, {
   3.845478092214491*^9, 3.8454781538161945`*^9}, {3.845478187763378*^9, 
   3.845478188009719*^9}, {3.8454783650503473`*^9, 3.845478365675747*^9}, 
   3.845480151088298*^9, {3.8454802279361506`*^9, 3.8454802280190897`*^9}, {
   3.8454803474579678`*^9, 3.8454803482351694`*^9}, {3.8454808047289486`*^9, 
   3.8454808053752193`*^9}, {3.8570319831549363`*^9, 3.85703198396876*^9}, {
   3.8657454533946457`*^9, 3.8657454870629263`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[161]:=",ExpressionUUID->"c1d361a6-5f71-41d4-8d88-ae4bda46ac4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extras", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}, {3.833874108661461*^9, 
   3.833874113945092*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"7cf29985-0c9b-4b37-839d-9fd8450ffc46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"version", "=", "\"\<1.0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fversion", "=", "\"\<1.0.0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mversion", "=", "\"\<13.0.1\>\""}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", "DIRECTORY", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"GRAPHICS", " ", "AND", " ", "FONTS"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft1", "=", 
   RowBox[{"{", 
    RowBox[{"17", ",", "Bold", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro SemiBold\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft2", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft3", "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}], ",", "col11"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fts", "=", 
   RowBox[{"{", 
    RowBox[{"16", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}], ",", "col11"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft4", "=", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st1", "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro Bold\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st2", "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro Light\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"at1", "=", 
    RowBox[{"{", 
     RowBox[{"15", ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro\>\""}]}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft10", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "Bold", ",", 
           RowBox[{
           "FontFamily", "\[Rule]", "\"\<Source Sans Pro SemiBold\>\""}]}], 
          "}"}]}], "]"}], ",", "s"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft20", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}]}], "}"}]}], 
        "]"}], ",", "s"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft30", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}]}], "}"}]}], 
        "]"}], ",", "s"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fts0", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
          "}"}]}], "]"}], ",", "s"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft40", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Segoe UI\>\""}]}], "}"}]}], 
        "]"}], ",", "s"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st10", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", 
           RowBox[{
           "FontFamily", "\[Rule]", "\"\<Source Sans Pro Bold\>\""}]}], 
          "}"}]}], "]"}], ",", "s"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st20", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "s", "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", 
           RowBox[{
           "FontFamily", "\[Rule]", "\"\<Source Sans Pro Light\>\""}]}], 
          "}"}]}], "]"}], ",", "s"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"at10", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"s", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "s", "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro\>\""}]}], 
           "}"}]}], "]"}], ",", "s"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fft1", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"m", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m0", "}"}], ",", 
       RowBox[{
        RowBox[{"m0", "=", "m"}], ";", 
        RowBox[{
         RowBox[{"m0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"ft10", ",", 
           RowBox[{"m0", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
        "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fft2", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"m", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m0", "}"}], ",", 
       RowBox[{
        RowBox[{"m0", "=", "m"}], ";", 
        RowBox[{
         RowBox[{"m0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"ft20", ",", 
           RowBox[{"m0", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
        "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fft4", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"m", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m0", "}"}], ",", 
       RowBox[{
        RowBox[{"m0", "=", "m"}], ";", 
        RowBox[{
         RowBox[{"m0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"ft40", ",", 
           RowBox[{"m0", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
        "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fst1", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"m", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m0", "}"}], ",", 
       RowBox[{
        RowBox[{"m0", "=", "m"}], ";", 
        RowBox[{
         RowBox[{"m0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"st10", ",", 
           RowBox[{"m0", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
        "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fst2", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"m", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m0", "}"}], ",", 
       RowBox[{
        RowBox[{"m0", "=", "m"}], ";", 
        RowBox[{
         RowBox[{"m0", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"st20", ",", 
           RowBox[{"m0", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
        "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fat1", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"m", ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "m0", "}"}], ",", 
        RowBox[{
         RowBox[{"m0", "=", "m"}], ";", 
         RowBox[{
          RowBox[{"m0", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"Map", "[", 
           RowBox[{"at10", ",", 
            RowBox[{"m0", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
         "m0"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "COLORS", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col00", "=", 
   RowBox[{"Lighter", "[", 
    RowBox[{
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "]"}], ",", "0.9"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col0", "=", 
   RowBox[{"Lighter", "[", 
    RowBox[{
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "]"}], ",", "0.8"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col1", "=", 
   RowBox[{"Lighter", "[", 
    RowBox[{
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.5", ",", "0.75", ",", "0.5"}], "]"}], ",", "0.5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col1l", "=", 
   RowBox[{"Lighter", "[", 
    RowBox[{"col1", ",", "0.7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col11", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.19", ",", "0.42", ",", "0.19"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col2", "=", 
   RowBox[{"Lighter", "[", 
    RowBox[{
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.89", ",", "0.6", ",", "0.53"}], "]"}], ",", " ", "0.5"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dcol", "=", "0.2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"darrow", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"col11", ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", 
           RowBox[{"{", 
            RowBox[{"1.6", ",", "1"}], "}"}]}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.6", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", ".5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{".4", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uarrow", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"col11", ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", 
             RowBox[{"{", 
              RowBox[{"1.6", ",", "1"}], "}"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.6", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", ".5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{".4", ",", "1"}], "}"}]}], "}"}]}], ")"}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uarrown", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"col11", ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{
         RowBox[{"-", ".07"}], 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1", "-", "30"}], ",", 
             RowBox[{
              RowBox[{"j", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", ".5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1.6", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{".4", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"darrown", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"col11", ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{
         RowBox[{"-", ".07"}], 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1", "-", "30"}], ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", ".5"}], ")"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1.6", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{".4", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs1", "=", 
   RowBox[{"Invisible", "@", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.2"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", ".1"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs2", "=", 
    RowBox[{"Invisible", "@", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", ".1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", ".1"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RegularPolygon", "[", 
      RowBox[{"r", ",", "6"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rpl", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.5", ",", "0.83", ",", "0.5", ",", 
           RowBox[{"Clock", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "]"}]}], "]"}], 
         "]"}], ",", "rp"}], "}"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logo", "=", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Interactive Epithelium\>\"", ",", "17", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
        ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5", ",", "0.83", ",", "0.5", ",", ".5"}], "]"}], 
             "]"}], ",", "rp"}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Ready to Start\>\"", ",", "14", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
        ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<version ``\>\"", ",", "fversion"}], "]"}], ",", "12", 
          ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}]}],
        "}"}], ",", 
      RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logowait", "=", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Interactive Epithelium\>\"", ",", "17", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
         ",", "rpl", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Simulating...\>\"", ",", "14", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"modrunQ", ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<model: ``\>\"", ",", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"StringForm", "[", 
                 RowBox[{"\"\<`1`/`2`\>\"", ",", "ik2", ",", 
                  RowBox[{"Length", "@", "savel"}]}], "]"}]}]}], "]"}], ",", 
             "12", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
            "]"}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"msimn", ">", "1"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<tissue: ``\>\"", ",", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"StringForm", "[", 
                 RowBox[{"\"\<`1`/`2`\>\"", ",", "ik", ",", "msimn"}], 
                 "]"}]}]}], "]"}], ",", "12", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
            "]"}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<mesh ``\>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", ">=", "1"}], ",", "\"\<\[Checkmark]\>\"", ",", 
               RowBox[{"progf", "[", 
                RowBox[{"miii", ",", 
                 RowBox[{"3", "n"}], ",", "n"}], "]"}]}], "]"}]}], "]"}], ",",
            "12", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check", ">=", "1"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<matrices ``\>\"", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"check", ">=", "2"}], ",", "\"\<\[Checkmark]\>\"", 
                 ",", 
                 RowBox[{"progf", "[", 
                  RowBox[{"aiii", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"Boole", "[", "protQ", "]"}]}], ")"}], 
                    RowBox[{"Length", "@", "gl"}]}], ",", 
                   RowBox[{"Length", "@", "lvs"}]}], "]"}]}], "]"}]}], "]"}], 
             ",", "12", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
            "]"}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check", ">=", "2"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<simulation ``\>\"", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"check", ">=", "3"}], ",", "\"\<\[Checkmark]\>\"", 
                 ",", 
                 RowBox[{"progf", "[", 
                  RowBox[{"iii", ",", "Tmax", ",", "Tmax"}], "]"}]}], "]"}]}],
               "]"}], ",", "12", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
            "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logowait2", "=", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Interactive Epithelium\>\"", ",", "17", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
       ",", "rpl", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Rendering...\>\"", ",", "14", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logowait3", "=", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Interactive Epithelium\>\"", ",", "17", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}], 
        ",", "rpl", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Exporting...\>\"", ",", "14", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], "]"}]}],
        "}"}], ",", 
      RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"ABOUT", " ", "SECTION"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "about", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"about", "[", "run_", "]"}], ":=", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Text", "@", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Interactive Epithelium\>\"", ",", "Bold", ",", 
             RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<version ``\>\"", ",", "fversion"}], "]"}], ",", 
            "12", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Terminal\>\""}]}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<by Francisco Berkemeier - `1` - `2`\>\"", ",", 
              RowBox[{"Hyperlink", "[", 
               RowBox[{
               "\"\<ucahfpb@ucl.ac.uk\>\"", ",", 
                "\"\<mailto:ucahfpb@ucl.ac.uk\>\""}], "]"}], ",", 
              RowBox[{"Hyperlink", "[", 
               RowBox[{
               "\"\<website\>\"", ",", 
                "\"\<https://franciscoberkemeier.com\>\""}], "]"}]}], "]"}], 
            ",", "at1"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Department of Mathematics\>\"", ",", "at1"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<University College London, `1`\>\"", ",", 
              RowBox[{"DateString", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<MonthName\>\"", ",", "\"\< \>\"", ",", "\"\<Year\>\""}], 
                "}"}], "]"}]}], "]"}], ",", "at1"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"musicQ", "&&", 
            RowBox[{"FileExistsQ", "[", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<Extras\>\"", ",", "\"\<Radio\>\""}], "}"}], "]"}], "]"}],
             "&&", 
            RowBox[{"musiclist", "=!=", 
             RowBox[{"{", "}"}]}]}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\[BeamedEighthNote] Now playing: ``\>\"", ",", 
                   RowBox[{"radios", "[", 
                    RowBox[{"aa", "[", "\"\<CurrentTrack\>\"", "]"}], "]"}]}],
                   "]"}], ",", "at1"}], "]"}], "}"}]}], "\[IndentingNewLine]",
              "}"}]}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<- - - - - - - - - -\>\"", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Description:\>\"", ",", "Bold", ",", "at1"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"TextCell", "[", 
           RowBox[{
           "\"\<This interactive program aims to provide a practical tool for \
testing parameter robustness while simulating the dynamics of different \
signalling pathways in an epithelium. The current version includes cell-cell \
signalling and protrusions, with several parameters available for custom \
simulations. The main available models are the Collier and Sprinzak models of \
juxtacrine signalling.\>\"", ",", 
            RowBox[{"CellSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"500", ",", "Automatic"}], "}"}]}], ",", 
            RowBox[{"TextAlignment", "\[Rule]", "Left"}], ",", "at1"}], "]"}],
           "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Row", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<``\>\"", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\< References \>\"", ",", "13"}], "]"}], ",", 
                   RowBox[{"run", "=", "2.1"}], ",", 
                   RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                  "]"}]}], "]"}], ",", "at1"}], "]"}], ",", 
             RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<``\>\"", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\< Future features \>\"", ",", "13"}], "]"}], 
                   ",", 
                   RowBox[{"sctn", "=", "1"}], ",", 
                   RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                  "]"}]}], "]"}], ",", "at1"}], "]"}], ",", 
             RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<``\>\"", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\< Known issues \>\"", ",", "13"}], "]"}], ",", 
                   RowBox[{"sctn", "=", "2"}], ",", 
                   RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                  "]"}]}], "]"}], ",", "at1"}], "]"}], ",", 
             RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<``\>\"", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\< Remarks \>\"", ",", "13"}], "]"}], ",", 
                   RowBox[{"sctn", "=", "3"}], ",", 
                   RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
                  "]"}]}], "]"}], ",", "at1"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "}"}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sctn", "==", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "at1"}], "]"}], "}"}], "&"}], "/@", 
             "todoa"}], ",", "\[IndentingNewLine]", 
            RowBox[{"sctn", "==", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "at1"}], "]"}], "}"}], "&"}], "/@", 
             "todob"}], ",", "\[IndentingNewLine]", 
            RowBox[{"sctn", "==", "3"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "at1"}], "]"}], "}"}], "&"}], "/@", 
             "todor"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Please read the `1` for more info.\>\"", ",", 
              RowBox[{"Hyperlink", "[", 
               RowBox[{
               "\"\<Interactive Epithelium Documentation\>\"", ",", 
                "\"\<https://drive.google.com/open?id=\
1AYnlNqeRlqDMpYUXmM8SpHZLlmioDmUg\>\""}], "]"}]}], "]"}], ",", "st1"}], "]"}],
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Written in Wolfram Mathematica ``\>\"", ",", "Mversion"}], 
             "]"}], ",", "at1"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0.5", ",", "0.83", ",", "0.5", ",", ".5"}], "]"}], 
               "]"}], ",", "rp"}], "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "SPACINGS", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spc", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<\>\"", ",", 
     RowBox[{"Spacer", "[", "0.5", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spc2", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<\>\"", ",", 
     RowBox[{"Spacer", "[", "0.35", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spl", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"l", ",", 
      RowBox[{"Insert", "[", 
       RowBox[{"l", ",", "SpanFromLeft", ",", "2"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTEBOOK", " ", "CLOSE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"InputNotebook", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cellObjs", "=", 
     RowBox[{"Cells", "[", 
      RowBox[{"CellTags", "->", 
       RowBox[{"{", "\"\<codetag\>\"", "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"nb", ",", "\[IndentingNewLine]", 
      RowBox[{"NotebookEventActions", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<WindowClose\>\"", ":>", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"SelectionMove", "[", 
               RowBox[{"#", ",", "All", ",", "Cell"}], "]"}], ";", 
              RowBox[{
              "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", 
               "]"}], ";"}], "&"}], "/@", "cellObjs"}], ";"}], 
          "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "MUSIC", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"musiclist", "=", 
   RowBox[{"FileNameTake", "/@", 
    RowBox[{"FileNames", "[", 
     RowBox[{"\"\<*.mp3\>\"", ",", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Extras\>\"", ",", 
         "\"\<Radio\>\""}], "}"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mfiles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Audio", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Extras\>\"", ",", 
         "\"\<Radio\>\"", ",", "mf"}], "}"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mf", ",", "musiclist"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"musicd", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "==", "\"\<goldberg.mp3\>\""}], ",", 
       "\[IndentingNewLine]", "\"\<Goldberg Variations, by J.S. Bach\>\"", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<mahler.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Adagietto (Symphony No. 5), by Mahler\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<reverie.mp3\>\""}], ",", 
       "\[IndentingNewLine]", "\"\<Reverie, by Debussy\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<david.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Announcement\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<david2.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Announcement\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<david3.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Announcement\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<lente.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<La Plus que Lente, by Debussy\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<ravel.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Une Barque sur L'Ocean, by Ravel\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<waltz.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Waltz No. 2, by Shostakovich\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<reborn.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Reborn, by Miguel Berkemeier\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"s", "==", "\"\<faun.mp3\>\""}], ",", "\[IndentingNewLine]", 
       "\"\<Prelude to the Afternoon of a Faun, by Debussy\>\"", ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       "\"\<Music\>\""}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radios", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"s", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"musicd", "/@", "musiclist"}], ")"}], "[", 
       RowBox[{"[", "shf", "]"}], "]"}], "[", 
      RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8338741177901864`*^9, 3.833874132383215*^9}, {
   3.8338742584381127`*^9, 3.833874260987401*^9}, {3.833961868529224*^9, 
   3.8339619237664456`*^9}, {3.8339619900270953`*^9, 
   3.8339620078003335`*^9}, {3.8342252321781225`*^9, 
   3.8342252756568613`*^9}, {3.8342253209158363`*^9, 3.834225395190277*^9}, {
   3.834225484056977*^9, 3.8342255290155344`*^9}, {3.834225668184308*^9, 
   3.8342257041552134`*^9}, {3.8342261209384813`*^9, 3.834226142308275*^9}, {
   3.8342262104374495`*^9, 3.834226232018504*^9}, {3.8342308577654715`*^9, 
   3.8342308908770757`*^9}, {3.8342309278024645`*^9, 
   3.8342310267098217`*^9}, {3.8342316517182713`*^9, 3.834231670927777*^9}, {
   3.8342369269740243`*^9, 3.834236942970366*^9}, {3.8346641330543766`*^9, 
   3.8346641364340286`*^9}, {3.834664216157392*^9, 3.8346642210984373`*^9}, {
   3.834664278533746*^9, 3.8346642937332134`*^9}, {3.8346643386618958`*^9, 
   3.834664339770608*^9}, {3.8346672235323915`*^9, 3.834667229478426*^9}, {
   3.8346896703217587`*^9, 3.834689679857782*^9}, {3.834689833891513*^9, 
   3.834689853193572*^9}, {3.8346898842184486`*^9, 3.834689904239786*^9}, {
   3.834690390697217*^9, 3.834690467029002*^9}, {3.8346905507306995`*^9, 
   3.8346905518633757`*^9}, {3.834690704313266*^9, 3.834690737474739*^9}, {
   3.8347320219036913`*^9, 3.8347320344975743`*^9}, {3.8347320712007327`*^9, 
   3.83473208683665*^9}, {3.83474316956287*^9, 3.8347431862167654`*^9}, {
   3.834751876500269*^9, 3.834751928212718*^9}, {3.8347519874286757`*^9, 
   3.834752051271763*^9}, {3.8347521118848886`*^9, 3.834752121353574*^9}, {
   3.8348314208447685`*^9, 3.83483142091558*^9}, {3.8348317187921944`*^9, 
   3.834831721790985*^9}, {3.8348321412390537`*^9, 3.8348321604949946`*^9}, {
   3.834832234082701*^9, 3.8348322691274385`*^9}, {3.834832323278566*^9, 
   3.83483232729497*^9}, {3.834902344608169*^9, 3.8349023482366323`*^9}, {
   3.8349023883199196`*^9, 3.834902389915888*^9}, {3.8349024242921424`*^9, 
   3.8349024569412594`*^9}, {3.8350981968938704`*^9, 
   3.8350982197433505`*^9}, {3.8351016046647663`*^9, 3.835101617813285*^9}, {
   3.8352811984065313`*^9, 3.8352812081429315`*^9}, {3.8352858505223613`*^9, 
   3.8352858536312594`*^9}, {3.8352858908154116`*^9, 
   3.8352858908981895`*^9}, {3.8353644092828417`*^9, 3.8353644671262913`*^9}, 
   3.8353645274584537`*^9, {3.835387044627808*^9, 3.8353870447532043`*^9}, {
   3.8353883746798224`*^9, 3.835388477716752*^9}, 3.8354303511038322`*^9, {
   3.8354482248055563`*^9, 3.835448224858047*^9}, {3.8354510982639313`*^9, 
   3.835451101544243*^9}, {3.8354512163986206`*^9, 3.8354513431218624`*^9}, {
   3.835451579547761*^9, 3.835451587985594*^9}, {3.83545169199608*^9, 
   3.835451696532943*^9}, {3.835456787337411*^9, 3.8354567995284452`*^9}, {
   3.8354576230042577`*^9, 3.83545762423514*^9}, {3.8354606859633827`*^9, 
   3.835460741604536*^9}, {3.8354614168676405`*^9, 3.8354614210772123`*^9}, 
   3.835461793327697*^9, 3.835461833402639*^9, {3.835461956573143*^9, 
   3.8354619922796235`*^9}, {3.835463210962427*^9, 3.835463222982273*^9}, {
   3.835463329335768*^9, 3.8354633934133115`*^9}, {3.8354636759751015`*^9, 
   3.8354636838040347`*^9}, {3.8354637428145857`*^9, 
   3.8354637444751434`*^9}, {3.835465889209082*^9, 3.8354660181140733`*^9}, {
   3.8354662727589626`*^9, 3.8354662728512297`*^9}, {3.835466770384529*^9, 
   3.835466774959695*^9}, {3.835689706899486*^9, 3.83568970698027*^9}, {
   3.835716490125287*^9, 3.835716500217289*^9}, {3.835716779241787*^9, 
   3.835716779534012*^9}, {3.8357170163242645`*^9, 3.835717049397727*^9}, {
   3.8357170811664543`*^9, 3.835717081506585*^9}, {3.8357171339865446`*^9, 
   3.8357171641619625`*^9}, {3.8357172888719406`*^9, 
   3.8357173018613787`*^9}, {3.8357734368492327`*^9, 
   3.8357734393960047`*^9}, {3.835773773171322*^9, 3.835773773222302*^9}, {
   3.835777039481382*^9, 3.8357771621990547`*^9}, {3.8357925764732904`*^9, 
   3.8357925765410995`*^9}, {3.835859645544589*^9, 3.8358596593064175`*^9}, {
   3.835862969379801*^9, 3.835862988706317*^9}, {3.835870308860114*^9, 
   3.83587032828389*^9}, {3.8358907785267305`*^9, 3.8358908736167846`*^9}, {
   3.8358909109142275`*^9, 3.8358909210989933`*^9}, {3.835891010812619*^9, 
   3.8358910584878597`*^9}, {3.83589110087215*^9, 3.8358911150354767`*^9}, 
   3.8358919345952034`*^9, {3.836291462563738*^9, 3.836291462603631*^9}, {
   3.836301094554982*^9, 3.8363011033148108`*^9}, 3.836301459098012*^9, {
   3.8363020393315687`*^9, 3.83630204724631*^9}, {3.8363021185962496`*^9, 
   3.8363021422582517`*^9}, {3.8363021866911116`*^9, 
   3.8363022134509583`*^9}, {3.83630408357611*^9, 3.8363041001406107`*^9}, {
   3.8363045439914775`*^9, 3.83630458427888*^9}, {3.8363102454048295`*^9, 
   3.83631027404772*^9}, {3.836311812636876*^9, 3.836311812761543*^9}, {
   3.836370598542062*^9, 3.83637061340932*^9}, {3.8363706620516367`*^9, 
   3.836370663363883*^9}, {3.836370710218369*^9, 3.836370733158533*^9}, {
   3.8363708792169466`*^9, 3.836370942730626*^9}, {3.836371050784827*^9, 
   3.8363710892080965`*^9}, {3.8363711956121902`*^9, 
   3.8363712454490585`*^9}, {3.8363712849362965`*^9, 
   3.8363712850440073`*^9}, {3.8363714898828363`*^9, 
   3.8363714996006174`*^9}, {3.8363715815615926`*^9, 3.83637158160744*^9}, {
   3.836377037402338*^9, 3.836377132962345*^9}, {3.8363853541204743`*^9, 
   3.836385358590615*^9}, {3.836484442849049*^9, 3.836484442905898*^9}, {
   3.836649145354911*^9, 3.836649198064268*^9}, {3.8366492750808225`*^9, 
   3.8366492794281588`*^9}, {3.836649381366066*^9, 3.8366493836545544`*^9}, {
   3.836649503247575*^9, 3.836649505073082*^9}, {3.8366495562544165`*^9, 
   3.836649556311264*^9}, {3.8366502051239705`*^9, 3.836650223407714*^9}, {
   3.8366504023945217`*^9, 3.8366504025147505`*^9}, {3.836651043535129*^9, 
   3.8366510680476837`*^9}, {3.83665126578557*^9, 3.8366512678855543`*^9}, {
   3.8366513231209164`*^9, 3.836651323931259*^9}, {3.8366514231805496`*^9, 
   3.8366514263331347`*^9}, {3.8366514672589693`*^9, 
   3.8366514706635747`*^9}, {3.8366515535764923`*^9, 3.83665155730079*^9}, {
   3.8366517133055906`*^9, 3.8366517557941446`*^9}, {3.836651800592938*^9, 
   3.8366518053528523`*^9}, {3.836651875705462*^9, 3.836651882608654*^9}, {
   3.836652190309558*^9, 3.8366522814205956`*^9}, {3.8366523717891145`*^9, 
   3.8366523844660673`*^9}, {3.8366524260292363`*^9, 
   3.8366524573628387`*^9}, {3.8366525507394705`*^9, 
   3.8366525562105713`*^9}, {3.836652684578153*^9, 3.836652704631591*^9}, {
   3.836652744704872*^9, 3.836652782073825*^9}, {3.836652887742159*^9, 
   3.8366528952138405`*^9}, {3.8366530039650464`*^9, 3.836653028379527*^9}, {
   3.8366530932869663`*^9, 3.83665309604795*^9}, {3.8366531348938494`*^9, 
   3.8366531350025587`*^9}, {3.836654536122117*^9, 3.8366545407923017`*^9}, {
   3.836814533204351*^9, 3.8368145386892185`*^9}, {3.8368145981200237`*^9, 
   3.8368145981848173`*^9}, {3.8369089457565007`*^9, 
   3.8369089478930635`*^9}, {3.8369894402259874`*^9, 
   3.8369894426802344`*^9}, {3.8369917376931925`*^9, 3.836991802009488*^9}, {
   3.836991840005768*^9, 3.8369918416792927`*^9}, {3.8370915337994227`*^9, 
   3.8370915366757317`*^9}, {3.8370918795387063`*^9, 3.837091888981473*^9}, {
   3.837091944643423*^9, 3.8370920077295475`*^9}, {3.8370923975405245`*^9, 
   3.8370924106169043`*^9}, {3.8370925830865746`*^9, 3.837092584132825*^9}, {
   3.8370927274403486`*^9, 3.83709272801326*^9}, {3.837092793383546*^9, 
   3.8370928332601824`*^9}, {3.8370929438150387`*^9, 3.837092948090701*^9}, {
   3.837095042574032*^9, 3.837095119929367*^9}, {3.8371172053518496`*^9, 
   3.8371172579335327`*^9}, {3.837117820587325*^9, 3.8371178584789505`*^9}, {
   3.837628638671384*^9, 3.8376286579125423`*^9}, {3.83777513900485*^9, 
   3.8377751392133274`*^9}, {3.837775212100589*^9, 3.837775237504259*^9}, {
   3.837775302599036*^9, 3.837775314913341*^9}, {3.8388062926386385`*^9, 
   3.8388062927074547`*^9}, {3.8396726304414034`*^9, 3.839672676801939*^9}, {
   3.8396729122893515`*^9, 3.8396729298982534`*^9}, {3.839674565627668*^9, 
   3.8396745862044716`*^9}, 3.8396746368384285`*^9, {3.8396746852129264`*^9, 
   3.8396746926925635`*^9}, {3.839674929485201*^9, 3.8396749353111286`*^9}, {
   3.839675074717715*^9, 3.83967510117132*^9}, 3.8400793024514837`*^9, {
   3.8406081745073104`*^9, 3.8406081800407677`*^9}, 3.840780073297723*^9, {
   3.840780105311056*^9, 3.840780106421932*^9}, {3.8407804813001156`*^9, 
   3.840780507438613*^9}, 3.8407882362385635`*^9, {3.840788480207638*^9, 
   3.8407884802594995`*^9}, {3.8408828304289255`*^9, 3.840882830488765*^9}, {
   3.840904244978188*^9, 3.840904246492028*^9}, {3.8409813129739103`*^9, 
   3.84098131456964*^9}, {3.840982517473857*^9, 3.8409825175227413`*^9}, {
   3.8409827935605245`*^9, 3.8409828283117065`*^9}, {3.8409863198539834`*^9, 
   3.840986327622409*^9}, {3.8409869167473464`*^9, 3.8409869173158255`*^9}, {
   3.8410101550757413`*^9, 3.841010155171485*^9}, {3.8415710772018228`*^9, 
   3.841571077297567*^9}, {3.84165730311403*^9, 3.841657486049755*^9}, {
   3.841657531493453*^9, 3.84165754004961*^9}, 3.8416576745330935`*^9, {
   3.8416577404782705`*^9, 3.841657765664695*^9}, {3.841657826884879*^9, 
   3.8416578653598375`*^9}, {3.8416579404652195`*^9, 3.8416579713985925`*^9}, 
   3.8416581570296545`*^9, {3.8416583578755903`*^9, 3.8416584203344183`*^9}, {
   3.8416584685892167`*^9, 3.8416584693690987`*^9}, {3.8417426593495264`*^9, 
   3.841742659429313*^9}, {3.841743020633216*^9, 3.841743020709013*^9}, {
   3.841743531096757*^9, 3.8417435311366515`*^9}, {3.842726160342331*^9, 
   3.8427261604733744`*^9}, {3.8438933181108694`*^9, 
   3.8438933228600173`*^9}, {3.844847248740662*^9, 3.844847248796513*^9}, {
   3.845635518796113*^9, 3.845635518860939*^9}, {3.850555299922633*^9, 
   3.8505553000084553`*^9}, {3.8505553641765013`*^9, 3.8505553679374447`*^9}, 
   3.856005440805859*^9, 3.8570310303860707`*^9, 3.8576404694853125`*^9, 
   3.8576405040050535`*^9, 3.858158113194353*^9, {3.861349606403022*^9, 
   3.8613496064708405`*^9}, {3.86212996330888*^9, 3.862129963603093*^9}, {
   3.8621338907963476`*^9, 3.862133890860177*^9}, {3.864721771151283*^9, 
   3.8647217714836206`*^9}, 3.8652422614542503`*^9, 3.8652471375740824`*^9, {
   3.865526225621537*^9, 3.865526227757699*^9}, {3.8670649611450863`*^9, 
   3.867064961269916*^9}, {3.867154017042998*^9, 3.8671540239190793`*^9}, {
   3.867154076432051*^9, 3.8671540786413813`*^9}, {3.880627519251917*^9, 
   3.880627520678811*^9}, {3.8806592741797547`*^9, 3.8806592979718523`*^9}, {
   3.880659361563076*^9, 3.880659363258681*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellTags->"codetag",
 CellLabel->
  "In[162]:=",ExpressionUUID->"6c33e863-9695-4dc7-876b-ce221481210e"]
}, Closed]],

Cell[CellGroupData[{

Cell["References", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}, {3.833874108661461*^9, 
   3.833874113945092*^9}, {3.8371130075475173`*^9, 3.837113008538871*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"7b47484a-83ba-4847-b47c-9bf94eaedaeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reorder", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"refs", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fname", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"refs", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"RegularExpression", "[", "\"\<\\\\W+\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "refs"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"refso", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"fname", ",", 
             RowBox[{
              RowBox[{"AlphabeticSort", "[", "fname", "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "refs"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"refs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "12", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro\>\""}]}], 
           "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "refso"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"biblio", "=", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<References\>\"", ",", "Bold", ",", 
            RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Spacer", "[", "30", "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"reorder", "@", 
          RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Hyperlink", "[", 
             RowBox[{
             "\"\<COLLIER, Joanne R., et al. Pattern formation by lateral \
inhibition with feedback: a mathematical model of delta-notch intercellular \
signalling. Journal of theoretical Biology, 1996, 183.4: 429-446.\>\"", ",", 
              "\[IndentingNewLine]", 
              "\"\<https://www.sciencedirect.com/science/article/pii/\
S0022519396902337\>\""}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", 
             RowBox[{
             "\"\<COHEN,Michael,et al.Dynamic filopodia transmit intermittent \
Delta-Notch signaling to drive pattern refinement during lateral \
inhibition.Developmental cell,2010,19.1:78-89.\>\"", ",", 
              "\[IndentingNewLine]", 
              "\"\<https://www.sciencedirect.com/science/article/pii/\
S1534580710002960\>\""}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", 
             RowBox[{
             "\"\<KHAIT, Itzhak, et al. Quantitative analysis of Delta-like 1 \
membrane dynamics elucidates the role of contact geometry on Notch signaling. \
Cell reports, 2016, 14.2: 225-233.\>\"", ",", "\[IndentingNewLine]", 
              "\"\<https://www.sciencedirect.com/science/article/pii/\
S2211124715014643\>\""}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<SHAYA, Oren, et al. Cell-cell contact area affects notch \
signaling and notch-dependent patterning. Developmental cell, 2017, 40.5: \
505-511. e6.\>\"", ",", "\[IndentingNewLine]", 
              "\"\<https://www.sciencedirect.com/science/article/pii/\
S1534580717300783\>\""}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<SPRINZAK, David, et al. Cis-interactions between Notch and \
Delta generate mutually exclusive signalling states. Nature, 2010, 465.7294: \
86-90.\>\"", ",", "\[IndentingNewLine]", 
              "\"\<https://www.nature.com/articles/nature08959/boxes/bx1\>\""}\
], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<SPRINZAK, David; NBINSHTOK, Udi. Modeling the notch \
response. Molecular Mechanisms of Notch Signaling, 2018, 79-98.\>\"", ",", 
              "\[IndentingNewLine]", 
              "\"\<https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6879322/\>\""}\
], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Hyperlink", "[", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<COHEN, Michael; BAUM, Buzz; MIODOWNIK, Mark. The importance \
of structured noise in the generation of self-organizing tissue patterns \
through contact-mediated cell\[Dash]cell signalling. Journal of the Royal \
Society Interface, 2011, 8.59: 787-798.\>\"", ",", "\[IndentingNewLine]", 
              "\"\<https://royalsocietypublishing.org/doi/full/10.1098/rsif.\
2010.0488\>\""}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}], ";"}]}], "Input",\

 InitializationGroup->True,
 CellChangeTimes->{{3.8370925140892096`*^9, 3.8370925680598326`*^9}, {
   3.8370931274390755`*^9, 3.83709313459943*^9}, {3.8370931807636213`*^9, 
   3.8370932073714805`*^9}, {3.837093273048713*^9, 3.83709335116349*^9}, {
   3.837094584452148*^9, 3.837094585698695*^9}, {3.8370946258116145`*^9, 
   3.8370946393154573`*^9}, {3.837094707592594*^9, 3.8370947549569864`*^9}, {
   3.8370947904317894`*^9, 3.83709479381591*^9}, {3.8370948346934423`*^9, 
   3.8370948359167547`*^9}, {3.8371125710096846`*^9, 
   3.8371125799524393`*^9}, {3.837112646228509*^9, 3.83711266790497*^9}, 
   3.8371128344873605`*^9, {3.8371130281150856`*^9, 3.837113134929486*^9}, {
   3.8371131822758*^9, 3.837113208074308*^9}, {3.8371132442950296`*^9, 
   3.837113283069784*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[216]:=",ExpressionUUID->"abcc06a0-904d-49ed-81e0-427f1a86e045"]
}, Closed]],

Cell[CellGroupData[{

Cell["Debug", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8336136687573137`*^9, 
   3.8336136712359924`*^9}, {3.833613738624074*^9, 3.833613740402709*^9}, {
   3.833621753339508*^9, 3.833621756329624*^9}, {3.833874108661461*^9, 
   3.833874113945092*^9}, {3.8371130075475173`*^9, 3.837113008538871*^9}, {
   3.83711340080017*^9, 3.83711340244178*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"4a9aff6d-62fa-41b1-810d-f78a53a78348"],

Cell[BoxData[
 RowBox[{
  RowBox[{"debug", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", ",", 
       "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", "sorc", ",", 
       "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
       ",", "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", 
       ",", "stats", ",", "sigm", ",", "sigr", ",", "vmod", ",", "vormod", 
       ",", "smod", ",", 
       StyleBox["ka", "Input"], 
       StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", "\[Eta]",
        ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", "diamx", ",", 
       "depQ", ",", 
       StyleBox["ka2", "Input"], 
       StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", "a0e2",
        ",", "d\[Kappa]2", ",", "diamx2", ",", 
       StyleBox["ka3", "Input"], 
       StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", "a0e3",
        ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", "treshT2", ",",
        "n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy", ",", "Tvf", ",", 
       "Tsimf", ",", "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
       "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", "stretNQ", ",", 
       "stretN", ",", "Trele", ",", "Thold", ",", "sigallQ", ",", "stetbQ", 
       ",", "bthk", ",", "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", 
       ",", "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", 
       "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", 
       "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",", 
       "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", "\[Kappa]RS", ",", 
       "m", ",", "p", ",", "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", 
       "stefv", ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
       "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",",
        "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", 
       "cellQ", ",", "longt", ",", "cutcQ", ",", "grQ", ",", "grt", ",", 
       "grT", ",", "colo1", ",", "colom", ",", "colob", ",", "mbmt", ",", 
       "rmb", ",", "expsQ", ",", "imgse", ",", "plotsQ", ",", "param1Q", ",", 
       "param1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bug", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"erri", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bugl", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"persQ", "&&", 
          RowBox[{"!", "perQ"}]}], ",", "\[IndentingNewLine]", 
         "\"\<Periodic signalling requires periodic mesh.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"plotSOPnQ", "||", "plotSOPdQ"}], ")"}], "&&", 
          RowBox[{"sigr", "=!=", "1"}]}], ",", "\[IndentingNewLine]", 
         "\"\<SOP distance analysis only available for double-stripe \
region.\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mshn", ",", "lliter", ",", "seed", ",", 
             StyleBox["ka", "Input"], 
             StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
             "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
             "diamx", ",", 
             StyleBox["ka2", "Input"], 
             StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", 
             "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
             StyleBox["ka3", "Input"], 
             StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", 
             "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", 
             "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", 
             "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",", 
             "Tsim2", ",", "rho", ",", "k", ",", "h", ",", "mu", ",", "aN0", 
             ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", "iniR", ",", 
             "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",", "\[Tau]", ",",
              "\[Kappa]t", ",", "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",",
              "p", ",", "l", ",", "Tste", ",", "nv", ",", "stefh", ",", 
             "stefv", ",", "pbt", ",", "pdt", ",", "pll", ",", 
             RowBox[{"N", "@", "pla"}], ",", "\[Epsilon]", ",", "longt", ",", 
             "grt", ",", "mbmt", ",", "rmb"}], "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NumberQ", "[", "#", "]"}]}], "&&", 
              RowBox[{"#", "=!=", "Null"}]}], "&"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         "\"\<One or more input values are not numbers.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mshn", ",", "lliter", ",", "seed", ",", 
             StyleBox["ka", "Input"], 
             StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
             "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
             "diamx", ",", 
             StyleBox["ka2", "Input"], 
             StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", 
             "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
             StyleBox["ka3", "Input"], 
             StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", 
             "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", 
             "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", 
             "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",", 
             "Tsim2", ",", "rho", ",", "k", ",", "h", ",", "mu", ",", "aN0", 
             ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", "iniR", ",", 
             "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",", "\[Tau]", ",",
              "\[Kappa]t", ",", "\[Kappa]c", ",", "\[Kappa]RS", ",", "m", ",",
              "p", ",", "l", ",", "Tste", ",", "nv", ",", "stefh", ",", 
             "stefv", ",", "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", 
             "\[Epsilon]", ",", "longt", ",", "grt", ",", "mbmt", ",", 
             "rmb"}], "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "==", "Null"}], "&"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<One or more missing parameters.\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "Tsim", ",", "Tmax", ",", "Tsim2", ",", "Tste", ",", "Tsimf"}], 
            "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "<", "0"}], "&"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<Time parameters cannot be negative.\>\"",
          ",", "\[IndentingNewLine]", 
         RowBox[{"Tstei", ">=", "Tstef"}], ",", "\[IndentingNewLine]", 
         "\"\<Stretch ending should be after its beginning.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy"}], 
            "}"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "<", "0"}], "&"}], ")"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         "\"\<Tissue dimensions cannot be negative.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tsimf", "<", "Tsim"}], "||", 
          RowBox[{"Tsimf", "<", "Tsim2"}]}], ",", "\[IndentingNewLine]", 
         "\"\<Signalling starting time must be lower than its end.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mshn", "<", "0"}], ",", "\[IndentingNewLine]", 
         "\"\<Hexagonal lattice noise should be a positive number.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "nx", "]"}]}], "||", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "ny", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         "\"\<Rows and columns should be integers.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sigr", "==", "4"}], "&&", 
          RowBox[{"!", "fitQ"}]}], ",", "\[IndentingNewLine]", 
         "\"\<Signal region not selected.\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mshn", "<", "0"}], "||", 
          RowBox[{"mshn", ">", "10"}]}], ",", "\[IndentingNewLine]", 
         "\"\<Noise should be between 0 and 1.\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Data\>\"", 
               ",", "sorc"}], "}"}], "]"}], "]"}]}], "&&", 
          RowBox[{"msht", "==", "2"}]}], ",", "\[IndentingNewLine]", 
         "\"\<Data folder doesn't exist.\>\""}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bugln", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerString", "[", 
             RowBox[{"j", ",", "10", ",", 
              RowBox[{"Floor", "@", 
               RowBox[{"N", "@", 
                RowBox[{"Log", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Length", "@", "bugl"}], "/", "2"}], ")"}]}]}]}]}],
              "]"}], ",", 
            RowBox[{"IntegerString", "[", 
             RowBox[{"j", ",", "10", ",", 
              RowBox[{"Floor", "@", 
               RowBox[{"N", "@", 
                RowBox[{"Log", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Length", "@", "bugl"}], "/", "2"}], ")"}]}]}]}]}],
              "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "bugl"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"bugl", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"bug", ",", 
            RowBox[{"StringForm", "[", 
             RowBox[{
              RowBox[{"\"\<``\>\"", "<>", 
               RowBox[{"bugl", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"StringForm", "[", 
                 RowBox[{"\"\<Error ``: \>\"", ",", 
                  RowBox[{"bugln", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "Red"}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "bugl"}], "-", "1"}], ",", "2"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"bug", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"bugQ", "=", "False"}], ",", 
        RowBox[{"bugQ", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bug", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Item", "[", 
            RowBox[{
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Interactive Epithelium Debug Log\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Alegreya SC\>\""}]}], 
               "]"}]}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
           "\"\<\>\""}], "}"}], ",", "bug"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bug", "=", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "bug", "}"}]}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.837113405357982*^9, 3.837113470681405*^9}, {
   3.837113523340867*^9, 3.8371135247731504`*^9}, {3.837113593489254*^9, 
   3.83711359485161*^9}, {3.8371137101806417`*^9, 3.837113768258013*^9}, {
   3.8371138202818413`*^9, 3.837113885473135*^9}, 3.837114147179062*^9, {
   3.8371142173285103`*^9, 3.837114220556184*^9}, {3.83711444376516*^9, 
   3.8371144759303083`*^9}, {3.8371145134726505`*^9, 
   3.8371145875458374`*^9}, {3.837114648646781*^9, 3.8371147079363604`*^9}, {
   3.8371147954419785`*^9, 3.8371148276198497`*^9}, {3.837114999658742*^9, 
   3.8371150127609816`*^9}, {3.837115079656386*^9, 3.837115083457223*^9}, {
   3.8371151335579815`*^9, 3.8371151385266867`*^9}, {3.8371152545767365`*^9, 
   3.8371152749431067`*^9}, {3.837115308261853*^9, 3.837115384922719*^9}, 
   3.837115455354347*^9, {3.8371154973603525`*^9, 3.837115497435152*^9}, {
   3.8371155336349974`*^9, 3.8371155527242556`*^9}, {3.8371155861950145`*^9, 
   3.8371156094129505`*^9}, {3.8371156773385653`*^9, 
   3.8371156829526224`*^9}, {3.8371157768374453`*^9, 
   3.8371157800746937`*^9}, {3.8371161018245645`*^9, 3.837116140140021*^9}, {
   3.8371162357805133`*^9, 3.837116249632799*^9}, {3.837116444132752*^9, 
   3.837116450481025*^9}, {3.837116557695319*^9, 3.8371165943169255`*^9}, {
   3.837156303321674*^9, 3.837156313082588*^9}, {3.8371565508522496`*^9, 
   3.837156643611538*^9}, {3.837156828676055*^9, 3.8371569144247537`*^9}, {
   3.83715695865562*^9, 3.837156976079251*^9}, {3.837621992037134*^9, 
   3.8376220004920936`*^9}, {3.837622046608732*^9, 3.8376221311138706`*^9}, {
   3.837622206589946*^9, 3.8376222687003956`*^9}, {3.83762232829959*^9, 
   3.837622329048587*^9}, {3.8376224531978445`*^9, 3.8376224830934467`*^9}, {
   3.8376226133430357`*^9, 3.8376226790909777`*^9}, 3.837622739847621*^9, {
   3.837622799822601*^9, 3.837622800070922*^9}, {3.837856890926339*^9, 
   3.837856902266656*^9}, {3.8378589841793776`*^9, 3.837858987406747*^9}, {
   3.837871976118489*^9, 3.8378720030133977`*^9}, {3.838802869597297*^9, 
   3.838802881383938*^9}, {3.8388029573326197`*^9, 3.8388029592656655`*^9}, 
   3.8388038843945217`*^9, {3.838806272165872*^9, 3.838806273605215*^9}, 
   3.8389797910526123`*^9, 3.839489539821429*^9, 3.839585245176512*^9, {
   3.839587313116004*^9, 3.839587372858775*^9}, 3.839587413348723*^9, {
   3.8395885184907*^9, 3.8395885216213837`*^9}, 3.839760674904913*^9, {
   3.8400882869705467`*^9, 3.8400883066798124`*^9}, 3.8400890206199784`*^9, 
   3.8400891894405885`*^9, 3.8400893091377707`*^9, 3.8400894577527113`*^9, 
   3.840090091490798*^9, 3.840092694408242*^9, {3.840092819698989*^9, 
   3.8400928210197997`*^9}, 3.840095090254347*^9, 3.8401113906974955`*^9, 
   3.8401118934010525`*^9, 3.8401841375795455`*^9, 3.8405253410497026`*^9, 
   3.840526804753026*^9, 3.8406193656822157`*^9, 3.8406246943553524`*^9, {
   3.840742071564138*^9, 3.84074209354086*^9}, {3.84157159588737*^9, 
   3.8415716133258677`*^9}, {3.841660542326192*^9, 3.8416605443573437`*^9}, {
   3.8416643235519257`*^9, 3.8416643239848433`*^9}, {3.841664363037033*^9, 
   3.841664363741468*^9}, {3.841744081991333*^9, 3.841744108159186*^9}, {
   3.842601761909638*^9, 3.8426017622876587`*^9}, {3.8432919360610332`*^9, 
   3.843291948461216*^9}, 3.84346948836555*^9, {3.843472887215808*^9, 
   3.84347289736053*^9}, {3.8447696121574774`*^9, 3.84476961380208*^9}, {
   3.84477037215454*^9, 3.844770372485656*^9}, {3.8447706623955083`*^9, 
   3.8447706639665937`*^9}, {3.844771716503258*^9, 3.8447717178466926`*^9}, {
   3.844771826395467*^9, 3.8447718288657556`*^9}, {3.8447757596513205`*^9, 
   3.844775759673236*^9}, 3.845465700759597*^9, 3.845465800367978*^9, {
   3.84547280324876*^9, 3.8454728049194736`*^9}, 3.8456362498325653`*^9, 
   3.845638668475771*^9, {3.855904168818942*^9, 3.8559041702845187`*^9}, 
   3.855909424256431*^9, {3.855909573108182*^9, 3.8559096238333125`*^9}, 
   3.8560053566785316`*^9, {3.8570328012358255`*^9, 3.857032802372634*^9}, {
   3.857032888823267*^9, 3.857032888836232*^9}, {3.8570333294478493`*^9, 
   3.857033330989727*^9}, {3.857033367814381*^9, 3.857033369090042*^9}, {
   3.8570334432960377`*^9, 3.857033444199953*^9}, 3.8570474704297833`*^9, 
   3.8570475313688703`*^9, {3.857050210534179*^9, 3.857050214459682*^9}, {
   3.857642477567793*^9, 3.857642479568739*^9}, 3.8621337430403748`*^9, 
   3.8647219974183364`*^9, 3.8647223080432496`*^9, 3.8655270814720564`*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[218]:=",ExpressionUUID->"9536c29b-5c0d-4461-b8ba-3a3b6d7595c8"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["IV Simulations",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
   3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
   3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
   3.832654871762952*^9, 3.83265487499767*^9}, {3.8326722067258415`*^9, 
   3.8326722068011107`*^9}, 3.8342266821383457`*^9, {3.835448465127184*^9, 
   3.8354484656631165`*^9}, {3.835448515678563*^9, 3.8354485264575195`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"9fda52d0-5195-4525-8283-909c703bb8c5"],

Cell[CellGroupData[{

Cell["InteractiveEpithelium[]", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8338826936159997`*^9, 
   3.833882694258896*^9}, {3.8338833391990476`*^9, 3.833883340659916*^9}, {
   3.8347438841924696`*^9, 3.8347438868835874`*^9}, {3.8352011745007105`*^9, 
   3.835201181443224*^9}, {3.8363029556373453`*^9, 3.836302957112359*^9}, {
   3.837004391777647*^9, 3.8370043964106636`*^9}, {3.8376245352426877`*^9, 
   3.8376245361048875`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"7b41a326-554e-4788-b54f-5e9b4e496e35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"NEW", " ", "WINDOW"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CreateDocument", "[", 
    RowBox[{"{", 
     RowBox[{"TextCell", "[", 
      RowBox[{
       RowBox[{"InteractiveEpithelium", "[", "]"}], ",", "\"\<Output\>\""}], 
      "]"}], "}"}], "]"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InteractiveEpithelium", "[", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Framed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"If", "[", 
            RowBox[{"quietQ", ",", "Quiet", ",", "Identity"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "UPDATE", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"err", "=", "1"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"run", "\[Equal]", "0"}], ",", 
            RowBox[{"frame", "=", "logo"}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "\[Equal]", "1.4"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", 
             RowBox[{"iii", "=", "0"}], ";", 
             RowBox[{"miii", "=", "0"}], ";", 
             RowBox[{"aiii", "=", "0"}], ";", 
             RowBox[{"ik", "=", "1"}], ";", 
             RowBox[{"ik2", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"frame", "=", "logowait"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{"modrunQ", ",", 
               RowBox[{"run", "=", "1.55"}], ",", 
               RowBox[{"run", "=", "1.5"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"run", "==", "1.55"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"runplotSOP", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"runvideos", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"runfframe", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"outl", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"statsl", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"runi", ">", "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"savela", "[", 
                    RowBox[{"[", "runi", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<n\>\"", ",", "\"\<nx\>\"", ",", "\"\<ny\>\"", ",", 
                    "\"\<seed\>\"", ",", "\"\<mshn\>\"", ",", "\"\<msht\>\"", 
                    ",", "\"\<randQ\>\"", ",", "\"\<vmod\>\"", ",", 
                    "\"\<vormod\>\"", ",", "\"\<streQ\>\""}], "}"}]}], "]"}], 
                    "==", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"savela", "[", 
                    RowBox[{"[", 
                    RowBox[{"runi", "-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<n\>\"", ",", "\"\<nx\>\"", ",", "\"\<ny\>\"", ",", 
                    "\"\<seed\>\"", ",", "\"\<mshn\>\"", ",", "\"\<msht\>\"", 
                    ",", "\"\<randQ\>\"", ",", "\"\<vmod\>\"", ",", 
                    "\"\<vormod\>\"", ",", "\"\<streQ\>\""}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", "==", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"savela", "[", 
                    RowBox[{"[", 
                    RowBox[{"runi", "-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<n\>\"", ",", "\"\<nx\>\"", ",", "\"\<ny\>\"", ",", 
                    "\"\<seed\>\"", ",", "\"\<mshn\>\""}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\"", 
                    ",", "\"\<False\>\""}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"skipmeshQ", "=", "True"}], ";", 
                    RowBox[{"skipmatricesQ", "=", "True"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"skipmeshQ", "=", "False"}], ";", 
                    RowBox[{"skipmatricesQ", "=", "False"}]}]}], 
                   "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{
                   RowBox[{"skipmeshQ", "=", "False"}], ";", 
                   RowBox[{"skipmatricesQ", "=", "False"}]}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"RunFn", "[", 
                 RowBox[{"savel", "[", 
                  RowBox[{"[", "runi", "]"}], "]"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"outl", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"outl", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"animQ", ",", "out", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"statsl", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"statsl", ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"statsQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Row", "[", "#", "]"}], "}"}], "&"}], "/@", 
                    RowBox[{"Partition", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"plottimeQ", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListAnimate", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ControlPlacement", "\[Rule]", "Top"}], ",", 
                    RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
                    RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}], 
                    "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", "plotsl"}], ")"}]}], ",", 
                    RowBox[{"Flatten", "@", "plots"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"UpTo", "[", "2", "]"}]}], "]"}]}], "]"}], ",", 
                    "\"\<\>\""}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"runi", "<", 
                   RowBox[{"Length", "@", "savel"}]}], ",", 
                  RowBox[{
                   RowBox[{"ik2", "++"}], ";", 
                   RowBox[{"check", "=", "0"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"runi", ",", "1", ",", 
                 RowBox[{"Length", "@", "savel"}]}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"run", "=", "0.9"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "\[Equal]", "1.5"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ik", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"outl", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"statsl", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"quiet", "@", 
                 RowBox[{"SimFn", "[", 
                  RowBox[{
                  "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", 
                   "mshn", ",", "lliter", ",", "randQ", ",", "seed", ",", 
                   "fitQ", ",", "sorc", ",", "plotperQ", ",", "plotcoeffvQ", 
                   ",", "plotSOPnQ", ",", "plotSOPdQ", ",", "plotsolQ", ",", 
                   "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", ",", 
                   "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", 
                   "vormod", ",", "smod", ",", 
                   StyleBox["ka", "Input"], 
                   StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", 
                   ",", "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", 
                   "d\[Kappa]", ",", "diamx", ",", "depQ", ",", 
                   StyleBox["ka2", "Input"], 
                   StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", 
                   ",", "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
                   StyleBox["ka3", "Input"], 
                   StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", 
                   ",", "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", 
                   "treshT1", ",", "treshT2", ",", "n", ",", "nx", ",", "ny", 
                   ",", "dmx", ",", "dmy", ",", "Tvf", ",", "Tsimf", ",", 
                   "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", "ss1",
                    ",", "streQ", ",", "stet", ",", "arfixQ", ",", "stretNQ", 
                   ",", "stretN", ",", "Trele", ",", "Thold", ",", "sigallQ", 
                   ",", "stetbQ", ",", "bthk", ",", "Tstei", ",", "Tstef", 
                   ",", "fareaQ", ",", "fperQ", ",", "fltensQ", ",", 
                   "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", "mu", ",", 
                   "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", 
                   "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", 
                   ",", "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", 
                   "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", "cisQ", 
                   ",", "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", 
                   "nv", ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", 
                   "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",", 
                   "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", 
                   "\[Epsilon]", ",", "cellQ", ",", "longt", ",", "cutcQ", 
                   ",", "grQ", ",", "grt", ",", "grT", ",", "colo1", ",", 
                   "colom", ",", "colob", ",", "mbmt", ",", "rmb"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ik", "<", "msimn"}], ",", 
                  RowBox[{
                   RowBox[{"ik", "++"}], ";", 
                   RowBox[{"check", "=", "0"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "msimn"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"outl", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"outl", ",", 
                RowBox[{"If", "[", 
                 RowBox[{"animQ", ",", "out", ",", 
                  RowBox[{"out", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"statsl", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"statsl", ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"statsQ", ",", "\[IndentingNewLine]", 
                  RowBox[{"Grid", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Row", "[", "#", "]"}], "}"}], "&"}], "/@", 
                    RowBox[{"Partition", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"plottimeQ", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListAnimate", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ControlPlacement", "\[Rule]", "Top"}], ",", 
                    RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
                    RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}], 
                    "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", "plotsl"}], ")"}]}], ",", 
                    RowBox[{"Flatten", "@", "plots"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"UpTo", "[", "2", "]"}]}], "]"}]}], "]"}], ",", 
                  "\"\<\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"run", "=", "0.9"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "\[Equal]", "0.9"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"frame", "=", "logowait2"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"frameout", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"allplotsQ", "||", 
                 RowBox[{"!", "modrunQ"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"outl", ",", "statsl"}], "}"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Last", "@", "outl"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Last", "@", "statsl"}], "}"}]}], "}"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"run", "=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "==", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"frame", "=", "frameout"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"alaQ", ",", 
               RowBox[{
                RowBox[{"alarm", "=", 
                 RowBox[{"Audio", "[", 
                  RowBox[{"FileNameJoin", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<Extras\>\"", ",", "\"\<Radio\>\"", ",", 
                    "\"\<waltz.mp3\>\""}], "}"}], "]"}], "]"}]}], ";", 
                RowBox[{"AudioPlay", "@", "alarm"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tt1", "=", 
              RowBox[{
               RowBox[{"SessionTime", "[", "]"}], "-", "tt0"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"run", "==", "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{"frame", "=", "logowait3"}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "==", "2"}], ",", 
            RowBox[{"frame", "=", 
             RowBox[{"about", "[", "run", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "==", "2.1"}], ",", 
            RowBox[{"frame", "=", "biblio"}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "==", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"frame", "=", "bug"}], ",", "\[IndentingNewLine]", 
            RowBox[{"run", "==", "4"}], ",", 
            RowBox[{"frame", "=", "editor"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"run0", "=", "run"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", "frame"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CONTROL", " ", "GRID"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Column", "@", 
          RowBox[{"{", 
           RowBox[{"Column", "@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"cont", "[", 
              RowBox[{
              "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", 
               ",", "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", 
               "sorc", ",", "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", 
               ",", "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
               "plottimeQ", ",", "dlthresh", ",", "stats", ",", "allplotsQ", 
               ",", "allexpQ", ",", "msimn", ",", "sigm", ",", "sigr", ",", 
               "vmod", ",", "vormod", ",", "smod", ",", 
               StyleBox["ka", "Input"], 
               StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
               "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
               "diamx", ",", "depQ", ",", 
               StyleBox["ka2", "Input"], 
               StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",",
                "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
               StyleBox["ka3", "Input"], 
               StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",",
                "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",",
                "treshT2", ",", 
               RowBox[{
                StyleBox["(*", "Input"], 
                RowBox[{
                "gam", ",", "P0", ",", "\[Eta]", ",", "\[CapitalLambda]", 
                 ","}], "*)"}], "n", ",", "nx", ",", "ny", ",", "dmx", ",", 
               "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",",
                "Tsim2", ",", "sigs", ",", "ss1", ",", "streQ", ",", "stet", 
               ",", "arfixQ", ",", "stretNQ", ",", "stretN", ",", "Trele", 
               ",", "Thold", ",", "sigallQ", ",", "stetbQ", ",", "bthk", ",", 
               "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", ",", 
               "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",",
                "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", ",", 
               "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",",
                "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", 
               "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", "cisQ", ",", 
               "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", "run", 
               ",", "nv", ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", 
               "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",", "pbt", 
               ",", "pdt", ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", 
               "cellQ", ",", "longt", ",", 
               RowBox[{"(*", "openers", "*)"}], "opg", ",", "opv", ",", "ops",
                ",", "opo", ",", "oposm", ",", "ovmod", ",", "ovormod", ",", 
               "oforce", ",", "ostre", ",", "oparam", ",", "oar", ",", 
               "otiss", ",", "osmod", ",", "cutcQ", ",", "grQ", ",", "grt", 
               ",", "grT", ",", "colo1", ",", "colom", ",", "colob", ",", 
               "mbmt", ",", "rmb", ",", "mexp", ",", "expsQ", ",", "imgse", 
               ",", "mops", ",", "animQ", ",", "cusnQ", ",", "nmp", ",", 
               "alaQ", ",", "quietQ", ",", "musicQ", ",", "plotsQ", ",", 
               "param1Q", ",", "param1", ",", "param1nr", ",", "param1min", 
               ",", "param1max", ",", "param1inc"}], "]"}], 
             "\[IndentingNewLine]", "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"run", ",", "0"}], "}"}], ",", 
           RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
          RowBox[{"{", "run", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Initialization", "\[RuleDelayed]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AudioPause", "[", "]"}], ";", 
            RowBox[{"run", "=", "0"}], ";", 
            RowBox[{"bugQ", "=", "False"}], ";", 
            RowBox[{"skipmeshQ", "=", "False"}], ";", 
            RowBox[{"skipmatricesQ", "=", "False"}], ";", 
            RowBox[{"imgs2", "=", 
             RowBox[{".8", "/", "2"}]}], 
            RowBox[{"(*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"plotlistQn", ">", "0"}], ",", 
               RowBox[{".9", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"plotlistQn", ">", "3"}], ",", 
                  RowBox[{"1", "/", "3"}], ",", 
                  RowBox[{"1", "/", "plotlistQn"}]}], "]"}]}], ",", "1"}], 
              "]"}], "*)"}], ";", "\[IndentingNewLine]", 
            RowBox[{"sctn", "=", "3"}], ";", "\[IndentingNewLine]", 
            RowBox[{"todo", "=", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
                "\"\<iEpithelium - To Do.txt\>\""}], ",", "\"\<List\>\""}], 
              "]"}]}], ";", 
            RowBox[{"todoa", "=", 
             RowBox[{"todo", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"todo", ",", "\"\<Future features:\>\""}], "]"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ";;", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"todo", ",", "\"\<Known issues:\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "2"}]}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"todob", "=", 
             RowBox[{"todo", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"todo", ",", "\"\<Known issues:\>\""}], "]"}], "[", 
                 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ";;", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"todo", ",", "\"\<Remarks:\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "2"}]}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"todor", "=", 
             RowBox[{"todo", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"todo", ",", "\"\<Remarks:\>\""}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ";;", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"todo", ",", "\"\<Done:\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "2"}]}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"save", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{"savel", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{"svm", "=", "0"}], ";", 
            RowBox[{"svc", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", 
               ",", "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", 
               "sorc", ",", "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", 
               ",", "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
               "plottimeQ", ",", "dlthresh", ",", "stats", ",", "allplotsQ", 
               ",", "allexpQ", ",", "msimn", ",", "sigm", ",", "sigr", ",", 
               "vmod", ",", "vormod", ",", "smod", ",", 
               StyleBox["ka", "Input"], 
               StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", 
               "\[Eta]", ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", 
               "diamx", ",", "depQ", ",", 
               StyleBox["ka2", "Input"], 
               StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",",
                "a0e2", ",", "d\[Kappa]2", ",", "diamx2", ",", 
               StyleBox["ka3", "Input"], 
               StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",",
                "a0e3", ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",",
                "treshT2", ",", "n", ",", "nx", ",", "ny", ",", "dmx", ",", 
               "dmy", ",", "Tvf", ",", "Tsimf", ",", "Tmax", ",", "Tsim", ",",
                "Tsim2", ",", "sigs", ",", "ss1", ",", "streQ", ",", "stet", 
               ",", "arfixQ", ",", "stretNQ", ",", "stretN", ",", "Trele", 
               ",", "Thold", ",", "sigallQ", ",", "stetbQ", ",", "bthk", ",", 
               "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", ",", 
               "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",",
                "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", ",", 
               "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",",
                "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", 
               "\[Kappa]RS", ",", "m", ",", "p", ",", "l", ",", "cisQ", ",", 
               "Tste", ",", "stefh", ",", "stefv", ",", "clmp", ",", "nv", 
               ",", "shpQ", ",", "protQ", ",", "inoiseQ", ",", "effvol", ",", 
               "dynpQ", ",", "uplQ", ",", "pfixQ", ",", "pbt", ",", "pdt", 
               ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", "cellQ", ",", 
               "longt", ",", "opg", ",", "opv", ",", "ops", ",", "opo", ",", 
               "oposm", ",", "ovmod", ",", "ovormod", ",", "oforce", ",", 
               "ostre", ",", "oparam", ",", "oar", ",", "otiss", ",", "osmod",
                ",", "cutcQ", ",", "grQ", ",", "grt", ",", "grT", ",", 
               "colo1", ",", "colom", ",", "colob", ",", "mbmt", ",", "rmb", 
               ",", "mexp", ",", "expsQ", ",", "imgse", ",", "mops", ",", 
               "animQ", ",", "cusnQ", ",", "nmp", ",", "alaQ", ",", "quietQ", 
               ",", "musicQ", ",", "plotsQ", ",", "param1Q", ",", 
               "param1nr"}], "}"}], "=", "ivar"}]}], "\[IndentingNewLine]", 
           ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ContinuousAction", "->", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
         RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
         RowBox[{"ContentSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Full", ",", 
            RowBox[{"UpTo", "[", "740", "]"}]}], "}"}]}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"run", "==", "0"}], ",", "Center", ",", 
             RowBox[{"{", 
              RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameMargins", "\[Rule]", "30"}], ",", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"Lighter", "[", 
         RowBox[{"col1", ",", "0.95"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"DynamicEvaluationTimeout", "\[Rule]", "500"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.8326722359654927`*^9, 3.832672236096553*^9}, {
   3.8326722816251345`*^9, 3.832672376491384*^9}, {3.832672410990156*^9, 
   3.832672474054536*^9}, {3.832672516314581*^9, 3.832672517749749*^9}, {
   3.8326725521170645`*^9, 3.832672561951583*^9}, {3.8326726715675764`*^9, 
   3.832672673601156*^9}, {3.8326727572347345`*^9, 3.8326727829756775`*^9}, {
   3.8326728179517727`*^9, 3.8326728197467113`*^9}, {3.832673113020619*^9, 
   3.8326731270544577`*^9}, {3.832673240753957*^9, 3.832673247858282*^9}, {
   3.83267331133609*^9, 3.8326733578256383`*^9}, {3.8326734539288187`*^9, 
   3.8326734539688673`*^9}, {3.832673586197505*^9, 3.832673610973406*^9}, {
   3.832673702914014*^9, 3.8326737279087625`*^9}, 3.832673978069395*^9, {
   3.8326742101513395`*^9, 3.832674210757919*^9}, {3.8326742632530274`*^9, 
   3.83267426377254*^9}, {3.832676033029853*^9, 3.8326760637469344`*^9}, {
   3.8326761083840213`*^9, 3.83267611086074*^9}, {3.8326761533572006`*^9, 
   3.832676231812673*^9}, {3.832676911094202*^9, 3.8326769409130535`*^9}, {
   3.832676974433792*^9, 3.8326769870408287`*^9}, {3.832677070926051*^9, 
   3.8326770752551937`*^9}, {3.8326773183130026`*^9, 3.832677321570853*^9}, {
   3.8326774949067187`*^9, 3.832677666612172*^9}, {3.83344504274829*^9, 
   3.833445047158716*^9}, {3.833445337137467*^9, 3.8334453868896723`*^9}, {
   3.833445679207599*^9, 3.8334457001331177`*^9}, {3.833445736573433*^9, 
   3.833445754151382*^9}, {3.8334459187911425`*^9, 3.8334459238750854`*^9}, {
   3.8335247522079525`*^9, 3.833524794495764*^9}, {3.833525295560134*^9, 
   3.8335252960381413`*^9}, {3.8335256561234903`*^9, 3.833525660301428*^9}, {
   3.8335265507077904`*^9, 3.8335265510497613`*^9}, {3.833526586598359*^9, 
   3.83352658669244*^9}, {3.833526648744954*^9, 3.8335266940054317`*^9}, {
   3.833526724242669*^9, 3.8335267266015005`*^9}, {3.8335267643764706`*^9, 
   3.833526827712735*^9}, {3.8335268627645674`*^9, 3.8335269128014708`*^9}, {
   3.8335270103930845`*^9, 3.833527020897051*^9}, {3.833527090007012*^9, 
   3.833527111207199*^9}, {3.8335272898536386`*^9, 3.833527330970523*^9}, {
   3.8335310531189747`*^9, 3.8335310531790705`*^9}, {3.8335311261593113`*^9, 
   3.8335311539512405`*^9}, 3.833531195470235*^9, {3.8335313353284283`*^9, 
   3.8335314601890774`*^9}, {3.8335330494558315`*^9, 3.83353308496918*^9}, {
   3.8336131338530197`*^9, 3.8336131583582397`*^9}, {3.8336132378244834`*^9, 
   3.833613258549449*^9}, {3.8336139997235155`*^9, 3.8336140217981043`*^9}, {
   3.8336143476718416`*^9, 3.8336143506186047`*^9}, {3.8336144214718084`*^9, 
   3.8336144221125298`*^9}, {3.8336144799744625`*^9, 3.8336144930441055`*^9}, 
   3.8336145266337585`*^9, {3.8336146119468856`*^9, 3.8336146144260263`*^9}, {
   3.8336183974079823`*^9, 3.833618434338332*^9}, {3.8336202707599525`*^9, 
   3.833620280902859*^9}, {3.833620514182733*^9, 3.8336205170464077`*^9}, {
   3.833620648062953*^9, 3.8336206500883045`*^9}, {3.83362084005938*^9, 
   3.833620853261033*^9}, {3.833620970247249*^9, 3.8336209739437237`*^9}, {
   3.8336210337981462`*^9, 3.833621037497548*^9}, {3.8336211826294556`*^9, 
   3.833621183979083*^9}, {3.833621375259995*^9, 3.833621384256473*^9}, {
   3.833874006671728*^9, 3.8338740181105423`*^9}, {3.833874167378416*^9, 
   3.833874200527613*^9}, {3.8338833552292275`*^9, 3.833883386035427*^9}, {
   3.8338834719445505`*^9, 3.8338834726337337`*^9}, {3.833883503389578*^9, 
   3.833883641693149*^9}, {3.8338837267674494`*^9, 3.833883728965934*^9}, {
   3.8339613974870386`*^9, 3.833961440950631*^9}, {3.8339615565314183`*^9, 
   3.8339615794711137`*^9}, {3.833961826281064*^9, 3.833961830678501*^9}, {
   3.8339620138776283`*^9, 3.833962117704179*^9}, {3.8339621980335283`*^9, 
   3.8339622171639066`*^9}, {3.833962378589599*^9, 3.83396240200735*^9}, {
   3.8339672575251293`*^9, 3.8339672619443197`*^9}, 3.8339673896690083`*^9, {
   3.83396742462858*^9, 3.833967478693982*^9}, {3.83396757764747*^9, 
   3.833967579156392*^9}, {3.833967781060423*^9, 3.833967788012797*^9}, {
   3.833968156845645*^9, 3.8339681936665306`*^9}, {3.834047131054784*^9, 
   3.834047142354648*^9}, {3.834049445820958*^9, 3.8340494567134504`*^9}, {
   3.8340498961428843`*^9, 3.8340499086753345`*^9}, {3.834051616900465*^9, 
   3.8340516204756365`*^9}, {3.8340538279496145`*^9, 
   3.8340538427684546`*^9}, {3.834054446018192*^9, 3.834054453931486*^9}, {
   3.8340547310111494`*^9, 3.834054748662881*^9}, {3.8340550722892065`*^9, 
   3.834055102750798*^9}, {3.8340552058665113`*^9, 3.834055218275652*^9}, {
   3.8340552539528785`*^9, 3.834055257711804*^9}, {3.834055298843833*^9, 
   3.8340553016842995`*^9}, {3.834059923678258*^9, 3.8340599270754423`*^9}, {
   3.8340600939395084`*^9, 3.834060095137702*^9}, {3.8340610567343736`*^9, 
   3.8340610580426035`*^9}, 3.8340612158757286`*^9, {3.834061258284466*^9, 
   3.834061261729782*^9}, {3.8340628592792053`*^9, 3.834062860392991*^9}, {
   3.83406291700239*^9, 3.8340629194805036`*^9}, {3.8340629866134815`*^9, 
   3.8340629907120514`*^9}, 3.83406302447721*^9, {3.8340666723747063`*^9, 
   3.8340666785294914`*^9}, {3.834067402612579*^9, 3.8340674130507355`*^9}, {
   3.834068291625822*^9, 3.8340682924671993`*^9}, {3.8341464033550243`*^9, 
   3.834146411150982*^9}, {3.8342184272557793`*^9, 3.834218469147851*^9}, {
   3.834218600895796*^9, 3.834218619354108*^9}, {3.8342186816138945`*^9, 
   3.8342187314623795`*^9}, {3.834221885369212*^9, 3.8342218873000045`*^9}, {
   3.8342248308522596`*^9, 3.8342248773461857`*^9}, {3.8342286556838875`*^9, 
   3.8342286792850475`*^9}, {3.8342294436964173`*^9, 3.834229448475258*^9}, {
   3.8342301022359953`*^9, 3.8342301089919076`*^9}, {3.834230580258482*^9, 
   3.8342306723612566`*^9}, {3.8342317033254976`*^9, 
   3.8342317034123273`*^9}, {3.834232094814064*^9, 3.8342320999338784`*^9}, {
   3.834232494889439*^9, 3.834232495878792*^9}, {3.8342363154235506`*^9, 
   3.834236340641953*^9}, {3.8342364706061535`*^9, 3.834236518185048*^9}, {
   3.834236554571235*^9, 3.8342365860054383`*^9}, {3.8342366360632877`*^9, 
   3.8342366545820456`*^9}, {3.8342367136490855`*^9, 
   3.8342367965079465`*^9}, {3.8342369567258506`*^9, 
   3.8342369574412713`*^9}, {3.8342370989429054`*^9, 
   3.8342371393282957`*^9}, {3.8342371887756424`*^9, 
   3.8342372140756407`*^9}, {3.834237269124076*^9, 3.8342372793912754`*^9}, {
   3.8342373219528885`*^9, 3.8342373824197297`*^9}, {3.8342374184475813`*^9, 
   3.834237430072015*^9}, {3.834494600273794*^9, 3.834494611035756*^9}, {
   3.8344948200227795`*^9, 3.8344948331387157`*^9}, {3.8344948806933627`*^9, 
   3.8344948812262077`*^9}, {3.834495763027186*^9, 3.8344957643544292`*^9}, {
   3.8344977283111806`*^9, 3.8344977335143147`*^9}, {3.83465685815757*^9, 
   3.834656858565118*^9}, {3.83465716285511*^9, 3.834657168622202*^9}, {
   3.834657208194105*^9, 3.834657244937115*^9}, {3.834664363348748*^9, 
   3.834664364169709*^9}, {3.8346665531613636`*^9, 3.834666556897055*^9}, {
   3.8346669521419897`*^9, 3.834666960512477*^9}, {3.834668401354558*^9, 
   3.834668413141923*^9}, {3.8346908095534444`*^9, 3.834690809636224*^9}, {
   3.834737103342347*^9, 3.834737135265911*^9}, {3.8347399224585075`*^9, 
   3.83473994865633*^9}, {3.834740220989445*^9, 3.8347402217434072`*^9}, {
   3.8347406751924734`*^9, 3.834740676629629*^9}, {3.8347410038249135`*^9, 
   3.834741009518259*^9}, {3.834741882131504*^9, 3.8347419284959*^9}, {
   3.8347419757177486`*^9, 3.834741995168745*^9}, {3.8347420691235723`*^9, 
   3.834742072076621*^9}, {3.8347427080780177`*^9, 3.8347427169530373`*^9}, {
   3.834743857800823*^9, 3.8347438643234015`*^9}, {3.834745037753654*^9, 
   3.83474505652391*^9}, {3.8347461713280845`*^9, 3.83474617837356*^9}, {
   3.8347464502250004`*^9, 3.8347464732996364`*^9}, {3.83474652451889*^9, 
   3.83474654133243*^9}, {3.8347465849889317`*^9, 3.834746616499452*^9}, {
   3.834746690625058*^9, 3.8347467210791316`*^9}, {3.8347467998774185`*^9, 
   3.8347468041143646`*^9}, {3.8347507013746915`*^9, 3.834750728945853*^9}, {
   3.8347507868158894`*^9, 3.834750799841153*^9}, {3.8347508496599216`*^9, 
   3.8347508504730463`*^9}, {3.8347509093585253`*^9, 3.834750961537582*^9}, {
   3.8347509986663895`*^9, 3.83475100284711*^9}, 3.834751548204647*^9, {
   3.8350953032586794`*^9, 3.835095307255559*^9}, {3.835101780735449*^9, 
   3.8351018201811914`*^9}, {3.8351019883125772`*^9, 3.835102007370844*^9}, {
   3.8351039656294365`*^9, 3.8351040344282813`*^9}, {3.835104132185881*^9, 
   3.835104135397481*^9}, {3.835104291373666*^9, 3.835104293968385*^9}, {
   3.835201403961882*^9, 3.8352014352534304`*^9}, {3.835201484881922*^9, 
   3.8352014853247375`*^9}, {3.835201531774272*^9, 3.835201535833778*^9}, {
   3.835201600081744*^9, 3.8352016006741605`*^9}, {3.835201730641097*^9, 
   3.835201731621766*^9}, 3.8352017890587215`*^9, {3.835262828567997*^9, 
   3.8352629570355825`*^9}, {3.83526321528244*^9, 3.8352632171026697`*^9}, {
   3.8352632657661457`*^9, 3.835263282304573*^9}, {3.8352689963124027`*^9, 
   3.835268997149191*^9}, {3.835270921041377*^9, 3.8352709292066913`*^9}, {
   3.8352714444044485`*^9, 3.835271462969028*^9}, {3.835280326156662*^9, 
   3.835280374508421*^9}, {3.8352806162190027`*^9, 3.83528061628682*^9}, {
   3.835280946305557*^9, 3.8352809986703863`*^9}, {3.8352811404781575`*^9, 
   3.835281188576271*^9}, 3.835281330371524*^9, {3.8352813685333014`*^9, 
   3.8352813863301973`*^9}, {3.8352814539372225`*^9, 3.835281496677084*^9}, {
   3.8352815339340353`*^9, 3.835281534205332*^9}, {3.835284060272703*^9, 
   3.835284074827667*^9}, {3.8352843426561527`*^9, 3.835284349760453*^9}, {
   3.835285873551711*^9, 3.8352858807776175`*^9}, {3.8353568790937815`*^9, 
   3.8353568796888847`*^9}, {3.83535960261375*^9, 3.835359604254733*^9}, {
   3.835359717140786*^9, 3.8353597171487656`*^9}, {3.8354310010164433`*^9, 
   3.8354310086549344`*^9}, {3.835449751325797*^9, 3.835449761122559*^9}, {
   3.8354498672432466`*^9, 3.8354498772659264`*^9}, {3.8354637092043233`*^9, 
   3.8354637114862185`*^9}, {3.8356935765451317`*^9, 
   3.8356935959864683`*^9}, {3.8356982065396605`*^9, 3.835698213587605*^9}, {
   3.835698297323826*^9, 3.835698299427683*^9}, {3.8356985644445815`*^9, 
   3.8356985671324043`*^9}, {3.8357001370495553`*^9, 3.835700137583129*^9}, {
   3.835706119960645*^9, 3.835706131508849*^9}, 3.8357062141823826`*^9, {
   3.835714678686908*^9, 3.835714734694871*^9}, {3.8357149106161113`*^9, 
   3.835714910856475*^9}, {3.835891229633459*^9, 3.8358912341927032`*^9}, {
   3.836292333941287*^9, 3.8362923361813154`*^9}, {3.836294062489623*^9, 
   3.836294071161105*^9}, {3.836294143547551*^9, 3.836294143695319*^9}, {
   3.836295256711974*^9, 3.836295259959584*^9}, {3.836295685409334*^9, 
   3.836295742106413*^9}, {3.8362966604504995`*^9, 3.836296681029503*^9}, {
   3.8362967209536705`*^9, 3.8362968239971375`*^9}, {3.8362968771992664`*^9, 
   3.836296878317069*^9}, {3.8362969125926437`*^9, 3.8362969562425337`*^9}, {
   3.836297048335354*^9, 3.836297101960676*^9}, {3.836297458723564*^9, 
   3.836297583208047*^9}, {3.83629761698118*^9, 3.836297638946664*^9}, {
   3.8362976961030197`*^9, 3.836297710717239*^9}, {3.8362978026657968`*^9, 
   3.8362979413647766`*^9}, {3.836299910657748*^9, 3.8362999128880005`*^9}, {
   3.8363029590230074`*^9, 3.8363029603848553`*^9}, {3.8363042977455792`*^9, 
   3.836304299232407*^9}, {3.8363106665070434`*^9, 3.836310666765521*^9}, {
   3.836311225913189*^9, 3.8363112325803504`*^9}, {3.836316183255927*^9, 
   3.8363162121828384`*^9}, {3.8363240254033775`*^9, 3.836324068335004*^9}, {
   3.836370797051374*^9, 3.8363707989447007`*^9}, {3.8363711069324675`*^9, 
   3.836371109299135*^9}, {3.836371303261774*^9, 3.83637130597046*^9}, {
   3.8363713899065647`*^9, 3.8363714446352634`*^9}, {3.836371726260053*^9, 
   3.8363717288193445`*^9}, {3.8363718853267136`*^9, 3.836371890354376*^9}, {
   3.836380139607336*^9, 3.8363801419510965`*^9}, {3.836381856923887*^9, 
   3.8363818718387957`*^9}, 3.836381907225073*^9, {3.8365007541182737`*^9, 
   3.8365007655971947`*^9}, {3.8365655048495893`*^9, 3.8365655072953053`*^9}, 
   3.836649451941863*^9, {3.836650248006462*^9, 3.836650249826882*^9}, {
   3.836651011725564*^9, 3.8366510197193623`*^9}, {3.8366516496880493`*^9, 
   3.8366516524427786`*^9}, {3.8366546895839653`*^9, 
   3.8366546908567266`*^9}, {3.8366547272915916`*^9, 3.83665472841243*^9}, {
   3.83665891181693*^9, 3.836658913302924*^9}, {3.836658958108783*^9, 
   3.836658959518361*^9}, {3.836659571486484*^9, 3.8366595735343885`*^9}, {
   3.8366600601942697`*^9, 3.8366600672361345`*^9}, {3.8366601171369147`*^9, 
   3.836660117199747*^9}, {3.836660187612438*^9, 3.8366601890366297`*^9}, {
   3.836660254374773*^9, 3.8366602556705637`*^9}, {3.836660316219283*^9, 
   3.836660316355917*^9}, {3.836660379446097*^9, 3.8366603804095206`*^9}, {
   3.836909386721498*^9, 3.8369093933204308`*^9}, {3.8369879224536767`*^9, 
   3.836987952907975*^9}, {3.83698840606938*^9, 3.836988413970253*^9}, {
   3.8369981986200604`*^9, 3.8369982029142475`*^9}, 3.8370013399073415`*^9, {
   3.8370014137619004`*^9, 3.8370014159561005`*^9}, {3.837001470430374*^9, 
   3.837001476503995*^9}, {3.8370015122835097`*^9, 3.8370015168973646`*^9}, {
   3.837001597588484*^9, 3.8370017237357073`*^9}, {3.8370017854089966`*^9, 
   3.837001796988925*^9}, {3.8370020432895203`*^9, 3.8370020479098716`*^9}, {
   3.837002176596266*^9, 3.8370021794369*^9}, {3.8370033912871094`*^9, 
   3.837003394974183*^9}, {3.8370034309189773`*^9, 3.8370034495187435`*^9}, {
   3.8370034973726854`*^9, 3.837003504957774*^9}, 3.8370035942794027`*^9, {
   3.8370037836563683`*^9, 3.83700381267985*^9}, 3.8370039202455664`*^9, {
   3.837004028413884*^9, 3.8370040295454717`*^9}, {3.8370040851841984`*^9, 
   3.8370040857702065`*^9}, {3.837004126772482*^9, 3.837004181457966*^9}, {
   3.8370042758211927`*^9, 3.8370042773502054`*^9}, {3.8370043237532325`*^9, 
   3.837004328955658*^9}, 3.8370044310901566`*^9, {3.837004567104702*^9, 
   3.8370045721944237`*^9}, {3.8370046261831665`*^9, 3.8370046294296837`*^9},
    {3.8370048017102046`*^9, 3.8370048129695263`*^9}, {3.837004884807478*^9, 
   3.8370049015811434`*^9}, 3.8370049526379995`*^9, {3.837004996161763*^9, 
   3.837005020527481*^9}, 3.83700535018224*^9, {3.8370053907326117`*^9, 
   3.8370053988378954`*^9}, {3.8370054338385296`*^9, 3.8370054488273*^9}, {
   3.8370057191135793`*^9, 3.837005719458681*^9}, {3.837005905281317*^9, 
   3.837005907266036*^9}, {3.83707643577439*^9, 3.8370764384219923`*^9}, {
   3.8370778831046515`*^9, 3.83707788695278*^9}, {3.8370779823989162`*^9, 
   3.8370779943459716`*^9}, {3.8370854239718456`*^9, 
   3.8370854332460465`*^9}, {3.8370855450602207`*^9, 3.83708556023105*^9}, {
   3.8370925998583746`*^9, 3.837092603848132*^9}, {3.8370927441164885`*^9, 
   3.8370927721511445`*^9}, {3.8370928861051235`*^9, 
   3.8370928869029903`*^9}, {3.8371134857440333`*^9, 
   3.8371134876054354`*^9}, {3.8371139737948866`*^9, 
   3.8371140081531568`*^9}, {3.8371140554683976`*^9, 3.8371140694488907`*^9}, 
   3.8371141401464815`*^9, {3.8371142877833643`*^9, 3.837114295589489*^9}, {
   3.837114743522433*^9, 3.8371147446503873`*^9}, {3.8371161493606567`*^9, 
   3.837116150375948*^9}, {3.8376227412060394`*^9, 3.837622743086009*^9}, {
   3.8376230905865655`*^9, 3.8376230919842143`*^9}, {3.83762447411053*^9, 
   3.837624475305049*^9}, {3.8376260663398886`*^9, 3.837626066466538*^9}, {
   3.83762612154348*^9, 3.837626155460724*^9}, {3.837626222199588*^9, 
   3.837626229751184*^9}, {3.837626359418455*^9, 3.8376263623689847`*^9}, {
   3.837628505688512*^9, 3.8376285705185013`*^9}, {3.837771069601818*^9, 
   3.837771083492379*^9}, {3.8377725292536583`*^9, 3.837772534910734*^9}, {
   3.8377751547151365`*^9, 3.837775154989621*^9}, 3.8377752028868866`*^9, {
   3.8377752447619*^9, 3.837775253274275*^9}, {3.837775365970992*^9, 
   3.8377753660388107`*^9}, {3.8377780809030633`*^9, 
   3.8377780810686674`*^9}, {3.838973051727108*^9, 3.83897305735096*^9}, {
   3.839062155521369*^9, 3.8390621558395185`*^9}, {3.839065115014462*^9, 
   3.8390651181760073`*^9}, {3.839489543221336*^9, 3.839489545652834*^9}, {
   3.839489991477765*^9, 3.8394900358918734`*^9}, {3.839585251020892*^9, 
   3.8395852563986397`*^9}, {3.8395864986183224`*^9, 
   3.8395865295263147`*^9}, {3.83958679100445*^9, 3.839586818107703*^9}, {
   3.839586863774122*^9, 3.8395868668589325`*^9}, {3.8395869126519012`*^9, 
   3.839586940887227*^9}, {3.839588302137855*^9, 3.8395883165859156`*^9}, {
   3.8396688197409773`*^9, 3.839668862822287*^9}, {3.839669601614832*^9, 
   3.8396696093753214`*^9}, {3.839669652906539*^9, 3.8396696573596287`*^9}, {
   3.839669746638794*^9, 3.8396697973598766`*^9}, {3.8396698397277255`*^9, 
   3.8396699229830804`*^9}, {3.8396702787140827`*^9, 3.839670287449571*^9}, {
   3.839671440740511*^9, 3.8396714550318565`*^9}, {3.8396720999234443`*^9, 
   3.8396721014254475`*^9}, {3.83967233094306*^9, 3.8396723720154595`*^9}, 
   3.839672568588954*^9, {3.8396729796180363`*^9, 3.8396730358687944`*^9}, {
   3.839673180241172*^9, 3.8396731812518034`*^9}, {3.839673758980586*^9, 
   3.8396737600611515`*^9}, {3.839674012043455*^9, 3.839674024659401*^9}, {
   3.839674081100211*^9, 3.8396740815659647`*^9}, {3.8396788770945635`*^9, 
   3.839678878588772*^9}, 3.8396789303173428`*^9, {3.839679360691738*^9, 
   3.8396793632718477`*^9}, {3.839680091132651*^9, 3.839680096035424*^9}, {
   3.839680275139324*^9, 3.839680285833934*^9}, {3.839746168294552*^9, 
   3.839746218122577*^9}, {3.8397465760497203`*^9, 3.8397465763967876`*^9}, {
   3.8397466286356764`*^9, 3.8397466289647956`*^9}, {3.8397478835486317`*^9, 
   3.839747951729143*^9}, {3.8397480112082767`*^9, 3.839748037632756*^9}, {
   3.839748138828802*^9, 3.839748138940505*^9}, {3.8397482752569547`*^9, 
   3.8397483103386984`*^9}, {3.839748371583746*^9, 3.839748488284795*^9}, {
   3.8397486844779854`*^9, 3.839748695937193*^9}, {3.839748921806794*^9, 
   3.8397489439768443`*^9}, {3.8397491636235127`*^9, 
   3.8397491732416286`*^9}, {3.839749595677553*^9, 3.839749597588456*^9}, {
   3.8397548848258*^9, 3.83975489083311*^9}, {3.8397580354054537`*^9, 
   3.839758038084289*^9}, {3.8397597994032784`*^9, 3.839759799517971*^9}, {
   3.839760427529371*^9, 3.8397604302554903`*^9}, {3.83976070378438*^9, 
   3.8397607119117756`*^9}, {3.839761395176698*^9, 3.839761420922449*^9}, {
   3.8399149293036575`*^9, 3.839914951371966*^9}, {3.840088352165188*^9, 
   3.8400883587015247`*^9}, {3.8400884176470375`*^9, 
   3.8400884321666403`*^9}, {3.8400886433126464`*^9, 3.840088644699052*^9}, {
   3.840089020625963*^9, 3.840089020635936*^9}, {3.8400891920815253`*^9, 
   3.840089200552907*^9}, {3.840089309141791*^9, 3.8400893091517324`*^9}, {
   3.840089459001373*^9, 3.8400894608255634`*^9}, {3.840090067255212*^9, 
   3.84009009246529*^9}, {3.8400907325593305`*^9, 3.8400907397287807`*^9}, {
   3.8400907788250504`*^9, 3.8400907789109592`*^9}, {3.8400926956090307`*^9, 
   3.8400927022313194`*^9}, {3.840095090261296*^9, 3.840095090271269*^9}, {
   3.8400977330956607`*^9, 3.8400977803060026`*^9}, {3.8400979035612774`*^9, 
   3.840097936028948*^9}, {3.8401017767168665`*^9, 3.8401017821644545`*^9}, {
   3.8401018586773415`*^9, 3.8401018715772223`*^9}, {3.840102339340913*^9, 
   3.8401023417615566`*^9}, {3.8401027410651255`*^9, 
   3.8401027531981087`*^9}, {3.8401113954741974`*^9, 3.840111399129407*^9}, {
   3.8401118975539455`*^9, 3.8401119077856493`*^9}, {3.8401747203855577`*^9, 
   3.840174720455389*^9}, {3.840184138658801*^9, 3.8401841391377354`*^9}, 
   3.8401877130879917`*^9, {3.8401879791996393`*^9, 3.840187983411701*^9}, {
   3.840523022830696*^9, 3.8405230448313913`*^9}, {3.8405231462785587`*^9, 
   3.840523155771841*^9}, {3.840523760543125*^9, 3.8405237608423247`*^9}, {
   3.8405237983432865`*^9, 3.8405237989436812`*^9}, {3.840523843287128*^9, 
   3.840523880495782*^9}, {3.8405243311819916`*^9, 3.840524331985166*^9}, {
   3.840524848344443*^9, 3.8405248484780846`*^9}, {3.840525343908933*^9, 
   3.840525346226241*^9}, {3.8405254314543395`*^9, 3.8405254637697906`*^9}, {
   3.8405256367591085`*^9, 3.840525650356358*^9}, {3.84052680719217*^9, 
   3.840526812529825*^9}, {3.8405270188005886`*^9, 3.8405270206088266`*^9}, {
   3.8405270755748*^9, 3.840527077311533*^9}, {3.8405272092323046`*^9, 
   3.84052725409173*^9}, {3.8405272992142534`*^9, 3.8405273001887197`*^9}, {
   3.840527461614716*^9, 3.8405274641811323`*^9}, {3.840527497839237*^9, 
   3.8405274996136427`*^9}, {3.8405275583621116`*^9, 3.840527558819887*^9}, {
   3.8405276066983724`*^9, 3.840527623344192*^9}, {3.8405280336688623`*^9, 
   3.84052805390379*^9}, {3.8405293555622625`*^9, 3.8405293567384205`*^9}, {
   3.8405309971830015`*^9, 3.8405310090307426`*^9}, {3.840531136224654*^9, 
   3.840531148336178*^9}, {3.840531226662648*^9, 3.840531228419798*^9}, {
   3.8405553705695686`*^9, 3.8405553720202255`*^9}, {3.8405609164063425`*^9, 
   3.8405609175257874`*^9}, {3.8406193698261375`*^9, 
   3.8406193739381447`*^9}, {3.840624696741973*^9, 3.84062470080482*^9}, {
   3.8416579070955563`*^9, 3.8416579288481703`*^9}, {3.841658314184442*^9, 
   3.841658320495661*^9}, {3.8416583838264465`*^9, 3.841658383881811*^9}, {
   3.8416584775613236`*^9, 3.8416584806043444`*^9}, {3.84166054541076*^9, 
   3.841660548710718*^9}, {3.8417305933972254`*^9, 3.841730593489003*^9}, 
   3.841739201129575*^9, {3.8417436145643797`*^9, 3.8417436171363015`*^9}, {
   3.8417437417729435`*^9, 3.8417437440556526`*^9}, {3.8417440535810757`*^9, 
   3.8417440841045256`*^9}, {3.8426017624392223`*^9, 
   3.8426017627593656`*^9}, {3.843291936085967*^9, 3.8432919484851675`*^9}, {
   3.8434694918824415`*^9, 3.843469493950427*^9}, {3.8434728872307673`*^9, 
   3.8434728973774834`*^9}, {3.8434730921683183`*^9, 3.843473093551652*^9}, {
   3.8438963254081173`*^9, 3.8438963254519997`*^9}, {3.8438964874642344`*^9, 
   3.8438964876577168`*^9}, {3.843913323997176*^9, 3.843913324768113*^9}, {
   3.843913508839537*^9, 3.843913510887488*^9}, {3.8439135592741995`*^9, 
   3.8439135593280554`*^9}, {3.843913614985461*^9, 3.843913678479607*^9}, {
   3.844769620043393*^9, 3.8447696255865717`*^9}, {3.8447703726192975`*^9, 
   3.844770373194759*^9}, {3.8447706667246857`*^9, 3.8447706685075684`*^9}, {
   3.844771720700038*^9, 3.844771722335664*^9}, {3.844775759681245*^9, 
   3.8447757597141595`*^9}, {3.8454657035253024`*^9, 
   3.8454657050961013`*^9}, {3.845465803597372*^9, 3.8454658066442237`*^9}, 
   3.8454725145974827`*^9, {3.8454728075010705`*^9, 3.845472813945368*^9}, {
   3.845636254695527*^9, 3.8456362573663826`*^9}, {3.8456386714977818`*^9, 
   3.845638673557288*^9}, {3.85081306818707*^9, 3.850813075909417*^9}, {
   3.8559041734384537`*^9, 3.855904177924754*^9}, {3.8559094330011015`*^9, 
   3.8559094370243764`*^9}, {3.856005286349978*^9, 3.856005293827984*^9}, {
   3.8560053603666697`*^9, 3.856005364390023*^9}, {3.8560054218094234`*^9, 
   3.8560054232954636`*^9}, {3.856005830518137*^9, 3.8560058340307436`*^9}, {
   3.856521910826022*^9, 3.856521910945702*^9}, {3.8570328056149645`*^9, 
   3.857032832196892*^9}, {3.857033329463807*^9, 3.85703333101466*^9}, {
   3.8570333707204638`*^9, 3.8570333724011717`*^9}, {3.8570334453150005`*^9, 
   3.8570334463064632`*^9}, {3.857047243800947*^9, 3.857047244625742*^9}, {
   3.8570474740610723`*^9, 3.857047487302787*^9}, {3.857047535554677*^9, 
   3.85704753821257*^9}, {3.85705021776285*^9, 3.857050219770481*^9}, {
   3.8576424835281544`*^9, 3.857642487716958*^9}, {3.862133743220891*^9, 
   3.862133743627803*^9}, {3.8647220002832985`*^9, 3.864722005747096*^9}, {
   3.8647223116129584`*^9, 3.8647223138045363`*^9}, {3.8652432637412076`*^9, 
   3.8652433017693453`*^9}, {3.865527082618902*^9, 3.8655270838018627`*^9}, {
   3.865533298830288*^9, 3.86553330663161*^9}, {3.8655338322037*^9, 
   3.8655338327382717`*^9}, {3.8655357319024134`*^9, 3.865535735940935*^9}, 
   3.8655359409314938`*^9, {3.865536023476745*^9, 3.8655360242456903`*^9}, {
   3.8655363462345815`*^9, 3.8655363465577173`*^9}, {3.8680162448817244`*^9, 
   3.868016245663771*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellTags->"codetag",
 CellLabel->
  "In[219]:=",ExpressionUUID->"60532982-4547-4e77-ba92-bd33ae4762f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Master function", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.805911326801117*^9, 3.8059113649177465`*^9}, {
   3.805912240465928*^9, 3.805912257297123*^9}, {3.805912396137786*^9, 
   3.805912399667384*^9}, {3.8062581649715147`*^9, 3.80625816741319*^9}, {
   3.808383751913423*^9, 3.8083837776550617`*^9}, 3.8213790745339174`*^9, {
   3.8217964322984643`*^9, 3.821796435016424*^9}, {3.8226269232559495`*^9, 
   3.822626932064167*^9}, {3.8237615322243347`*^9, 3.823761552191305*^9}, {
   3.833527170156079*^9, 3.8335271743764615`*^9}, {3.8338826936159997`*^9, 
   3.833882694258896*^9}, {3.8338833391990476`*^9, 3.833883340659916*^9}, {
   3.842726165997369*^9, 3.842726166463604*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"414922c6-ad60-46ec-9c2a-4fb995ee3e4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimFn", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "msht", ",", "perQ", ",", "persQ", ",", "lloydQ", ",", "mshn", ",", 
       "lliter", ",", "randQ", ",", "seed", ",", "fitQ", ",", "sorc", ",", 
       "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
       ",", "plotsolQ", ",", "plotSOPQ", ",", "plottimeQ", ",", "dlthresh", 
       ",", "msimn", ",", "sigm", ",", "sigr", ",", "vmod", ",", "vormod", 
       ",", "smod", ",", 
       StyleBox["ka", "Input"], 
       StyleBox[",", "Input"], "gamc", ",", "\[CapitalLambda]", ",", "\[Eta]",
        ",", "d\[Eta]", ",", "a0e", ",", "d\[Kappa]", ",", "diamx", ",", 
       "depQ", ",", 
       StyleBox["ka2", "Input"], 
       StyleBox[",", "Input"], "gamc2", ",", "\[CapitalLambda]2", ",", "a0e2",
        ",", "d\[Kappa]2", ",", "diamx2", ",", 
       StyleBox["ka3", "Input"], 
       StyleBox[",", "Input"], "gamc3", ",", "\[CapitalLambda]3", ",", "a0e3",
        ",", "d\[Kappa]3", ",", "diamx3", ",", "treshT1", ",", "treshT2", ",",
        "n", ",", "nx", ",", "ny", ",", "dmx", ",", "dmy", ",", "Tvf", ",", 
       "Tsimf", ",", "Tmax", ",", "Tsim", ",", "Tsim2", ",", "sigs", ",", 
       "ss1", ",", "streQ", ",", "stet", ",", "arfixQ", ",", "stretNQ", ",", 
       "stretN", ",", "Trele", ",", "Thold", ",", "sigallQ", ",", "stetbQ", 
       ",", "bthk", ",", "Tstei", ",", "Tstef", ",", "fareaQ", ",", "fperQ", 
       ",", "fltensQ", ",", "fhookeQ", ",", "rho", ",", "k", ",", "h", ",", 
       "mu", ",", "aN0", ",", "bN0", ",", "iniN", ",", "iniD", " ", ",", 
       "iniR", ",", "\[Beta]N", ",", "\[Beta]D", ",", "\[Beta]R", ",", 
       "\[Tau]", ",", "\[Kappa]t", ",", "\[Kappa]c", ",", "\[Kappa]RS", ",", 
       "m", ",", "p", ",", "l", ",", "cisQ", ",", "Tste", ",", "stefh", ",", 
       "stefv", ",", "clmp", ",", "nv", ",", "shpQ", ",", "protQ", ",", 
       "inoiseQ", ",", "effvol", ",", "dynpQ", ",", "uplQ", ",", "pfixQ", ",",
        "pbt", ",", "pdt", ",", "pll", ",", "pla", ",", "\[Epsilon]", ",", 
       "cellQ", ",", "longt", ",", "cutcQ", ",", "grQ", ",", "grt", ",", 
       "grT", ",", "colo1", ",", "colom", ",", "colob", ",", "mbmt", ",", 
       "rmb"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iii", "=", "0"}], ";", 
      RowBox[{"miii", "=", "0"}], ";", 
      RowBox[{"aiii", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RANDOM", " ", "SEED"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"randQ", ",", 
        RowBox[{"SeedRandom", "[", "]"}], ",", 
        RowBox[{"SeedRandom", "[", "seed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msht", "==", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"tssL", "=", 
         RowBox[{"tssL1", "=", 
          RowBox[{"tssL2", "=", 
           RowBox[{"N", "[", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"(", 
              RowBox[{"n", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dmx", "/", "dmy"}], ")"}], "/", "4"}]}], ")"}]}], 
            "]"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"msht", "==", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tssL", "=", 
          RowBox[{"N", "[", 
           RowBox[{"Sqrt", "@", 
            RowBox[{"(", 
             RowBox[{"n", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nx", "/", "ny"}], ")"}], "/", "4"}]}], ")"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tssL1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "4"}], ")"}], "nx"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tssL2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "4"}], ")"}], "ny"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"msht", "==", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{"tssL", "=", "1"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RUN", " ", 
        RowBox[{"STATS", " ", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"statsQ", "=", 
       RowBox[{"AnyTrue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", "plotSOPdQ", 
           ",", "plotsolQ", ",", "plotSOPQ"}], "}"}], ",", "TrueQ"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"plotsl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tssLt", "=", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"INITIAL", " ", "MESH"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"vmod", ",", 
        RowBox[{"lloydQv", "=", "True"}], ",", 
        RowBox[{"lloydQv", "=", "lloydQ"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"perQ", ",", "\[IndentingNewLine]", 
        RowBox[{"mesh0p", "[", 
         RowBox[{
         "n", ",", "nx", ",", "ny", ",", "msht", ",", "dmx", ",", "dmy", ",", 
          "randQ", ",", "seed", ",", "lloydQv", ",", "mshn", ",", "cutcQ", 
          ",", "lliter"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"mesh0", "[", 
         RowBox[{
         "n", ",", "nx", ",", "ny", ",", "msht", ",", "dmx", ",", "dmy", ",", 
          "randQ", ",", "seed", ",", "lloydQv", ",", "mshn", ",", "cutcQ", 
          ",", "lliter"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"steptsr", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steptsl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"FIXING", " ", "VALUES"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"protQ", ",", 
        RowBox[{"If", "[", 
         RowBox[{"dynpQ", ",", 
          RowBox[{"\[Epsilon]v", "=", 
           RowBox[{"N", "[", "\[Epsilon]", " ", 
            RowBox[{"(*", 
             RowBox[{"pbt", "/", 
              RowBox[{"(", 
               RowBox[{"pbt", "+", "pdt"}], ")"}]}], "*)"}], "]"}]}], ",", 
          RowBox[{"\[Epsilon]v", "=", 
           RowBox[{"N", "@", "\[Epsilon]"}]}]}], "]"}], ",", 
        RowBox[{"\[Epsilon]v", "=", "0."}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "INITIALISATION", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"inif", "[", 
       RowBox[{"sigm", ",", "sigr", ",", "sigs", ",", "perQ"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"divlist", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"remlist", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dinl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"din1l", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"din2l", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data0", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "TRACKER", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"iii0", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PrintTemporary", "[", 
           RowBox[{"\"\<Time remaining: \>\"", ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"Tmax", "+", "2", "-", "iii"}], "]"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"MULTIPLE", " ", "STRETCH"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"stet", "==", "2"}], ",", 
           RowBox[{"Tste", "=", "Tstei"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"stetil", "=", 
          RowBox[{"{", "Tste", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stetrl", "=", 
          RowBox[{"{", 
           RowBox[{"Tste", "+", "Thold"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{
            RowBox[{"i", "<=", 
             RowBox[{"stretN", "-", "1"}]}], "&&", "stretNQ"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"stetil", ",", 
              RowBox[{
               RowBox[{"Last", "[", "stetil", "]"}], "+", "Thold", "+", 
               "Trele"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stetrl", ",", 
              RowBox[{
               RowBox[{"Last", "[", "stetrl", "]"}], "+", "Thold", "+", 
               "Trele"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"MAIN", " ", "CYCLE"}], " ", "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"\[Eta]v", "=", 
          RowBox[{"10", "^", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"ti", "\[LessEqual]", 
            RowBox[{"Tmax", "*", "\[Eta]v"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Tsimi", "=", "Tsim"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "STRETCH", " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"stetil", ",", "stetrl"}], "]"}], ",", "iii"}], 
                "]"}], "&&", "streQ", "&&", 
               RowBox[{"stet", "==", "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"stetil", ",", "iii"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"stefhn", "=", "stefh"}], ";", 
                  RowBox[{"stefvn", "=", "stefv"}]}], ",", 
                 RowBox[{
                  RowBox[{"stefhn", "=", 
                   RowBox[{"1", "/", "stefh"}]}], ";", 
                  RowBox[{"stefvn", "=", 
                   RowBox[{"1", "/", "stefv"}]}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"indTopts", "=", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "indTopts", "]"}], "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stefhn", " ", "#1"}], ",", 
                    RowBox[{"stefvn", "#2"}]}], "}"}], "&"}], "@@@", 
                    RowBox[{"Values", "@", "indTopts"}]}], ")"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"ptsToInd", "=", 
                RowBox[{"AssociationMap", "[", 
                 RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"cellToPts", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
                 "cellToVertexG"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"areaPolygonAssoc", "=", 
                RowBox[{"areaPolygon", "/@", "cellToPts"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"diamPolygonAssoc", "=", 
                RowBox[{"diamPolygon", "/@", "cellToPts"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"periPolygonAssoc", "=", 
                RowBox[{"perimeterPolygon", "/@", "cellToPts"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"edges0", "=", 
                RowBox[{"DeleteDuplicatesBy", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}]}], "]"}], 
                    ",", "1"}], "]"}], ",", "Sort"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"edges0", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"edges0", ",", 
                  RowBox[{"Reverse", "/@", "edges0"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"sigr", "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"fitQ", "&&", 
                    RowBox[{"msht", "==", "2"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lsig1", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"Region", "@", 
                    RowBox[{"ParametricRegion", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fit", "[", 
                    RowBox[{"regccs1", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "x", ",", 
                    RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"regccs1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"regccs1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"lsig2", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"Region", "@", 
                    RowBox[{"ParametricRegion", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Fit", "[", 
                    RowBox[{"regccs2", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "x", ",", 
                    RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"regccs2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"regccs2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "}"}]}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lsig1", "=", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], "+", "rf"}], ",", 
                    RowBox[{
                    RowBox[{"-", "sigs"}], "-", "rfw"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sigx", "-", "rf"}], ",", 
                    RowBox[{"-", "sigs"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lsig2", "=", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], "+", "rf"}], ",", "sigs"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sigx", "-", "rf"}], ",", 
                    RowBox[{"sigs", "+", "rfw"}]}], "}"}]}], "]"}]}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"sigR", "=", 
                   RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"(", 
                    RowBox[{"RegionUnion", "[", 
                    RowBox[{"lsig1", ",", "lsig2"}], "]"}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sigr", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sigR", "=", 
                  RowBox[{"Rectangle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], " ", "stefhn"}], "-", "rf"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigy"}], " ", "stefvn"}], " ", "-", 
                    "rf"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sigx", " ", "stefhn"}], "+", "rf"}], ",", 
                    RowBox[{
                    RowBox[{"sigy", " ", "stefvn"}], "+", "rf"}]}], "}"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"sigr", "\[Equal]", "3"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sigR", "=", 
                  RowBox[{"Rectangle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigx"}], " ", "stefhn"}], "+", "rf"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "sigy"}], " ", "stefvn"}], "+", "rf"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sigx", " ", "stefhn"}], "-", "rf"}], ",", 
                    RowBox[{
                    RowBox[{"sigy", " ", "stefvn"}], "-", "rf"}]}], "}"}]}], 
                   "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ipts0", "=", 
                RowBox[{"Values", "[", "indTopts", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"minix", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"ipts0", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"maxix", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"ipts0", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"pclmp", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"ipts0", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "minix"}], "]"}], 
                    "<", "clmpw"}], "||", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "maxix"}], "]"}], 
                    "<", "clmpw"}]}], ")"}], "&"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"kclmp", "=", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"AssociationMap", "[", 
                   RowBox[{"Reverse", ",", "indTopts"}], "]"}], ",", 
                  "pclmp"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"REAL", " ", "STRETCH"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"iii", "\[Equal]", "1"}], "&&", "streQ", "&&", 
               RowBox[{"stet", "==", "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"xindp", "=", 
                RowBox[{
                 RowBox[{"Values", "[", "indTopts", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"yindp", "=", 
                RowBox[{
                 RowBox[{"Values", "[", "indTopts", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"steptsr", "=", 
                RowBox[{"Keys", "@", 
                 RowBox[{"Select", "[", 
                  RowBox[{"indTopts", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "@", "xindp"}], "-", "bthk"}], "<=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{"Max", "@", "xindp"}]}], ")"}], "&"}]}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"steptsl", "=", 
                RowBox[{"Keys", "@", 
                 RowBox[{"Select", "[", 
                  RowBox[{"indTopts", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "<=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "+", "bthk"}]}], ")"}], 
                    "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"recl", "=", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "-", ".1"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "@", "yindp"}], "-", ".1"}]}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "+", "bthk"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "@", "yindp"}], "+", ".1"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"recr", "=", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "@", "xindp"}], "-", "bthk"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "@", "yindp"}], "-", ".1"}]}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "@", "xindp"}], "+", ".1"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "@", "yindp"}], "+", ".1"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "BARS", " ", "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{"recll", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "-", ".1"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "@", "yindp"}], "-", ".1"}]}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "@", "xindp"}], "+", "bthk"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "@", "yindp"}], "+", ".1"}]}], "}"}]}], 
                 "}"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"recrl", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "@", "xindp"}], "-", "bthk"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "@", "yindp"}], "-", ".1"}]}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "@", "xindp"}], "+", ".1"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "@", "yindp"}], "+", ".1"}]}], "}"}]}], 
                 "}"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"xr1", "=", 
                RowBox[{"recrl", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"xr2", "=", 
                RowBox[{"recrl", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"yr1", "=", 
                RowBox[{"recrl", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"yr2", "=", 
                RowBox[{"recrl", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"xl1", "=", 
                RowBox[{"recll", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"xl2", "=", 
                RowBox[{"recll", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"yl1", "=", 
                RowBox[{"recll", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"yl2", "=", 
                RowBox[{"recll", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ht", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"stefh", "*", "xr2"}], "-", "xr2"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"Tstef", "-", "Tstei"}], ")"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rects", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xl1", "-", 
                    RowBox[{"j", "*", "ht"}]}], ",", "yl1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xl2", "-", 
                    RowBox[{"j", "*", "ht"}]}], ",", "yl2"}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xr1", "+", 
                    RowBox[{"j", "*", "ht"}]}], ",", "yr1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xr2", "+", 
                    RowBox[{"j", "*", "ht"}]}], ",", "yr2"}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Tstef", "-", "Tstei"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"recs0", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{"Sequence", "@@", "recll"}], "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{"Sequence", "@@", "recrl"}], "]"}]}], "}"}], ",", 
                    
                    RowBox[{"Tstei", "+", "1"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", "rects", ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xl1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei"}], ")"}], "*", "ht"}]}], 
                    ",", "yl1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xl2", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei"}], ")"}], "*", "ht"}]}], 
                    ",", "yl2"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xr1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei"}], ")"}], "*", "ht"}]}], 
                    ",", "yr1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xr2", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei"}], ")"}], "*", "ht"}]}], 
                    ",", "yr2"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Tmax", ">=", "Tstef"}], ",", 
                    RowBox[{"Tmax", "-", "Tstef"}], ",", "0"}], "]"}]}], 
                   "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"recs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.92", ",", "0.71", ",", "0."}], "]"}], ",", 
                    RowBox[{"Thickness", "[", ".005", "]"}]}], "}"}], "]"}], 
                    ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.92", ",", "0.71", ",", "0.", ",", "0.2"}], 
                    "]"}], ",", "#"}], "}"}], "]"}], "&"}], "/@", "recs0"}]}],
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"cj", "=", 
             RowBox[{"Round", "[", 
              RowBox[{"ti", "/", "\[Eta]v"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"PRE", "-", "SIGNALLING"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Tsimi", "\[LessEqual]", "iii", "<=", "Tsim"}], "&&", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"iii", ",", "sv"}], "]"}], "\[Equal]", "0"}], "&&", 
               "smod"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"plist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"plist", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"Polygon", ",", "cellToPts"}], "]"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"pcells", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"pcells", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", "rmb", "]"}], "==", "0."}], ",", 
                    RowBox[{"Last", "[", "plist", "]"}], ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "->", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"roundm", "[", 
                    RowBox[{"#", ",", "rmb", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], "&"}], ",", 
                    RowBox[{"Values", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"lv", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"lv", ",", 
                  RowBox[{"First", "/@", 
                   RowBox[{
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], "]"}], "@", 
                    "cellToPts"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sigm", "\[Equal]", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"solnsl", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"initln0", ",", "initld0"}], "}"}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"sigm", "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"solnsl", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"initln0", ",", "initld0", ",", "initlr0"}], 
                    "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"solnsl", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"initlne0", ",", "initlde0", ",", "initlr0"}], 
                    "}"}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"SIGNAL", " ", "INITIALISATION"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"iii", "\[Equal]", "Tsim"}], "&&", "smod"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"lvt", "=", 
                RowBox[{"Last", "[", "lv", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"lvs", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}], ",",
                     "sigR"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sigr", "\[Equal]", "1"}], "&&", 
                    RowBox[{"!", "vmod"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"lvs1", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}], ",",
                     "lsig1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"lvs2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionDimension", "[", 
                    RowBox[{"RegionIntersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", "j", "]"}], ",",
                     "lsig2"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "Infinity"}]}], ",", "un", ",", "j"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "}"}]}], "]"}]}], 
                    ";"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"lvs1", "=", 
                    RowBox[{"lvs2", "=", 
                    RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
                 ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"plistn", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"plistn", ",", 
                  RowBox[{"KeyTake", "[", 
                   RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], ",", "lvs"}], 
                   "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"val0", "=", 
                RowBox[{"RandomColor", "[", 
                 RowBox[{"Length", "[", "lvs", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"initlne0", "=", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "iniN"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"initlde0", "=", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "iniD"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"protl", "=", 
                RowBox[{"pll", " ", 
                 RowBox[{"Mean", "@", 
                  RowBox[{"protlf", "[", 
                   RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "longt"}], 
                   "]"}]}]}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"protll", "=", "\[IndentingNewLine]", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{"lvs", "->", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"cellQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"pll", " ", 
                    RowBox[{"protlf", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "longt"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"protl", ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "]"}]}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"SKIP", " ", "MATRICES", " ", "OPTION"}], " ", "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "skipmatricesQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"matFn", "[", 
                   RowBox[{"lv", ",", "lvs", ",", 
                    RowBox[{"Last", "@", "plistn"}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"check", "++"}], ";", "\[IndentingNewLine]", 
               RowBox[{"asslJ", "=", 
                RowBox[{"ArrayReshape", "[", 
                 RowBox[{
                  RowBox[{"Values", "@", "asslJp"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Length", "@", "lvs"}], ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"asslL", "=", 
                RowBox[{"ArrayReshape", "[", 
                 RowBox[{
                  RowBox[{"Values", "@", "asslLp"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Length", "@", "lvs"}], ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"assl", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], "asslJ"}], "+", 
                 RowBox[{"\[Epsilon]v", " ", "asslL"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"agll", "=", 
                RowBox[{"{", "assl", "}"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"mat", "=", 
                RowBox[{"Last", "[", "agll", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mata", "=", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{"lvs", "\[Rule]", "mat"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"val", "=", 
                RowBox[{"{", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"lvs", "\[Rule]", "val0"}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"DYNAMIC", " ", "PROTRUSIONS"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"dynpQ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"asslp", "=", 
                   RowBox[{"Merge", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"asslJp", ",", "asslLp"}], "}"}], ",", "Total"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"allpairs", "=", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"asslp", "=", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"asslp", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "->", " ", "1"}], " ", "&"}], " ", "/@", 
                    RowBox[{"Complement", "[", 
                    RowBox[{"allpairs", ",", "gltp"}], "]"}]}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"fill", "=", 
                   RowBox[{"RandomInteger", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"Length", "@", "gltp"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"agpp", "=", 
                   RowBox[{"{", 
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"asslp", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"gltp", "->", "fill"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}], "}"}]}]}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"agpp", "=", 
                  RowBox[{"{", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}], "}"}]}]}], 
                "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"INITIAL", " ", "VALUES", " ", "ASSOCIATIONS"}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"initln", "=", 
                RowBox[{"{", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"lvs", "\[Rule]", "initln0"}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initld", "=", 
                RowBox[{"{", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"lvs", "\[Rule]", "initld0"}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initlr", "=", 
                RowBox[{"{", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"lvs", "\[Rule]", "initlr0"}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initlnn", "=", 
                RowBox[{"{", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Last", "[", "initln", "]"}], "[", "j", "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initldd", "=", 
                RowBox[{"{", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Last", "[", "initld", "]"}], "[", "j", "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initlrr", "=", 
                RowBox[{"{", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Last", "[", "initlr", "]"}], "[", "j", "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], "}"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"initlne", "=", 
                   RowBox[{"{", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", "initlne0"}], "]"}], "}"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"initlde", "=", 
                   RowBox[{"{", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", "initlde0"}], "]"}], "}"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"initlnne", "=", 
                   RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initlne", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"initldde", "=", 
                   RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initlde", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], "}"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"WHITE", " ", "NOISE"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"wn", "=", 
                RowBox[{"WhiteNoiseProcess", "[", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"wnoi", "=", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"RandomFunction", "[", 
                    RowBox[{"wn", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Tmax"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "}"}]}], "]"}], "]"}]}],
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "SIGNALLING", " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Tsim", "<", "iii"}], "&&", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"iii", ",", "sv"}], "]"}], "\[Equal]", "0"}], "&&", 
               "smod"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"iii", "\[LessEqual]", "Tsimf"}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"SIGNAL", " ", "NOISE"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"noi", ",", "\[IndentingNewLine]", 
                   RowBox[{"noif", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Fp", ",", "Fm"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Surd", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Fp", "+", 
                    RowBox[{"Abs", "[", "Fm", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "nV"}], ")"}]}], ",", "2"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"noif", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Fp", ",", "Fm"}], "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "lvs", "]"}]}], "]"}]}], "]"}]}]}],
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"sigm", "==", "0"}], ",", 
                   RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"10", "^", "aN0"}]}], ";", 
                    RowBox[{"b", "=", 
                    RowBox[{"10", "^", "bN0"}]}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"ODE", " ", "SOLVING"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"solns", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                   "solns", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "Which", "[", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"sigm", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NDSolveValue", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"not", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{"ss1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}], "^", "k"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"a", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}], "^", "k"}]}], 
                    ")"}]}], ")"}], "-", 
                    RowBox[{"not", "[", "t", "]"}], "\[IndentingNewLine]", 
                    "+", 
                    RowBox[{"If", "[", 
                    RowBox[{"inoiseQ", ",", 
                    RowBox[{
                    RowBox[{"Surd", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}], "^", "k"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"a", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}], "^", "k"}]}], 
                    ")"}]}], ")"}], "-", 
                    RowBox[{"not", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "effvol"}], ")"}]}], ",", "2"}], "]"}], "*", 
                    
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", "0"}], "]"}]}], ")"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"del", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{"ss1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"mu", "/", "rho"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"b", " ", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "^", "h"}]}]}], ")"}]}], 
                    "-", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}]}], "+", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"inoiseQ", ",", 
                    RowBox[{
                    RowBox[{"Surd", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"mu", "/", "rho"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"b", " ", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "^", "h"}]}]}], ")"}]}], 
                    "+", 
                    RowBox[{"del", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "effvol"}], ")"}]}], ",", "2"}], "]"}], "*", 
                    
                    RowBox[{"RandomVariate", "[", 
                    RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", "0"}], "]"}]}], ")"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"not", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlnn", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"del", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initldd", "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"not", ",", "del"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"ii", "-", "1"}], ",", "ii"}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"sigm", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NDSolveValue", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "ss1"}], ")"}], " ", "\[Tau]", " ", 
                    RowBox[{
                    RowBox[{"not", "'"}], "[", "t", "]"}]}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]N", "-", 
                    RowBox[{"not", "[", "t", "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{"cisQ", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"not", "[", "t", "]"}]}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "\[Kappa]c", ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ",", "0"}], "]"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "ss1"}], ")"}], " ", "\[Tau]", " ", 
                    RowBox[{
                    RowBox[{"del", "'"}], "[", "t", "]"}]}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]D", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"rep", "[", "t", "]"}], "^", "m"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"del", "[", "t", "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{"cisQ", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"del", "[", "t", "]"}]}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"not", "[", "t", "]"}]}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "\[Kappa]c", ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ",", "0"}], "]"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "ss1"}], ")"}], " ", 
                    RowBox[{
                    RowBox[{"rep", "'"}], "[", "t", "]"}]}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]R", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ")"}], "^", "p"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"\[Kappa]RS", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], "*", 
                    RowBox[{"Last", "[", "agpp", "]"}]}], ")"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ")"}], "^", "p"}]}], 
                    ")"}]}]}], "-", 
                    RowBox[{"rep", "[", "t", "]"}]}], ")"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"not", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlnn", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"del", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initldd", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"rep", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlrr", "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"not", ",", "del", ",", "rep"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"ii", "-", "1"}], ",", "ii"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"NDSolveValue", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Tau]", " ", 
                    RowBox[{
                    RowBox[{"not", "'"}], "[", "t", "]"}]}], "\[Equal]", 
                    RowBox[{"1", "-", 
                    RowBox[{"not", "[", "t", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\[Tau]", " ", 
                    RowBox[{
                    RowBox[{"del", "'"}], "[", "t", "]"}]}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Beta]D", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"rep", "[", "t", "]"}], "^", "m"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rep", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Beta]R", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ")"}], "^", "p"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{
                    RowBox[{"Last", "[", "agll", "]"}], ".", 
                    RowBox[{"del", "[", "t", "]"}]}]}], ")"}], "^", "p"}]}], 
                    ")"}]}]}], "-", 
                    RowBox[{"rep", "[", "t", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"not", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlnn", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"del", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initldd", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"rep", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlrr", "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"not", ",", "del", ",", "rep"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"ii", "-", "1"}], ",", "ii"}], "}"}]}], "]"}], 
                    "*)"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NDSolveValue", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"not", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Beta]N", "/", "Lps"}], "-", 
                    RowBox[{"not", "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"\[Kappa]t", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"del", "[", "t", "]"}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"del", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Beta]D", "/", "Lps"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"repf", "[", 
                    RowBox[{
                    RowBox[{"rep", "[", "t", "]"}], ",", "ns"}], "]"}], "^", 
                    "l"}]}], ")"}]}], ")"}]}], "-", 
                    RowBox[{"del", "[", "t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"\[Kappa]t", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                    RowBox[{"del", "[", "t", "]"}], "*", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"not", "[", "t", "]"}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rep", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Beta]R", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mlt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"del", "[", "t", "]"}], "]"}]}], ",", "mat"}], 
                    "]"}], ".", "msum"}], ")"}], "^", "m"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mlt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"not", "[", "t", "]"}], "*", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"del", "[", "t", "]"}], "]"}]}], ",", "mat"}], 
                    "]"}], ".", "msum"}], ")"}], "^", "m"}]}], ")"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"rep", "[", "t", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"not", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlnne", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"del", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initldde", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"rep", "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], "\[Equal]", 
                    RowBox[{"Last", "[", "initlrr", "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"not", ",", "del", ",", "rep"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"ii", "-", "1"}], ",", "ii"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
                  "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"sigm", "\[Equal]", "0"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"solnsl", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "ii"}], "]"}], "]"}], "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "ii"}], "]"}], "]"}], "[", 
                    RowBox[{"ii", "-", "1"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"sigm", "\[Equal]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"solnsl", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "ii"}], "]"}], "]"}], "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "ii"}], "]"}], "]"}], "[", 
                    RowBox[{"ii", "-", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "ii"}], "]"}], "]"}], "[", 
                    RowBox[{"ii", "-", "1"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"solnsl", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"solnsl", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ii"}], "\[RightDoubleBracket]"}], "[", 
                    
                    RowBox[{"ii", "-", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}], ",", 
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "ii"}], "\[RightDoubleBracket]"}], "[", 
                    
                    RowBox[{"ii", "-", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"3", ",", "ii"}], "\[RightDoubleBracket]"}], "[", 
                    
                    RowBox[{"ii", "-", "1"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"valt", "=", 
                  RowBox[{"Last", "[", "val", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"valtne", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "ii"}], "]"}], "]"}], "[", "ii", 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"valtde", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "ii"}], "]"}], "]"}], "[", "ii", 
                    "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"valtn", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "ii"}], "]"}], "]"}], "[", "ii", 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"valtd", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "ii"}], "]"}], "]"}], "[", "ii", 
                    "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sigm", "\[Equal]", "1"}], "||", 
                    RowBox[{"sigm", "\[Equal]", "2"}]}], ",", 
                   RowBox[{"valtr", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "solns", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "ii"}], "]"}], "]"}], "[", "ii", 
                    "]"}]}], "]"}]}], ",", 
                   RowBox[{"valtr", "=", 
                    RowBox[{"{", "}"}]}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"solnsl", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"solnsl", ",", 
                    RowBox[{"Last", "[", "solnsl", "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"lv", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"lv", ",", 
                    RowBox[{"Last", "[", "lv", "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"plist", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"plist", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Polygon", ",", "cellToPts"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"pcells", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"pcells", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", "rmb", "]"}], "==", "0."}], ",", 
                    RowBox[{"Last", "[", "plist", "]"}], ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "->", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"roundm", "[", 
                    RowBox[{"#", ",", "rmb", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], "&"}], ",", 
                    RowBox[{"Values", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"plistn", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"plistn", ",", 
                    RowBox[{"KeyTake", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], ",", "lvs"}], 
                    "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"VERTEX", " ", "UPDATES"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
             "vmod", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"T2", " ", "TRANSITIONS"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "perQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"non", "-", "periodic"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cellsToRemove", ",", "vertsToRemove"}], "}"}], 
                   "=", 
                   RowBox[{"cellsforT2", "[", 
                    RowBox[{
                    "areaPolygonAssoc", ",", "cellToVertexG", ",", "perQ", 
                    ",", "treshT2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Tsim", "<", "iii", "\[LessEqual]", "Tsimf"}], "&&",
                     "vmod"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"remlist", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"remlist", ",", "cellsToRemove"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"rems", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"remlist", ",", 
                    RowBox[{
                    RowBox[{"UnsameQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cellsToRemove", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "indTopts", ",", "cellToVertexG", ",", "vertexToCell", 
                    ",", "areaPolygonAssoc", ",", "periPolygonAssoc"}], "}"}],
                     "=", 
                    RowBox[{"T2transitionFn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cellsToRemove", ",", "vertsToRemove"}], "}"}], 
                    ",", "indTopts", ",", "cellToVertexG", ",", 
                    "areaPolygonAssoc", ",", "periPolygonAssoc", ",", 
                    "cellsToRemove", ",", "indTopts", ",", "ptsToInd", ",", 
                    "vertexToCell", ",", "cellToVertexG", ",", 
                    "$wrappedMatTrim", ",", "$faceListCoords", ",", "perQ"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", "periodic", " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"cellsToRemove", "=", 
                   RowBox[{"cellsforT2", "[", 
                    RowBox[{
                    "areaPolygonAssoc", ",", "cellToVertexG", ",", 
                    "treshT2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cellsToRemove", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "indTopts", ",", "ptsToInd", ",", "vertexToCell", ",", 
                    "cellToVertexG", ",", "$wrappedMat", ",", 
                    "$faceListCoords"}], "}"}], "=", 
                    RowBox[{"T2transitionFn", "[", 
                    RowBox[{
                    "cellsToRemove", ",", "indTopts", ",", "ptsToInd", ",", 
                    "vertexToCell", ",", "cellToVertexG", ",", 
                    "$wrappedMatTrim", ",", "$faceListCoords", ",", "perQ"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"bcells", "=", 
                    RowBox[{"outerCellsFn", "[", 
                    RowBox[{
                    "$faceListCoords", ",", "vertexToCell", ",", "ptsToInd"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"$wrappedMatTrim", "=", 
                    RowBox[{"KeyTake", "[", 
                    RowBox[{"$wrappedMat", ",", "bcells"}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Tsim", "<", "iii", "\[LessEqual]", "Tsimf"}], "&&",
                   "smod"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"lvt", "=", 
                   RowBox[{"First", "/@", 
                    RowBox[{
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], "]"}], "@", 
                    "cellToVertexG"}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"valt", "=", 
                   RowBox[{"KeyDrop", "[", 
                    RowBox[{"valt", ",", "rems"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"valtn", "=", 
                   RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtn", ",", "rems"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"valtd", "=", 
                   RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtd", ",", "rems"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"valtr", "=", 
                   RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtr", ",", "rems"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"cellToVertexG0", "=", "cellToVertexG"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"T1", " ", "TRANSITIONS"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "perQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"non", "-", "periodic"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"edges0", "=", 
                   RowBox[{"DeleteDuplicatesBy", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}]}], "]"}], 
                    ",", "1"}], "]"}], ",", "Sort"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"edges0", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"edges0", ",", 
                    RowBox[{"Reverse", "/@", "edges0"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "edgechanged", ",", "indTopts", ",", "cellToVertexG", ",",
                     "vertexToCell"}], "}"}], "=", 
                   RowBox[{"T1transitionFn", "[", 
                    RowBox[{
                    "edges0", ",", "indTopts", ",", "ptsToInd", ",", 
                    "vertexToCell", ",", "cellToVertexG", ",", 
                    "$wrappedMatTrim", ",", "$faceListCoords", ",", "perQ", 
                    ",", "treshT1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cellToPts", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
                    "cellToVertexG"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ptsToInd", "=", 
                   RowBox[{"AssociationMap", "[", 
                    RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"areaPolygonAssoc", "=", 
                   RowBox[{"areaPolygon", "/@", "cellToPts"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"diamPolygonAssoc", "=", 
                   RowBox[{"diamPolygon", "/@", "cellToPts"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"periPolygonAssoc", "=", 
                   RowBox[{"perimeterPolygon", "/@", "cellToPts"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"lvt", "=", 
                   RowBox[{"First", "/@", 
                    RowBox[{
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], "]"}], "@", 
                    "cellToVertexG"}]}]}]}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", "periodic", " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"edges0", "=", 
                   RowBox[{"DeleteDuplicatesBy", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}]}], "]"}], 
                    ",", "1"}], "]"}], ",", "Sort"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"edges0", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"edges0", ",", 
                    RowBox[{"Reverse", "/@", "edges0"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "indTopts", ",", "vertexToCell", ",", "cellToVertexG", 
                    ",", "$wrappedMat", ",", "$faceListCoords"}], "}"}], "=", 
                   
                   RowBox[{"T1transitionFn", "[", 
                    RowBox[{
                    "edges0", ",", "indTopts", ",", "ptsToInd", ",", 
                    "vertexToCell", ",", "cellToVertexG", ",", 
                    "$wrappedMatTrim", ",", "$faceListCoords", ",", "perQ", 
                    ",", "treshT1"}], "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"bcells", "=", 
                   RowBox[{"outerCellsFn", "[", 
                    RowBox[{
                    "$faceListCoords", ",", "vertexToCell", ",", "ptsToInd"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"$wrappedMatTrim", "=", 
                   RowBox[{"KeyTake", "[", 
                    RowBox[{"$wrappedMat", ",", "bcells"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptsToInd", "=", 
                   RowBox[{"AssociationMap", "[", 
                    RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"areaPolygonAssoc", "=", 
                   RowBox[{"areaPolygon", "/@", "$faceListCoords"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"diamPolygonAssoc", "=", 
                   RowBox[{"diamPolygon", "/@", "$faceListCoords"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"periPolygonAssoc", "=", 
                   RowBox[{"perimeterPolygon", "/@", "$faceListCoords"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"CELL", " ", "DIVISIONS"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "perQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"non", "-", "periodic"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"polydiv", "=", 
                   RowBox[{"selectDivCells", "[", "areaPolygonAssoc", "]"}]}],
                   ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"Tsim", "<", "iii", "\[LessEqual]", "Tsimf"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"divlist", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"divlist", ",", "polydiv"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"divs", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"divlist", ",", 
                    RowBox[{
                    RowBox[{"UnsameQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"polydiv", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Scan", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "indTopts", ",", "cellToVertexG", ",", "areaPolygonAssoc",
                     ",", "periPolygonAssoc"}], "}"}], "=", 
                    RowBox[{"cellDivision", "[", 
                    RowBox[{
                    "#", ",", "indTopts", ",", "areaPolygonAssoc", ",", 
                    "periPolygonAssoc", ",", "cellToVertexG"}], "]"}]}], 
                    ")"}], "&"}], ",", "\[IndentingNewLine]", "polydiv"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"vertexToCell", "=", 
                    RowBox[{"GroupBy", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}], "@*", 
                    "Thread"}], "/@", 
                    RowBox[{"Normal", "@", "cellToVertexG"}]}], "]"}], ",", 
                    RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Tsim", "<", "iii", "\[LessEqual]", "Tsimf"}], "&&",
                     "smod"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lvt", "=", 
                    RowBox[{"First", "/@", 
                    RowBox[{
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "&"}], "]"}], "@", 
                    "cellToVertexG"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nlvn", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valt", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valt", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nlvnn", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtn", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtn", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nlvnd", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtd", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtd", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nlvnr", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtr", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"RankedMax", "[", 
                    RowBox[{"lvt", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "\[Rule]", 
                    RowBox[{"valtr", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Last", "[", "divs", "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"valt", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"valt", ",", 
                    RowBox[{"Last", "[", "divs", "]"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", "nlvn", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"valtn", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtn", ",", 
                    RowBox[{"Last", "[", "divs", "]"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", "nlvnn", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"valtd", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtd", ",", 
                    RowBox[{"Last", "[", "divs", "]"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", "nlvnd", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"valtr", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"valtr", ",", 
                    RowBox[{"Last", "[", "divs", "]"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", "nlvnr", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"divT", "=", "1"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ptsToInd", "=", 
                   RowBox[{"AssociationMap", "[", 
                    RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"edges0", "=", 
                   RowBox[{"DeleteDuplicatesBy", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}]}], "]"}], 
                    ",", "1"}], "]"}], ",", "Sort"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"edges0", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"edges0", ",", 
                    RowBox[{"Reverse", "/@", "edges0"}]}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", "periodic", " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"polydiv", "=", 
                   RowBox[{"selectDivCells", "[", "areaPolygonAssoc", "]"}]}],
                   ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"polydiv", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Scan", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "indTopts", ",", "cellToVertexG", ",", "areaPolygonAssoc",
                     ",", "periPolygonAssoc"}], "}"}], "=", 
                    RowBox[{"cellDivision", "[", 
                    RowBox[{
                    "#", ",", "indTopts", ",", "areaPolygonAssoc", ",", 
                    "periPolygonAssoc", ",", "cellToVertexG"}], "]"}]}], 
                    ")"}], "&"}], ",", "polydiv"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"vertexToCell", "=", 
                    RowBox[{"KeySort", "@", 
                    RowBox[{"GroupBy", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}], "@*", 
                    "Thread"}], "/@", 
                    RowBox[{"Normal", "@", "cellToVertexG"}]}], "]"}], ",", 
                    RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"$faceListCoords", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
                    "cellToVertexG"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"$wrappedMat", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "/.", "periodicRules"}], "&"}], ",", 
                    "$faceListCoords"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"bcells", "=", 
                    RowBox[{"outerCellsFn", "[", 
                    RowBox[{
                    "$faceListCoords", ",", "vertexToCell", ",", "ptsToInd"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"$wrappedMatTrim", "=", 
                    RowBox[{"KeyTake", "[", 
                    RowBox[{"$wrappedMat", ",", "bcells"}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ptsToInd", "=", 
                   RowBox[{"AssociationMap", "[", 
                    RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"FATE", " ", 
                 RowBox[{"DEPENDENT", " ", "[", 
                  RowBox[{"OTHER", " ", "MODEL"}], "]"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"kk", "=", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{"edges0", ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"\[CapitalLambda]", ",", 
                    RowBox[{"Length", "[", "edges0", "]"}]}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"border", " ", "line", " ", "tension"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"degreea", "=", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "indTopts", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}], "]"}], ",",
                     "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"Keys", "[", "indTopts", "]"}]}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"bordereg", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"degreea", "[", "#", "]"}], "&"}], "/@", "j"}], 
                    "]"}], "<", "5"}], ",", "j", ",", "Nothing"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Keys", "[", "kk", "]"}]}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"AssociateTo", "[", 
                RowBox[{"kk", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "->", "d\[Eta]"}], "&"}], "/@", 
                  "bordereg"}]}], "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Use", " ", "for", " ", "random", " ", "preffered", " ", 
                 "area"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"A0ll", "=", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "lv", "]"}], ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"a0e", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Last", "[", "lv", "]"}]}]}], "]"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "areQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"A0llss", "=", 
                   RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], ",", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a0e", "-", ".5"}], ",", 
                    RowBox[{"a0e", "+", ".5"}]}], "}"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Last", "[", "lv", "]"}]}]}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"areQ", "=", "False"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"kall", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "lv", "]"}], ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"ka", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Last", "[", "lv", "]"}]}]}], "]"}]}], "]"}]}], 
                "Input"], 
               StyleBox[";", "Input"], 
               StyleBox["\[IndentingNewLine]", "Input"], 
               StyleBox[
                RowBox[{"diamll", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "lv", "]"}], ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"diamx", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Last", "[", "lv", "]"}]}]}], "]"}]}], "]"}]}], 
                "Input"], 
               StyleBox[";", "Input"], 
               StyleBox["\[IndentingNewLine]", "Input"], 
               StyleBox[
                RowBox[{"diamkll", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "lv", "]"}], ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"d\[Kappa]", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Last", "[", "lv", "]"}]}]}], "]"}]}], "]"}]}], 
                "Input"], 
               StyleBox[";", "Input"], "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"gamll", "=", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "lv", "]"}], ",", "gamc"}], "]"}]}], 
                "Input"], 
               StyleBox[";", "Input"], 
               StyleBox["\[IndentingNewLine]", "Input"], 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"solnsl", "=!=", 
                   RowBox[{"{", "}"}]}], "&&", "depQ"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"deltas", "=", 
                   RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Values", "[", 
                    RowBox[{"Last", "[", "solnsl", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"Last", "[", "solnsl", "]"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"dthr", "=", "dlthresh"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"dind", "=", 
                   RowBox[{"Values", "[", 
                    RowBox[{"KeySelect", "[", 
                    RowBox[{"deltas", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "dthr"}], "&"}]}], 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dind1", "=", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"RegionCentroid", "/@", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plistn", "]"}], ",", "dind"}], 
                    "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"dind2", "=", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"RegionCentroid", "/@", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plistn", "]"}], ",", "dind"}], 
                    "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<=", "0"}], "&"}]}], 
                    "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "LINE", " ", "TENSIONS"}], " ", 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[CapitalLambda]2", "=!=", "\[CapitalLambda]"}], 
                    "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"\[CapitalLambda]3", "=!=", "\[CapitalLambda]"}], 
                    ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgea", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Keys", "[", "cellToVertexG", "]"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "cellToVertexG", "]"}]}], "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgeai1", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"edgea", ",", "dind1"}], "]"}], ",", "1"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeai2", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"edgea", ",", "dind2"}], "]"}], ",", "1"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeai21", "=", 
                    RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"edgeai1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Reverse", ",", "edgeai1"}], "]"}]}], "]"}]}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeai22", "=", 
                    RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"edgeai2", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Reverse", ",", "edgeai2"}], "]"}]}], "]"}]}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nedges1", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"edges0", ",", "edgeai21"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nedges2", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"edges0", ",", "edgeai22"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"inlc", ",", 
                    RowBox[{"nedges1", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"cellToVertexG", ",", "lvs"}], "]"}], "]"}], ",", 
                    "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"nedges1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ">", "3"}], ",", 
                    
                    RowBox[{"nedges1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "un"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "nedges1", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"inlc", ",", 
                    RowBox[{"nedges2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"cellToVertexG", ",", "lvs"}], "]"}], "]"}], ",", 
                    "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"nedges2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ">", "3"}], ",", 
                    
                    RowBox[{"nedges2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "un"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "nedges2", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kk", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"nedges", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"\[CapitalLambda]2", ",", 
                    RowBox[{"Length", "[", "nedges", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kk", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"nedges", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"\[CapitalLambda]2", ",", 
                    RowBox[{"Length", "[", "nedges", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgeai", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"edgea", ",", "dind"}], "]"}], ",", "1"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"edgeai2", "=", 
                    RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"edgeai", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Reverse", ",", "edgeai"}], "]"}]}], "]"}]}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nedges", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"edges0", ",", "edgeai2"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"inlc", ",", 
                    RowBox[{"nedges", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"cellToVertexG", ",", "lvs"}], "]"}], "]"}], ",", 
                    "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"nedges", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ">", "3"}], ",", 
                    
                    RowBox[{"nedges", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "un"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "nedges", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kk", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"nedges", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"\[CapitalLambda]2", ",", 
                    RowBox[{"Length", "[", "nedges", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "PREFERRED", " ", "AREA"}], " ", 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"a0e2", "=!=", "a0e"}], "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"a0e3", "=!=", "a0e"}], ",", "False"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"A0ll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind1", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"a0e2", ",", 
                    RowBox[{"Length", "@", "dind1"}]}], "]"}]}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"A0ll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind2", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"a0e3", ",", 
                    RowBox[{"Length", "@", "dind2"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"A0ll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"a0e2", ",", 
                    RowBox[{"Length", "@", "dind"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "ELASTICITY"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ka2", "=!=", "ka"}], "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"ka3", "=!=", "ka"}], ",", "False"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kall", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind1", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"ka2", ",", 
                    RowBox[{"Length", "@", "dind1"}]}], "]"}]}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kall", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind2", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"ka3", ",", 
                    RowBox[{"Length", "@", "dind2"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"kall", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"ka2", ",", 
                    RowBox[{"Length", "@", "dind"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "STIFFNESS"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"d\[Kappa]2", "=!=", "d\[Kappa]"}], "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"d\[Kappa]3", "=!=", "d\[Kappa]"}], ",", 
                    "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamkll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind1", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"d\[Kappa]2", ",", 
                    RowBox[{"Length", "@", "dind1"}]}], "]"}]}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamkll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind2", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"d\[Kappa]3", ",", 
                    RowBox[{"Length", "@", "dind2"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamkll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"d\[Kappa]2", ",", 
                    RowBox[{"Length", "@", "dind"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "PREFERRED", " ", "DIAMETER"}], " ",
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"diamx2", "=!=", "diamx"}], "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"diamx3", "=!=", "diamx"}], ",", "False"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind1", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"diamx2", ",", 
                    RowBox[{"Length", "@", "dind1"}]}], "]"}]}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind2", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"diamx3", ",", 
                    RowBox[{"Length", "@", "dind2"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"diamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"diamx2", ",", 
                    RowBox[{"Length", "@", "dind"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"CHANGE", " ", "CONTRACTILITY"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"gamc2", "=!=", "gamc"}], "||", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", 
                    RowBox[{"gamc3", "=!=", "gamc"}], ",", "False"}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigr", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"gamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind1", "\[Rule]", "gamc2"}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"gamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind2", "\[Rule]", "gamc3"}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"gamll", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"dind", "\[Rule]", "gamc2"}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"VORONOI", " ", "NOISE"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"VM", " ", "NOISE"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"nvm", ",", 
              RowBox[{"nsvp", "=", 
               RowBox[{"RandomReal", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "nst"}], ",", "nst"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "indTopts", "]"}], ",", "2"}], 
                  "}"}]}], "]"}]}], ",", 
              RowBox[{"nsvp", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"Length", "[", "indTopts", "]"}]}], "]"}]}]}], "]"}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"UPDATE", " ", "POSITIONS"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "perQ"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"non", "-", "periodic"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"vmod", "&&", 
                  RowBox[{"iii", "\[LessEqual]", "Tvf"}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"iii", "==", "1"}], ",", 
                    RowBox[{"indTopts0", "=", "indTopts"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"indTopts", "=", 
                   RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Keys", "[", "indTopts", "]"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Values", "[", "indTopts", "]"}], "+", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["F", "T"], "[", 
                    RowBox[{
                    "indTopts", ",", "ptsToInd", ",", "vertexToCell", ",", 
                    "cellToVertexG", ",", "areaPolygonAssoc", ",", 
                    "periPolygonAssoc", ",", "diamPolygonAssoc", ",", 
                    "diamll", ",", "diamkll", ",", "edges0", ",", "kk", ",", 
                    "A0ll", ",", "kall", ",", "gamll", ",", "localtopo", ",", 
                    "perQ"}], "]"}], " ", 
                    RowBox[{"N", "[", "\[Eta]v", "]"}]}]}], 
                    RowBox[{"(*", 
                    RowBox[{"+", "nsvp"}], "*)"}], ")"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"streQ", "&&", 
                    RowBox[{"stet", "==", "2"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"iii", "<", "Tstei"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsr", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "&"}], "/@", 
                    "steptsr"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsl", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "&"}], "/@", 
                    "steptsl"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Tstei", "<=", "iii", "<=", "Tstef"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsr", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"ht", 
                    RowBox[{"(", 
                    RowBox[{"iii", "-", "Tstei", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ")"}], "&"}], "/@",
                     "steptsr"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsl", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"ht", 
                    RowBox[{"(", 
                    RowBox[{"iii", "-", "Tstei", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ")"}], "&"}], "/@",
                     "steptsl"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"iii", ">", "Tstef"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsr", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"ht", 
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ")"}], "&"}], "/@",
                     "steptsr"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"steptsl", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"ht", 
                    RowBox[{"(", 
                    RowBox[{"Tstef", "-", "Tstei", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"indTopts0", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ")"}], "&"}], "/@",
                     "steptsl"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
                     "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"clmp", ",", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"indTopts", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"kclmp", "\[Rule]", "pclmp"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"indTopts", "=", "indTopts"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"cellToPts", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
                 "cellToVertexG"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"areaPolygonAssoc", "=", 
                RowBox[{"areaPolygon", "/@", "cellToPts"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"diamPolygonAssoc", "=", 
                RowBox[{"diamPolygon", "/@", "cellToPts"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"periPolygonAssoc", "=", 
                RowBox[{"perimeterPolygon", "/@", "cellToPts"}]}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", "periodic", " ", "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"vmod", "&&", 
                 RowBox[{"iii", "\[LessEqual]", "Tvf"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"localtopo", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"getLocalTopology", "[", 
                    RowBox[{
                    "ptsToInd", ",", "indTopts", ",", "vertexToCell", ",", 
                    "cellToVertexG", ",", "$wrappedMatTrim", ",", 
                    "$faceListCoords"}], "]"}], "[", "#", "]"}], "&"}], "/@", 
                   "indTopts"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"edgeLst", "=", 
                  RowBox[{"SortBy", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}],
                     ",", 
                    RowBox[{"Values", "[", "$faceListCoords", "]"}]}], "]"}], 
                    ",", "1"}], "]"}], ",", "First"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"externedges", "=", 
                  RowBox[{"outeredges", "[", 
                   RowBox[{"indTopts", ",", "localtopo"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"edgeLst", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"edgeLst", ",", "externedges"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "capture", " ", "the", " ", "first", " ", "and", " ", "the",
                    " ", "last", " ", "output", " ", "for", " ", "the", " ", 
                   "magnitude", " ", "of", " ", "force"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"cj", "\[Equal]", "3"}], "||", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cj", "+", "1"}], ")"}], "\[Equal]", "Tmax"}]}], 
                   ",", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"tt", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["F", "T"], "[", 
                    RowBox[{
                    "indTopts", ",", "ptsToInd", ",", "localtopo", ",", 
                    "areaPolygonAssoc", ",", "periPolygonAssoc", ",", 
                    "diamPolygonAssoc", ",", "diamll", ",", "diamkll", ",", 
                    "edgeLst"}], "]"}], "\[Eta]v"}]}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"indTopts", "=", 
                  RowBox[{"AssociationThread", "[", 
                   RowBox[{
                    RowBox[{"Keys", "[", "indTopts", "]"}], "\[Rule]", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Values", "[", "indTopts", "]"}], "+", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["F", "T"], "[", 
                    RowBox[{
                    "indTopts", ",", "ptsToInd", ",", "localtopo", ",", 
                    "areaPolygonAssoc", ",", "periPolygonAssoc", ",", 
                    "diamPolygonAssoc", ",", "diamll", ",", "diamkll", ",", 
                    "edgeLst"}], "]"}], "\[Eta]v"}]}], ")"}], ",", "10"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ptsToInd", "=", 
                  RowBox[{"AssociationMap", "[", 
                   RowBox[{"Reverse", ",", "indTopts"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"$faceListCoords", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indTopts", ",", "#"}], "]"}], "&"}], "/@", 
                   "cellToVertexG"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"areaPolygonAssoc", "=", 
                  RowBox[{"areaPolygon", "/@", "$faceListCoords"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"diamPolygonAssoc", "=", 
                  RowBox[{"diamPolygon", "/@", "$faceListCoords"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"periPolygonAssoc", "=", 
                  RowBox[{"perimeterPolygon", "/@", "$faceListCoords"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"vertexToCell", "=", 
                  RowBox[{"GroupBy", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}], "@*", 
                    "Thread"}], "/@", 
                    RowBox[{"Normal", "@", "cellToVertexG"}]}], "]"}], ",", 
                    RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"$wrappedMat", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "/.", "periodicRules"}], "&"}], ",", 
                    "$faceListCoords"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 
                 RowBox[{"bcells", "=", 
                  RowBox[{"outerCellsFn", "[", 
                   RowBox[{
                   "$faceListCoords", ",", "vertexToCell", ",", "ptsToInd"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"$wrappedMatTrim", "=", 
                  RowBox[{"KeyTake", "[", 
                   RowBox[{"$wrappedMat", ",", "bcells"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "GRAPHICS", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"plt", "=", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FaceForm", "[", "LightBlue", "]"}], ",", 
                RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                RowBox[{"Values", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Polygon", "@", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"indTopts", ",", "#"}], "]"}]}], "&"}], "/@", 
                  "cellToVertexG"}], "]"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"flist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"flist", ",", "plt"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"SIGNALLING", " ", "UPDATES"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Tsim", "<", "iii", "\[LessEqual]", "Tsimf"}], "&&", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"iii", ",", "sv"}], "]"}], "\[Equal]", "0"}], "&&", 
               "smod"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"val", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"val", ",", "valt"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"lv", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"lv", ",", "lvt"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initln", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initln", ",", "valtn"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initld", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initld", ",", "valtd"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"initlr", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initlr", ",", "valtr"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"initlnn", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initlnn", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initln", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"initldd", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initldd", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initld", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"initlrr", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"initlrr", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initlr", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"initlne", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initlne", ",", "valtne"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"initlde", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initlde", ",", "valtde"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"initlnne", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initlnne", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initlne", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"initldde", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initldde", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "initlde", "]"}], "[", "j", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"SIGNAL", " ", "WAVE"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"iii", "<", "Tsim2"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"sigy", "=", 
                   RowBox[{"Mean", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cellToPts", "/@", "lvs"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], 
                    ")"}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"lvsw", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sigy", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], ",", 
                    RowBox[{"lvs", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "un"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "lvs", "]"}]}], "}"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"lvsw0", "=", "lvsw"}], ";", "\[IndentingNewLine]", 
                  
                  RowBox[{"lvswc", "=", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"lvs", ",", "lvsw"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"initlnn", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initlnn", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"lvswc", ",", "j"}], "]"}], ",", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "initln", "]"}], "[", "j", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"initldd", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initldd", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"lvswc", ",", "j"}], "]"}], ",", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "initld", "]"}], "[", "j", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"initlrr", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"initlrr", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"lvswc", ",", "j"}], "]"}], ",", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "initlr", "]"}], "[", "j", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"lvsw", "=", "lvs"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"MATRIX", " ", "UPDATES"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"LONG", "-", "RANGE"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"vmod", "&&", 
                    RowBox[{"iii", "\[LessEqual]", "Tvf"}], "&&", "updQ"}], 
                   ")"}], "||", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"stetil", ",", "stetrl"}], "]"}], ",", "iii"}], 
                    "]"}], "&&", "streQ"}], ")"}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"plist", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"plist", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Polygon", ",", "cellToPts"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"pcells", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"pcells", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", "rmb", "]"}], "==", "0."}], ",", 
                    RowBox[{"Last", "[", "plist", "]"}], ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "->", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"roundm", "[", 
                    RowBox[{"#", ",", "rmb", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], "&"}], ",", 
                    RowBox[{"Values", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"plistn", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"plistn", ",", 
                    RowBox[{"KeyTake", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], ",", "lvs"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"uplQ", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"protl", "=", 
                    RowBox[{"pll", " ", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"protlf", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "longt"}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"protll", "=", "\[IndentingNewLine]", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "->", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"cellQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"pll", " ", 
                    RowBox[{"protlf", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "plistn"}], ",", "longt"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"protl", ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "]"}]}], "]"}]}], 
                    "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"matFn", "[", 
                   RowBox[{"lv", ",", "lvs", ",", 
                    RowBox[{"Last", "@", "plistn"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"asslJ", "=", 
                   RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", "asslJp"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "@", "lvs"}], ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"asslL", "=", 
                   RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", "asslLp"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "@", "lvs"}], ",", 
                    RowBox[{"Length", "@", "lvs"}]}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"assl", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], "asslJ"}], "+", 
                    
                    RowBox[{"\[Epsilon]v", " ", "asslL"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"agll", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"agll", ",", "assl"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"plist", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"plist", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Polygon", ",", "cellToPts"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"pcells", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"pcells", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", "rmb", "]"}], "==", "0."}], ",", 
                    RowBox[{"Last", "[", "plist", "]"}], ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "lv", "]"}], "->", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"roundm", "[", 
                    RowBox[{"#", ",", "rmb", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], "&"}], ",", 
                    RowBox[{"Values", "@", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"plistn", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"plistn", ",", 
                    RowBox[{"KeyTake", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plist", "]"}], ",", "lvs"}], 
                    "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"DYNAMIC", " ", "PROTRUSIONS", " ", "UPDATES"}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"dynpQ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{"vmod", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"asslp", "=", 
                    RowBox[{"Merge", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"asslJp", ",", "asslLp"}], "}"}], ",", "Total"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"allpairs", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "lvs"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "lvs"}], "}"}]}], "]"}], ",", "1"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"asslp", "=", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"asslp", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "->", " ", "1"}], " ", "&"}], " ", "/@", 
                    RowBox[{"Complement", "[", 
                    RowBox[{"allpairs", ",", "gltp"}], "]"}]}]}], "]"}]}]}]}],
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  
                  RowBox[{"fill", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1000"}], "}"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pbt", "/", 
                    RowBox[{"(", 
                    RowBox[{"pbt", "+", "pdt"}], ")"}]}], ")"}], "*", 
                    "1000"}]}], ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "gltp"}]}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fill", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1000"}], "}"}], "]"}], "<", 
                    RowBox[{"pbt", "*", "1000"}]}], ",", "1", ",", 
                    RowBox[{"fill", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "gltp"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fill", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1000"}], "}"}], "]"}], "<", 
                    RowBox[{"pdt", "*", "1000"}]}], ",", "0", ",", 
                    RowBox[{"fill", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "gltp"}]}], "}"}]}], "]"}]}], 
                    ";"}], "\[IndentingNewLine]", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"agpp", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"agpp", ",", 
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"asslp", ",", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"gltp", "->", "fill"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ns", ",", "ns"}], "}"}]}], "]"}]}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"sigm", "\[Equal]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mat", "=", 
                   RowBox[{"Last", "[", "agll", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"mata", "=", 
                   RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", "\[Rule]", "mat"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ii", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"updQ", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"edgesT1", "==", 
                RowBox[{"{", "}"}]}], ",", "False", ",", 
               RowBox[{"AnyTrue", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"cellToVertexG0", ",", "lvs"}], "]"}], "]"}], ",",
                     "#"}], "]"}], "&"}], ",", "edgesT1"}], "]"}], ",", 
                 "TrueQ"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"smod", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"lvsc", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "lv", "]"}], ",", "lvs"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"lvsc", "=!=", 
                  RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"sigm", "=!=", "2"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"solnsle", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvsc", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sigm", "\[Equal]", "0"}], ",", "2", ",", "3"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"Length", "[", "lvsc", "]"}]}], "]"}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"solnsle", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvsc", "\[Rule]", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", "ns"}], "]"}], ",", "2"}], "]"}], ",", 
                    "0"}], "]"}], ",", 
                    RowBox[{"Length", "[", "lvsc", "]"}]}], "]"}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"solnsle", "=", 
                  RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"sols", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"sols", ",", 
                  RowBox[{"Merge", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"solnsle", ",", 
                    RowBox[{"Last", "[", "solnsl", "]"}]}], "}"}], ",", 
                    "Total"}], "]"}]}], "]"}]}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"STATISTICS", " ", "AND", " ", "DATA"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"dlts", "=", 
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Keys", "[", 
                 RowBox[{"Last", "[", "solnsl", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Values", "[", 
                  RowBox[{"Last", "[", "solnsl", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"din", "=", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"dlts", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ">", "dlthresh"}], "&"}]}],
                "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dinl", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"dinl", ",", "din"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"statsQ", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"plottimeQ", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"statsFn", "[", 
                  RowBox[{
                  "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", 
                   "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
                   "plottimeQ", ",", "dlthresh", ",", "sigm", ",", "sols", 
                   ",", "solnsl", ",", "plistn", ",", "lvs", ",", "lvs1", ",",
                    "lvs2", ",", "iii"}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"plotsl", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"plotsl", ",", "plots"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"iii", "==", "Tmax"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"statsFn", "[", 
                    RowBox[{
                    "plotperQ", ",", "plotcoeffvQ", ",", "plotSOPnQ", ",", 
                    "plotSOPdQ", ",", "plotsolQ", ",", "plotSOPQ", ",", 
                    "plottimeQ", ",", "dlthresh", ",", "sigm", ",", "sols", 
                    ",", "solnsl", ",", "plistn", ",", "lvs", ",", "lvs1", 
                    ",", "lvs2", ",", "iii"}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "GRAPH", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"grQ", "&&", "smod"}], ",", "  ", "\[IndentingNewLine]", 
              RowBox[{"gr", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"gr", ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"vmod", "||", 
                    RowBox[{"iii", "==", "0"}]}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{
                    RowBox[{"regcla0", "=", 
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{"lvs", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RegionCentroid", "[", 
                    RowBox[{
                    RowBox[{"Last", "[", "plistn", "]"}], "[", "#", "]"}], 
                    "]"}], "&"}], "/@", "lvs"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{
                    RowBox[{"UpperTriangularize", "@", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"grt", "==", "1"}], ",", "asslJ", ",", 
                    RowBox[{"grt", "==", "2"}], ",", "asslL", ",", 
                    RowBox[{"grt", "==", "3"}], ",", "assl"}], "]"}]}]}], ",", 
                    RowBox[{"PlotTheme", "\[Rule]", "grT"}], ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"Values", "@", "regcla0"}]}], ",", 
                    RowBox[{"DirectedEdges", "\[Rule]", "False"}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Last", "@", "gr"}]}], "\[IndentingNewLine]", 
                  "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"iii", "++"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"cj", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"Sow", "[", "plt", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ti", "+=", "\[Eta]v"}], ";"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"check", "++"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"iii0", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"VIDEO", " ", "OUTPUT"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"outputf", "[", 
        RowBox[{
        "smod", ",", "sigm", ",", "nv", ",", "colo1", ",", "colom", ",", 
         "colob", ",", "mbmt"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.83267263273648*^9, 3.832672666659565*^9}, {
   3.832675415376792*^9, 3.832675416456207*^9}, {3.8326758093129673`*^9, 
   3.83267581577308*^9}, {3.83267600481102*^9, 3.832676007721677*^9}, 
   3.8326762361710157`*^9, {3.83267717907596*^9, 3.8326771933856697`*^9}, {
   3.832677258714867*^9, 3.832677259243103*^9}, 3.832677311499368*^9, {
   3.8326776593860817`*^9, 3.832677660379597*^9}, {3.833445177629583*^9, 
   3.8334451778049603`*^9}, {3.8334457123705864`*^9, 3.833445712851154*^9}, {
   3.833445896843877*^9, 3.833445899838191*^9}, {3.8335252810464616`*^9, 
   3.833525290470376*^9}, {3.833525511988706*^9, 3.833525530304578*^9}, {
   3.833526491307163*^9, 3.8335265451108294`*^9}, {3.83354312664977*^9, 
   3.833543209996155*^9}, {3.8335432757109957`*^9, 3.833543407511919*^9}, {
   3.833543445320122*^9, 3.833543574444744*^9}, {3.8335437392172723`*^9, 
   3.833543959974185*^9}, {3.833544042541461*^9, 3.8335440464082565`*^9}, {
   3.833544124867161*^9, 3.833544167400465*^9}, {3.833544207799179*^9, 
   3.8335442079188786`*^9}, {3.833544323669923*^9, 3.833544333791174*^9}, 
   3.833544379083189*^9, {3.833545369188651*^9, 3.8335453894736586`*^9}, {
   3.8335458947851405`*^9, 3.8335458978911877`*^9}, {3.833546016698059*^9, 
   3.83354603416553*^9}, {3.8335461036615667`*^9, 3.833546105972266*^9}, {
   3.8335462194123964`*^9, 3.833546301532466*^9}, {3.833546863446436*^9, 
   3.8335468716452017`*^9}, {3.833547146609254*^9, 3.8335471534996777`*^9}, {
   3.8335471847229977`*^9, 3.8335472177977266`*^9}, {3.833547254545024*^9, 
   3.8335473378564453`*^9}, {3.8335487794946003`*^9, 3.8335487796189547`*^9}, 
   3.8336131505426416`*^9, {3.833614336786615*^9, 3.833614340357894*^9}, {
   3.833614426114335*^9, 3.8336144267338667`*^9}, {3.833614499012847*^9, 
   3.8336145190069647`*^9}, {3.8336145922330933`*^9, 3.833614604725851*^9}, {
   3.833620507630601*^9, 3.8336205102313576`*^9}, {3.8336206557398987`*^9, 
   3.8336206567403135`*^9}, {3.8336207975975485`*^9, 3.833620798856295*^9}, {
   3.833620856953841*^9, 3.8336208590584507`*^9}, {3.833620960992178*^9, 
   3.833620965878441*^9}, {3.833621024561453*^9, 3.8336210297589607`*^9}, {
   3.833621111872799*^9, 3.833621116615196*^9}, {3.833621174202751*^9, 
   3.8336211760870886`*^9}, 3.833621387140691*^9, {3.833622775373582*^9, 
   3.833622808035943*^9}, {3.83362287952995*^9, 3.8336229000779543`*^9}, {
   3.8336230027757444`*^9, 3.8336230104206867`*^9}, {3.8336232985039186`*^9, 
   3.8336233289398394`*^9}, {3.833623973069626*^9, 3.833623975363538*^9}, {
   3.833624194297167*^9, 3.8336242072097683`*^9}, {3.833624502620799*^9, 
   3.83362450582654*^9}, {3.833624664597335*^9, 3.833624744413097*^9}, {
   3.8336247790818143`*^9, 3.8336248366911364`*^9}, {3.833624871726266*^9, 
   3.833624926119378*^9}, 3.8336251035295367`*^9, {3.833625243486656*^9, 
   3.83362524400182*^9}, {3.8338735245152164`*^9, 3.8338735734396753`*^9}, {
   3.833873609292552*^9, 3.8338736176324153`*^9}, {3.8338736631767097`*^9, 
   3.8338736814605875`*^9}, {3.8338737908935795`*^9, 3.833873792754615*^9}, {
   3.8338738303547535`*^9, 3.833873836346016*^9}, {3.833874513609522*^9, 
   3.833874514744834*^9}, {3.833874717015358*^9, 3.8338747307077007`*^9}, {
   3.8338751011043005`*^9, 3.8338751345523653`*^9}, {3.8338755545507503`*^9, 
   3.8338755564727554`*^9}, {3.833875623052557*^9, 3.8338756258111563`*^9}, {
   3.8338781245554748`*^9, 3.8338781292031403`*^9}, 3.833878210680585*^9, {
   3.833878247868331*^9, 3.8338782486117544`*^9}, {3.8338786423709335`*^9, 
   3.8338786489720736`*^9}, {3.833881071556451*^9, 3.833881106402376*^9}, {
   3.8338811426288815`*^9, 3.8338811635094185`*^9}, 3.833882312824329*^9, {
   3.8338824510767126`*^9, 3.833882467930772*^9}, {3.8338826190461583`*^9, 
   3.833882621941967*^9}, 3.83388270171513*^9, {3.8338827878623004`*^9, 
   3.8338827929116964`*^9}, {3.8338828970620966`*^9, 3.833882897576287*^9}, {
   3.8339617981106725`*^9, 3.833961798423724*^9}, {3.833969058681364*^9, 
   3.8339691028576555`*^9}, {3.8339691763190565`*^9, 
   3.8339691845876265`*^9}, {3.833969701727698*^9, 3.833969701885249*^9}, {
   3.833973558633996*^9, 3.8339735844375257`*^9}, {3.833973615120257*^9, 
   3.833973633744145*^9}, {3.8339737115010586`*^9, 3.833973727244314*^9}, {
   3.833973872087165*^9, 3.8339738749960804`*^9}, {3.833974566022687*^9, 
   3.8339745826347904`*^9}, {3.8339746225823455`*^9, 3.833974623583152*^9}, {
   3.8339812078280993`*^9, 3.8339812671716022`*^9}, {3.8339816767830696`*^9, 
   3.8339816951972227`*^9}, {3.833982308295515*^9, 3.83398230895002*^9}, {
   3.833982924326973*^9, 3.8339830559855943`*^9}, {3.834043916242523*^9, 
   3.8340439648579416`*^9}, {3.83404411853266*^9, 3.8340441188470774`*^9}, {
   3.834046978138547*^9, 3.83404698022243*^9}, {3.8340471452733994`*^9, 
   3.834047154827423*^9}, {3.834047559426595*^9, 3.8340475664909887`*^9}, {
   3.8340476508008347`*^9, 3.834047671718262*^9}, {3.8340477108678493`*^9, 
   3.834047718107974*^9}, {3.834047749293393*^9, 3.834047752426609*^9}, {
   3.834048335927313*^9, 3.834048390619896*^9}, 3.8340487361957808`*^9, {
   3.834049201069966*^9, 3.8340493178493323`*^9}, {3.8340494628721557`*^9, 
   3.8340494702149534`*^9}, 3.834049913687476*^9, {3.8340499550401506`*^9, 
   3.834049960627897*^9}, {3.8340501365838346`*^9, 3.8340501432711267`*^9}, {
   3.8340501998792458`*^9, 3.8340502095578547`*^9}, {3.8340503195194073`*^9, 
   3.834050321907948*^9}, {3.834050712106821*^9, 3.834050735027624*^9}, {
   3.8340510470920143`*^9, 3.834051053345642*^9}, 3.8340516234074335`*^9, {
   3.8340516953881874`*^9, 3.83405173308295*^9}, {3.834051764847934*^9, 
   3.8340519399509945`*^9}, 3.8340520032821217`*^9, {3.834052055542494*^9, 
   3.834052094580879*^9}, {3.8340522425327587`*^9, 3.834052243786059*^9}, 
   3.834053845245908*^9, {3.834054018090867*^9, 3.8340540188499417`*^9}, {
   3.834054140817212*^9, 3.8340541605617633`*^9}, {3.83405439990711*^9, 
   3.8340544314576178`*^9}, {3.834054756320788*^9, 3.834054762108568*^9}, {
   3.834054971075294*^9, 3.834054973868067*^9}, {3.8340551196507354`*^9, 
   3.834055121371419*^9}, {3.8340551531442194`*^9, 3.8340551533685923`*^9}, {
   3.834055397584424*^9, 3.8340553987810893`*^9}, {3.8340559795901947`*^9, 
   3.8340559848075676`*^9}, {3.834056061080557*^9, 3.834056066878422*^9}, {
   3.834056099586542*^9, 3.8340561496700916`*^9}, {3.8340594521690226`*^9, 
   3.834059452321116*^9}, {3.834059889710124*^9, 3.8340598912896566`*^9}, {
   3.8340599216858683`*^9, 3.8340599217697353`*^9}, {3.8340600525165973`*^9, 
   3.834060052897398*^9}, 3.834060961881541*^9, {3.8340609988519783`*^9, 
   3.8340610459604797`*^9}, {3.8340612215581555`*^9, 
   3.8340612233381567`*^9}, {3.8340612923786454`*^9, 
   3.8340613349918575`*^9}, {3.834062591003212*^9, 3.8340625911198177`*^9}, {
   3.834062623384626*^9, 3.834062623401582*^9}, {3.8340627465625997`*^9, 
   3.8340627479936905`*^9}, {3.834062789555038*^9, 3.8340627915057077`*^9}, {
   3.834066258865769*^9, 3.8340662659871593`*^9}, {3.834066313492591*^9, 
   3.8340663425235176`*^9}, {3.83406647499751*^9, 3.8340664799403887`*^9}, {
   3.83406652019503*^9, 3.834066548841571*^9}, 3.8340666805592422`*^9, 
   3.834067417255307*^9, {3.834067667958872*^9, 3.8340676795772038`*^9}, 
   3.8340689520506682`*^9, {3.834069657250016*^9, 3.834069671834367*^9}, {
   3.834069963974285*^9, 3.834069965304551*^9}, {3.8340705662552133`*^9, 
   3.8340705796850295`*^9}, {3.834070678349617*^9, 3.834070679692974*^9}, {
   3.834146041353634*^9, 3.83414604637318*^9}, {3.8341464143806114`*^9, 
   3.834146437311607*^9}, {3.834146476298036*^9, 3.8341464781088257`*^9}, {
   3.83414653410658*^9, 3.8341465677875185`*^9}, {3.8341474306116276`*^9, 
   3.8341474375859547`*^9}, {3.8342135335258536`*^9, 3.834213576999264*^9}, {
   3.834213666790859*^9, 3.8342136744033566`*^9}, {3.834213739589157*^9, 
   3.8342137407117558`*^9}, {3.8342137764503827`*^9, 3.834213777518171*^9}, {
   3.834213821068966*^9, 3.8342138246809072`*^9}, {3.8342138659332495`*^9, 
   3.8342138996766987`*^9}, {3.8342139300794353`*^9, 
   3.8342139359037285`*^9}, {3.8342141591727433`*^9, 
   3.8342141747393723`*^9}, {3.83421420884571*^9, 3.83421421191044*^9}, {
   3.8342143127217054`*^9, 3.8342143129180727`*^9}, {3.834217938406455*^9, 
   3.8342179851225166`*^9}, {3.8342180234344506`*^9, 
   3.8342180338720517`*^9}, {3.8342180797169905`*^9, 
   3.8342180842754145`*^9}, {3.8342184106406555`*^9, 
   3.8342184113641496`*^9}, {3.8342187584875135`*^9, 3.834218758558427*^9}, {
   3.8342232980414867`*^9, 3.834223300037221*^9}, {3.8342233340251055`*^9, 
   3.8342233638134995`*^9}, {3.834223474174557*^9, 3.834223540372445*^9}, {
   3.834223680281281*^9, 3.83422368045807*^9}, {3.8342238958014245`*^9, 
   3.8342239224360914`*^9}, {3.834224023410133*^9, 3.834224062187256*^9}, {
   3.8342241223780813`*^9, 3.8342241277237206`*^9}, {3.8342270653020945`*^9, 
   3.834227093399832*^9}, {3.834227485989913*^9, 3.8342275366544847`*^9}, {
   3.8342276600086374`*^9, 3.8342276789915037`*^9}, {3.834227734467376*^9, 
   3.8342277516598444`*^9}, {3.834227843737358*^9, 3.834227874305417*^9}, {
   3.834227939872614*^9, 3.8342279399816003`*^9}, {3.8342280757037573`*^9, 
   3.8342280757601457`*^9}, {3.8342281076952868`*^9, 
   3.8342281180696507`*^9}, {3.8342285497272263`*^9, 3.8342285512873898`*^9}, 
   3.8342286845553412`*^9, {3.8342289129671617`*^9, 3.83422894890386*^9}, {
   3.8342289879730783`*^9, 3.8342290278355627`*^9}, {3.834229069734519*^9, 
   3.8342290892183924`*^9}, {3.834229411503866*^9, 3.8342294359026985`*^9}, {
   3.834229798112156*^9, 3.834229801212369*^9}, 3.834230111388466*^9, {
   3.8342303649587345`*^9, 3.834230365122572*^9}, {3.8342321049924316`*^9, 
   3.834232105135909*^9}, {3.834232144446542*^9, 3.834232148267848*^9}, {
   3.83423219203887*^9, 3.834232205567011*^9}, {3.8342346193553123`*^9, 
   3.8342346217075663`*^9}, {3.8342347483948345`*^9, 
   3.8342347486968727`*^9}, {3.8342347818215237`*^9, 3.834234781956787*^9}, {
   3.834234849268795*^9, 3.834234849351416*^9}, {3.834494616862282*^9, 
   3.8344946195982*^9}, {3.8344957315684443`*^9, 3.834495755432167*^9}, 
   3.8344959929901443`*^9, {3.8344977367653284`*^9, 3.834497742601716*^9}, {
   3.8345518698990417`*^9, 3.834551876142047*^9}, {3.8345524028359947`*^9, 
   3.8345524464299517`*^9}, {3.8345531816839013`*^9, 3.834553182383978*^9}, {
   3.83455336373079*^9, 3.834553409472664*^9}, {3.8345535339906826`*^9, 
   3.8345535341653504`*^9}, {3.8345536618700113`*^9, 
   3.8345536630840807`*^9}, {3.8345538222810907`*^9, 3.834553822412078*^9}, {
   3.8345539058792353`*^9, 3.8345539063068867`*^9}, {3.834554517987525*^9, 
   3.8345545183391438`*^9}, 3.834555087407662*^9, {3.8345551791308556`*^9, 
   3.8345551872854805`*^9}, {3.8345572433773193`*^9, 
   3.8345572530723114`*^9}, {3.8345575555255547`*^9, 
   3.8345575955808754`*^9}, {3.834559512018237*^9, 3.834559569492124*^9}, {
   3.8345600982334538`*^9, 3.8345601045435534`*^9}, {3.834563401854307*^9, 
   3.8345634240080643`*^9}, 3.8345636251804075`*^9, {3.8346551325111756`*^9, 
   3.8346551753448925`*^9}, {3.8346552344681664`*^9, 3.834655304181864*^9}, {
   3.8346553460628304`*^9, 3.8346553528041925`*^9}, {3.834655408679802*^9, 
   3.834655444031911*^9}, {3.834659405581151*^9, 3.8346594083167953`*^9}, {
   3.834659541503255*^9, 3.834659559107936*^9}, 3.8346596434674244`*^9, {
   3.834737276273443*^9, 3.8347373435845304`*^9}, {3.834737482908969*^9, 
   3.8347375269184694`*^9}, {3.8347375910819626`*^9, 
   3.8347376008942895`*^9}, {3.834737663996065*^9, 3.834737665332523*^9}, {
   3.834737810417775*^9, 3.8347378391492176`*^9}, {3.8347379691078463`*^9, 
   3.834738011976391*^9}, {3.834739860495205*^9, 3.834739861576312*^9}, 
   3.8347402210253277`*^9, 3.834741020567172*^9, 3.83474108203646*^9, {
   3.8347413103789625`*^9, 3.8347413180830173`*^9}, {3.834742344779248*^9, 
   3.8347423777464466`*^9}, {3.8347425110390573`*^9, 3.8347425252971897`*^9},
    {3.8347427590169377`*^9, 3.834742790304908*^9}, {3.834742874317401*^9, 
   3.8347428759086885`*^9}, 3.834743873855624*^9, {3.834743960577525*^9, 
   3.8347440384672527`*^9}, {3.83474434634632*^9, 3.8347443499725914`*^9}, {
   3.834744630739745*^9, 3.834744665064474*^9}, {3.834745097177314*^9, 
   3.8347451101577215`*^9}, {3.8347455944651594`*^9, 3.834745626387727*^9}, {
   3.8347456924696264`*^9, 3.8347457017127733`*^9}, {3.8347457351797748`*^9, 
   3.834745743638447*^9}, {3.8347461376634903`*^9, 3.834746154128614*^9}, {
   3.834750318580298*^9, 3.834750347311762*^9}, {3.834750401708581*^9, 
   3.8347504168821187`*^9}, {3.8347512720052137`*^9, 
   3.8347512747483883`*^9}, {3.8351043682042475`*^9, 3.835104454380447*^9}, {
   3.8352627973955574`*^9, 3.8352628060275173`*^9}, 3.8352633320337257`*^9, {
   3.8352638838275023`*^9, 3.8352639450627127`*^9}, 3.8352639997130857`*^9, {
   3.8352659419082193`*^9, 3.8352659499625854`*^9}, {3.835270934043603*^9, 
   3.8352709460932465`*^9}, {3.8352714664873066`*^9, 3.835271472678788*^9}, {
   3.8352724447553406`*^9, 3.835272472812522*^9}, {3.8352726158389797`*^9, 
   3.8352726173632298`*^9}, {3.8352735729927096`*^9, 3.835273574589778*^9}, {
   3.835276824009726*^9, 3.835276824220297*^9}, {3.8352773956952953`*^9, 
   3.8352774006573057`*^9}, {3.8352775261197033`*^9, 
   3.8352775658970804`*^9}, {3.8352787058192205`*^9, 3.835278747377388*^9}, {
   3.8352790457802553`*^9, 3.8352790538616047`*^9}, {3.8352792565236397`*^9, 
   3.8352792642982397`*^9}, {3.8352794260231466`*^9, 3.83527942952204*^9}, 
   3.8352840904368963`*^9, {3.835284148944623*^9, 3.835284150744354*^9}, {
   3.835284354752838*^9, 3.835284367332793*^9}, {3.835350219786721*^9, 
   3.8353502794039392`*^9}, {3.835353403460533*^9, 3.8353534437751226`*^9}, {
   3.8353535310173388`*^9, 3.835353595733593*^9}, {3.835359717200655*^9, 
   3.8353597172215967`*^9}, {3.835359791638603*^9, 3.835359792411539*^9}, {
   3.8353598272011633`*^9, 3.835359828507738*^9}, {3.8354310157059116`*^9, 
   3.835431023396772*^9}, {3.8354427989185743`*^9, 3.8354428261406317`*^9}, {
   3.8354430728848968`*^9, 3.835443074973918*^9}, {3.8354432947417173`*^9, 
   3.835443294948242*^9}, {3.835443890422257*^9, 3.835443892147732*^9}, {
   3.835443922438773*^9, 3.8354439315752206`*^9}, {3.8354439632630544`*^9, 
   3.8354439666915045`*^9}, {3.8354440288617086`*^9, 3.835444036129401*^9}, {
   3.8354440663642855`*^9, 3.835444066406931*^9}, 3.835444119296938*^9, {
   3.835444374142645*^9, 3.8354444130125504`*^9}, {3.835444528159884*^9, 
   3.8354445420408278`*^9}, {3.8354446780217147`*^9, 3.835444680338628*^9}, {
   3.835444896408294*^9, 3.8354448975893106`*^9}, 3.8354462928089314`*^9, {
   3.835446451041568*^9, 3.8354464678955317`*^9}, {3.835693544059183*^9, 
   3.8356935536906834`*^9}, {3.835693994819949*^9, 3.8356939959941964`*^9}, {
   3.835694278531406*^9, 3.8356942925467367`*^9}, {3.8356944555189843`*^9, 
   3.835694505886602*^9}, {3.835694539795721*^9, 3.8356945746579976`*^9}, {
   3.8356947246868706`*^9, 3.835694794427763*^9}, {3.8356950208685627`*^9, 
   3.835695023838583*^9}, {3.8356950694516077`*^9, 3.8356950706434965`*^9}, {
   3.8356951149466333`*^9, 3.83569511755466*^9}, {3.835695278150486*^9, 
   3.8356952995196757`*^9}, {3.8356956162497506`*^9, 3.835695625853814*^9}, {
   3.835695695658022*^9, 3.835695700750407*^9}, {3.835696708974177*^9, 
   3.8356967486512794`*^9}, {3.835697466624745*^9, 3.8356975081319*^9}, 
   3.8356978232076674`*^9, 3.8356982151947374`*^9, 3.835698300846055*^9, 
   3.8356985685008945`*^9, {3.835705411004304*^9, 3.8357054119719296`*^9}, {
   3.8357866968149157`*^9, 3.835786703673458*^9}, {3.835786762144041*^9, 
   3.8357868198958807`*^9}, {3.83578685729443*^9, 3.8357868608439245`*^9}, {
   3.8357873073777494`*^9, 3.835787325714901*^9}, {3.8357874578158207`*^9, 
   3.835787479665737*^9}, {3.835788782826146*^9, 3.835788817606801*^9}, {
   3.835795910570995*^9, 3.8357959261326075`*^9}, {3.835795991480116*^9, 
   3.83579599719984*^9}, {3.835796490929779*^9, 3.8357964921458273`*^9}, {
   3.8357966262680664`*^9, 3.835796628568942*^9}, {3.835796699151533*^9, 
   3.8357967150165267`*^9}, {3.835863307200307*^9, 3.835863307778711*^9}, {
   3.8358634130235453`*^9, 3.8358634142905684`*^9}, 3.8358634529704514`*^9, {
   3.835863508848477*^9, 3.835863509722657*^9}, {3.835863582114009*^9, 
   3.8358635945555577`*^9}, {3.8358637919420757`*^9, 
   3.8358637934173565`*^9}, {3.8358638249680853`*^9, 
   3.8358638251595736`*^9}, {3.835863879146347*^9, 3.835863952817684*^9}, {
   3.8358643153496385`*^9, 3.8358643260201883`*^9}, {3.8358646455874076`*^9, 
   3.835864676220152*^9}, {3.835867156566808*^9, 3.8358671566816387`*^9}, 
   3.835891236413799*^9, {3.83589147110555*^9, 3.835891472419069*^9}, {
   3.835891563015162*^9, 3.835891564226922*^9}, 3.8362923284210424`*^9, {
   3.8362927396059985`*^9, 3.8362927613996377`*^9}, {3.836292933015648*^9, 
   3.8362929337090282`*^9}, {3.8362929782731314`*^9, 3.836292988963757*^9}, {
   3.8362930212799816`*^9, 3.8362930216832285`*^9}, 3.83629341775113*^9, {
   3.836293462060939*^9, 3.8362934842566223`*^9}, {3.836293634896948*^9, 
   3.836293647948881*^9}, {3.8362936805681915`*^9, 3.8362936943250637`*^9}, {
   3.836293773228959*^9, 3.836293795137538*^9}, {3.8362940478318253`*^9, 
   3.8362940521385517`*^9}, {3.8362941475479236`*^9, 3.8362941498457985`*^9}, 
   3.836295262320784*^9, {3.8362953282838025`*^9, 3.836295362327218*^9}, {
   3.836299759507194*^9, 3.8362998339978495`*^9}, {3.8363004960771275`*^9, 
   3.8363005086197214`*^9}, {3.8363043233217726`*^9, 
   3.8363043256252165`*^9}, {3.8363713174732027`*^9, 3.836371323322452*^9}, {
   3.836371730037118*^9, 3.836371745294092*^9}, 3.836371892107745*^9, {
   3.836372029441045*^9, 3.836372050533985*^9}, {3.8364997241591864`*^9, 
   3.8364997583051453`*^9}, {3.836499882042944*^9, 3.836499888330616*^9}, {
   3.836499928992248*^9, 3.836499932876887*^9}, {3.8365004066536207`*^9, 
   3.8365004071424294`*^9}, 3.83650073823086*^9, {3.8365015927151117`*^9, 
   3.8365015934960184`*^9}, 3.836502036059544*^9, {3.8365029908447514`*^9, 
   3.8365029934937773`*^9}, {3.8365034875735917`*^9, 3.836503508825096*^9}, {
   3.8365036138557453`*^9, 3.8365036255654955`*^9}, {3.836503863811722*^9, 
   3.8365038650494127`*^9}, {3.8365055579203253`*^9, 3.8365055732798977`*^9}, 
   3.836565508372319*^9, 3.8366494558721347`*^9, {3.836650253040857*^9, 
   3.8366502550845065`*^9}, {3.8366503320874724`*^9, 3.836650347911657*^9}, {
   3.836650451842273*^9, 3.836650452199303*^9}, {3.836650575018402*^9, 
   3.8366505764422226`*^9}, {3.8366508471974497`*^9, 3.836650854513962*^9}, {
   3.8366514871859956`*^9, 3.8366514907987766`*^9}, {3.83665185996222*^9, 
   3.8366518616007805`*^9}, {3.836659682940176*^9, 3.8366597192024307`*^9}, {
   3.8366599166606426`*^9, 3.8366599179252377`*^9}, {3.836660014477199*^9, 
   3.8366600530887733`*^9}, {3.83666029853846*^9, 3.836660298668085*^9}, {
   3.836660385177226*^9, 3.8366603953747377`*^9}, {3.8369013752612896`*^9, 
   3.836901382474041*^9}, 3.836909394461383*^9, {3.8369110368878374`*^9, 
   3.8369110463665433`*^9}, {3.8369110875542097`*^9, 3.836911088462817*^9}, {
   3.8369111195292816`*^9, 3.836911131170858*^9}, {3.8369113163235617`*^9, 
   3.836911333241973*^9}, {3.8369793931940165`*^9, 3.836979393270816*^9}, 
   3.8369884151830406`*^9, {3.8370003130794344`*^9, 3.8370003284400544`*^9}, 
   3.8370008472994223`*^9, 3.8370010875882425`*^9, 3.83707643974667*^9, {
   3.8370769817689276`*^9, 3.8370770218997016`*^9}, {3.8370775322867203`*^9, 
   3.837077551117998*^9}, {3.837081528009068*^9, 3.837081533518448*^9}, {
   3.8370836031090107`*^9, 3.837083699109723*^9}, {3.837084242151154*^9, 
   3.83708425013507*^9}, 3.837085433826521*^9, 3.8370855591709146`*^9, {
   3.8370860382993817`*^9, 3.837086056155198*^9}, {3.837622744130245*^9, 
   3.8376227480260324`*^9}, {3.837859016827242*^9, 3.8378590180423007`*^9}, {
   3.8378641287023973`*^9, 3.8378641305841665`*^9}, 3.8387037774228067`*^9, {
   3.838703863486642*^9, 3.8387039075750437`*^9}, 3.838703960494426*^9, {
   3.8387060181608567`*^9, 3.8387060213674927`*^9}, {3.8387063153166175`*^9, 
   3.8387063179157047`*^9}, {3.838706451588663*^9, 3.8387064532869177`*^9}, {
   3.838706515522448*^9, 3.8387065308393335`*^9}, {3.8387065873463297`*^9, 
   3.838706589596567*^9}, {3.8387067124287777`*^9, 3.8387067422686853`*^9}, {
   3.838706776945335*^9, 3.838706777052047*^9}, {3.838706860051341*^9, 
   3.8387068601041994`*^9}, 3.838706890259989*^9, {3.838706930068902*^9, 
   3.8387070440538898`*^9}, 3.838707199133776*^9, {3.838707234764006*^9, 
   3.8387072531507196`*^9}, {3.8387073067331533`*^9, 
   3.8387073080528393`*^9}, {3.8387122191694736`*^9, 
   3.8387122193200636`*^9}, {3.8387123268637457`*^9, 3.838712326937009*^9}, {
   3.8387126441786785`*^9, 3.838712703951831*^9}, 3.838712821339546*^9, {
   3.8387130715787764`*^9, 3.8387130826401124`*^9}, {3.8387250126264524`*^9, 
   3.838725012730221*^9}, 3.8387250546078444`*^9, {3.8387257721906986`*^9, 
   3.8387257919930353`*^9}, {3.8387265720278525`*^9, 3.838726621514262*^9}, {
   3.838726683666174*^9, 3.838726683739833*^9}, {3.8387291044340973`*^9, 
   3.8387291052848177`*^9}, {3.838729137997369*^9, 3.838729147796476*^9}, {
   3.838729273840051*^9, 3.838729305824171*^9}, {3.838729541552307*^9, 
   3.838729546564869*^9}, {3.8387296499051304`*^9, 3.838729650883513*^9}, {
   3.8387298914077616`*^9, 3.838729891604205*^9}, 3.8387299850100775`*^9, 
   3.838807320513543*^9, {3.8388073851936073`*^9, 3.8388073853422127`*^9}, 
   3.838807436282507*^9, {3.838807486589592*^9, 3.8388075155633607`*^9}, {
   3.8388075852296324`*^9, 3.8388075858560543`*^9}, {3.838808532213231*^9, 
   3.8388085368189497`*^9}, {3.8388147353974247`*^9, 3.838814752333818*^9}, {
   3.838814801367959*^9, 3.83881488464193*^9}, {3.8388149158999987`*^9, 
   3.8388150665490513`*^9}, {3.83881512488895*^9, 3.838815171399037*^9}, {
   3.838815220412312*^9, 3.8388152292356496`*^9}, {3.8388153184085712`*^9, 
   3.838815321421934*^9}, {3.8388156615140104`*^9, 3.8388156619737806`*^9}, {
   3.8388157232144194`*^9, 3.838815723892192*^9}, {3.8388164478672023`*^9, 
   3.8388164756447153`*^9}, {3.838816616358262*^9, 3.8388166174324474`*^9}, {
   3.8388167559382973`*^9, 3.8388167959932756`*^9}, {3.838817137249246*^9, 
   3.83881714486208*^9}, {3.8389726796372566`*^9, 3.8389727227103825`*^9}, 
   3.838973961016728*^9, {3.838975333062346*^9, 3.8389753413198276`*^9}, {
   3.838975794980774*^9, 3.8389757972356205`*^9}, {3.83897594685293*^9, 
   3.8389759645131674`*^9}, {3.8389762016251507`*^9, 
   3.8389762276950493`*^9}, {3.83897633150448*^9, 3.838976393406947*^9}, {
   3.838978518686409*^9, 3.8389785641243305`*^9}, {3.838978596661967*^9, 
   3.8389786003376317`*^9}, 3.83948954669807*^9, {3.8394897458719177`*^9, 
   3.83948976807983*^9}, 3.8395852581190248`*^9, {3.83967029428496*^9, 
   3.8396702952084894`*^9}, {3.8396747240741568`*^9, 3.839674724428211*^9}, {
   3.839674822188491*^9, 3.8396748233470306`*^9}, {3.839678828244278*^9, 
   3.8396788461203275`*^9}, {3.8396788869827957`*^9, 
   3.8396788942517657`*^9}, {3.8396789377379527`*^9, 3.839678938937684*^9}, {
   3.8397488691007156`*^9, 3.8397489244298058`*^9}, {3.8397497284378505`*^9, 
   3.839749731376681*^9}, 3.839749790114192*^9, {3.8400820854140434`*^9, 
   3.84008211417599*^9}, {3.8400883772690215`*^9, 3.8400884007726717`*^9}, {
   3.840088665216819*^9, 3.8400886782056785`*^9}, {3.8400887082583933`*^9, 
   3.8400887349858093`*^9}, {3.8400890206638927`*^9, 3.840089020689823*^9}, 
   3.8400892030475173`*^9, 3.840089309178661*^9, 3.840089461694362*^9, 
   3.840090077221657*^9, {3.840092703404687*^9, 3.840092708043317*^9}, {
   3.84009503209192*^9, 3.8400950903231616`*^9}, {3.840095125731958*^9, 
   3.8400951588730226`*^9}, {3.840095202802575*^9, 3.840095274717676*^9}, {
   3.840096749665765*^9, 3.840096841010545*^9}, {3.840096884680351*^9, 
   3.8400968876404343`*^9}, {3.8400969252446117`*^9, 3.840096926178116*^9}, {
   3.8400973859569273`*^9, 3.840097404449317*^9}, {3.840109360796713*^9, 
   3.8401093889907475`*^9}, {3.8401096382355633`*^9, 3.840109669799535*^9}, {
   3.840109932357836*^9, 3.840109959733439*^9}, 3.840110011058334*^9, {
   3.840110194824031*^9, 3.840110195474265*^9}, {3.840110349306212*^9, 
   3.840110356035718*^9}, {3.8401104560477*^9, 3.840110462371459*^9}, {
   3.8401114001666327`*^9, 3.840111428450158*^9}, {3.840111538352724*^9, 
   3.840111545601219*^9}, {3.8401119085336747`*^9, 3.840111913821644*^9}, {
   3.8401757111946945`*^9, 3.84017571315217*^9}, 3.8401878788650694`*^9, 
   3.8401880039652853`*^9, 3.840192443027732*^9, {3.8401924787402835`*^9, 
   3.8401925207877045`*^9}, {3.8402034008168073`*^9, 
   3.8402034009275384`*^9}, {3.8402106423221855`*^9, 3.8402106496555486`*^9}, 
   3.8405253498713326`*^9, 3.840526819413786*^9, {3.8405340776422014`*^9, 
   3.840534081971678*^9}, {3.840560127713051*^9, 3.8405601454781504`*^9}, {
   3.840610454082411*^9, 3.840610460100666*^9}, {3.8406133884557953`*^9, 
   3.840613401849535*^9}, {3.840615707849498*^9, 3.8406157091651225`*^9}, {
   3.8406157417562294`*^9, 3.840615756196437*^9}, {3.840616214107032*^9, 
   3.840616222004145*^9}, {3.8406175953424487`*^9, 3.840617596359184*^9}, {
   3.840617784438449*^9, 3.8406177849426403`*^9}, 3.840619376269943*^9, 
   3.840624703233392*^9, {3.8406249907127275`*^9, 3.840625045856043*^9}, {
   3.8406251004595056`*^9, 3.8406251058861113`*^9}, {3.8406251513803825`*^9, 
   3.840625162613037*^9}, {3.8406913700836353`*^9, 3.840691374342325*^9}, {
   3.8407088521920075`*^9, 3.8407089683719215`*^9}, {3.8407090148231106`*^9, 
   3.8407090236426353`*^9}, {3.8407099550336266`*^9, 3.840709981154108*^9}, {
   3.840717815579465*^9, 3.8407178216351247`*^9}, {3.8407364669810433`*^9, 
   3.840736487022564*^9}, {3.840736563589631*^9, 3.84073659654053*^9}, {
   3.8407375542126307`*^9, 3.8407375605632353`*^9}, {3.840739417385324*^9, 
   3.8407394216242676`*^9}, {3.8407394635525*^9, 3.8407394772953773`*^9}, {
   3.8407418395238967`*^9, 3.840741845556447*^9}, {3.840742016635727*^9, 
   3.8407420365366645`*^9}, {3.840742664103594*^9, 3.840742671033725*^9}, {
   3.8407736789116926`*^9, 3.840773687525275*^9}, 3.840774830847293*^9, {
   3.840774863708972*^9, 3.840774899354582*^9}, {3.840774975238425*^9, 
   3.8407750101950197`*^9}, {3.840775042390847*^9, 3.840775051475642*^9}, {
   3.840775118225168*^9, 3.840775121161971*^9}, {3.840779856546139*^9, 
   3.8407798624680133`*^9}, {3.8407821603137264`*^9, 
   3.8407822190148506`*^9}, {3.8407826899757395`*^9, 3.840782701511594*^9}, {
   3.840787922299094*^9, 3.8407879360099473`*^9}, {3.8408076507541866`*^9, 
   3.8408076626058435`*^9}, {3.8408078551150475`*^9, 
   3.8408078622905226`*^9}, {3.8408238447555346`*^9, 3.840823852550036*^9}, {
   3.840824997117646*^9, 3.840825031084796*^9}, {3.8408251123900394`*^9, 
   3.840825124266282*^9}, 3.8408257171884713`*^9, 3.8408257899166565`*^9, 
   3.840826027847034*^9, 3.8408260678188887`*^9, 3.840826111637298*^9, {
   3.8408618446402907`*^9, 3.8408618448377647`*^9}, {3.840862244826796*^9, 
   3.8408622808396597`*^9}, 3.8408623128293457`*^9, {3.8408627329248114`*^9, 
   3.8408627413051777`*^9}, {3.8408628379302125`*^9, 
   3.8408628502010336`*^9}, {3.840862973479486*^9, 3.840862979640998*^9}, {
   3.840863033299103*^9, 3.840863033588437*^9}, {3.84086320329943*^9, 
   3.8408632081897783`*^9}, {3.840863246055991*^9, 3.8408632753847466`*^9}, {
   3.840863308669248*^9, 3.840863308825802*^9}, {3.840871311071906*^9, 
   3.84087131823066*^9}, {3.8408892313113422`*^9, 3.840889293638271*^9}, {
   3.8408893254874444`*^9, 3.8408894493968687`*^9}, {3.840983389749174*^9, 
   3.8409834196639304`*^9}, {3.841064382578246*^9, 3.841064401625284*^9}, {
   3.841064467242749*^9, 3.8410645007277436`*^9}, {3.841064700787324*^9, 
   3.841064717401457*^9}, {3.841576379088559*^9, 3.841576380140915*^9}, {
   3.841579726493216*^9, 3.841579727026785*^9}, 3.841660549778963*^9, {
   3.84260134779129*^9, 3.842601352129122*^9}, {3.8426013954176083`*^9, 
   3.8426014551177187`*^9}, {3.842601620473235*^9, 3.842601649281769*^9}, {
   3.84260176293493*^9, 3.8426017782873096`*^9}, {3.842601815997072*^9, 
   3.842601873228985*^9}, {3.8426022043781567`*^9, 3.842602207176673*^9}, {
   3.842720315280761*^9, 3.8427203325106273`*^9}, {3.842723549352269*^9, 
   3.842723586191605*^9}, {3.8432919250484514`*^9, 3.843291948554965*^9}, {
   3.843389197373535*^9, 3.843389200515275*^9}, {3.843396069806519*^9, 
   3.8433960702552433`*^9}, {3.8434694952630386`*^9, 3.843469502097273*^9}, {
   3.843472887265674*^9, 3.8434728974213715`*^9}, {3.843561999257634*^9, 
   3.843562033542877*^9}, {3.843564937665353*^9, 3.843564938050634*^9}, {
   3.8438976281353874`*^9, 3.8438976284605217`*^9}, {3.84389842211734*^9, 
   3.843898426704467*^9}, {3.8438992331605854`*^9, 3.843899252349367*^9}, {
   3.843899295448146*^9, 3.8438992955770183`*^9}, {3.8438993999312572`*^9, 
   3.8438994070468893`*^9}, {3.843900360991686*^9, 3.843900363254033*^9}, {
   3.8439004285256157`*^9, 3.843900431317151*^9}, {3.843900768592288*^9, 
   3.8439007745507913`*^9}, {3.8439008470935755`*^9, 
   3.8439008500780396`*^9}, {3.843901895979074*^9, 3.8439018983512545`*^9}, {
   3.8439020859758005`*^9, 3.8439021023179274`*^9}, {3.8439021663194385`*^9, 
   3.8439021664422235`*^9}, {3.8439022259456787`*^9, 
   3.8439022470643682`*^9}, {3.8439024035046625`*^9, 3.843902417216997*^9}, {
   3.8439030560500603`*^9, 3.843903100951792*^9}, {3.8439034159682755`*^9, 
   3.843903418518445*^9}, {3.8439075159305773`*^9, 3.8439075160562415`*^9}, {
   3.843908353420589*^9, 3.8439083535661983`*^9}, 3.8447696270915794`*^9, {
   3.844769740735922*^9, 3.8447697910378356`*^9}, {3.84477037340423*^9, 
   3.844770373610673*^9}, 3.844770669592698*^9, {3.844771723304075*^9, 
   3.844771739984375*^9}, {3.8447721633087015`*^9, 3.8447721647524443`*^9}, {
   3.8447725745218353`*^9, 3.8447725943153896`*^9}, {3.8447726804579096`*^9, 
   3.8447726874165015`*^9}, {3.844772805150721*^9, 3.8447729218279753`*^9}, {
   3.84477368028374*^9, 3.8447736962387524`*^9}, {3.8447737508474393`*^9, 
   3.8447737536509695`*^9}, {3.8447749771384516`*^9, 
   3.8447750157930655`*^9}, {3.844775063761511*^9, 3.844775104127839*^9}, {
   3.844775367335239*^9, 3.844775371404151*^9}, {3.8447754602998905`*^9, 
   3.8447755145910835`*^9}, {3.844775759746072*^9, 3.8447757599405537`*^9}, {
   3.844790193581585*^9, 3.8447902273935037`*^9}, {3.8447922394332933`*^9, 
   3.8447923391941533`*^9}, {3.844792387040404*^9, 3.8447923874961843`*^9}, {
   3.844792523066445*^9, 3.8447925276289935`*^9}, {3.844792833191795*^9, 
   3.8447928402397304`*^9}, {3.8453787044670343`*^9, 
   3.8453787135365458`*^9}, {3.8453787497546687`*^9, 
   3.8453787682550893`*^9}, {3.845379455135282*^9, 3.845379460875099*^9}, 
   3.8454598366660547`*^9, {3.845462626974681*^9, 3.8454626482984667`*^9}, {
   3.845462683272417*^9, 3.8454626903115873`*^9}, {3.8454628485105886`*^9, 
   3.8454628487798967`*^9}, {3.8454628933974047`*^9, 3.845462904025504*^9}, {
   3.8454629949398766`*^9, 3.845463078808112*^9}, 3.8454631510656495`*^9, {
   3.8454631839474754`*^9, 3.8454633294813185`*^9}, {3.8454633697885885`*^9, 
   3.845463441837059*^9}, {3.845463628764634*^9, 3.845463637379357*^9}, {
   3.8454636867873983`*^9, 3.8454637556242533`*^9}, {3.8454638951974306`*^9, 
   3.8454638959523807`*^9}, {3.845464105342784*^9, 3.8454641078464956`*^9}, {
   3.8454641731350217`*^9, 3.845464174378718*^9}, {3.8454642939516993`*^9, 
   3.845464302930358*^9}, {3.845464393451737*^9, 3.845464436016609*^9}, {
   3.845464518118712*^9, 3.845464518192505*^9}, {3.8454646018766537`*^9, 
   3.8454646139525394`*^9}, {3.845465084565342*^9, 3.8454651153794174`*^9}, {
   3.8454652408667026`*^9, 3.8454652728636475`*^9}, 3.8454653726591005`*^9, {
   3.8454654491217623`*^9, 3.845465485034954*^9}, 3.845465706310853*^9, 
   3.845465807726363*^9, {3.845465978698958*^9, 3.8454659800247335`*^9}, {
   3.8454668273094974`*^9, 3.8454668285062966`*^9}, {3.84546691193655*^9, 
   3.8454669284798346`*^9}, {3.8454669722017565`*^9, 
   3.8454670266010485`*^9}, {3.845467159507826*^9, 3.8454671607654676`*^9}, {
   3.845467199137821*^9, 3.845467209536069*^9}, {3.845467544245125*^9, 
   3.845467553359436*^9}, {3.8454681180409217`*^9, 3.8454681207677965`*^9}, {
   3.845472440790207*^9, 3.8454724422312193`*^9}, {3.845472494550941*^9, 
   3.8454725106159782`*^9}, {3.84547270329558*^9, 3.845472755072115*^9}, 
   3.845472816984696*^9, {3.845475777732094*^9, 3.845475791237212*^9}, {
   3.84548049712738*^9, 3.845480522455495*^9}, {3.845480599133217*^9, 
   3.8454806053275156`*^9}, {3.8454808245464354`*^9, 
   3.8454809688992643`*^9}, {3.845481298992482*^9, 3.8454813012609277`*^9}, {
   3.8454813614085474`*^9, 3.845481389990655*^9}, {3.8454814653304186`*^9, 
   3.8454814811970015`*^9}, {3.8454815447880096`*^9, 3.84548155253049*^9}, {
   3.8454816206159153`*^9, 3.8454816290257177`*^9}, {3.845636030653737*^9, 
   3.8456360695698347`*^9}, {3.8456361042991014`*^9, 3.8456361077448845`*^9}, 
   3.845636258837479*^9, {3.8456373923964767`*^9, 3.845637413210247*^9}, {
   3.845637449883906*^9, 3.845637453607705*^9}, {3.845637527841682*^9, 
   3.845637529500245*^9}, {3.845637881586076*^9, 3.845637892312873*^9}, {
   3.84563859770162*^9, 3.8456385978455706`*^9}, 3.8456386748945303`*^9, {
   3.845643663479514*^9, 3.845643672338909*^9}, {3.845651068959772*^9, 
   3.8456511378946853`*^9}, {3.8456512462956195`*^9, 3.8456512485032167`*^9}, 
   3.845651607865865*^9, 3.8456601340544605`*^9, {3.845919242440591*^9, 
   3.845919256222426*^9}, {3.8459195868615904`*^9, 3.845919587196694*^9}, {
   3.8459201454225965`*^9, 3.8459201517162895`*^9}, {3.845920277469014*^9, 
   3.845920288235237*^9}, {3.8552330672765694`*^9, 3.8552331229912825`*^9}, {
   3.855233166541771*^9, 3.855233170129868*^9}, {3.855233349130003*^9, 
   3.855233356390868*^9}, {3.8552665881593184`*^9, 3.855266590517723*^9}, {
   3.855320552903469*^9, 3.8553205733132553`*^9}, 3.8559041815201707`*^9, {
   3.8559094387996855`*^9, 3.8559095372925987`*^9}, {3.8560033732631245`*^9, 
   3.856003447580434*^9}, {3.8560035620599527`*^9, 3.8560035631460485`*^9}, {
   3.8560036235734663`*^9, 3.8560036236462717`*^9}, {3.856003747955799*^9, 
   3.856003797991005*^9}, 3.8560053805920105`*^9, {3.8560059886692896`*^9, 
   3.856006003961426*^9}, {3.8565219659993515`*^9, 3.8565219661359863`*^9}, {
   3.8568580801012907`*^9, 3.8568580805111675`*^9}, {3.8568581631557493`*^9, 
   3.856858171107267*^9}, {3.857031551609365*^9, 3.857031593040383*^9}, {
   3.8570324331206713`*^9, 3.8570324336613874`*^9}, {3.8570328103244953`*^9, 
   3.857032842587246*^9}, {3.857033129989189*^9, 3.8570331581724854`*^9}, {
   3.857033209276514*^9, 3.857033219366157*^9}, {3.857033329513674*^9, 
   3.857033331045577*^9}, 3.857033373391923*^9, {3.8570334467664614`*^9, 
   3.8570334476892557`*^9}, {3.8570335785342464`*^9, 
   3.8570335794777236`*^9}, {3.857043433714692*^9, 3.857043483681079*^9}, {
   3.8570435164820013`*^9, 3.8570435422965937`*^9}, {3.857043662257098*^9, 
   3.8570437420493264`*^9}, {3.8570437998836746`*^9, 3.8570438183612638`*^9}, 
   3.857045809617427*^9, {3.857047477953663*^9, 3.8570475394213376`*^9}, {
   3.8570501043777246`*^9, 3.8570501077217817`*^9}, 3.857050221123862*^9, {
   3.8576417891356964`*^9, 3.857641817160014*^9}, {3.857641907409687*^9, 
   3.8576419986024466`*^9}, {3.8576420332983627`*^9, 3.8576423408283772`*^9}, 
   3.857642489051423*^9, {3.8613044267477694`*^9, 3.861304463835037*^9}, {
   3.861304497217451*^9, 3.861304507871649*^9}, {3.8613049025476675`*^9, 
   3.861304903226077*^9}, 3.861306043371339*^9, {3.861306401285838*^9, 
   3.861306407541149*^9}, {3.861307082310999*^9, 3.8613071304030714`*^9}, {
   3.861307309077665*^9, 3.8613073131556487`*^9}, {3.8613073718463173`*^9, 
   3.8613073856972656`*^9}, {3.861307461807596*^9, 3.8613074876252947`*^9}, 
   3.8613495841839314`*^9, {3.8621259196898007`*^9, 3.862125933877152*^9}, {
   3.8621261649935093`*^9, 3.8621261761805835`*^9}, {3.862128042629808*^9, 
   3.8621281231648808`*^9}, 3.8621295715238934`*^9, {3.862129912643568*^9, 
   3.8621299256897507`*^9}, 3.862133743877163*^9, 3.8647220070009556`*^9, 
   3.864722314757043*^9, {3.8647225569942493`*^9, 3.864722565629339*^9}, {
   3.8647225968525414`*^9, 3.864722719522914*^9}, {3.8647227582639112`*^9, 
   3.8647227842161975`*^9}, {3.8647229791569643`*^9, 
   3.8647229871183686`*^9}, {3.864723238684296*^9, 3.864723251244439*^9}, {
   3.864723568058051*^9, 3.864723578994544*^9}, {3.8654291513870816`*^9, 
   3.8654291532650614`*^9}, {3.865429192517581*^9, 3.8654292521043034`*^9}, {
   3.8654292941092443`*^9, 3.865429318608734*^9}, {3.8654294808157363`*^9, 
   3.8654294928600693`*^9}, {3.8654295952783136`*^9, 3.86542961018157*^9}, {
   3.8654300619786043`*^9, 3.8654300648100357`*^9}, {3.865430312083802*^9, 
   3.8654303141194806`*^9}, {3.865430438999164*^9, 3.8654304445369377`*^9}, {
   3.865430601700062*^9, 3.8654306141118364`*^9}, {3.8654307516345496`*^9, 
   3.865430754413395*^9}, {3.865430802290111*^9, 3.8654308047491465`*^9}, {
   3.865435968540002*^9, 3.8654359937413244`*^9}, {3.8655262916075735`*^9, 
   3.8655263062813654`*^9}, {3.865526511200266*^9, 3.86552651191707*^9}, 
   3.8655270853898706`*^9, {3.8655301621158304`*^9, 3.865530177800084*^9}, {
   3.8683570234227953`*^9, 3.8683570471722956`*^9}, {3.86835709135244*^9, 
   3.868357094866644*^9}, 3.868357265919504*^9, {3.8806596753591566`*^9, 
   3.8806597010039682`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellTags->"codetag",
 CellLabel->
  "In[220]:=",ExpressionUUID->"d75933fb-6072-4833-b732-3951906ed5a9"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["V Experimental Data",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
   3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
   3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
   3.832654871762952*^9, 3.832654885257023*^9}, {3.832672208050552*^9, 
   3.8326722080944057`*^9}, {3.8346684928733644`*^9, 3.834668495684127*^9}, {
   3.8352692880421944`*^9, 3.835269290483378*^9}, {3.835448468221949*^9, 
   3.8354484687074327`*^9}, {3.835448507666094*^9, 3.83544851220776*^9}, {
   3.836385875632767*^9, 3.8363858804596214`*^9}, 3.8369094369477243`*^9, {
   3.8370047163877687`*^9, 3.837004716653504*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellTags->"codetag",ExpressionUUID->"55bbcfc0-ffaf-418d-93f4-d13619f4499e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getData", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"dtxfolder", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Data\>\"", ",", 
          "dtxfolder"}], "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "All", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dtxAll", "=", 
       RowBox[{
        RowBox[{"Import", "[", "\"\<cell_export.xls\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtxAllID", "=", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"dtxAll", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtxAllArea", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"dtxAll", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dtxAllPolN", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"dtxAll", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dtxAssocArea", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"dtxAllID", "->", "dtxAllArea"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dtxAssocPolN", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"dtxAllID", "->", "dtxAllPolN"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dtxAllPts", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"dtxAll", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtxAssocPts", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"dtxAllID", "->", "dtxAllPts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "SOP", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dtxSOP", "=", 
       RowBox[{
        RowBox[{"Import", "[", "\"\<CellColorTag_SOPs_tracked.xls\>\"", "]"}],
         "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtxSOPID", "=", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"dtxSOP", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SOP", " ", "DISTANCE", " ", 
        RowBox[{"(", "#", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dtxSOPdist", "=", 
         RowBox[{
          RowBox[{"Import", "[", "\"\<results.xlsx\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dtxSOPdistN", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"dtxSOPdist", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"dtxSOPdistE", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"dtxSOPdist", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NON", "-", "SOP"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dtxNonSOPID", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"dtxAllID", ",", "dtxSOPID"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "CALCULATIONS", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"meshxa", "=", 
       RowBox[{"Mean", "@", "dtxAllArea"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mndtxp", "=", 
       RowBox[{"Mean", "@", "dtxAllPts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pts", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "mndtxp"}], "&"}], "/@", "dtxAllPts"}], ")"}], 
        "/", 
        RowBox[{"Sqrt", "@", "meshxa"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meshx", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"pts", ",", "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hexagons", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"3", "<=", 
            RowBox[{"Length", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"Area", "[", "#", "]"}], "<", "4"}]}], "&"}], "]"}], "@", 
        
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"meshx", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "\"\<Interior\>\""}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mesh", "=", 
       RowBox[{"DiscretizeGraphics", "@", 
        RowBox[{"Graphics", "@", "hexagons"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"mesh", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"regcs", "=", 
       RowBox[{"RegionCentroid", "/@", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"mesh", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"regccs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{"regcs", ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "-", "mndtxp"}], "&"}], "/@", "dtxAssocPts"}], 
               ")"}], "/", 
              RowBox[{"Sqrt", "@", "meshxa"}]}], ",", "dtxSOPID"}], "]"}]}], 
          "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"regsop", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"regcs", ",", "#"}], "]"}], "&"}], ",", "regccs"}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sopgr", "=", 
       RowBox[{
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"mesh", ",", "2"}], "]"}], "[", 
        RowBox[{"[", "regsop", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"regccs1", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"regccs", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], "&"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"regccs2", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"regccs", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&"}]}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.836466682383172*^9, 3.8364668459752226`*^9}, {
  3.8364669219771404`*^9, 3.8364669241535835`*^9}, {3.836467146262477*^9, 
  3.8364671532423654`*^9}, {3.8364671901261654`*^9, 3.8364672047363925`*^9}, {
  3.8364672812001066`*^9, 3.83646729107837*^9}, {3.8364673908923974`*^9, 
  3.8364673998115463`*^9}, {3.8364675603365345`*^9, 3.836467599594101*^9}, {
  3.836470750441229*^9, 3.836470790126613*^9}, {3.836484083500809*^9, 
  3.8364841069674234`*^9}, {3.83649902491037*^9, 3.836499025038046*^9}, {
  3.8365004568886375`*^9, 3.836500457030476*^9}, {3.8365020859199443`*^9, 
  3.8365021098521748`*^9}, {3.836502385033078*^9, 3.8365023859223495`*^9}, {
  3.8365655631661425`*^9, 3.8365655640820413`*^9}, {3.8369051947037897`*^9, 
  3.836905197356698*^9}, {3.8369988269382153`*^9, 3.836998833583016*^9}, {
  3.8378573164644513`*^9, 3.8378573166120567`*^9}, {3.8378610325971317`*^9, 
  3.8378610354518576`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[221]:=",ExpressionUUID->"9ef36f7b-3b88-45a0-b8bc-8cd4d6b2d20b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Interactive Epithelium",
 FontFamily->"Alegreya SC",
 FontColor->RGBColor[0.6, 0.4, 0.2]]], "Chapter",
 CellChangeTimes->{{3.825062232625661*^9, 3.8250622369096427`*^9}, {
  3.8250622908428144`*^9, 3.825062291995398*^9}, {3.8326544637428036`*^9, 
  3.8326544786500597`*^9}, {3.832654568833205*^9, 3.8326546032939997`*^9}, {
  3.832654871762952*^9, 3.832654885257023*^9}, {3.832672208050552*^9, 
  3.8326722080944057`*^9}, {3.8346684928733644`*^9, 3.834668495684127*^9}, {
  3.836302854643711*^9, 3.8363028825435247`*^9}, {3.8363872733448524`*^9, 
  3.836387273585205*^9}, {3.836817784166114*^9, 3.836817785438017*^9}, {
  3.837622758203437*^9, 3.8376227591369314`*^9}, {3.8671519805053997`*^9, 
  3.8671519832313833`*^9}, {3.8671539187073755`*^9, 3.867153924450343*^9}},
 Background->RGBColor[
  0.792156862745098, 0.9333333333333333, 
   0.792156862745098],ExpressionUUID->"3e170d52-d1b6-482e-adfe-878a73395286"],

Cell[BoxData[
 StyleBox[
  RowBox[{"InteractiveEpithelium", "[", "]"}],
  FontFamily->"Alegreya SC",
  FontColor->RGBColor[0.6, 0.4, 0.2]]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.834668368191771*^9, 3.8346683884041777`*^9}, {
   3.8347362276275625`*^9, 3.834736228789454*^9}, {3.8348275687498684`*^9, 
   3.8348275944797616`*^9}, {3.8352011636617017`*^9, 
   3.8352011863167067`*^9}, {3.8357059962631416`*^9, 
   3.8357060009553375`*^9}, {3.835706137071783*^9, 3.83570613828486*^9}, {
   3.8358633149567547`*^9, 3.8358633155262833`*^9}, {3.836293712461643*^9, 
   3.8362937136374097`*^9}, {3.8363029082343154`*^9, 
   3.8363029096469765`*^9}, {3.836305601142601*^9, 3.8363056158998694`*^9}, {
   3.8363056751268578`*^9, 3.836305680841942*^9}, {3.836312720847243*^9, 
   3.836312721919713*^9}, {3.8363139870807457`*^9, 3.836313988046317*^9}, 
   3.8363154251352253`*^9, {3.836317101352694*^9, 3.836317101720927*^9}, {
   3.836319818411486*^9, 3.8363198185072007`*^9}, {3.8363230361346903`*^9, 
   3.8363230362743163`*^9}, 3.836377270975813*^9, {3.836380817636466*^9, 
   3.836380817690313*^9}, {3.8364844053419046`*^9, 3.8364844054226885`*^9}, {
   3.83690887347248*^9, 3.836908873542318*^9}, 3.8369913226242146`*^9, {
   3.836998472196334*^9, 3.8369984722741175`*^9}, {3.8369990195659866`*^9, 
   3.836999023790287*^9}, {3.837005560852146*^9, 3.837005565390813*^9}, 
   3.8370056358875465`*^9, {3.837626103533386*^9, 3.83762611663646*^9}, {
   3.8378654623495784`*^9, 3.83786546243136*^9}, {3.838730842241068*^9, 
   3.838730842902563*^9}, {3.838816528454029*^9, 3.83881652855892*^9}, {
   3.8396786153341427`*^9, 3.839678615914133*^9}, {3.840090245038767*^9, 
   3.8400902455175104`*^9}, {3.8405360483587494`*^9, 
   3.8405360484225783`*^9}, {3.84166124815866*^9, 3.841661249515107*^9}, {
   3.843913273213315*^9, 3.843913288602869*^9}, {3.8459158764685507`*^9, 
   3.845915877465892*^9}, {3.8559084212951536`*^9, 3.8559084220700817`*^9}, {
   3.855908741310237*^9, 3.8559087423368883`*^9}, {3.8571344431023827`*^9, 
   3.857134444951438*^9}},
 FontSize->16,
 Background->RGBColor[
  0.792156862745098, 0.9333333333333333, 0.792156862745098],
 CellLabel->
  "In[222]:=",ExpressionUUID->"85383d1a-a28d-4c5f-9f3c-fc79b9b170ed"]
}, Open  ]]
},
NotebookEventActions->{
 "WindowClose" :> (
   Map[(FrontEndTokenExecute["DeleteGeneratedCells"]; 
     SelectionMove[#, All, Cell]; 
     FrontEndTokenExecute["SelectionCloseAllGroups"]; 
     Null)& , $CellContext`cellObjs]; Null)},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
SpellingDictionaries->{"CorrectWords"->{"Farhadifar's"}},
Magnification:>0.7 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"03e24c21-5e95-4b4f-b991-877f73ab62a7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "codetag"->{
  Cell[2232, 58, 692, 12, 51, "Section",ExpressionUUID->"f5b1c457-01cb-4338-be9b-e8395d123dd5",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[2949, 74, 755, 12, 48, "Subsection",ExpressionUUID->"fafd933b-3cf8-470e-b533-54cf079c83d9",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[3707, 88, 10520, 167, 218, "Input",ExpressionUUID->"3dd97646-9dcf-481e-ae9a-f62f24f2150d",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[14264, 260, 500, 8, 48, "Subsection",ExpressionUUID->"115e6658-3a3f-4e65-8338-0eb4c442a122",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[14789, 272, 823, 13, 43, "Subsubsection",ExpressionUUID->"43781ef2-a5e6-46e0-ad66-0f9b951abb2d",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[85088, 1687, 718, 12, 51, "Section",ExpressionUUID->"9193ecb9-32f8-4da2-bc51-b6cc70cf7761",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[85831, 1703, 842, 13, 48, "Subsection",ExpressionUUID->"14d9d1af-a823-466d-936b-5397bbc717e7",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[86676, 1718, 16864, 241, 58, "Input",ExpressionUUID->"b48a3a27-b8ac-4944-9365-c1d822bf61a6",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[103577, 1964, 771, 12, 38, "Subsection",ExpressionUUID->"6965c3f3-0a09-495e-be8e-d91812854299",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[104373, 1980, 708, 11, 43, "Subsubsection",ExpressionUUID->"17439844-4c74-4e24-8f23-9de8f2189807",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[105084, 1993, 4731, 103, 151, "Input",ExpressionUUID->"b8ef69f4-b39c-4568-94c5-6ff81ce75cdb",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[109852, 2101, 761, 12, 38, "Subsubsection",ExpressionUUID->"0fb7dce3-3d99-4ad8-aa9d-5248f675e8ce",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[110616, 2115, 4924, 91, 285, "Input",ExpressionUUID->"89548b47-52e6-4daf-b2fd-9bd745022a34",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[115577, 2211, 756, 12, 38, "Subsubsection",ExpressionUUID->"185fef26-9eea-4b78-815e-c88c518d4804",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[116336, 2225, 4317, 75, 178, "Input",ExpressionUUID->"d1a8fd94-6836-4e4c-815b-264062c5a702",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[120690, 2305, 709, 11, 38, "Subsubsection",ExpressionUUID->"ad4b5aeb-0191-4e7d-9280-6c158f9427c3",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[121402, 2318, 23438, 428, 657, "Input",ExpressionUUID->"611bdf8c-e18e-4751-a3c0-d204533b0f9f",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[144865, 2750, 565, 17, 35, "Input",ExpressionUUID->"2759c0f7-ab79-45f4-b59a-195e6dbc3a9a",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[145433, 2769, 228, 5, 70, "Output",ExpressionUUID->"1676e10e-ba5d-4dc2-bca0-fe079c2372a3",
   CellTags->"codetag"],
  Cell[145698, 2779, 2080, 55, 114, "Input",ExpressionUUID->"143c3955-9162-4fed-9972-b8af524e265d",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[147781, 2836, 243, 5, 70, "Output",ExpressionUUID->"40d7d676-e4a6-4f99-8343-1103062578dd",
   CellTags->"codetag"],
  Cell[148097, 2849, 658, 11, 51, "Section",ExpressionUUID->"661494ca-ef7e-4d69-8288-45d70b6edd5e",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[148780, 2864, 859, 13, 48, "Subsection",ExpressionUUID->"346b2c59-f8f4-4332-bcd4-8278647a60f4",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[163209, 3160, 6778, 163, 151, "Input",ExpressionUUID->"7f214d9d-cfaa-493b-88d7-37e124271643",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[169990, 3325, 12348, 262, 484, "Input",ExpressionUUID->"1f204ace-288e-4d47-9339-8c139c9cfbb5",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[182341, 3589, 7916, 167, 125, "Input",ExpressionUUID->"3a5e2392-d240-4f7a-bc66-9d48bd3501cf",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[193348, 3844, 901, 14, 48, "Subsection",ExpressionUUID->"9dd62609-0be5-441e-a6d4-5a76052af921",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[294355, 6058, 900, 14, 38, "Subsection",ExpressionUUID->"e7ff0c19-31d7-4e81-9c80-8dc41f7a2c19",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[329446, 6900, 873, 13, 38, "Subsection",ExpressionUUID->"9b401317-068f-44f1-b72b-982338d04140",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[330322, 6915, 24063, 561, 817, "Input",ExpressionUUID->"abe77338-1ee6-413c-9388-5fcc6e3f2ed0",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[354388, 7478, 23417, 522, 1004, "Input",ExpressionUUID->"7c14710b-e35b-4f6d-80a5-6dbc0ffe2743",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[377808, 8002, 43557, 940, 1909, "Input",ExpressionUUID->"a6a8b7ee-ea94-47bb-a4c5-ef5acbda0c3e",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[421368, 8944, 26949, 468, 684, "Input",ExpressionUUID->"aa9894db-8484-4180-bc9b-4a044ba673f2",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[448354, 9417, 754, 12, 48, "Subsection",ExpressionUUID->"8f686246-3ffb-4968-9947-c6f97814a846",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[449111, 9431, 139935, 2486, 5292, "Input",ExpressionUUID->"73acf02e-9eae-4023-b010-5d7828bb67dc",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[589083, 11922, 751, 12, 48, "Subsection",ExpressionUUID->"6b588259-a233-43c3-aa3f-764ad1952bfb",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[589837, 11936, 45532, 795, 1217, "Input",ExpressionUUID->"fa67cb41-f069-45c2-ac35-7fec9b162b28",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[635406, 12736, 909, 14, 38, "Subsection",ExpressionUUID->"2e54da77-49b4-48c1-8e00-2299f8b9c563",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[636318, 12752, 39663, 805, 1177, "Input",ExpressionUUID->"47b2ac4d-a87e-4ae0-87ad-69172bcbc70c",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[676018, 13562, 854, 13, 38, "Subsection",ExpressionUUID->"3570e9ac-d272-4b96-9001-b50f56f5541d",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[735205, 14902, 900, 14, 38, "Subsection",ExpressionUUID->"811240bc-cc80-463f-9cea-e2d952e8e01f",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[736108, 14918, 23137, 480, 631, "Input",ExpressionUUID->"c1d361a6-5f71-41d4-8d88-ae4bda46ac4f",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[759282, 15403, 896, 14, 38, "Subsection",ExpressionUUID->"7cf29985-0c9b-4b37-839d-9fd8450ffc46",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[760181, 15419, 50274, 1198, 2123, "Input",ExpressionUUID->"6c33e863-9695-4dc7-876b-ce221481210e",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[810492, 16622, 948, 14, 48, "Subsection",ExpressionUUID->"7b47484a-83ba-4847-b47c-9bf94eaedaeb",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[818326, 16786, 991, 15, 38, "Subsection",ExpressionUUID->"4a9aff6d-62fa-41b1-810d-f78a53a78348",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[836518, 17136, 740, 12, 51, "Section",ExpressionUUID->"9fda52d0-5195-4525-8283-909c703bb8c5",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[837283, 17152, 1073, 16, 48, "Subsection",ExpressionUUID->"7b41a326-554e-4788-b54f-5e9b4e496e35",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[838359, 17170, 53510, 895, 1617, "Input",ExpressionUUID->"60532982-4547-4e77-ba92-bd33ae4762f3",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[891906, 18070, 855, 13, 38, "Subsection",ExpressionUUID->"414922c6-ad60-46ec-9c2a-4fb995ee3e4b",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[892764, 18085, 228841, 4602, 9572, "Input",ExpressionUUID->"d75933fb-6072-4833-b732-3951906ed5a9",
   InitializationGroup->True,
   CellTags->"codetag"],
  Cell[1121654, 22693, 945, 15, 51, "Section",ExpressionUUID->"55bbcfc0-ffaf-418d-93f4-d13619f4499e",
   InitializationCell->True,
   InitializationGroup->True,
   CellTags->"codetag"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"codetag", 1135303, 23005}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 749, 16, 87, "Chapter",ExpressionUUID->"21d67043-0439-4dcb-9738-67dac4e280fa"],
Cell[CellGroupData[{
Cell[1332, 40, 875, 14, 56, "Chapter",ExpressionUUID->"ef6ebd39-854b-4022-b856-4c37988f2f71",
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[2232, 58, 692, 12, 51, "Section",ExpressionUUID->"f5b1c457-01cb-4338-be9b-e8395d123dd5",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[2949, 74, 755, 12, 48, "Subsection",ExpressionUUID->"fafd933b-3cf8-470e-b533-54cf079c83d9",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[3707, 88, 10520, 167, 218, "Input",ExpressionUUID->"3dd97646-9dcf-481e-ae9a-f62f24f2150d",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[14264, 260, 500, 8, 48, "Subsection",ExpressionUUID->"115e6658-3a3f-4e65-8338-0eb4c442a122",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[14789, 272, 823, 13, 43, "Subsubsection",ExpressionUUID->"43781ef2-a5e6-46e0-ad66-0f9b951abb2d",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[15615, 287, 1002, 30, 57, "Input",ExpressionUUID->"00e1dfb2-2619-4d50-8ef7-495e7ba9429f",
 InitializationGroup->True],
Cell[16620, 319, 4478, 109, 152, "Input",ExpressionUUID->"c76398dd-5245-4bff-a858-39191d16fca2",
 InitializationGroup->True],
Cell[21101, 430, 12538, 304, 374, "Input",ExpressionUUID->"492cd829-20f7-413b-b485-49f0854e3c10",
 InitializationGroup->True],
Cell[33642, 736, 51385, 944, 1687, "Input",ExpressionUUID->"b6987550-1c44-4c8e-83f2-dbe8502c5b66",
 InitializationGroup->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[85088, 1687, 718, 12, 51, "Section",ExpressionUUID->"9193ecb9-32f8-4da2-bc51-b6cc70cf7761",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[85831, 1703, 842, 13, 48, "Subsection",ExpressionUUID->"14d9d1af-a823-466d-936b-5397bbc717e7",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[86676, 1718, 16864, 241, 58, "Input",ExpressionUUID->"b48a3a27-b8ac-4944-9365-c1d822bf61a6",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[103577, 1964, 771, 12, 38, "Subsection",ExpressionUUID->"6965c3f3-0a09-495e-be8e-d91812854299",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[104373, 1980, 708, 11, 43, "Subsubsection",ExpressionUUID->"17439844-4c74-4e24-8f23-9de8f2189807",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[105084, 1993, 4731, 103, 151, "Input",ExpressionUUID->"b8ef69f4-b39c-4568-94c5-6ff81ce75cdb",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[109852, 2101, 761, 12, 38, "Subsubsection",ExpressionUUID->"0fb7dce3-3d99-4ad8-aa9d-5248f675e8ce",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[110616, 2115, 4924, 91, 285, "Input",ExpressionUUID->"89548b47-52e6-4daf-b2fd-9bd745022a34",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[115577, 2211, 756, 12, 38, "Subsubsection",ExpressionUUID->"185fef26-9eea-4b78-815e-c88c518d4804",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[116336, 2225, 4317, 75, 178, "Input",ExpressionUUID->"d1a8fd94-6836-4e4c-815b-264062c5a702",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[120690, 2305, 709, 11, 38, "Subsubsection",ExpressionUUID->"ad4b5aeb-0191-4e7d-9280-6c158f9427c3",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[121402, 2318, 23438, 428, 657, "Input",ExpressionUUID->"611bdf8c-e18e-4751-a3c0-d204533b0f9f",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[144865, 2750, 565, 17, 35, "Input",ExpressionUUID->"2759c0f7-ab79-45f4-b59a-195e6dbc3a9a",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[145433, 2769, 228, 5, 70, "Output",ExpressionUUID->"1676e10e-ba5d-4dc2-bca0-fe079c2372a3",
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[145698, 2779, 2080, 55, 114, "Input",ExpressionUUID->"143c3955-9162-4fed-9972-b8af524e265d",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[147781, 2836, 243, 5, 70, "Output",ExpressionUUID->"40d7d676-e4a6-4f99-8343-1103062578dd",
 CellTags->"codetag"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[148097, 2849, 658, 11, 51, "Section",ExpressionUUID->"661494ca-ef7e-4d69-8288-45d70b6edd5e",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[148780, 2864, 859, 13, 48, "Subsection",ExpressionUUID->"346b2c59-f8f4-4332-bcd4-8278647a60f4",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[149642, 2879, 1239, 25, 71, "Input",ExpressionUUID->"4af41dba-e75c-4e79-8299-07d35ab894f4",
 InitializationGroup->True],
Cell[150884, 2906, 12322, 252, 471, "Input",ExpressionUUID->"3d6f59ac-cd47-44a9-a2e8-703fefb122bb",
 InitializationGroup->True],
Cell[163209, 3160, 6778, 163, 151, "Input",ExpressionUUID->"7f214d9d-cfaa-493b-88d7-37e124271643",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[169990, 3325, 12348, 262, 484, "Input",ExpressionUUID->"1f204ace-288e-4d47-9339-8c139c9cfbb5",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[182341, 3589, 7916, 167, 125, "Input",ExpressionUUID->"3a5e2392-d240-4f7a-bc66-9d48bd3501cf",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[190260, 3758, 3051, 81, 125, "Input",ExpressionUUID->"ce0d0684-5028-4de7-a822-3f068ba70ded",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[193348, 3844, 901, 14, 48, "Subsection",ExpressionUUID->"9dd62609-0be5-441e-a6d4-5a76052af921",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[194252, 3860, 1679, 47, 85, "Input",ExpressionUUID->"9938a427-64dc-4ea0-8bb3-89ae1c335bca",
 InitializationGroup->True],
Cell[195934, 3909, 1272, 40, 58, "Input",ExpressionUUID->"29fc1449-5689-4063-ad1b-e9c2bf726ad0",
 InitializationGroup->True],
Cell[197209, 3951, 5308, 139, 247, "Input",ExpressionUUID->"fcdf6c78-5ab5-4fc3-9e07-cb742990a284",
 InitializationGroup->True],
Cell[202520, 4092, 91798, 1961, 3541, "Input",ExpressionUUID->"34c6c809-d92d-49f5-91d5-21c238677cb1",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[294355, 6058, 900, 14, 38, "Subsection",ExpressionUUID->"e7ff0c19-31d7-4e81-9c80-8dc41f7a2c19",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[295258, 6074, 3470, 85, 287, "Input",ExpressionUUID->"4d5c86ee-641d-4bd3-9332-7dd45c9b9c2e",
 InitializationGroup->True],
Cell[298731, 6161, 6342, 148, 165, "Input",ExpressionUUID->"b0f5f187-0c18-4cde-85ec-d2a1ecf0d2e0",
 InitializationGroup->True],
Cell[305076, 6311, 24333, 584, 1067, "Input",ExpressionUUID->"6ac9819b-115a-4dd5-8449-1342b25f7d15",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[329446, 6900, 873, 13, 38, "Subsection",ExpressionUUID->"9b401317-068f-44f1-b72b-982338d04140",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[330322, 6915, 24063, 561, 817, "Input",ExpressionUUID->"abe77338-1ee6-413c-9388-5fcc6e3f2ed0",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[354388, 7478, 23417, 522, 1004, "Input",ExpressionUUID->"7c14710b-e35b-4f6d-80a5-6dbc0ffe2743",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[377808, 8002, 43557, 940, 1909, "Input",ExpressionUUID->"a6a8b7ee-ea94-47bb-a4c5-ef5acbda0c3e",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[421368, 8944, 26949, 468, 684, "Input",ExpressionUUID->"aa9894db-8484-4180-bc9b-4a044ba673f2",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[448354, 9417, 754, 12, 48, "Subsection",ExpressionUUID->"8f686246-3ffb-4968-9947-c6f97814a846",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[449111, 9431, 139935, 2486, 5292, "Input",ExpressionUUID->"73acf02e-9eae-4023-b010-5d7828bb67dc",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[589083, 11922, 751, 12, 48, "Subsection",ExpressionUUID->"6b588259-a233-43c3-aa3f-764ad1952bfb",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[589837, 11936, 45532, 795, 1217, "Input",ExpressionUUID->"fa67cb41-f069-45c2-ac35-7fec9b162b28",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[635406, 12736, 909, 14, 38, "Subsection",ExpressionUUID->"2e54da77-49b4-48c1-8e00-2299f8b9c563",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[636318, 12752, 39663, 805, 1177, "Input",ExpressionUUID->"47b2ac4d-a87e-4ae0-87ad-69172bcbc70c",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[676018, 13562, 854, 13, 38, "Subsection",ExpressionUUID->"3570e9ac-d272-4b96-9001-b50f56f5541d",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[676875, 13577, 1011, 24, 111, "Input",ExpressionUUID->"3bd8804e-687c-48e6-a9fb-f3c6654a2ff1",
 InitializationGroup->True],
Cell[677889, 13603, 739, 18, 97, "Input",ExpressionUUID->"cd5d9982-322f-4989-bf76-647836dc80ac",
 InitializationGroup->True],
Cell[678631, 13623, 21838, 506, 956, "Input",ExpressionUUID->"c2d12b86-006d-4f13-9057-f329c54fc73d",
 InitializationGroup->True],
Cell[700472, 14131, 6657, 130, 419, "Input",ExpressionUUID->"b450ede4-e687-49e3-aa5e-af4ddc2fdc35",
 InitializationGroup->True],
Cell[707132, 14263, 6132, 136, 246, "Input",ExpressionUUID->"614a636c-614b-4029-a6ea-8e3649f6dcc6",
 InitializationGroup->True],
Cell[713267, 14401, 8961, 201, 313, "Input",ExpressionUUID->"2a58de34-5724-4ba2-b6b6-ffb423515f08",
 InitializationGroup->True],
Cell[722231, 14604, 6949, 152, 406, "Input",ExpressionUUID->"45e28963-cc31-4392-8d46-e7f4a6cac121",
 InitializationGroup->True],
Cell[729183, 14758, 2863, 60, 139, "Input",ExpressionUUID->"c46f8669-714b-4815-a474-eea452bb09ff",
 InitializationGroup->True],
Cell[732049, 14820, 3119, 77, 166, "Input",ExpressionUUID->"7ec15ea6-c934-4165-a964-ce4afaaec45e",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[735205, 14902, 900, 14, 38, "Subsection",ExpressionUUID->"811240bc-cc80-463f-9cea-e2d952e8e01f",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[736108, 14918, 23137, 480, 631, "Input",ExpressionUUID->"c1d361a6-5f71-41d4-8d88-ae4bda46ac4f",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[759282, 15403, 896, 14, 38, "Subsection",ExpressionUUID->"7cf29985-0c9b-4b37-839d-9fd8450ffc46",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[760181, 15419, 50274, 1198, 2123, "Input",ExpressionUUID->"6c33e863-9695-4dc7-876b-ce221481210e",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[810492, 16622, 948, 14, 48, "Subsection",ExpressionUUID->"7b47484a-83ba-4847-b47c-9bf94eaedaeb",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[811443, 16638, 6846, 143, 578, "Input",ExpressionUUID->"abcc06a0-904d-49ed-81e0-427f1a86e045",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[818326, 16786, 991, 15, 38, "Subsection",ExpressionUUID->"4a9aff6d-62fa-41b1-810d-f78a53a78348",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[819320, 16803, 17149, 327, 604, "Input",ExpressionUUID->"9536c29b-5c0d-4461-b8ba-3a3b6d7595c8",
 InitializationGroup->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[836518, 17136, 740, 12, 51, "Section",ExpressionUUID->"9fda52d0-5195-4525-8283-909c703bb8c5",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[CellGroupData[{
Cell[837283, 17152, 1073, 16, 48, "Subsection",ExpressionUUID->"7b41a326-554e-4788-b54f-5e9b4e496e35",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[838359, 17170, 53510, 895, 1617, "Input",ExpressionUUID->"60532982-4547-4e77-ba92-bd33ae4762f3",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]],
Cell[CellGroupData[{
Cell[891906, 18070, 855, 13, 38, "Subsection",ExpressionUUID->"414922c6-ad60-46ec-9c2a-4fb995ee3e4b",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[892764, 18085, 228841, 4602, 9572, "Input",ExpressionUUID->"d75933fb-6072-4833-b732-3951906ed5a9",
 InitializationGroup->True,
 CellTags->"codetag"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1121654, 22693, 945, 15, 51, "Section",ExpressionUUID->"55bbcfc0-ffaf-418d-93f4-d13619f4499e",
 InitializationCell->True,
 InitializationGroup->True,
 CellTags->"codetag"],
Cell[1122602, 22710, 8734, 213, 551, "Input",ExpressionUUID->"9ef36f7b-3b88-45a0-b8bc-8cd4d6b2d20b",
 InitializationGroup->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1131385, 22929, 937, 14, 56, "Chapter",ExpressionUUID->"3e170d52-d1b6-482e-adfe-878a73395286"],
Cell[1132325, 22945, 2246, 37, 35, "Input",ExpressionUUID->"85383d1a-a28d-4c5f-9f3c-fc79b9b170ed",
 InitializationCell->True]
}, Open  ]]
}
]
*)

